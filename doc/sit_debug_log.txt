=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
openwrt2         192.168.1.102  OK
openwrt1         192.168.1.101  OK
rpi1             192.168.1.104  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --scpmod
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --scpmod
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --scpmod
=+=+= NLAN Request to router:rpi1,platform:debian =+=+=+=+=+=+=+=+=+=+=+=+=+=+
operation: --scpmod
=+=+= Files copied to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
target_dir: /opt/nlan
files: ['nlan.py', 'command.py', 'ovsdbrow.py', 'init.py', 'db.py', 'test.py', 'system.py', 'vxlan.py', 'subnets.py', 'gateway.py', 'bridges.py', 'services.py', 'ovsdb.py', 'nlan_agent.py', 'oputil.py', 'cmdutil.py', 'nlan_debian', 'nlan.schema_0.0.1.yaml', 'nlan_openwrt', 'ovsdb_nlan.schema', 'vswitch.schema_2.0.0', 'nlan_env.conf']
exit: 0
=+=+= Files copied to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
target_dir: /opt/nlan
files: ['nlan.py', 'command.py', 'ovsdbrow.py', 'init.py', 'db.py', 'test.py', 'system.py', 'vxlan.py', 'subnets.py', 'gateway.py', 'bridges.py', 'services.py', 'ovsdb.py', 'nlan_agent.py', 'oputil.py', 'cmdutil.py', 'nlan_debian', 'nlan.schema_0.0.1.yaml', 'nlan_openwrt', 'ovsdb_nlan.schema', 'vswitch.schema_2.0.0', 'nlan_env.conf']
exit: 0
=+=+= Files copied to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
target_dir: /opt/nlan
files: ['nlan.py', 'command.py', 'ovsdbrow.py', 'init.py', 'db.py', 'test.py', 'system.py', 'vxlan.py', 'subnets.py', 'gateway.py', 'bridges.py', 'services.py', 'ovsdb.py', 'nlan_agent.py', 'oputil.py', 'cmdutil.py', 'nlan_debian', 'nlan.schema_0.0.1.yaml', 'nlan_openwrt', 'ovsdb_nlan.schema', 'vswitch.schema_2.0.0', 'nlan_env.conf']
exit: 0
=+=+= Files copied to router:rpi1,platform:debian =+=+=+=+=+=+=+=+=+=+=+=+=+=+
target_dir: /opt/nlan
files: ['nlan.py', 'command.py', 'ovsdbrow.py', 'init.py', 'db.py', 'test.py', 'system.py', 'vxlan.py', 'subnets.py', 'gateway.py', 'bridges.py', 'services.py', 'ovsdb.py', 'nlan_agent.py', 'oputil.py', 'cmdutil.py', 'nlan_debian', 'nlan.schema_0.0.1.yaml', 'nlan_openwrt', 'ovsdb_nlan.schema', 'vswitch.schema_2.0.0', 'nlan_env.conf']
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:48:31.835552

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         2.88(sec)
openwrt3          :-)         2.99(sec)
openwrt2          :-)         3.00(sec)
rpi1              :-)         3.08(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
openwrt2         192.168.1.102  OK
openwrt1         192.168.1.101  OK
rpi1             192.168.1.104  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: rm -rf /opt/nlan
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: rm -rf /opt/nlan
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: rm -rf /opt/nlan
=+=+= NLAN Request to router:rpi1,platform:debian =+=+=+=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: rm -rf /opt/nlan
exit: 0
exit: 0
exit: 0
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:48:36.386345

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.68(sec)
openwrt1          :-)         0.69(sec)
openwrt2          :-)         0.72(sec)
rpi1              :-)         0.76(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
openwrt2         192.168.1.102  OK
openwrt1         192.168.1.101  OK
rpi1             192.168.1.104  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --scpmod
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --scpmod
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --scpmod
=+=+= NLAN Request to router:rpi1,platform:debian =+=+=+=+=+=+=+=+=+=+=+=+=+=+
operation: --scpmod
=+=+= Files copied to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
target_dir: /opt/nlan
files: ['nlan.py', 'command.py', 'ovsdbrow.py', 'init.py', 'db.py', 'test.py', 'system.py', 'vxlan.py', 'subnets.py', 'gateway.py', 'bridges.py', 'services.py', 'ovsdb.py', 'nlan_agent.py', 'oputil.py', 'cmdutil.py', 'nlan_debian', 'nlan.schema_0.0.1.yaml', 'nlan_openwrt', 'ovsdb_nlan.schema', 'vswitch.schema_2.0.0', 'nlan_env.conf']
exit: 0
=+=+= Files copied to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
target_dir: /opt/nlan
files: ['nlan.py', 'command.py', 'ovsdbrow.py', 'init.py', 'db.py', 'test.py', 'system.py', 'vxlan.py', 'subnets.py', 'gateway.py', 'bridges.py', 'services.py', 'ovsdb.py', 'nlan_agent.py', 'oputil.py', 'cmdutil.py', 'nlan_debian', 'nlan.schema_0.0.1.yaml', 'nlan_openwrt', 'ovsdb_nlan.schema', 'vswitch.schema_2.0.0', 'nlan_env.conf']
exit: 0
=+=+= Files copied to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
target_dir: /opt/nlan
files: ['nlan.py', 'command.py', 'ovsdbrow.py', 'init.py', 'db.py', 'test.py', 'system.py', 'vxlan.py', 'subnets.py', 'gateway.py', 'bridges.py', 'services.py', 'ovsdb.py', 'nlan_agent.py', 'oputil.py', 'cmdutil.py', 'nlan_debian', 'nlan.schema_0.0.1.yaml', 'nlan_openwrt', 'ovsdb_nlan.schema', 'vswitch.schema_2.0.0', 'nlan_env.conf']
exit: 0
=+=+= Files copied to router:rpi1,platform:debian =+=+=+=+=+=+=+=+=+=+=+=+=+=+
target_dir: /opt/nlan
files: ['nlan.py', 'command.py', 'ovsdbrow.py', 'init.py', 'db.py', 'test.py', 'system.py', 'vxlan.py', 'subnets.py', 'gateway.py', 'bridges.py', 'services.py', 'ovsdb.py', 'nlan_agent.py', 'oputil.py', 'cmdutil.py', 'nlan_debian', 'nlan.schema_0.0.1.yaml', 'nlan_openwrt', 'ovsdb_nlan.schema', 'vswitch.schema_2.0.0', 'nlan_env.conf']
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:48:38.932240

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         2.32(sec)
openwrt1          :-)         2.33(sec)
rpi1              :-)         2.82(sec)
openwrt2          :-)         2.92(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
openwrt2         192.168.1.102  OK
openwrt1         192.168.1.101  OK
rpi1             192.168.1.104  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: init.run
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: init.run
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: init.run
=+=+= NLAN Request to router:rpi1,platform:debian =+=+=+=+=+=+=+=+=+=+=+=+=+=+
command: init.run
=+=+= NLAN Response from router:openwrt1,platform:openwrt =+=+=+=+=+=+=+=+=+=+
[INFO] module:nlan_agent,function:<module>,router:openwrt1
NLAN Agent initialization completed
{'mod_dir': ['command', 'config'], 'etc_dir': '/opt/nlan/etc', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'ip_dvr': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'mode': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}}, 'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'indexes': {'services': 'name', 'subnets': 'vni'}, 'platform': 'openwrt', 'init': False, 'router': 'openwrt1', 'logger': <logging.Logger object at 0xb75734ac>, 'schema': 'ovsdb_nlan.schema'}
[INFO] module:nlan_agent,function:_route,router:openwrt1
function:init.run, args:()
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: lxc-ls
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl --if-exists del-br br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl --if-exists del-br br-int
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl show
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns3 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delif br3 veth-ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br3 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delbr br3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns2 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delif br2 veth-ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br2 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delbr br2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delif br1 veth-ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br1 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delbr br1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns list
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns del ns-global
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns del ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns del ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns del ns1
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","where":[],"op":"delete"}],"method":"transact","id":761353}
... JSON-RPC response ...
{"id":761353,"result":[{"count":1}],"error":null}
__ NLAN response __
message: Execution completed
exit: 0
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
[INFO] module:nlan_agent,function:<module>,router:openwrt3
NLAN Agent initialization completed
{'mod_dir': ['command', 'config'], 'etc_dir': '/opt/nlan/etc', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'ip_dvr': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'mode': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}}, 'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'indexes': {'services': 'name', 'subnets': 'vni'}, 'platform': 'openwrt', 'init': False, 'router': 'openwrt3', 'logger': <logging.Logger object at 0xb75cb50c>, 'schema': 'ovsdb_nlan.schema'}
[INFO] module:nlan_agent,function:_route,router:openwrt3
function:init.run, args:()
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: lxc-ls
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl --if-exists del-br br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl --if-exists del-br br-int
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl show
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns3 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delif br3 veth-ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br3 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delbr br3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns2 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delif br2 veth-ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br2 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delbr br2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns1 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delif br1 veth-ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br1 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delbr br1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns list
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns del ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns del ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns del ns2
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","where":[],"op":"delete"}],"method":"transact","id":936938}
... JSON-RPC response ...
{"id":936938,"result":[{"count":1}],"error":null}
__ NLA=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
[INFO] module:nlan_agent,function:<module>,router:openwrt2
NLAN Agent initialization completed
{'mod_dir': ['command', 'config'], 'etc_dir': '/opt/nlan/etc', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'ip_dvr': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'mode': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}}, 'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'indexes': {'services': 'name', 'subnets': 'vni'}, 'platform': 'openwrt', 'init': False, 'router': 'openwrt2', 'logger': <logging.Logger object at 0xb75a150c>, 'schema': 'ovsdb_nlan.schema'}
[INFO] module:nlan_agent,function:_route,router:openwrt2
function:init.run, args:()
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: lxc-ls
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl --if-exists del-br br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl --if-exists del-br br-int
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl show
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns3 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delif br3 veth-ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br3 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delbr br3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns2 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delif br2 veth-ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br2 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delbr br2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns1 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delif br1 veth-ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br1 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delbr br1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns list
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns del ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns del ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns del ns2
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","where":[],"op":"delete"}],"method":"transact","id":487918}
... JSON-RPC response ...
{"id":487918,"result":[{"count":1}],"error":null}
__ NLAN response __
message: Execution completed
exit: 0
=+=+= NLAN Response from router:rpi1,platform:debian +=+=+=+=+=+=+=+=+=+=+=+=+
[INFO] module:nlan_agent,function:<module>,router:rpi1
NLAN Agent initialization completed
{'mod_dir': ['command', 'config'], 'etc_dir': '/opt/nlan/etc', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'ip_dvr': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'mode': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}}, 'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'indexes': {'services': 'name', 'subnets': 'vni'}, 'platform': 'debian', 'init': False, 'router': 'rpi1', 'logger': <logging.Logger object at 0xb727716c>, 'schema': 'ovsdb_nlan.schema'}
[INFO] module:nlan_agent,function:_route,router:rpi1
function:init.run, args:()
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: lxc-ls
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: lxc-stop -n snort1
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: lxc-stop -n snort2
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl --if-exists del-br br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl --if-exists del-br br-int
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl show
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev dmz.1001 down
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl delif br111 dmz.1001
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev veth-ns111 down
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl delif br111 veth-ns111
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev br111 down
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl delbr br111
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev mz.101 down
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl delif br1 mz.101
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev veth-ns1 down
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl delif br1 veth-ns1
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev br1 down
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl delbr br1
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip netns list
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip netns del ns1
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip netns del ns111
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN", "where": [], "op": "delete"}], "method": "transact", "id": 763240}
... JSON-RPC response ...
{"id":763240,"result":[{"count":1}],"errorN response __
message: Execution completed
exit: 0
":null}
__ NLAN response __
message: Execution completed
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:48:42.976138

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         1.17(sec)
openwrt3          :-)         1.31(sec)
openwrt2          :-)         1.40(sec)
rpi1              :-)         1.49(sec)
cmd: git show HEAD:dvsdvr.yaml
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
openwrt2         192.168.1.102  OK
openwrt1         192.168.1.101  OK
rpi1             192.168.1.104  OK
=+=+= NLAN Request to router:rpi1,platform:debian =+=+=+=+=+=+=+=+=+=+=+=+=+=+
operation: --add
dict_args: "OrderedDict([('bridges', {'ovs_bridges': 'enabled'}), ('services', {('name', 'snort1'): {'name': 'snort1', 'chain': ['mz.101', 'dmz.1001']}}), ('vxlan', {'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.101'], 'local_ip': '192.168.1.104'}), ('subnets', {('vni', 1001): {'peers': ['192.168.1.101'], 'vid': 111, 'vni': 1001, 'ports': ['dmz.1001']}, ('vni', 101): {'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 1, 'vni': 101, 'ports': ['mz.101']}})])"
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --add
dict_args: "OrderedDict([('bridges', {'ovs_bridges': 'enabled'}), ('vxlan', {'remote_ips': ['192.168.1.102', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.103'}), ('subnets', {('vni', 1): {'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 2, 'ip_vhost': '192.168.100.103/24', 'default_gw': '192.168.100.1', 'ip_dvr': '192.168.100.3/24', 'vni': 1}, ('vni', 103): {'ip_vhost': '10.0.3.103/24', 'ip_dvr': '10.0.3.1/24', 'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 3, 'vni': 103}, ('vni', 101): {'peers': ['192.168.1.102', '192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.103/24', 'vni': 101, 'ip_dvr': '10.0.1.1/24', 'mode': 'spoke_dvr'}})])"
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --add
dict_args: "OrderedDict([('bridges', {'ovs_bridges': 'enabled'}), ('vxlan', {'remote_ips': ['192.168.1.103', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.102'}), ('subnets', {('vni', 1): {'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 2, 'ip_vhost': '192.168.100.102/24', 'default_gw': '192.168.100.1', 'ip_dvr': '192.168.100.2/24', 'vni': 1}, ('vni', 103): {'ip_vhost': '10.0.3.102/24', 'ip_dvr': '10.0.3.1/24', 'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 3, 'vni': 103}, ('vni', 101): {'peers': ['192.168.1.103', '192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.102/24', 'vni': 101, 'ip_dvr': '10.0.1.1/24', 'mode': 'spoke_dvr'}})])"
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --add
dict_args: "OrderedDict([('bridges', {'ovs_bridges': 'enabled'}), ('gateway', {'network': 'eth2', 'rip': 'enabled'}), ('vxlan', {'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.104'], 'local_ip': '192.168.1.101'}), ('subnets', {('vni', 1): {'ip_vhost': '192.168.100.101/24', 'ip_dvr': '192.168.100.1/24', 'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 2, 'vni': 1}, ('vni', 103): {'ip_vhost': '10.0.3.101/24', 'ip_dvr': '10.0.3.1/24', 'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 3, 'vni': 103}, ('vni', 1001): {'peers': ['192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.101/24', 'vni': 1001, 'ip_dvr': '10.0.1.1/24', 'mode': 'hub'}})])"
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
[INFO] module:nlan_agent,function:<module>,router:openwrt2
NLAN Agent initialization completed
{'mod_dir': ['command', 'config'], 'etc_dir': '/opt/nlan/etc', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'ip_dvr': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'mode': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}}, 'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'indexes': {'services': 'name', 'subnets': 'vni'}, 'platform': 'openwrt', 'init': False, 'router': 'openwrt2', 'logger': <logging.Logger object at 0xb75c918c>, 'schema': 'ovsdb_nlan.schema'}
[INFO] module:nlan_agent,function:_route,router:openwrt2
function:bridges.add, model:{'ovs_bridges': 'enabled'}
[INFO] module:bridges,function:add,router:openwrt2
Adding bridges: br-int and br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-br br-int
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-br br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl del-flows br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int patch-int -- set interface patch-int type=patch options:peer=patch-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-tun patch-tun -- set interface patch-tun type=patch options:peer=patch-int
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["name","==","patch-tun"]],"op":"select"}],"method":"transact","id":791125}
... JSON-RPC response ...
{"id":791125,"result":[{"rows":[{"options":["map",[["peer","patch-int"]]],"mtu":["set",[]],"link_speed":["set",[]],"statistics":["map",[["collisions",0],["rx_bytes",0],["rx_crc_err",0],["rx_dropped",0],["rx_errors",0],["rx_frame_err",0],["rx_over_err",0],["rx_packets",0],["tx_bytes",0],["tx_dropped",0],["tx_errors",0],["tx_packets",0]]],"mac_in_use":"62:0d:11:9b:9d:37","ingress_policing_rate":0,"ofport":1,"mac":["set",[]],"cfm_fault_status":["set",[]],"duplex":["set",[]],"lacp_current":["set",[]],"cfm_fault":["set",[]],"link_state":["set",[]],"external_ids":["map",[]],"bfd_status":["map",[]],"link_resets":["set",[]],"name":"patch-tun","type":"patch","cfm_remote_opstate":["set",[]],"_uuid":["uuid","9bb08397-e9a0-4379-a87e-6c939bf9b71e"],"status":["map",[]],"ifindex":0,"_version":["uuid","e0178172-849f-458c-be8b-0b39c4d6ace4"],"other_config":["map",[]],"admin_state":["set",[]],"cfm_remote_mpids":["set",[]],"cfm_mpid":["set",[]],"bfd":["map",[]],"ofport_request":["set",[]],"ingress_policing_burst":0,"cfm_flap_count":["set",[]],"cfm_health":["set",[]]}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl del-flows br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=1,actions=resubmit(,1)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=0,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=01:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,19)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=00:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,20)
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["name","==","patch-tun"]],"op":"select"}],"method":"transact","id":771006}
... JSON-RPC response ...
{"id":771006,"result":[{"rows":[{"options":["map",[["peer","patch-int"]]],"mtu":["set",[]],"link_speed":["set",[]],"statistics":["map",[["collisions",0],["rx_bytes",0],["rx_crc_err",0],["rx_dropped",0],["rx_errors",0],["rx_frame_err",0],["rx_over_err",0],["rx_packets",0],["tx_bytes",0],["tx_dropped",0],["tx_errors",0],["tx_packets",0]]],"mac_in_use":"62:0d:11:9b:9d:37","ingress_policing_rate":0,"ofport":1,"mac":["set",[]],"cfm_fault_status":["set",[]],"duplex":["set",[]],"lacp_current":["set",[]],"cfm_fault":["set",[]],"link_state":"up","external_ids":["map",[]],"bfd_status":["map",[]],"link_resets":0,"name":"patch-tun","type":"patch","cfm_remote_opstate":["set",[]],"_uuid":["uuid","9bb08397-e9a0-4379-a87e-6c939bf9b71e"],"status":["map",[]],"ifindex":0,"_version":["uuid","44b14e62-518a-4cdc-8b59-2764371fd368"],"other_config":["map",[]],"admin_state":"up","cfm_remote_mpids":["set",[]],"cfm_mpid":["set",[]],"bfd":["map",[]],"ofport_request":["set",[]],"ingress_policing_burst":0,"cfm_flap_count":["set",[]],"cfm_health":["set",[]]}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=2,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=3,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=10,priority=1,actions=learn(table=20,hard_timeout=300,priority=1,NXM_OF_VLAN_TCI[0..11],NXM_OF_ETH_DST[]=NXM_OF_ETH_SRC[],load:0->NXM_OF_VLAN_TCI[],load:NXM_NX_TUN_ID[]->NXM_NX_TUN_ID[],output:NXM_OF_IN_PORT[]),output:1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=19,priority=0,actions=resubmit(,21)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=20,priority=0,actions=resubmit(,21)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=21,priority=0,actions=drop
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":90883}
... JSON-RPC response ...
{"id":90883,"result":[{"uuid":["uuid","99bbfb91-4a76-4227-b392-2be60a006744"]}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Bridges","where":[],"op":"select"}],"method":"transact","id":1112}
... JSON-RPC response ...
{"id":1112,"result":[{"rows":[]}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Bridges","uuid-name":"temp_320692","row":{"ovs_bridges":"enabled"},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["bridges","insert",["set",[["named-uuid","temp_320692"]]]]],"op":"mutate"}],"method":"transact","id":400708}
... JSON-RPC response ...
{"id":400708,"result":[{"uuid":["uuid","39acf14c-2228-4f4a-9463-17a43b40c5dd"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Bridges","where":[],"op":"select"}],"method":"transact","id":594444}
... JSON-RPC response ...
{"id":594444,"result":[{"rows":[{"_uuid":["uuid","39acf14c-2228-4f4a-9463-17a43b40c5dd"],"_version":["uuid","c424267d-dad0-4b91-9b18-109ae9168a16"],"ovs_bridges":"enabled","controller":["set",[]]}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:openwrt2
function:vxlan.add, model:{'remote_ips': ['192.168.1.103', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.102'}
[INFO] module:vxlan,function:add,router:openwrt2
Adding a VXLAN tunnel: vxlan_103
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-tun vxlan_103 -- set interface vxlan_103 type=vxlan options:in_key=flow options:local_ip=192.168.1.102 options:out_key=flow options:remote_ip=192.168.1.103
[INFO] module:vxlan,function:add,router:openwrt2
Adding a VXLAN tunnel: vxlan_101
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-tun vxlan_101 -- set interface vxlan_101 type=vxlan options:in_key=flow options:local_ip=192.168.1.102 options:out_key=flow options:remote_ip=192.168.1.101
[INFO] module:vxlan,function:add,router:openwrt2
Adding a VXLAN tunnel: vxlan_104
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-tun vxlan_104 -- set interface vxlan_104 type=vxlan options:in_key=flow options:local_ip=192.168.1.102 options:out_key=flow options:remote_ip=192.168.1.104
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["type","==","vxlan"]],"columns":["ofport","options"],"op":"select"}],"method":"transact","id":827069}
... JSON-RPC response ...
{"id":827069,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.102"],["out_key","flow"],["remote_ip","192.168.1.101"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.102"],["out_key","flow"],["remote_ip","192.168.1.103"]]],"ofport":2},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.102"],["out_key","flow"],["remote_ip","192.168.1.104"]]],"ofport":4}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=3,actions=resubmit(,2)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=2,actions=resubmit(,2)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=4,actions=resubmit(,2)
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":701229}
... JSON-RPC response ...
{"id":701229,"result":[{"uuid":["uuid","76f2b80d-5834-476c-8e6b-c24bd36190af"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_VXLAN","where":[],"op":"select"}],"method":"transact","id":985002}
... JSON-RPC response ...
{"id":985002,"result":[{"rows":[]}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_VXLAN","uuid-name":"temp_984566","row":{"remote_ips":["set",["192.168.1.103","192.168.1.101","192.168.1.104"]],"local_ip":"192.168.1.102"},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["vxlan","insert",["set",[["named-uuid","temp_984566"]]]]],"op":"mutate"}],"method":"transact","id":346049}
... JSON-RPC response ...
{"id":346049,"result":[{"uuid":["uuid","851512d8-540e-4913-8f70-777771b430d3"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_VXLAN","where":[],"op":"select"}],"method":"transact","id":994221}
... JSON-RPC response ...
{"id":994221,"result":[{"rows":[{"_version":["uuid","462a00df-27c1-4d42-aafa-e5f07c9340a9"],"_uuid":["uuid","851512d8-540e-4913-8f70-777771b430d3"],"local_ip":"192.168.1.102","remote_ips":["set",["192.168.1.101","192.168.1.103","192.168.1.104"]]}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:openwrt2
function:subnets.add, index:('vni', 1), model:{'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 2, 'ip_vhost': '192.168.100.102/24', 'default_gw': '192.168.100.1', 'ip_dvr': '192.168.100.2/24', 'vni': 1}
[INFO] module:subnets,function:_crud,router:openwrt2
Adding a subnet(vlan): 2
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":360870}
... JSON-RPC response ...
{"id":360870,"result":[{"uuid":["uuid","b01f2ee1-2522-451f-99d7-7b01b6954023"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",1]],"op":"select"}],"method":"transact","id":137643}
... JSON-RPC response ...
{"id":137643,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns add ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addbr br2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link add veth-ns2 type veth peer name temp-ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev temp-ns2 netns ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns2 ip link set dev temp-ns2 name eth0
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int-br2 tag=2 -- set interface int-br2 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int-dvr2 tag=2 -- set interface int-dvr2 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br2 veth-ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br2 int-br2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns2 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns2 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns2 ip link set dev eth0 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-br2 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-br2 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-dvr2 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br2 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns2 ip addr add dev eth0 192.168.100.102/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip addr add dev int-dvr2 192.168.100.2/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns2 ip route add default via 192.168.100.2 dev eth0
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: route
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip route add default via 192.168.100.1
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Controller","where":[],"columns":["target"],"op":"select"}],"method":"transact","id":111086}
... JSON-RPC response ...
{"id":111086,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=1,actions=mod_vlan_vid:2,resubmit(,10)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=2,nw_dst=192.168.100.2,actions=drop
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["type","==","vxlan"]],"columns":["ofport","options"],"op":"select"}],"method":"transact","id":702440}
... JSON-RPC response ...
{"id":702440,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.102"],["out_key","flow"],["remote_ip","192.168.1.101"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.102"],["out_key","flow"],["remote_ip","192.168.1.103"]]],"ofport":2},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.102"],["out_key","flow"],["remote_ip","192.168.1.104"]]],"ofport":4}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=2,actions=strip_vlan,set_tunnel:1,output:3,output:2
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":994791}
... JSON-RPC response ...
{"id":994791,"result":[{"uuid":["uuid","a79c8752-d263-4133-ad92-70f24af72052"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",1]],"op":"select"}],"method":"transact","id":546500}
... JSON-RPC response ...
{"id":546500,"result":[{"rows":[]}],"error":null}
[DEBUG] module:ovsdb,function:crud,router:openwrt2
CRUD operation (add): {'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 2, 'ip_vhost': '192.168.100.102/24', 'default_gw': '192.168.100.1', 'ip_dvr': '192.168.100.2/24', 'vni': 1}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","uuid-name":"temp_608005","row":{"peers":["set",["192.168.1.101","192.168.1.103"]],"vid":2,"ip_vhost":"192.168.100.102/24","default_gw":"192.168.100.1","ip_dvr":"192.168.100.2/24","vni":1},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["subnets","insert",["set",[["named-uuid","temp_608005"]]]]],"op":"mutate"}],"method":"transact","id":591854}
... JSON-RPC response ...
{"id":591854,"result":[{"uuid":["uuid","d644cca7-b398-4b8d-92a4-b8326dcdd364"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",1]],"op":"select"}],"method":"transact","id":977939}
... JSON-RPC response ...
{"id":977939,"result":[{"rows":[{"peers":["set",["192.168.1.101","192.168.1.103"]],"_version":["uuid","46d40c23-7e99-426c-86b4-04d23437b238"],"vni":1,"ports":["set",[]],"mode":["set",[]],"vid":2,"_uuid":["uuid","d644cca7-b398-4b8d-92a4-b8326dcdd364"],"default_gw":"192.168.100.1","ip_vhost":"192.168.100.102/24","ip_dvr":"192.168.100.2/24"}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:openwrt2
function:subnets.add, index:('vni', 103), model:{'ip_dvr': '10.0.3.1/24', 'ip_vhost': '10.0.3.102/24', 'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 3, 'vni': 103}
[INFO] module:subnets,function:_crud,router:openwrt2
Adding a subnet(vlan): 3
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":193702}
... JSON-RPC response ...
{"id":193702,"result":[{"uuid":["uuid","33ee3f4b-3cf3-4dd4-ae21-41037ad66f2c"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",103]],"op":"select"}],"method":"transact","id":511149}
... JSON-RPC response ...
{"id":511149,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns add ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addbr br3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link add veth-ns3 type veth peer name temp-ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev temp-ns3 netns ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns3 ip link set dev temp-ns3 name eth0
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int-br3 tag=3 -- set interface int-br3 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int-dvr3 tag=3 -- set interface int-dvr3 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br3 veth-ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br3 int-br3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns3 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns3 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns3 ip link set dev eth0 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-br3 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-br3 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-dvr3 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br3 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns3 ip addr add dev eth0 10.0.3.102/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip addr add dev int-dvr3 10.0.3.1/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns3 ip route add default via 10.0.3.1 dev eth0
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Controller","where":[],"columns":["target"],"op":"select"}],"method":"transact","id":962046}
... JSON-RPC response ...
{"id":962046,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=103,actions=mod_vlan_vid:3,resubmit(,10)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=3,nw_dst=10.0.3.1,actions=drop
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["type","==","vxlan"]],"columns":["ofport","options"],"op":"select"}],"method":"transact","id":576367}
... JSON-RPC response ...
{"id":576367,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.102"],["out_key","flow"],["remote_ip","192.168.1.101"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.102"],["out_key","flow"],["remote_ip","192.168.1.103"]]],"ofport":2},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.102"],["out_key","flow"],["remote_ip","192.168.1.104"]]],"ofport":4}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=3,actions=strip_vlan,set_tunnel:103,output:3,output:2
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":899077}
... JSON-RPC response ...
{"id":899077,"result":[{"uuid":["uuid","a3199bad-1052-4096-a5b1-d68382f45e18"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",103]],"op":"select"}],"method":"transact","id":763518}
... JSON-RPC response ...
{"id":763518,"result":[{"rows":[]}],"error":null}
[DEBUG] module:ovsdb,function:crud,router:openwrt2
CRUD operation (add): {'ip_dvr': '10.0.3.1/24', 'ip_vhost': '10.0.3.102/24', 'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 3, 'vni': 103}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","uuid-name":"temp_991346","row":{"ip_dvr":"10.0.3.1/24","ip_vhost":"10.0.3.102/24","peers":["set",["192.168.1.101","192.168.1.103"]],"vid":3,"vni":103},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["subnets","insert",["set",[["named-uuid","temp_991346"]]]]],"op":"mutate"}],"method":"transact","id":214051}
... JSON-RPC response ...
{"id":214051,"result":[{"uuid":["uuid","7d061cdf-234d-4a22-8d5c-0b2ba04f872f"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",103]],"op":"select"}],"method":"transact","id":755715}
... JSON-RPC response ...
{"id":755715,"result":[{"rows":[{"peers":["set",["192.168.1.101","192.168.1.103"]],"_version":["uuid","edd8719e-eaa2-4975-8eae-3298c2de870a"],"vni":103,"ports":["set",[]],"mode":["set",[]],"vid":3,"_uuid":["uuid","7d061cdf-234d-4a22-8d5c-0b2ba04f872f"],"default_gw":["set",[]],"ip_vhost":"10.0.3.102/24","ip_dvr":"10.0.3.1/24"}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:openwrt2
function:subnets.add, index:('vni', 101), model:{'peers': ['192.168.1.103', '192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.102/24', 'vni': 101, 'ip_dvr': '10.0.1.1/24', 'mode': 'spoke_dvr'}
[INFO] module:subnets,function:_crud,router:openwrt2
Adding a subnet(vlan): 1
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":73461}
... JSON-RPC response ...
{"id":73461,"result":[{"uuid":["uuid","02eec1f0-264c-4de6-9287-5806c9f2f1f2"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",101]],"op":"select"}],"method":"transact","id":436805}
... JSON-RPC response ...
{"id":436805,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns add ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addbr br1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link add veth-ns1 type veth peer name temp-ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev temp-ns1 netns ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns1 ip link set dev temp-ns1 name eth0
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int-br1 tag=1 -- set interface int-br1 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int-dvr1 tag=1 -- set interface int-dvr1 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br1 veth-ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br1 int-br1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns1 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns1 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns1 ip link set dev eth0 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-br1 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-br1 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-dvr1 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br1 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns1 ip addr add dev eth0 10.0.1.102/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip addr add dev int-dvr1 10.0.1.1/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns1 ip route add default via 10.0.1.1 dev eth0
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Controller","where":[],"columns":["target"],"op":"select"}],"method":"transact","id":658421}
... JSON-RPC response ...
{"id":658421,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=101,actions=mod_vlan_vid:1,resubmit(,10)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link show dev int-dvr1
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["name","==","int-dvr1"]],"op":"select"}],"method":"transact","id":769366}
... JSON-RPC response ...
{"id":769366,"result":[{"rows":[{"options":["map",[]],"mtu":1500,"link_speed":["set",[]],"statistics":["map",[["collisions",0],["rx_bytes",0],["rx_crc_err",0],["rx_dropped",0],["rx_errors",0],["rx_frame_err",0],["rx_over_err",0],["rx_packets",0],["tx_bytes",0],["tx_dropped",0],["tx_errors",0],["tx_packets",0]]],"mac_in_use":"3e:32:3a:94:ac:29","ingress_policing_rate":0,"ofport":7,"mac":["set",[]],"cfm_fault_status":["set",[]],"duplex":["set",[]],"lacp_current":["set",[]],"cfm_fault":["set",[]],"link_state":"up","external_ids":["map",[]],"bfd_status":["map",[]],"link_resets":2,"name":"int-dvr1","type":"internal","cfm_remote_opstate":["set",[]],"_uuid":["uuid","798b5c08-3c68-4158-b2ff-e2d6dd692f2d"],"status":["map",[["driver_name","openvswitch"]]],"ifindex":46,"_version":["uuid","a2074d8c-671c-42cb-960b-50ecc87f0943"],"other_config":["map",[]],"admin_state":"up","cfm_remote_mpids":["set",[]],"cfm_mpid":["set",[]],"bfd":["map",[]],"ofport_request":["set",[]],"ingress_policing_burst":0,"cfm_flap_count":["set",[]],"cfm_health":["set",[]]}]}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["name","==","int-br1"]],"op":"select"}],"method":"transact","id":661178}
... JSON-RPC response ...
{"id":661178,"result":[{"rows":[{"options":["map",[]],"mtu":1500,"link_speed":["set",[]],"statistics":["map",[["collisions",0],["rx_bytes",0],["rx_crc_err",0],["rx_dropped",0],["rx_errors",0],["rx_frame_err",0],["rx_over_err",0],["rx_packets",0],["tx_bytes",0],["tx_dropped",0],["tx_errors",0],["tx_packets",0]]],"mac_in_use":"ae:22:bb:1b:78:6a","ingress_policing_rate":0,"ofport":6,"mac":["set",[]],"cfm_fault_status":["set",[]],"duplex":["set",[]],"lacp_current":["set",[]],"cfm_fault":["set",[]],"link_state":"up","external_ids":["map",[]],"bfd_status":["map",[]],"link_resets":2,"name":"int-br1","type":"internal","cfm_remote_opstate":["set",[]],"_uuid":["uuid","860e7caa-b3a1-45ee-b738-948149be9902"],"status":["map",[["driver_name","openvswitch"]]],"ifindex":45,"_version":["uuid","8d82fd33-4cfe-4012-9c70-03a2e8f2c348"],"other_config":["map",[]],"admin_state":"up","cfm_remote_mpids":["set",[]],"cfm_mpid":["set",[]],"bfd":["map",[]],"ofport_request":["set",[]],"ingress_policing_burst":0,"cfm_flap_count":["set",[]],"cfm_health":["set",[]]}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=0,priority=2,in_port=6,dl_type=0x0800,nw_dst=10.0.1.0/24,actions=normal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=10.0.0.0/8,actions=resubmit(,1)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=172.16.0.0/12,actions=resubmit(,1)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=192.168.0.0/16,actions=resubmit(,1)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=7,dl_type=0x0806,nw_src=10.0.1.1,nw_proto=2,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=1,priority=0,actions=set_field:3e:32:3a:94:ac:29->dl_dst,output:7
[DEBUG] module:ovsdb,function:_send,router:o=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
[INFO] module:nlan_agent,function:<module>,router:openwrt3
NLAN Agent initialization completed
{'mod_dir': ['command', 'config'], 'etc_dir': '/opt/nlan/etc', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'ip_dvr': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'mode': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}}, 'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'indexes': {'services': 'name', 'subnets': 'vni'}, 'platform': 'openwrt', 'init': False, 'router': 'openwrt3', 'logger': <logging.Logger object at 0xb750e18c>, 'schema': 'ovsdb_nlan.schema'}
[INFO] module:nlan_agent,function:_route,router:openwrt3
function:bridges.add, model:{'ovs_bridges': 'enabled'}
[INFO] module:bridges,function:add,router:openwrt3
Adding bridges: br-int and br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-br br-int
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-br br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl del-flows br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int patch-int -- set interface patch-int type=patch options:peer=patch-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-tun patch-tun -- set interface patch-tun type=patch options:peer=patch-int
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["name","==","patch-tun"]],"op":"select"}],"method":"transact","id":25986}
... JSON-RPC response ...
{"id":25986,"result":[{"rows":[{"options":["map",[["peer","patch-int"]]],"mtu":["set",[]],"link_speed":["set",[]],"statistics":["map",[["collisions",0],["rx_bytes",0],["rx_crc_err",0],["rx_dropped",0],["rx_errors",0],["rx_frame_err",0],["rx_over_err",0],["rx_packets",0],["tx_bytes",0],["tx_dropped",0],["tx_errors",0],["tx_packets",0]]],"mac_in_use":"7a:07:63:27:7e:b3","ingress_policing_rate":0,"ofport":1,"mac":["set",[]],"cfm_fault_status":["set",[]],"duplex":["set",[]],"lacp_current":["set",[]],"cfm_fault":["set",[]],"link_state":["set",[]],"external_ids":["map",[]],"bfd_status":["map",[]],"link_resets":["set",[]],"name":"patch-tun","type":"patch","cfm_remote_opstate":["set",[]],"_uuid":["uuid","0ba32f1a-973f-4710-8a43-6cede076ce18"],"status":["map",[]],"ifindex":0,"_version":["uuid","e5d01caf-8330-4686-9b71-2bee5315186e"],"other_config":["map",[]],"admin_state":["set",[]],"cfm_remote_mpids":["set",[]],"cfm_mpid":["set",[]],"bfd":["map",[]],"ofport_request":["set",[]],"ingress_policing_burst":0,"cfm_flap_count":["set",[]],"cfm_health":["set",[]]}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl del-flows br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=1,actions=resubmit(,1)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=0,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=01:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,19)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=00:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,20)
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["name","==","patch-tun"]],"op":"select"}],"method":"transact","id":621382}
... JSON-RPC response ...
{"id":621382,"result":[{"rows":[{"options":["map",[["peer","patch-int"]]],"mtu":["set",[]],"link_speed":["set",[]],"statistics":["map",[["collisions",0],["rx_bytes",0],["rx_crc_err",0],["rx_dropped",0],["rx_errors",0],["rx_frame_err",0],["rx_over_err",0],["rx_packets",0],["tx_bytes",0],["tx_dropped",0],["tx_errors",0],["tx_packets",0]]],"mac_in_use":"7a:07:63:27:7e:b3","ingress_policing_rate":0,"ofport":1,"mac":["set",[]],"cfm_fault_status":["set",[]],"duplex":["set",[]],"lacp_current":["set",[]],"cfm_fault":["set",[]],"link_state":["set",[]],"external_ids":["map",[]],"bfd_status":["map",[]],"link_resets":["set",[]],"name":"patch-tun","type":"patch","cfm_remote_opstate":["set",[]],"_uuid":["uuid","0ba32f1a-973f-4710-8a43-6cede076ce18"],"status":["map",[]],"ifindex":0,"_version":["uuid","e5d01caf-8330-4686-9b71-2bee5315186e"],"other_config":["map",[]],"admin_state":["set",[]],"cfm_remote_mpids":["set",[]],"cfm_mpid":["set",[]],"bfd":["map",[]],"ofport_request":["set",[]],"ingress_policing_burst":0,"cfm_flap_count":["set",[]],"cfm_health":["set",[]]}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=2,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=3,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=10,priority=1,actions=learn(table=20,hard_timeout=300,priority=1,NXM_OF_VLAN_TCI[0..11],NXM_OF_ETH_DST[]=NXM_OF_ETH_SRC[],load:0->NXM_OF_VLAN_TCI[],load:NXM_NX_TUN_ID[]->NXM_NX_TUN_ID[],output:NXM_OF_IN_PORT[]),output:1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=19,priority=0,actions=resubmit(,21)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=20,priority=0,actions=resubmit(,21)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=21,priority=0,actions=drop
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":913686}
... JSON-RPC response ...
{"id":913686,"result":[{"uuid":["uuid","60504770-496d-43bf-ba0e-4d92a3b1883a"]}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Bridges","where":[],"op":"select"}],"method":"transact","id":449321}
... JSON-RPC response ...
{"id":449321,"result":[{"rows":[]}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Bridges","uuid-name":"temp_54428","row":{"ovs_bridges":"enabled"},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["bridges","insert",["set",[["named-uuid","temp_54428"]]]]],"op":"mutate"}],"method":"transact","id":960330}
... JSON-RPC response ...
{"id":960330,"result":[{"uuid":["uuid","3bb492ed-2507-41e0-992a-bdf75cc9a380"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Bridges","where":[],"op":"select"}],"method":"transact","id":197939}
... JSON-RPC response ...
{"id":197939,"result":[{"rows":[{"_uuid":["uuid","3bb492ed-2507-41e0-992a-bdf75cc9a380"],"_version":["uuid","32f75b91-c7de-4d4d-a060-087d19289b32"],"ovs_bridges":"enabled","controller":["set",[]]}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:openwrt3
function:vxlan.add, model:{'remote_ips': ['192.168.1.102', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.103'}
[INFO] module:vxlan,function:add,router:openwrt3
Adding a VXLAN tunnel: vxlan_102
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-tun vxlan_102 -- set interface vxlan_102 type=vxlan options:in_key=flow options:local_ip=192.168.1.103 options:out_key=flow options:remote_ip=192.168.1.102
[INFO] module:vxlan,function:add,router:openwrt3
Adding a VXLAN tunnel: vxlan_101
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-tun vxlan_101 -- set interface vxlan_101 type=vxlan options:in_key=flow options:local_ip=192.168.1.103 options:out_key=flow options:remote_ip=192.168.1.101
[INFO] module:vxlan,function:add,router:openwrt3
Adding a VXLAN tunnel: vxlan_104
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-tun vxlan_104 -- set interface vxlan_104 type=vxlan options:in_key=flow options:local_ip=192.168.1.103 options:out_key=flow options:remote_ip=192.168.1.104
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["type","==","vxlan"]],"columns":["ofport","options"],"op":"select"}],"method":"transact","id":793105}
... JSON-RPC response ...
{"id":793105,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.103"],["out_key","flow"],["remote_ip","192.168.1.101"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.103"],["out_key","flow"],["remote_ip","192.168.1.102"]]],"ofport":2},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.103"],["out_key","flow"],["remote_ip","192.168.1.104"]]],"ofport":4}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=3,actions=resubmit(,2)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=2,actions=resubmit(,2)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=4,actions=resubmit(,2)
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":210165}
... JSON-RPC response ...
{"id":210165,"result":[{"uuid":["uuid","28831317-f294-45e4-807a-3e589651bcd5"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_VXLAN","where":[],"op":"select"}],"method":"transact","id":968864}
... JSON-RPC response ...
{"id":968864,"result":[{"rows":[]}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_VXLAN","uuid-name":"temp_372755","row":{"remote_ips":["set",["192.168.1.102","192.168.1.101","192.168.1.104"]],"local_ip":"192.168.1.103"},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["vxlan","insert",["set",[["named-uuid","temp_372755"]]]]],"op":"mutate"}],"method":"transact","id":806398}
... JSON-RPC response ...
{"id":806398,"result":[{"uuid":["uuid","9de94b13-00a1-4ac4-95a4-b59f1f4a2553"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_VXLAN","where":[],"op":"select"}],"method":"transact","id":850072}
... JSON-RPC response ...
{"id":850072,"result":[{"rows":[{"_version":["uuid","ea0c015b-28a0-4912-bb1b-41959fbf52bd"],"_uuid":["uuid","9de94b13-00a1-4ac4-95a4-b59f1f4a2553"],"local_ip":"192.168.1.103","remote_ips":["set",["192.168.1.101","192.168.1.102","192.168.1.104"]]}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:openwrt3
function:subnets.add, index:('vni', 1), model:{'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 2, 'ip_vhost': '192.168.100.103/24', 'default_gw': '192.168.100.1', 'ip_dvr': '192.168.100.3/24', 'vni': 1}
[INFO] module:subnets,function:_crud,router:openwrt3
Adding a subnet(vlan): 2
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":794175}
... JSON-RPC response ...
{"id":794175,"result":[{"uuid":["uuid","07333b1c-3f06-4bc3-8257-75ba2bc0a198"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",1]],"op":"select"}],"method":"transact","id":952417}
... JSON-RPC response ...
{"id":952417,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns add ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addbr br2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link add veth-ns2 type veth peer name temp-ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev temp-ns2 netns ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns2 ip link set dev temp-ns2 name eth0
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int-br2 tag=2 -- set interface int-br2 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int-dvr2 tag=2 -- set interface int-dvr2 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br2 veth-ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br2 int-br2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns2 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns2 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns2 ip link set dev eth0 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-br2 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-br2 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-dvr2 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br2 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns2 ip addr add dev eth0 192.168.100.103/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip addr add dev int-dvr2 192.168.100.3/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns2 ip route add default via 192.168.100.3 dev eth0
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: route
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip route add default via 192.168.100.1
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Controller","where":[],"columns":["target"],"op":"select"}],"method":"transact","id":598892}
... JSON-RPC response ...
{"id":598892,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=1,actions=mod_vlan_vid:2,resubmit(,10)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=2,nw_dst=192.168.100.3,actions=drop
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["type","==","vxlan"]],"columns":["ofport","options"],"op":"select"}],"method":"transact","id":793598}
... JSON-RPC response ...
{"id":793598,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.103"],["out_key","flow"],["remote_ip","192.168.1.101"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.103"],["out_key","flow"],["remote_ip","192.168.1.102"]]],"ofport":2},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.103"],["out_key","flow"],["remote_ip","192.168.1.104"]]],"ofport":4}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=2,actions=strip_vlan,set_tunnel:1,output:3,output:2
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":277350}
... JSON-RPC response ...
{"id":277350,"result":[{"uuid":["uuid","0699b47c-e9e5-4a4b-af41-79a35903eaba"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",1]],"op":"select"}],"method":"transact","id":252687}
... JSON-RPC response ...
{"id":252687,"result":[{"rows":[]}],"error":null}
[DEBUG] module:ovsdb,function:crud,router:openwrt3
CRUD operation (add): {'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 2, 'ip_vhost': '192.168.100.103/24', 'default_gw': '192.168.100.1', 'ip_dvr': '192.168.100.3/24', 'vni': 1}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","uuid-name":"temp_87036","row":{"peers":["set",["192.168.1.101","192.168.1.102"]],"vid":2,"ip_vhost":"192.168.100.103/24","default_gw":"192.168.100.1","ip_dvr":"192.168.100.3/24","vni":1},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["subnets","insert",["set",[["named-uuid","temp_87036"]]]]],"op":"mutate"}],"method":"transact","id":119392}
... JSON-RPC response ...
{"id":119392,"result":[{"uuid":["uuid","4e41eff8-e0a6-4fd5-8d91-80ebdf8b7788"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",1]],"op":"select"}],"method":"transact","id":798291}
... JSON-RPC response ...
{"id":798291,"result":[{"rows":[{"peers":["set",["192.168.1.101","192.168.1.102"]],"_version":["uuid","6c773286-f4d8-4937-95de-a56bc8a8c96b"],"vni":1,"ports":["set",[]],"mode":["set",[]],"vid":2,"_uuid":["uuid","4e41eff8-e0a6-4fd5-8d91-80ebdf8b7788"],"default_gw":"192.168.100.1","ip_vhost":"192.168.100.103/24","ip_dvr":"192.168.100.3/24"}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:openwrt3
function:subnets.add, index:('vni', 103), model:{'ip_dvr': '10.0.3.1/24', 'ip_vhost': '10.0.3.103/24', 'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 3, 'vni': 103}
[INFO] module:subnets,function:_crud,router:openwrt3
Adding a subnet(vlan): 3
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":741020}
... JSON-RPC response ...
{"id":741020,"result":[{"uuid":["uuid","f7e74d34-49ff-4bf2-b39f-4a71b108a421"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",103]],"op":"select"}],"method":"transact","id":409310}
... JSON-RPC response ...
{"id":409310,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns add ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addbr br3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link add veth-ns3 type veth peer name temp-ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev temp-ns3 netns ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns3 ip link set dev temp-ns3 name eth0
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int-br3 tag=3 -- set interface int-br3 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int-dvr3 tag=3 -- set interface int-dvr3 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br3 veth-ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br3 int-br3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns3 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns3 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns3 ip link set dev eth0 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-br3 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-br3 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-dvr3 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br3 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns3 ip addr add dev eth0 10.0.3.103/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip addr add dev int-dvr3 10.0.3.1/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns3 ip route add default via 10.0.3.1 dev eth0
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Controller","where":[],"columns":["target"],"op":"select"}],"method":"transact","id":17287}
... JSON-RPC response ...
{"id":17287,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=103,actions=mod_vlan_vid:3,resubmit(,10)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=3,nw_dst=10.0.3.1,actions=drop
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["type","==","vxlan"]],"columns":["ofport","options"],"op":"select"}],"method":"transact","id":985326}
... JSON-RPC response ...
{"id":985326,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.103"],["out_key","flow"],["remote_ip","192.168.1.101"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.103"],["out_key","flow"],["remote_ip","192.168.1.102"]]],"ofport":2},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.103"],["out_key","flow"],["remote_ip","192.168.1.104"]]],"ofport":4}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=3,actions=strip_vlan,set_tunnel:103,output:3,output:2
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":464413}
... JSON-RPC response ...
{"id":464413,"result":[{"uuid":["uuid","858386d8-f918-4d83-8ba8-c987d9fd8b64"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",103]],"op":"select"}],"method":"transact","id":546961}
... JSON-RPC response ...
{"id":546961,"result":[{"rows":[]}],"error":null}
[DEBUG] module:ovsdb,function:crud,router:openwrt3
CRUD operation (add): {'ip_dvr': '10.0.3.1/24', 'ip_vhost': '10.0.3.103/24', 'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 3, 'vni': 103}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","uuid-name":"temp_99593","row":{"ip_dvr":"10.0.3.1/24","ip_vhost":"10.0.3.103/24","peers":["set",["192.168.1.101","192.168.1.102"]],"vid":3,"vni":103},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["subnets","insert",["set",[["named-uuid","temp_99593"]]]]],"op":"mutate"}],"method":"transact","id":353696}
... JSON-RPC response ...
{"id":353696,"result":[{"uuid":["uuid","27396896-a74a-4b0f-9adb-3492eb6aa869"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",103]],"op":"select"}],"method":"transact","id":679264}
... JSON-RPC response ...
{"id":679264,"result":[{"rows":[{"peers":["set",["192.168.1.101","192.168.1.102"]],"_version":["uuid","31c6d6bb-8900-44ed-bd58-e8909f3b1c8a"],"vni":103,"ports":["set",[]],"mode":["set",[]],"vid":3,"_uuid":["uuid","27396896-a74a-4b0f-9adb-3492eb6aa869"],"default_gw":["set",[]],"ip_vhost":"10.0.3.103/24","ip_dvr":"10.0.3.1/24"}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:openwrt3
function:subnets.add, index:('vni', 101), model:{'peers': ['192.168.1.102', '192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.103/24', 'vni': 101, 'ip_dvr': '10.0.1.1/24', 'mode': 'spoke_dvr'}
[INFO] module:subnets,function:_crud,router:openwrt3
Adding a subnet(vlan): 1
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":634565}
... JSON-RPC response ...
{"id":634565,"result":[{"uuid":["uuid","1fcd65f7-9733-43d1-9fd1-de30c51fbaf2"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",101]],"op":"select"}],"method":"transact","id":54344}
... JSON-RPC response ...
{"id":54344,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns add ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addbr br1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link add veth-ns1 type veth peer name temp-ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev temp-ns1 netns ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns1 ip link set dev temp-ns1 name eth0
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int-br1 tag=1 -- set interface int-br1 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int-dvr1 tag=1 -- set interface int-dvr1 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br1 veth-ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br1 int-br1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns1 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns1 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns1 ip link set dev eth0 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-br1 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-br1 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-dvr1 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br1 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns1 ip addr add dev eth0 10.0.1.103/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip addr add dev int-dvr1 10.0.1.1/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns1 ip route add default via 10.0.1.1 dev eth0
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Controller","where":[],"columns":["target"],"op":"select"}],"method":"transact","id":736184}
... JSON-RPC response ...
{"id":736184,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=101,actions=mod_vlan_vid:1,resubmit(,10)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link show dev int-dvr1
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["name","==","int-dvr1"]],"op":"select"}],"method":"transact","id":491028}
... JSON-RPC response ...
{"id":491028,"result":[{"rows":[{"options":["map",[]],"mtu":1500,"link_speed":["set",[]],"statistics":["map",[["collisions",0],["rx_bytes",0],["rx_crc_err",0],["rx_dropped",0],["rx_errors",0],["rx_frame_err",0],["rx_over_err",0],["rx_packets",0],["tx_bytes",0],["tx_dropped",0],["tx_errors",0],["tx_packets",0]]],"mac_in_use":"36:69:45:80:61:16","ingress_policing_rate":0,"ofport":7,"mac":["set",[]],"cfm_fault_status":["set",[]],"duplex":["set",[]],"lacp_current":["set",[]],"cfm_fault":["set",[]],"link_state":"up","external_ids":["map",[]],"bfd_status":["map",[]],"link_resets":2,"name":"int-dvr1","type":"internal","cfm_remote_opstate":["set",[]],"_uuid":["uuid","96eb4e19-707e-49b1-a750-cec1c4d0f6a3"],"status":["map",[["driver_name","openvswitch"]]],"ifindex":46,"_version":["uuid","9d00b0f7-fc4e-4c6f-a527-62f63bf219d8"],"other_config":["map",[]],"admin_state":"up","cfm_remote_mpids":["set",[]],"cfm_mpid":["set",[]],"bfd":["map",[]],"ofport_request":["set",[]],"ingress_policing_burst":0,"cfm_flap_count":["set",[]],"cfm_health":["set",[]]}]}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["name","==","int-br1"]],"op":"select"}],"method":"transact","id":856914}
... JSON-RPC response ...
{"id":856914,"result":[{"rows":[{"options":["map",[]],"mtu":1500,"link_speed":["set",[]],"statistics":["map",[["collisions",0],["rx_bytes",0],["rx_crc_err",0],["rx_dropped",0],["rx_errors",0],["rx_frame_err",0],["rx_over_err",0],["rx_packets",0],["tx_bytes",0],["tx_dropped",0],["tx_errors",0],["tx_packets",0]]],"mac_in_use":"ea:03:c5:76:d5:b4","ingress_policing_rate":0,"ofport":6,"mac":["set",[]],"cfm_fault_status":["set",[]],"duplex":["set",[]],"lacp_current":["set",[]],"cfm_fault":["set",[]],"link_state":"up","external_ids":["map",[]],"bfd_status":["map",[]],"link_resets":2,"name":"int-br1","type":"internal","cfm_remote_opstate":["set",[]],"_uuid":["uuid","f6988de8-8b37-4ef6-a65f-2ae75a8fefd3"],"status":["map",[["driver_name","openvswitch"]]],"ifindex":45,"_version":["uuid","6eedab78-1e57-4d3a-a882-4715ec68a208"],"other_config":["map",[]],"admin_state":"up","cfm_remote_mpids":["set",[]],"cfm_mpid":["set",[]],"bfd":["map",[]],"ofport_request":["set",[]],"ingress_policing_burst":0,"cfm_flap_count":["set",[]],"cfm_health":["set",[]]}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=0,priority=2,in_port=6,dl_type=0x0800,nw_dst=10.0.1.0/24,actions=normal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=10.0.0.0/8,actions=resubmit(,1)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=172.16.0.0/12,actions=resubmit(,1)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=192.168.0.0/16,actions=resubmit(,1)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=7,dl_type=0x0806,nw_src=10.0.1.1,nw_proto=2,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=1,priority=0,actions=set_field:36:69:45:80:61:16->dl_dst,output:7
[DEBUG] module:ovsdb,functipenwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["type","==","vxlan"]],"columns":["ofport","options"],"op":"select"}],"method":"transact","id":891864}
... JSON-RPC response ...
{"id":891864,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.102"],["out_key","flow"],["remote_ip","192.168.1.101"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.102"],["out_key","flow"],["remote_ip","192.168.1.103"]]],"ofport":2},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.102"],["out_key","flow"],["remote_ip","192.168.1.104"]]],"ofport":4}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=1,actions=strip_vlan,set_tunnel:101,output:2,output:4
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":813589}
... JSON-RPC response ...
{"id":813589,"result":[{"uuid":["uuid","94ca85c9-fd73-4e29-a5d3-e677fb536105"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",101]],"op":"select"}],"method":"transact","id":108794}
... JSON-RPC response ...
{"id":108794,"result":[{"rows":[]}],"error":null}
[DEBUG] module:ovsdb,function:crud,router:openwrt2
CRUD operation (add): {'peers': ['192.168.1.103', '192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.102/24', 'vni': 101, 'ip_dvr': '10.0.1.1/24', 'mode': 'spoke_dvr'}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","uuid-name":"temp_131063","row":{"peers":["set",["192.168.1.103","192.168.1.104"]],"vid":1,"ip_vhost":"10.0.1.102/24","vni":101,"ip_dvr":"10.0.1.1/24","mode":"spoke_dvr"},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["subnets","insert",["set",[["named-uuid","temp_131063"]]]]],"op":"mutate"}],"method":"transact","id":325860}
... JSON-RPC response ...
{"id":325860,"result":[{"uuid":["uuid","da39c759-a088-4655-b506-388981d06330"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",101]],"op":"select"}],"method":"transact","id":24584}
... JSON-RPC response ...
{"id":24584,"result":[{"rows":[{"peers":["set",["192.168.1.103","192.168.1.104"]],"_version":["uuid","8332b776-0054-4a4e-acd0-b2f9c904117e"],"vni":101,"ports":["set",[]],"mode":"spoke_dvr","vid":1,"_uuid":["uuid","da39c759-a088-4655-b506-388981d06330"],"default_gw":["set",[]],"ip_vhost":"10.0.1.102/24","ip_dvr":"10.0.1.1/24"}]}],"error":null}
__ NLAN response __
message: Execution completed
exit: 0
=+=+= NLAN Response from router:rpi1,platform:debian +=+=+=+=+=+=+=+=+=+=+=+=+
[INFO] module:nlan_agent,function:<module>,router:rpi1
NLAN Agent initialization completed
{'mod_dir': ['command', 'config'], 'etc_dir': '/opt/nlan/etc', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'ip_dvr': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'mode': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}}, 'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'indexes': {'services': 'name', 'subnets': 'vni'}, 'platform': 'debian', 'init': False, 'router': 'rpi1', 'logger': <logging.Logger object at 0xb72a8dcc>, 'schema': 'ovsdb_nlan.schema'}
[INFO] module:nlan_agent,function:_route,router:rpi1
function:bridges.add, model:{'ovs_bridges': 'enabled'}
[INFO] module:bridges,function:add,router:rpi1
Adding bridges: br-int and br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-br br-int
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-br br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl del-flows br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-int patch-int -- set interface patch-int type=patch options:peer=patch-tun
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-tun patch-tun -- set interface patch-tun type=patch options:peer=patch-int
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "Interface", "where": [["name", "==", "patch-tun"]], "op": "select"}], "method": "transact", "id": 18238}
... JSON-RPC response ...
{"id":18238,"result":[{"rows":[{"options":["map",[["peer","patch-int"]]],"mtu":["set",[]],"link_speed":["set",[]],"statistics":["map",[["collisions",0],["rx_bytes",0],["rx_crc_err",0],["rx_dropped",0],["rx_errors",0],["rx_frame_err",0],["rx_over_err",0],["rx_packets",0],["tx_bytes",0],["tx_dropped",0],["tx_errors",0],["tx_packets",0]]],"mac_in_use":"7a:44:ec:27:8a:0a","ingress_policing_rate":0,"mac":["set",[]],"ofport":1,"cfm_fault_status":["set",[]],"duplex":["set",[]],"cfm_fault":["set",[]],"lacp_current":["set",[]],"external_ids":["map",[]],"link_state":["set",[]],"bfd_status":["map",[]],"link_resets":["set",[]],"name":"patch-tun","type":"patch","cfm_remote_opstate":["set",[]],"_uuid":["uuid","d99eaa97-3888-4452-a412-1ceaf12dd24c"],"status":["map",[]],"ifindex":0,"_version":["uuid","1211551b-9ae9-4da6-88c0-d06f11eb4727"],"other_config":["map",[]],"admin_state":["set",[]],"cfm_remote_mpids":["set",[]],"cfm_mpid":["set",[]],"bfd":["map",[]],"ofport_request":["set",[]],"ingress_policing_burst":0,"cfm_flap_count":["set",[]],"cfm_health":["set",[]]}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl del-flows br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=1,actions=resubmit(,1)
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=0,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=01:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,19)
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=00:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,20)
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "Interface", "where": [["name", "==", "patch-tun"]], "op": "select"}], "method": "transact", "id": 805796}
... JSON-RPC response ...
{"id":805796,"result":[{"rows":[{"options":["map",[["peer","patch-int"]]],"mtu":["set",[]],"link_speed":["set",[]],"statistics":["map",[["collisions",0],["rx_bytes",0],["rx_crc_err",0],["rx_dropped",0],["rx_errors",0],["rx_frame_err",0],["rx_over_err",0],["rx_packets",0],["tx_bytes",0],["tx_dropped",0],["tx_errors",0],["tx_packets",0]]],"mac_in_use":"7a:44:ec:27:8a:0a","ingress_policing_rate":0,"mac":["set",[]],"ofport":1,"cfm_fault_status":["set",[]],"duplex":["set",[]],"cfm_fault":["set",[]],"lacp_current":["set",[]],"external_ids":["map",[]],"link_state":"up","bfd_status":["map",[]],"link_resets":0,"name":"patch-tun","type":"patch","cfm_remote_opstate":["set",[]],"_uuid":["uuid","d99eaa97-3888-4452-a412-1ceaf12dd24c"],"status":["map",[]],"ifindex":0,"_version":["uuid","5f5f3ff3-9c2d-4b1d-a589-afc1b9006f8b"],"other_config":["map",[]],"admin_state":"up","cfm_remote_mpids":["set",[]],"cfm_mpid":["set",[]],"bfd":["map",[]],"ofport_request":["set",[]],"ingress_policing_burst":0,"cfm_flap_count":["set",[]],"cfm_health":["set",[]]}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=2,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=3,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=10,priority=1,actions=learn(table=20,hard_timeout=300,priority=1,NXM_OF_VLAN_TCI[0..11],NXM_OF_ETH_DST[]=NXM_OF_ETH_SRC[],load:0->NXM_OF_VLAN_TCI[],load:NXM_NX_TUN_ID[]->NXM_NX_TUN_ID[],output:NXM_OF_IN_PORT[]),output:1
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=19,priority=0,actions=resubmit(,21)
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=20,priority=0,actions=resubmit(,21)
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=21,priority=0,actions=drop
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN", "row": {}, "op": "insert"}], "method": "transact", "id": 987473}
... JSON-RPC response ...
{"id":987473,"result":[{"uuid":["uuid","d6b29784-286f-4d61-8d5c-0e67d16f7e68"]}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_Bridges", "where": [], "op": "select"}], "method": "transact", "id": 128661}
... JSON-RPC response ...
{"id":128661,"result":[{"rows":[]}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_Bridges", "uuid-name": "temp_111075", "row": {"ovs_bridges": "enabled"}, "op": "insert"}, {"table": "NLAN", "where": [], "mutations": [["bridges", "insert", ["set", [["named-uuid", "temp_111075"]]]]], "op": "mutate"}], "method": "transact", "id": 508292}
... JSON-RPC response ...
{"id":508292,"result":[{"uuid":["uuid","cfe1b291-5190-4bdc-bb58-884073f396c2"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_Bridges", "where": [], "op": "select"}], "method": "transact", "id": 8217}
... JSON-RPC response ...
{"id":8217,"result":[{"rows":[{"_uuid":["uuid","cfe1b291-5190-4bdc-bb58-884073f396c2"],"_version":["uuid","8a475655-1992-406f-b988-7126a3f59649"],"ovs_bridges":"enabled","controller":["set",[]]}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:rpi1
function:services.add, index:('name', 'snort1'), model:{'name': 'snort1', 'chain': ['mz.101', 'dmz.1001']}
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: lxc-start -d -f /var/lib/lxc/snort1/config_nlan -n snort1
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN", "row": {}, "op": "insert"}], "method": "transact", "id": 312819}
... JSON-RPC response ...
{"id":312819,"result":[{"uuid":["uuid","3c486cdf-d01c-4c23-b401-ccaa3939a985"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_Service", "where": [["name", "==", "snort1"]], "op": "select"}], "method": "transact", "id": 346859}
... JSON-RPC response ...
{"id":346859,"result":[{"rows":[]}],"error":null}
[DEBUG] module:ovsdb,function:crud,router:rpi1
CRUD operation (add): {'name': 'snort1', 'chain': ['mz.101', 'dmz.1001']}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_Service", "uuid-name": "temp_703640", "row": {"name": "snort1", "chain": ["set", ["mz.101", "dmz.1001"]]}, "op": "insert"}, {"table": "NLAN", "where": [], "mutations": [["services", "insert", ["set", [["named-uuid", "temp_703640"]]]]], "op": "mutate"}], "method": "transact", "id": 53691}
... JSON-RPC response ...
{"id":53691,"result":[{"uuid":["uuid","d2ce244e-807e-4873-bf7c-e673c4e86346"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_Service", "where": [["name", "==", "snort1"]], "op": "select"}], "method": "transact", "id": 203815}
... JSON-RPC response ...
{"id":203815,"result":[{"rows":[{"_version":["uuid","dbd7ef4b-2024-492d-ba2b-aca9ffaa9f5d"],"_uuid":["uuid","d2ce244e-807e-4873-bf7c-e673c4e86346"],"name":"snort1","chain":["set",["dmz.1001","mz.101"]]}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:rpi1
function:vxlan.add, model:{'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.101'], 'local_ip': '192.168.1.104'}
[INFO] module:vxlan,function:add,router:rpi1
Adding a VXLAN tunnel: vxlan_103
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-tun vxlan_103 -- set interface vxlan_103 type=vxlan options:in_key=flow options:local_ip=192.168.1.104 options:out_key=flow options:remote_ip=192.168.1.103
[INFO] module:vxlan,function:add,router:rpi1
Adding a VXLAN tunnel: vxlan_102
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-tun vxlan_102 -- set interface vxlan_102 type=vxlan options:in_key=flow options:local_ip=192.168.1.104 options:out_key=flow options:remote_ip=192.168.1.102
[INFO] module:vxlan,function:add,router:rpi1
Adding a VXLAN tunnel: vxlan_101
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-tun vxlan_101 -- set interface vxlan_101 type=vxlan options:in_key=flow options:local_ip=192.168.1.104 options:out_key=flow options:remote_ip=192.168.1.101
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "Interface", "where": [["type", "==", "vxlan"]], "columns": ["ofport", "options"], "op": "select"}], "method": "transact", "id": 23502}
... JSON-RPC response ...
{"id":23502,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.104"],["out_key","flow"],["remote_ip","192.168.1.101"]]],"ofport":4},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.104"],["out_key","flow"],["remote_ip","192.168.1.102"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.104"],["out_key","flow"],["remote_ip","192.168.1.103"]]],"ofport":2}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=4,actions=resubmit(,2)
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=3,actions=resubmit(,2)
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=2,actions=resubmit(,2)
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN", "row": {}, "op": "insert"}], "method": "transact", "id": 341470}
... JSON-RPC response ...
{"id":341470,"result":[{"uuid":["uuid","9ddb2039-8724-4499-8339-4552f7cd627d"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_VXLAN", "where": [], "op": "select"}], "method": "transact", "id": 295349}
... JSON-RPC response ...
{"id":295349,"result":[{"rows":[]}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_VXLAN", "uuid-name": "temp_407990", "row": {"remote_ips": ["set", ["192.168.1.103", "192.168.1.102", "192.168.1.101"]], "local_ip": "192.168.1.104"}, "op": "insert"}, {"table": "NLAN", "where": [], "mutations": [["vxlan", "insert", ["set", [["named-uuid", "temp_407990"]]]]], "op": "mutate"}], "method": "transact", "id": 340876}
... JSON-RPC response ...
{"id":340876,"result":[{"uuid":["uuid","3ce95f5d-da6c-437d-8015-73ceef1c1140"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_VXLAN", "where": [], "op": "select"}], "method": "transact", "id": 543247}
... JSON-RPC response ...
{"id":543247,"result":[{"rows":[{"_version":["uuid","0c8fca98-33e6-4c32-8c6d-3c89ea76417f"],"_uuid":["uuid","3ce95f5d-da6c-437d-8015-73ceef1c1140"],"remote_ips":["set",["192.168.1.101","192.168.1.102","192.168.1.103"]],"local_ip":"192.168.1.104"}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:rpi1
function:subnets.add, index:('vni', 1001), model:{'peers': ['192.168.1.101'], 'vni': 1001, 'vid': 111, 'ports': ['dmz.1001']}
[INFO] module:subnets,function:_crud,router:rpi1
Adding a subnet(vlan): 111
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN", "row": {}, "op": "insert"}], "method": "transact", "id": 936387}
... JSON-RPC response ...
{"id":936387,"result":[{"uuid":["uuid","b96fa615-2547-4250-affc-1aa61f0e730b"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_Subnet", "where": [["vni", "==", 1001]], "op": "select"}], "method": "transact", "id": 81590}
... JSON-RPC response ...
{"id":81590,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip netns add ns111
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addbr br111
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link add veth-ns111 type veth peer name temp-ns111
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev temp-ns111 netns ns111
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip netns exec ns111 ip link set dev temp-ns111 name eth0
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-int int-br111 tag=111 -- set interface int-br111 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-int int-dvr111 tag=111 -- set interface int-dvr111 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addif br111 veth-ns111
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addif br111 int-br111
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev veth-ns111 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev veth-ns111 up
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip netns exec ns111 ip link set dev eth0 up
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int-br111 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int-br111 up
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int-dvr111 up
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev br111 up
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addif br111 dmz.1001
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "Controller", "where": [], "columns": ["target"], "op": "select"}], "method": "transact", "id": 6740}
... JSON-RPC response ...
{"id":6740,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=1001,actions=mod_vlan_vid:111,resubmit(,10)
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "Interface", "where": [["type", "==", "vxlan"]], "columns": ["ofport", "options"], "op": "select"}], "method": "transact", "id": 778069}
... JSON-RPC response ...
{"id":778069,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.104"],["out_key","flow"],["remote_ip","192.168.1.101"]]],"ofport":4},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.104"],["out_key","flow"],["remote_ip","192.168.1.102"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.104"],["out_key","flow"],["remote_ip","192.168.1.103"]]],"ofport":2}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=111,actions=strip_vlan,set_tunnel:1001,output:4
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN", "row": {}, "op": "insert"}], "method": "transact", "id": 734148}
... JSON-RPC response ...
{"id":734148,"result":[{"uuid":["uuid","3f7115c3-4850-4b1a-8c39-39246c30d5aa"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_Subnet", "where": [["vni", "==", 1001]], "op": "select"}], "method": "transact", "id": 370672}
... JSON-RPC response ...
{"id":370672,"result":[{"rows":[]}],"error":null}
[DEBUG] module:ovsdb,function:crud,router:rpi1
CRUD operation (add): {'peers': ['192.168.1.101'], 'vni': 1001, 'vid': 111, 'ports': ['dmz.1001']}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_Subnet", "uuid-name": "temp_805169", "row": {"peers": ["set", ["192.168.1.101"]], "vid": 111, "vni": 1001, "ports": ["set", ["dmz.1001"]]}, "op": "insert"}, {"table": "NLAN", "where": [], "mutations": [["subnets", "insert", ["set", [["named-uuid", "temp_805169"]]]]], "op": "mutate"}], "method": "transact", "id": 808611}
... JSON-RPC response ...
{"id":808611,"result":[{"uuid":["uuid","7322329f-c9ab-42d8-874c-0d032505654b"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_Subnet", "where": [["vni", "==", 1001]], "op": "select"}], "method": "transact", "id": 126671}
... JSON-RPC response ...
{"id":126671,"result":[{"rows":[{"peers":"192.168.1.101","_version":["uuid","c8b6bdbb-14a0-491b-89ae-ad54e56a5d05"],"vni":1001,"ports":"dmz.1001","mode":["set",[]],"vid":111,"_uuid":["uuid","7322329f-c9ab-42d8-874c-0d032505654b"],"default_gw":["set",[]],"ip_vhost":["set",[]],"ip_dvr":["set",[]]}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:rpi1
function:subnets.add, index:('vni', 101), model:{'peers': ['192.168.1.102', '192.168.1.103'], 'vni': 101, 'vid': 1, 'ports': ['mz.101']}
[INFO] module:subnets,function:_crud,router:rpi1
Adding a subnet(vlan): 1
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN", "row": {}, "op": "insert"}], "method": "transact", "id": 391280}
... JSON-RPC response ...
{"id":391280,"result":[{"uuid":["uuid","42e82b20-3a6c-4dc1-9dc4-b77f9823a5ee"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_Subnet", "where": [["vni", "==", 101]], "op": "select"}], "method": "transact", "id": 361202}
... JSON-RPC response ...
{"id":361202,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip netns add ns1
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addbr br1
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link add veth-ns1 type veth peer name temp-ns1
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev temp-ns1 netns ns1
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip netns exec ns1 ip link set dev temp-ns1 name eth0
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-int int-br1 tag=1 -- set interface int-br1 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-int int-dvr1 tag=1 -- set interface int-dvr1 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addif br1 veth-ns1
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addif br1 int-br1
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev veth-ns1 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev veth-ns1 up
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip netns exec ns1 ip link set dev eth0 up
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int-br1 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int-br1 up
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int-dvr1 up
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev br1 up
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addif br1 mz.101
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "Controller", "where": [], "columns": ["target"], "op": "select"}], "method": "transact", "id": 467619}
... JSON-RPC response ...
{"id":467619,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=101,actions=mod_vlan_vid:1,resubmit(,10)
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "Interface", "where": [["type", "==", "vxlan"]], "columns": ["ofport", "options"], "op": "select"}], "method": "transact", "id": 523886}
... JSON-RPC response ...
{"id":523886,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.104"],["out_key","flow"],["remote_ip","192.168.1.101"]]],"ofport":4},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.104"],["out_key","flow"],["remote_ip","192.168.1.102"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.104"],["out_key","flow"],["remote_ip","192.168.1.103"]]],"ofport":2}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=1,actions=strip_vlan,set_tunnel:101,output:3,output:2
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"tabon:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["type","==","vxlan"]],"columns":["ofport","options"],"op":"select"}],"method":"transact","id":214333}
... JSON-RPC response ...
{"id":214333,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.103"],["out_key","flow"],["remote_ip","192.168.1.101"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.103"],["out_key","flow"],["remote_ip","192.168.1.102"]]],"ofport":2},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.103"],["out_key","flow"],["remote_ip","192.168.1.104"]]],"ofport":4}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=1,actions=strip_vlan,set_tunnel:101,output:2,output:4
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":320098}
... JSON-RPC response ...
{"id":320098,"result":[{"uuid":["uuid","32b8d25c-2c4b-4e0b-abaf-da22128c737d"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",101]],"op":"select"}],"method":"transact","id":15734}
... JSON-RPC response ...
{"id":15734,"result":[{"rows":[]}],"error":null}
[DEBUG] module:ovsdb,function:crud,router:openwrt3
CRUD operation (add): {'peers': ['192.168.1.102', '192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.103/24', 'vni': 101, 'ip_dvr': '10.0.1.1/24', 'mode': 'spoke_dvr'}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","uuid-name":"temp_683171","row":{"peers":["set",["192.168.1.102","192.168.1.104"]],"vid":1,"ip_vhost":"10.0.1.103/24","vni":101,"ip_dvr":"10.0.1.1/24","mode":"spoke_dvr"},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["subnets","insert",["set",[["named-uuid","temp_683171"]]]]],"op":"mutate"}],"method":"transact","id":597899}
... JSON-RPC response ...
{"id":597899,"result":[{"uuid":["uuid","18967f67-218d-4fa6-9d33-8b7cdea3b438"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",101]],"op":"select"}],"method":"transact","id":291084}
... JSON-RPC response ...
{"id":291084,"result":[{"rows":[{"peers":["set",["192.168.1.102","192.168.1.104"]],"_version":["uuid","af7eeb49-2cca-4af6-9b74-5fe064c29304"],"vni":101,"ports":["set",[]],"mode":"spoke_dvr","vid":1,"_uuid":["uuid","18967f67-218d-4fa6-9d33-8b7cdea3b438"],"default_gw":["set",[]],"ip_vhost":"10.0.1.103/24","ip_dvr":"10.0.1.1/24"}]}],"error":null}
__ NLAN response __
message: Execution completed
exit: 0
le": "NLAN", "row": {}, "op": "insert"}], "method": "transact", "id": 32068}
... JSON-RPC response ...
{"id":32068,"result":[{"uuid":["uuid","5054e095-1a11-47aa-b1d9-6939adce922a"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_Subnet", "where": [["vni", "==", 101]], "op": "select"}], "method": "transact", "id": 646045}
... JSON-RPC response ...
{"id":646045,"result":[{"rows":[]}],"error":null}
[DEBUG] module:ovsdb,function:crud,router:rpi1
CRUD operation (add): {'peers': ['192.168.1.102', '192.168.1.103'], 'vni': 101, 'vid': 1, 'ports': ['mz.101']}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_Subnet", "uuid-name": "temp_117948", "row": {"peers": ["set", ["192.168.1.102", "192.168.1.103"]], "vid": 1, "vni": 101, "ports": ["set", ["mz.101"]]}, "op": "insert"}, {"table": "NLAN", "where": [], "mutations": [["subnets", "insert", ["set", [["named-uuid", "temp_117948"]]]]], "op": "mutate"}], "method": "transact", "id": 299451}
... JSON-RPC response ...
{"id":299451,"result":[{"uuid":["uuid","0f877312-2fc1-46a2-8617-df30ec6bb896"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_Subnet", "where": [["vni", "==", 101]], "op": "select"}], "method": "transact", "id": 337795}
... JSON-RPC response ...
{"id":337795,"result":[{"rows":[{"peers":["set",["192.168.1.102","192.168.1.103"]],"_version":["uuid","8b04a07e-c861-416d-891a-c96ebc2efd00"],"vni":101,"ports":"mz.101","mode":["set",[]],"vid":1,"_uuid":["uuid","0f877312-2fc1-46a2-8617-df30ec6bb896"],"default_gw":["set",[]],"ip_vhost":["set",[]],"ip_dvr":["set",[]]}]}],"error":null}
__ NLAN response __
message: Execution completed
exit: 0
=+=+= NLAN Response from router:openwrt1,platform:openwrt =+=+=+=+=+=+=+=+=+=+
[INFO] module:nlan_agent,function:<module>,router:openwrt1
NLAN Agent initialization completed
{'mod_dir': ['command', 'config'], 'etc_dir': '/opt/nlan/etc', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'ip_dvr': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'mode': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}}, 'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'indexes': {'services': 'name', 'subnets': 'vni'}, 'platform': 'openwrt', 'init': False, 'router': 'openwrt1', 'logger': <logging.Logger object at 0xb752212c>, 'schema': 'ovsdb_nlan.schema'}
[INFO] module:nlan_agent,function:_route,router:openwrt1
function:bridges.add, model:{'ovs_bridges': 'enabled'}
[INFO] module:bridges,function:add,router:openwrt1
Adding bridges: br-int and br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-br br-int
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-br br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl del-flows br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int patch-int -- set interface patch-int type=patch options:peer=patch-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-tun patch-tun -- set interface patch-tun type=patch options:peer=patch-int
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["name","==","patch-tun"]],"op":"select"}],"method":"transact","id":855015}
... JSON-RPC response ...
{"id":855015,"result":[{"rows":[{"options":["map",[["peer","patch-int"]]],"mtu":["set",[]],"link_speed":["set",[]],"statistics":["map",[["collisions",0],["rx_bytes",0],["rx_crc_err",0],["rx_dropped",0],["rx_errors",0],["rx_frame_err",0],["rx_over_err",0],["rx_packets",0],["tx_bytes",0],["tx_dropped",0],["tx_errors",0],["tx_packets",0]]],"mac_in_use":"de:d2:36:d3:0b:bb","ingress_policing_rate":0,"ofport":1,"mac":["set",[]],"cfm_fault_status":["set",[]],"duplex":["set",[]],"lacp_current":["set",[]],"cfm_fault":["set",[]],"link_state":["set",[]],"external_ids":["map",[]],"bfd_status":["map",[]],"link_resets":["set",[]],"name":"patch-tun","type":"patch","cfm_remote_opstate":["set",[]],"_uuid":["uuid","1cac14da-6a5a-4856-96e5-e038c6e2f1f3"],"status":["map",[]],"ifindex":0,"_version":["uuid","28b8a588-8027-41f1-b1da-17e16cac9f28"],"other_config":["map",[]],"admin_state":["set",[]],"cfm_remote_mpids":["set",[]],"cfm_mpid":["set",[]],"bfd":["map",[]],"ofport_request":["set",[]],"ingress_policing_burst":0,"cfm_flap_count":["set",[]],"cfm_health":["set",[]]}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl del-flows br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=1,actions=resubmit(,1)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=01:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,19)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=00:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,20)
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["name","==","patch-tun"]],"op":"select"}],"method":"transact","id":806741}
... JSON-RPC response ...
{"id":806741,"result":[{"rows":[{"options":["map",[["peer","patch-int"]]],"mtu":["set",[]],"link_speed":["set",[]],"statistics":["map",[["collisions",0],["rx_bytes",0],["rx_crc_err",0],["rx_dropped",0],["rx_errors",0],["rx_frame_err",0],["rx_over_err",0],["rx_packets",0],["tx_bytes",0],["tx_dropped",0],["tx_errors",0],["tx_packets",0]]],"mac_in_use":"de:d2:36:d3:0b:bb","ingress_policing_rate":0,"ofport":1,"mac":["set",[]],"cfm_fault_status":["set",[]],"duplex":["set",[]],"lacp_current":["set",[]],"cfm_fault":["set",[]],"link_state":"up","external_ids":["map",[]],"bfd_status":["map",[]],"link_resets":0,"name":"patch-tun","type":"patch","cfm_remote_opstate":["set",[]],"_uuid":["uuid","1cac14da-6a5a-4856-96e5-e038c6e2f1f3"],"status":["map",[]],"ifindex":0,"_version":["uuid","9e5514da-6542-4919-b82e-af3365c66961"],"other_config":["map",[]],"admin_state":"up","cfm_remote_mpids":["set",[]],"cfm_mpid":["set",[]],"bfd":["map",[]],"ofport_request":["set",[]],"ingress_policing_burst":0,"cfm_flap_count":["set",[]],"cfm_health":["set",[]]}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=2,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=3,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=10,priority=1,actions=learn(table=20,hard_timeout=300,priority=1,NXM_OF_VLAN_TCI[0..11],NXM_OF_ETH_DST[]=NXM_OF_ETH_SRC[],load:0->NXM_OF_VLAN_TCI[],load:NXM_NX_TUN_ID[]->NXM_NX_TUN_ID[],output:NXM_OF_IN_PORT[]),output:1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=19,priority=0,actions=resubmit(,21)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=20,priority=0,actions=resubmit(,21)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=21,priority=0,actions=drop
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":29747}
... JSON-RPC response ...
{"id":29747,"result":[{"uuid":["uuid","88062309-3553-44e2-a62a-0272a1a3164b"]}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Bridges","where":[],"op":"select"}],"method":"transact","id":193074}
... JSON-RPC response ...
{"id":193074,"result":[{"rows":[]}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Bridges","uuid-name":"temp_731981","row":{"ovs_bridges":"enabled"},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["bridges","insert",["set",[["named-uuid","temp_731981"]]]]],"op":"mutate"}],"method":"transact","id":669327}
... JSON-RPC response ...
{"id":669327,"result":[{"uuid":["uuid","55f340d2-69b5-438a-bf1b-f19d0e41dccb"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Bridges","where":[],"op":"select"}],"method":"transact","id":876897}
... JSON-RPC response ...
{"id":876897,"result":[{"rows":[{"_uuid":["uuid","55f340d2-69b5-438a-bf1b-f19d0e41dccb"],"_version":["uuid","818d3e53-0ed6-4998-af89-8559807e50b9"],"ovs_bridges":"enabled","controller":["set",[]]}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:openwrt1
function:gateway.add, model:{'network': 'eth2', 'rip': 'enabled'}
[INFO] module:gateway,function:add,router:openwrt1
Adding a gateway router: rip
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: vtysh -c configure terminal -c interface eth2 -c link-detect -c exit -c router rip -c version 2 -c redistribute connected -c network eth2 -c exit -c exit -c write -c exit
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: /etc/init.d/quagga start
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: vtysh -c configure terminal -c interface eth2 -c link-detect -c exit -c router rip -c version 2 -c redistribute connected -c network eth2 -c exit -c exit -c write -c exit
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: /etc/init.d/quagga restart
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":7681}
... JSON-RPC response ...
{"id":7681,"result":[{"uuid":["uuid","aba54423-47ad-4cee-bd04-98f089e03beb"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Gateway","where":[],"op":"select"}],"method":"transact","id":404788}
... JSON-RPC response ...
{"id":404788,"result":[{"rows":[]}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Gateway","uuid-name":"temp_818908","row":{"network":"eth2","rip":"enabled"},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["gateway","insert",["set",[["named-uuid","temp_818908"]]]]],"op":"mutate"}],"method":"transact","id":734832}
... JSON-RPC response ...
{"id":734832,"result":[{"uuid":["uuid","fb0668ad-4216-4ddc-81f8-dff2755952f6"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Gateway","where":[],"op":"select"}],"method":"transact","id":238548}
... JSON-RPC response ...
{"id":238548,"result":[{"rows":[{"_version":["uuid","9b2e746f-e9fd-4377-b53f-9abd291d8a10"],"network":"eth2","_uuid":["uuid","fb0668ad-4216-4ddc-81f8-dff2755952f6"],"rip":"enabled"}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:openwrt1
function:vxlan.add, model:{'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.104'], 'local_ip': '192.168.1.101'}
[INFO] module:vxlan,function:add,router:openwrt1
Adding a VXLAN tunnel: vxlan_103
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-tun vxlan_103 -- set interface vxlan_103 type=vxlan options:in_key=flow options:local_ip=192.168.1.101 options:out_key=flow options:remote_ip=192.168.1.103
[INFO] module:vxlan,function:add,router:openwrt1
Adding a VXLAN tunnel: vxlan_102
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-tun vxlan_102 -- set interface vxlan_102 type=vxlan options:in_key=flow options:local_ip=192.168.1.101 options:out_key=flow options:remote_ip=192.168.1.102
[INFO] module:vxlan,function:add,router:openwrt1
Adding a VXLAN tunnel: vxlan_104
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-tun vxlan_104 -- set interface vxlan_104 type=vxlan options:in_key=flow options:local_ip=192.168.1.101 options:out_key=flow options:remote_ip=192.168.1.104
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["type","==","vxlan"]],"columns":["ofport","options"],"op":"select"}],"method":"transact","id":39992}
... JSON-RPC response ...
{"id":39992,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.101"],["out_key","flow"],["remote_ip","192.168.1.102"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.101"],["out_key","flow"],["remote_ip","192.168.1.103"]]],"ofport":2},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.101"],["out_key","flow"],["remote_ip","192.168.1.104"]]],"ofport":4}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=3,actions=resubmit(,2)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=2,actions=resubmit(,2)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=4,actions=resubmit(,2)
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":882981}
... JSON-RPC response ...
{"id":882981,"result":[{"uuid":["uuid","0e22c688-666b-4c5d-8979-d8b44bed4d03"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_VXLAN","where":[],"op":"select"}],"method":"transact","id":65011}
... JSON-RPC response ...
{"id":65011,"result":[{"rows":[]}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_VXLAN","uuid-name":"temp_530594","row":{"remote_ips":["set",["192.168.1.103","192.168.1.102","192.168.1.104"]],"local_ip":"192.168.1.101"},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["vxlan","insert",["set",[["named-uuid","temp_530594"]]]]],"op":"mutate"}],"method":"transact","id":341097}
... JSON-RPC response ...
{"id":341097,"result":[{"uuid":["uuid","a4896120-9215-4c2b-a0c6-8125a4f389f7"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_VXLAN","where":[],"op":"select"}],"method":"transact","id":499879}
... JSON-RPC response ...
{"id":499879,"result":[{"rows":[{"_version":["uuid","ea9bcd6e-7ae4-427a-935a-ab7b44c42753"],"_uuid":["uuid","a4896120-9215-4c2b-a0c6-8125a4f389f7"],"local_ip":"192.168.1.101","remote_ips":["set",["192.168.1.102","192.168.1.103","192.168.1.104"]]}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:openwrt1
function:subnets.add, index:('vni', 1), model:{'ip_dvr': '192.168.100.1/24', 'ip_vhost': '192.168.100.101/24', 'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 2, 'vni': 1}
[INFO] module:subnets,function:_crud,router:openwrt1
Adding a subnet(vlan): 2
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":376984}
... JSON-RPC response ...
{"id":376984,"result":[{"uuid":["uuid","b6f61685-8854-4b30-a0b5-676fa1d16a3c"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",1]],"op":"select"}],"method":"transact","id":557974}
... JSON-RPC response ...
{"id":557974,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns add ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addbr br2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link add veth-ns2 type veth peer name temp-ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev temp-ns2 netns ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns2 ip link set dev temp-ns2 name eth0
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int-br2 tag=2 -- set interface int-br2 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int-dvr2 tag=2 -- set interface int-dvr2 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br2 veth-ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br2 int-br2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns2 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns2 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns2 ip link set dev eth0 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-br2 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-br2 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-dvr2 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br2 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns2 ip addr add dev eth0 192.168.100.101/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip addr add dev int-dvr2 192.168.100.1/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns2 ip route add default via 192.168.100.1 dev eth0
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Controller","where":[],"columns":["target"],"op":"select"}],"method":"transact","id":890663}
... JSON-RPC response ...
{"id":890663,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=1,actions=mod_vlan_vid:2,resubmit(,10)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=2,nw_dst=192.168.100.1,actions=drop
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["type","==","vxlan"]],"columns":["ofport","options"],"op":"select"}],"method":"transact","id":188871}
... JSON-RPC response ...
{"id":188871,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.101"],["out_key","flow"],["remote_ip","192.168.1.102"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.101"],["out_key","flow"],["remote_ip","192.168.1.103"]]],"ofport":2},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.101"],["out_key","flow"],["remote_ip","192.168.1.104"]]],"ofport":4}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=2,actions=strip_vlan,set_tunnel:1,output:3,output:2
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":959762}
... JSON-RPC response ...
{"id":959762,"result":[{"uuid":["uuid","9afb6726-4416-4b37-a5f1-42c219466910"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",1]],"op":"select"}],"method":"transact","id":333609}
... JSON-RPC response ...
{"id":333609,"result":[{"rows":[]}],"error":null}
[DEBUG] module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'ip_dvr': '192.168.100.1/24', 'ip_vhost': '192.168.100.101/24', 'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 2, 'vni': 1}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","uuid-name":"temp_48373","row":{"ip_dvr":"192.168.100.1/24","ip_vhost":"192.168.100.101/24","peers":["set",["192.168.1.102","192.168.1.103"]],"vid":2,"vni":1},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["subnets","insert",["set",[["named-uuid","temp_48373"]]]]],"op":"mutate"}],"method":"transact","id":90225}
... JSON-RPC response ...
{"id":90225,"result":[{"uuid":["uuid","73ca58cb-08d6-4cf7-bbb5-a90f4f290405"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",1]],"op":"select"}],"method":"transact","id":192780}
... JSON-RPC response ...
{"id":192780,"result":[{"rows":[{"peers":["set",["192.168.1.102","192.168.1.103"]],"_version":["uuid","63a6d9d9-511e-4620-b758-c6b4de314972"],"vni":1,"ports":["set",[]],"mode":["set",[]],"vid":2,"_uuid":["uuid","73ca58cb-08d6-4cf7-bbb5-a90f4f290405"],"default_gw":["set",[]],"ip_vhost":"192.168.100.101/24","ip_dvr":"192.168.100.1/24"}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:openwrt1
function:subnets.add, index:('vni', 103), model:{'ip_dvr': '10.0.3.1/24', 'ip_vhost': '10.0.3.101/24', 'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 3, 'vni': 103}
[INFO] module:subnets,function:_crud,router:openwrt1
Adding a subnet(vlan): 3
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":383125}
... JSON-RPC response ...
{"id":383125,"result":[{"uuid":["uuid","9dad93d8-8a06-4a79-b338-ef580f64aa99"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",103]],"op":"select"}],"method":"transact","id":853306}
... JSON-RPC response ...
{"id":853306,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns add ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addbr br3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link add veth-ns3 type veth peer name temp-ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev temp-ns3 netns ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns3 ip link set dev temp-ns3 name eth0
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int-br3 tag=3 -- set interface int-br3 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int-dvr3 tag=3 -- set interface int-dvr3 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br3 veth-ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br3 int-br3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns3 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns3 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns3 ip link set dev eth0 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-br3 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-br3 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-dvr3 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br3 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns3 ip addr add dev eth0 10.0.3.101/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip addr add dev int-dvr3 10.0.3.1/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns3 ip route add default via 10.0.3.1 dev eth0
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Controller","where":[],"columns":["target"],"op":"select"}],"method":"transact","id":79177}
... JSON-RPC response ...
{"id":79177,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=103,actions=mod_vlan_vid:3,resubmit(,10)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=3,nw_dst=10.0.3.1,actions=drop
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["type","==","vxlan"]],"columns":["ofport","options"],"op":"select"}],"method":"transact","id":585050}
... JSON-RPC response ...
{"id":585050,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.101"],["out_key","flow"],["remote_ip","192.168.1.102"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.101"],["out_key","flow"],["remote_ip","192.168.1.103"]]],"ofport":2},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.101"],["out_key","flow"],["remote_ip","192.168.1.104"]]],"ofport":4}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=3,actions=strip_vlan,set_tunnel:103,output:3,output:2
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":370429}
... JSON-RPC response ...
{"id":370429,"result":[{"uuid":["uuid","50514ded-f72b-4e14-9c8d-3bf1925ebb31"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",103]],"op":"select"}],"method":"transact","id":606965}
... JSON-RPC response ...
{"id":606965,"result":[{"rows":[]}],"error":null}
[DEBUG] module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'ip_dvr': '10.0.3.1/24', 'ip_vhost': '10.0.3.101/24', 'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 3, 'vni': 103}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","uuid-name":"temp_235391","row":{"ip_dvr":"10.0.3.1/24","ip_vhost":"10.0.3.101/24","peers":["set",["192.168.1.102","192.168.1.103"]],"vid":3,"vni":103},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["subnets","insert",["set",[["named-uuid","temp_235391"]]]]],"op":"mutate"}],"method":"transact","id":512447}
... JSON-RPC response ...
{"id":512447,"result":[{"uuid":["uuid","d1572448-62ff-415f-9397-8af8e2df0282"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",103]],"op":"select"}],"method":"transact","id":671616}
... JSON-RPC response ...
{"id":671616,"result":[{"rows":[{"peers":["set",["192.168.1.102","192.168.1.103"]],"_version":["uuid","91e223f4-9951-4161-ac38-5071aba3790f"],"vni":103,"ports":["set",[]],"mode":["set",[]],"vid":3,"_uuid":["uuid","d1572448-62ff-415f-9397-8af8e2df0282"],"default_gw":["set",[]],"ip_vhost":"10.0.3.101/24","ip_dvr":"10.0.3.1/24"}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:openwrt1
function:subnets.add, index:('vni', 1001), model:{'peers': ['192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.101/24', 'vni': 1001, 'ip_dvr': '10.0.1.1/24', 'mode': 'hub'}
[INFO] module:subnets,function:_crud,router:openwrt1
Adding a subnet(vlan): 1
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":470281}
... JSON-RPC response ...
{"id":470281,"result":[{"uuid":["uuid","11d1194f-11d9-48a6-a583-a01e522682a2"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",1001]],"op":"select"}],"method":"transact","id":383056}
... JSON-RPC response ...
{"id":383056,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns add ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addbr br1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link add veth-ns1 type veth peer name temp-ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev temp-ns1 netns ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1 ip link set dev temp-ns1 name eth0
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int-br1 tag=1 -- set interface int-br1 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int-dvr1 tag=1 -- set interface int-dvr1 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br1 veth-ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br1 int-br1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1 ip link set dev eth0 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-br1 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-br1 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-dvr1 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br1 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1 ip addr add dev eth0 10.0.1.101/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip addr add dev int-dvr1 10.0.1.1/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1 ip route add default via 10.0.1.1 dev eth0
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Controller","where":[],"columns":["target"],"op":"select"}],"method":"transact","id":189853}
... JSON-RPC response ...
{"id":189853,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=1001,actions=mod_vlan_vid:1,resubmit(,10)
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["type","==","vxlan"]],"columns":["ofport","options"],"op":"select"}],"method":"transact","id":429633}
... JSON-RPC response ...
{"id":429633,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.101"],["out_key","flow"],["remote_ip","192.168.1.102"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.101"],["out_key","flow"],["remote_ip","192.168.1.103"]]],"ofport":2},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.101"],["out_key","flow"],["remote_ip","192.168.1.104"]]],"ofport":4}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=1,actions=strip_vlan,set_tunnel:1001,output:4
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":364632}
... JSON-RPC response ...
{"id":364632,"result":[{"uuid":["uuid","79e327eb-a9f7-49d8-a262-d0901bcb9c94"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",1001]],"op":"select"}],"method":"transact","id":916559}
... JSON-RPC response ...
{"id":916559,"result":[{"rows":[]}],"error":null}
[DEBUG] module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'peers': ['192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.101/24', 'vni': 1001, 'ip_dvr': '10.0.1.1/24', 'mode': 'hub'}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","uuid-name":"temp_597433","row":{"peers":["set",["192.168.1.104"]],"vid":1,"ip_vhost":"10.0.1.101/24","vni":1001,"ip_dvr":"10.0.1.1/24","mode":"hub"},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["subnets","insert",["set",[["named-uuid","temp_597433"]]]]],"op":"mutate"}],"method":"transact","id":424575}
... JSON-RPC response ...
{"id":424575,"result":[{"uuid":["uuid","90cce2f2-750d-4ad4-9c3f-462a3a36e613"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",1001]],"op":"select"}],"method":"transact","id":17944}
... JSON-RPC response ...
{"id":17944,"result":[{"rows":[{"peers":"192.168.1.104","_version":["uuid","dde7ff3e-709c-4152-92f4-274566e21686"],"vni":1001,"ports":["set",[]],"mode":"hub","vid":1,"_uuid":["uuid","90cce2f2-750d-4ad4-9c3f-462a3a36e613"],"default_gw":["set",[]],"ip_vhost":"10.0.1.101/24","ip_dvr":"10.0.1.1/24"}]}],"error":null}
__ NLAN response __
message: Execution completed
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:48:46.181883

Router           Result    Elapsed Time
---------------------------------------
openwrt2          :-)         2.35(sec)
openwrt3          :-)         2.42(sec)
rpi1              :-)         2.54(sec)
openwrt1          :-)         5.21(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns add ns-global
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:48:52.265165

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.29(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip link add veth-global type veth peer name temp
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:48:53.332977

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.36(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip link set dev temp netns ns-global
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:48:54.417348

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.31(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns-global ip link set dev temp name eth0
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:48:55.383038

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.26(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns-global ip addr add dev eth0 8.8.8.8/24
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:48:56.443564

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.29(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip link set dev veth-global up
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:48:57.502238

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.29(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip addr add dev veth-global 8.8.8.1/24
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:48:58.555115

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.29(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns-global ip link set dev eth0 up
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:48:59.653094

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.29(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns-global ip route add default via  8.8.8.1
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:49:00.722667

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.29(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
openwrt2         192.168.1.102  OK
openwrt1         192.168.1.101  OK
rpi1             192.168.1.104  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: test.echo Hello World!
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: test.echo Hello World!
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: test.echo Hello World!
=+=+= NLAN Request to router:rpi1,platform:debian =+=+=+=+=+=+=+=+=+=+=+=+=+=+
command: test.echo Hello World!
=+=+= NLAN Response from router:openwrt1,platform:openwrt =+=+=+=+=+=+=+=+=+=+
Hello World!
__ NLAN response __
message: Execution completed
exit: 0
=+=+= NLAN Response from router:rpi1,platform:debian +=+=+=+=+=+=+=+=+=+=+=+=+
Hello World!
__ NLAN response __
message: Execution completed
exit: 0
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
Hello World!
__ NLAN response __
message: Execution completed
exit: 0
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
Hello World!
__ NLAN response __
message: Execution completed
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:49:01.802587

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.88(sec)
rpi1              :-)         0.89(sec)
openwrt2          :-)         0.97(sec)
openwrt3          :-)         0.98(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns1 ping -c 1 10.0.1.102
=+=+= NLAN Response from router:openwrt1,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.1.102 (10.0.1.102): 56 data bytes
64 bytes from 10.0.1.102: seq=0 ttl=64 time=10.445 ms

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 10.445/10.445/10.445 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:49:04.454425

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.30(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns1 ping -c 1 10.0.1.102
=+=+= NLAN Response from router:openwrt1,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.1.102 (10.0.1.102): 56 data bytes
64 bytes from 10.0.1.102: seq=0 ttl=64 time=1.659 ms

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 1.659/1.659/1.659 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:49:05.520802

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.29(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 10.0.3.103
=+=+= NLAN Response from router:openwrt1,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.3.103 (10.0.3.103): 56 data bytes
64 bytes from 10.0.3.103: seq=0 ttl=64 time=5.707 ms

--- 10.0.3.103 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 5.707/5.707/5.707 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:49:06.578261

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.30(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 10.0.1.101
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.1.101 (10.0.1.101): 56 data bytes
64 bytes from 10.0.1.101: seq=0 ttl=63 time=13.418 ms

--- 10.0.1.101 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 13.418/13.418/13.418 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:49:07.645192

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.30(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns1 ping -c 1 192.168.100.1
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=11.236 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 11.236/11.236/11.236 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:49:08.709037

Router           Result    Elapsed Time
---------------------------------------
openwrt2          :-)         0.29(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns1 ping -c 1 192.168.100.1
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=7.892 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 7.892/7.892/7.892 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:49:09.675875

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.26(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 192.168.100.1
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=6.593 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 6.593/6.593/6.593 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:49:10.735853

Router           Result    Elapsed Time
---------------------------------------
openwrt2          :-)         0.30(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ping -c 1 192.168.100.1
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=4.378 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 4.378/4.378/4.378 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:49:11.788058

Router           Result    Elapsed Time
---------------------------------------
openwrt2          :-)         0.31(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 10.0.1.102
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.1.102 (10.0.1.102): 56 data bytes
64 bytes from 10.0.1.102: seq=0 ttl=63 time=8.064 ms

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 8.064/8.064/8.064 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:49:12.858510

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.30(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 10.0.1.1
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.1.1 (10.0.1.1): 56 data bytes
64 bytes from 10.0.1.1: seq=0 ttl=64 time=2.368 ms

--- 10.0.1.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 2.368/2.368/2.368 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:49:13.910803

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.32(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 10.0.1.1
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.1.1 (10.0.1.1): 56 data bytes
64 bytes from 10.0.1.1: seq=0 ttl=64 time=1.204 ms

--- 10.0.1.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 1.204/1.204/1.204 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:49:14.968014

Router           Result    Elapsed Time
---------------------------------------
openwrt2          :-)         0.30(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns1 ping -c 1 8.8.8.8
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=7.127 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 7.127/7.127/7.127 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:49:16.057420

Router           Result    Elapsed Time
---------------------------------------
openwrt2          :-)         0.33(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 8.8.8.8
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=2.982 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 2.982/2.982/2.982 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:49:17.115699

Router           Result    Elapsed Time
---------------------------------------
openwrt2          :-)         0.29(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns1 ping -c 1 8.8.8.8
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=5.211 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 5.211/5.211/5.211 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:49:18.173542

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.29(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 8.8.8.8
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=6.014 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 6.014/6.014/6.014 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:49:19.297860

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.31(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
openwrt2         192.168.1.102  OK
openwrt1         192.168.1.101  OK
rpi1             192.168.1.104  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: system.reboot
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: system.reboot
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: system.reboot
=+=+= NLAN Request to router:rpi1,platform:debian =+=+=+=+=+=+=+=+=+=+=+=+=+=+
command: system.reboot
=+=+= NLAN Response from router:openwrt1,platform:openwrt =+=+=+=+=+=+=+=+=+=+
__ NLAN response __
message: Execution completed
exit: 0
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
__ NLAN response __
message: Execution completed
exit: 0
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
__ NLAN response __
message: Execution completed
exit: 0
=+=+= NLAN Response from router:rpi1,platform:debian +=+=+=+=+=+=+=+=+=+=+=+=+
__ NLAN response __
message: Execution completed
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:49:20.337184

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.80(sec)
openwrt3          :-)         0.95(sec)
openwrt2          :-)         0.98(sec)
rpi1              :-)         1.10(sec)

Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  NG
openwrt2         192.168.1.102  NG
openwrt1         192.168.1.101  NG
rpi1             192.168.1.104  NG

Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
openwrt2         192.168.1.102  OK
openwrt1         192.168.1.101  OK
rpi1             192.168.1.104  OK
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns add ns-global
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:50:02.421683

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.32(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip link add veth-global type veth peer name temp
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:50:03.501226

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.31(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip link set dev temp netns ns-global
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:50:04.706572

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.37(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns-global ip link set dev temp name eth0
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:50:05.790629

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.32(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns-global ip addr add dev eth0 8.8.8.8/24
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:50:06.800634

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.32(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip link set dev veth-global up
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:50:07.757746

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.27(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip addr add dev veth-global 8.8.8.1/24
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:50:08.827528

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.32(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns-global ip link set dev eth0 up
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:50:09.868404

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.29(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns-global ip route add default via  8.8.8.1
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:50:11.071488

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.32(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
openwrt2         192.168.1.102  OK
openwrt1         192.168.1.101  OK
rpi1             192.168.1.104  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: test.echo Hello World!
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: test.echo Hello World!
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: test.echo Hello World!
=+=+= NLAN Request to router:rpi1,platform:debian =+=+=+=+=+=+=+=+=+=+=+=+=+=+
command: test.echo Hello World!
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
Hello World!
__ NLAN response __
message: Execution completed
exit: 0
=+=+= NLAN Response from router:openwrt1,platform:openwrt =+=+=+=+=+=+=+=+=+=+
Hello World!
__ NLAN response __
message: Execution completed
exit: 0
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
Hello World!
__ NLAN response __
message: Execution completed
exit: 0
=+=+= NLAN Response from router:rpi1,platform:debian +=+=+=+=+=+=+=+=+=+=+=+=+
Hello World!
__ NLAN response __
message: Execution completed
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:50:12.107582

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.70(sec)
openwrt1          :-)         0.84(sec)
openwrt2          :-)         0.89(sec)
rpi1              :-)         1.67(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns1 ping -c 1 10.0.1.102
=+=+= NLAN Response from router:openwrt1,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.1.102 (10.0.1.102): 56 data bytes
64 bytes from 10.0.1.102: seq=0 ttl=64 time=1011.858 ms

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 1011.858/1011.858/1011.858 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:50:14.733036

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         1.32(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns1 ping -c 1 10.0.1.102
=+=+= NLAN Response from router:openwrt1,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.1.102 (10.0.1.102): 56 data bytes
64 bytes from 10.0.1.102: seq=0 ttl=64 time=2.918 ms

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 2.918/2.918/2.918 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:50:16.767217

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.29(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 10.0.3.103
=+=+= NLAN Response from router:openwrt1,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.3.103 (10.0.3.103): 56 data bytes
64 bytes from 10.0.3.103: seq=0 ttl=64 time=6.152 ms

--- 10.0.3.103 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 6.152/6.152/6.152 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:50:17.846746

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.31(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 10.0.1.101
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.1.101 (10.0.1.101): 56 data bytes
64 bytes from 10.0.1.101: seq=0 ttl=63 time=19.419 ms

--- 10.0.1.101 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 19.419/19.419/19.419 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:50:18.931641

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.32(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns1 ping -c 1 192.168.100.1
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=12.363 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 12.363/12.363/12.363 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:50:20.008180

Router           Result    Elapsed Time
---------------------------------------
openwrt2          :-)         0.32(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns1 ping -c 1 192.168.100.1
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=9.581 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 9.581/9.581/9.581 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:50:21.124310

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.30(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 192.168.100.1
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=5.209 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 5.209/5.209/5.209 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:50:22.203727

Router           Result    Elapsed Time
---------------------------------------
openwrt2          :-)         0.30(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ping -c 1 192.168.100.1
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=1.955 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 1.955/1.955/1.955 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:50:23.275303

Router           Result    Elapsed Time
---------------------------------------
openwrt2          :-)         0.28(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 10.0.1.102
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.1.102 (10.0.1.102): 56 data bytes
64 bytes from 10.0.1.102: seq=0 ttl=63 time=4.768 ms

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 4.768/4.768/4.768 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:50:24.367360

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.30(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 10.0.1.1
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.1.1 (10.0.1.1): 56 data bytes
64 bytes from 10.0.1.1: seq=0 ttl=64 time=2.706 ms

--- 10.0.1.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 2.706/2.706/2.706 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:50:25.431877

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.31(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 10.0.1.1
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.1.1 (10.0.1.1): 56 data bytes
64 bytes from 10.0.1.1: seq=0 ttl=64 time=1.293 ms

--- 10.0.1.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 1.293/1.293/1.293 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:50:26.515663

Router           Result    Elapsed Time
---------------------------------------
openwrt2          :-)         0.28(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns1 ping -c 1 8.8.8.8
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=5.756 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 5.756/5.756/5.756 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:50:27.579812

Router           Result    Elapsed Time
---------------------------------------
openwrt2          :-)         0.31(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 8.8.8.8
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=2.393 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 2.393/2.393/2.393 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:50:28.650865

Router           Result    Elapsed Time
---------------------------------------
openwrt2          :-)         0.29(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns1 ping -c 1 8.8.8.8
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=5.176 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 5.176/5.176/5.176 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:50:29.746907

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.29(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 8.8.8.8
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=12.059 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 12.059/12.059/12.059 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-22 20:50:30.824434

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.31(sec)
