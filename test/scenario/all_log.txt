///// TEST: copy the latest modules to the targets /////////////////////////////
///// TEST: initialization /////////////////////////////////////////////////////
///// TEST: add, if _controller and not _ovs_bridges_ (failure) ////////////////
--- RESPONSE from router:openwrt1,platform:openwrt
exception: ModelError
message: cannot add _controller w/o _ovs_bridges_
traceback: Traceback (most recent call last):
  File "/opt/nlan/nlan_agent.py", line 96, in _route
    result = call(m)
  File "/opt/nlan/config/bridges.py", line 52, in add
    raise ModelError(message='cannot add _controller w/o _ovs_bridges_', model=model.model)
ModelError: cannot add _controller w/o _ovs_bridges_
model: {'controller': '192.168.1.1:6633'}

exit: 1
operation: add
progress: OrderedDict([('bridges', False)])
****************
*** SUCCESS! ***
****************
///// TEST: add, _ovs_bridges and not _controller //////////////////////////////
--- STDOUT from router:openwrt1,platform:openwrt
[INFO] module:nlan_agent,function:<module>,router:openwrt1
NLAN Agent initialization completed
{'share_dir': '/opt/nlan/share', 'router': 'openwrt1', 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'enum': ['set', ['enabled']], 'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'ip_dvr': {'max': 2, 'value': {'type': 'string'}, 'key': {'enum': ['set', ['addr', 'mode']], 'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}}, 'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'indexes': {'services': 'name', 'subnets': 'vni'}, 'platform': 'openwrt', 'init': False, 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'logger': <logging.Logger object at 0xb761920c>, 'schema': 'ovsdb_nlan.schema'}
[INFO] module:nlan_agent,function:_route,router:openwrt1
function:bridges.add, model:{'ovs_bridges': 'enabled'}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
request:
  id: 748688
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 748688
  result:
  - rows:
    - _uuid:
      - uuid
      - e472ca27-c78a-4602-b5b6-471cfc06b618
      _version:
      - uuid
      - d6c1c125-2e5d-4842-bc35-10960336fb84
      bridges:
      - set
      - []
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - set
      - []
      vxlan:
      - set
      - []
[DEBUG] module:ovsdb,function:_send,router:openwrt1
request:
  id: 246830
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row: {}
    table: NLAN
response:
  error: null
  id: 246830
  result:
  - uuid:
    - uuid
    - ac58a10f-ca0d-4675-a20a-4eb4c19fff3f
  - details: transaction causes "NLAN" table to contain 2 rows, greater than the schema-defined
      limit of 1 row(s)
    error: constraint violation
[DEBUG] module:ovsdb,function:_send,router:openwrt1
request:
  id: 452892
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Bridges
    where: []
response:
  error: null
  id: 452892
  result:
  - rows: []
[INFO] module:bridges,function:add,router:openwrt1
Adding bridges: br-int and br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-br br-int
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-br br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl del-flows br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int patch-int -- set interface patch-int type=patch options:peer=patch-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-tun patch-tun -- set interface patch-tun type=patch options:peer=patch-int
[DEBUG] module:ovsdb,function:_send,router:openwrt1
request:
  id: 109649
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: Interface
    where:
    - - name
      - ==
      - patch-tun
response:
  error: null
  id: 109649
  result:
  - rows:
    - _uuid:
      - uuid
      - 5744b56d-f3dc-4841-b36f-2c0bd06818fb
      _version:
      - uuid
      - bb24afea-989c-4c49-b6f1-22c63db81402
      admin_state: up
      bfd:
      - map
      - []
      bfd_status:
      - map
      - []
      cfm_fault:
      - set
      - []
      cfm_fault_status:
      - set
      - []
      cfm_flap_count:
      - set
      - []
      cfm_health:
      - set
      - []
      cfm_mpid:
      - set
      - []
      cfm_remote_mpids:
      - set
      - []
      cfm_remote_opstate:
      - set
      - []
      duplex:
      - set
      - []
      external_ids:
      - map
      - []
      ifindex: 0
      ingress_policing_burst: 0
      ingress_policing_rate: 0
      lacp_current:
      - set
      - []
      link_resets: 0
      link_speed:
      - set
      - []
      link_state: up
      mac:
      - set
      - []
      mac_in_use: a2:04:46:c5:48:ef
      mtu:
      - set
      - []
      name: patch-tun
      ofport: 1
      ofport_request:
      - set
      - []
      options:
      - map
      - - - peer
          - patch-int
      other_config:
      - map
      - []
      statistics:
      - map
      - - - collisions
          - 0
        - - rx_bytes
          - 0
        - - rx_crc_err
          - 0
        - - rx_dropped
          - 0
        - - rx_errors
          - 0
        - - rx_frame_err
          - 0
        - - rx_over_err
          - 0
        - - rx_packets
          - 0
        - - tx_bytes
          - 0
        - - tx_dropped
          - 0
        - - tx_errors
          - 0
        - - tx_packets
          - 0
      status:
      - map
      - []
      type: patch
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=1,actions=resubmit(,1)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=01:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,19)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=00:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,20)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=2,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=3,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=10,priority=1,actions=learn(table=20,hard_timeout=300,priority=1,NXM_OF_VLAN_TCI[0..11],NXM_OF_ETH_DST[]=NXM_OF_ETH_SRC[],load:0->NXM_OF_VLAN_TCI[],load:NXM_NX_TUN_ID[]->NXM_NX_TUN_ID[],output:NXM_OF_IN_PORT[]),output:1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=19,priority=0,actions=resubmit(,21)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=20,priority=0,actions=resubmit(,21)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=21,priority=0,actions=drop
[DEBUG] module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'ovs_bridges': 'enabled'}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
request:
  id: 597492
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ovs_bridges: enabled
    table: NLAN_Bridges
    uuid-name: temp_52656
  - mutations:
    - - bridges
      - insert
      - - set
        - - - named-uuid
            - temp_52656
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 597492
  result:
  - uuid:
    - uuid
    - 7966b6cf-dc14-4b99-a9cb-88b8115ca9e4
  - count: 1
[DEBUG] module:ovsdb,function:_send,router:openwrt1
request:
  id: 886567
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Bridges
    where: []
response:
  error: null
  id: 886567
  result:
  - rows:
    - _uuid:
      - uuid
      - 7966b6cf-dc14-4b99-a9cb-88b8115ca9e4
      _version:
      - uuid
      - 0ad04cc6-7d64-462f-91d7-aa1729d899a5
      controller:
      - set
      - []
      ovs_bridges: enabled
///// TEST: add, _ovs_bridges and not _controller (ovs-vsctl) //////////////////
--- STDOUT from router:openwrt1,platform:openwrt
d4f22fa4-2a1c-4609-9893-54182089c8f8
    Bridge br-int
        Port br-int
            Interface br-int
                type: internal
        Port patch-int
            Interface patch-int
                type: patch
                options: {peer=patch-tun}
    Bridge br-tun
        Port patch-tun
            Interface patch-tun
                type: patch
                options: {peer=patch-int}
        Port br-tun
            Interface br-tun
                type: internal
///// TEST: add, _ovs_bridges and not _controller (ovs-ofctl) //////////////////
--- STDOUT from router:openwrt1,platform:openwrt
NXST_FLOW reply (xid=0x4):
 cookie=0x0, duration=2.45s, table=0, n_packets=0, n_bytes=0, idle_age=2, priority=1,in_port=1 actions=resubmit(,1)
 cookie=0x0, duration=2.44s, table=0, n_packets=0, n_bytes=0, idle_age=2, priority=0 actions=drop
 cookie=0x0, duration=2.43s, table=1, n_packets=0, n_bytes=0, idle_age=2, priority=0,dl_dst=01:00:00:00:00:00/01:00:00:00:00:00 actions=resubmit(,19)
 cookie=0x0, duration=2.43s, table=1, n_packets=0, n_bytes=0, idle_age=2, priority=0,dl_dst=00:00:00:00:00:00/01:00:00:00:00:00 actions=resubmit(,20)
 cookie=0x0, duration=2.42s, table=2, n_packets=0, n_bytes=0, idle_age=2, priority=0 actions=drop
 cookie=0x0, duration=2.41s, table=3, n_packets=0, n_bytes=0, idle_age=2, priority=0 actions=drop
 cookie=0x0, duration=2.4s, table=10, n_packets=0, n_bytes=0, idle_age=2, priority=1 actions=learn(table=20,hard_timeout=300,priority=1,NXM_OF_VLAN_TCI[0..11],NXM_OF_ETH_DST[]=NXM_OF_ETH_SRC[],load:0->NXM_OF_VLAN_TCI[],load:NXM_NX_TUN_ID[]->NXM_NX_TUN_ID[],output:NXM_OF_IN_PORT[]),output:1
 cookie=0x0, duration=2.39s, table=19, n_packets=0, n_bytes=0, idle_age=2, priority=0 actions=resubmit(,21)
 cookie=0x0, duration=2.39s, table=20, n_packets=0, n_bytes=0, idle_age=2, priority=0 actions=resubmit(,21)
 cookie=0x0, duration=2.38s, table=21, n_packets=0, n_bytes=0, idle_age=2, priority=0 actions=drop
///// TEST: add, _ovs_bridges and not _controller (ovsdb) //////////////////////
--- STDOUT from router:openwrt1,platform:openwrt
bridges:
  ovs_bridges: enabled
****************
*** SUCCESS! ***
****************
///// TEST: add, _controller and _ovs_bridges_ /////////////////////////////////
///// TEST: add, _controller and _ovs_bridges_ (ovs-vsctl) /////////////////////
--- STDOUT from router:openwrt1,platform:openwrt
d4f22fa4-2a1c-4609-9893-54182089c8f8
    Bridge br-int
        Port br-int
            Interface br-int
                type: internal
        Port patch-int
            Interface patch-int
                type: patch
                options: {peer=patch-tun}
    Bridge br-tun
        Controller "tcp:192.168.1.1:6633"
        Port patch-tun
            Interface patch-tun
                type: patch
                options: {peer=patch-int}
        Port br-tun
            Interface br-tun
                type: internal
///// TEST: add, _controller and _ovs_bridges_ (ovs-ofctl) /////////////////////
--- STDOUT from router:openwrt1,platform:openwrt
NXST_FLOW reply (xid=0x4):
///// TEST: add, _controller and _ovs_bridges_ (ovsdb) /////////////////////////
--- STDOUT from router:openwrt1,platform:openwrt
bridges:
  controller: 192.168.1.1:6633
  ovs_bridges: enabled
****************
*** SUCCESS! ***
****************
///// TEST: delete, _controller and not _ovs_bridges ///////////////////////////
///// TEST: delete, _controller and not _ovs_bridges (ovs-vsctl) ///////////////
--- STDOUT from router:openwrt1,platform:openwrt
d4f22fa4-2a1c-4609-9893-54182089c8f8
    Bridge br-int
        Port br-int
            Interface br-int
                type: internal
        Port patch-int
            Interface patch-int
                type: patch
                options: {peer=patch-tun}
    Bridge br-tun
        Port patch-tun
            Interface patch-tun
                type: patch
                options: {peer=patch-int}
        Port br-tun
            Interface br-tun
                type: internal
///// TEST: delete, _controller and not _ovs_bridges (ovs-ofctl) ///////////////
--- STDOUT from router:openwrt1,platform:openwrt
NXST_FLOW reply (xid=0x4):
 cookie=0x0, duration=2.96s, table=0, n_packets=0, n_bytes=0, idle_age=2, priority=1,in_port=1 actions=resubmit(,1)
 cookie=0x0, duration=2.96s, table=0, n_packets=0, n_bytes=0, idle_age=2, priority=0 actions=drop
 cookie=0x0, duration=2.96s, table=1, n_packets=0, n_bytes=0, idle_age=2, priority=0,dl_dst=01:00:00:00:00:00/01:00:00:00:00:00 actions=resubmit(,19)
 cookie=0x0, duration=2.96s, table=1, n_packets=0, n_bytes=0, idle_age=2, priority=0,dl_dst=00:00:00:00:00:00/01:00:00:00:00:00 actions=resubmit(,20)
 cookie=0x0, duration=2.96s, table=2, n_packets=0, n_bytes=0, idle_age=2, priority=0 actions=drop
 cookie=0x0, duration=2.96s, table=3, n_packets=0, n_bytes=0, idle_age=2, priority=0 actions=drop
 cookie=0x0, duration=2.96s, table=10, n_packets=0, n_bytes=0, idle_age=2, priority=1 actions=learn(table=20,hard_timeout=300,priority=1,NXM_OF_VLAN_TCI[0..11],NXM_OF_ETH_DST[]=NXM_OF_ETH_SRC[],load:0->NXM_OF_VLAN_TCI[],load:NXM_NX_TUN_ID[]->NXM_NX_TUN_ID[],output:NXM_OF_IN_PORT[]),output:1
 cookie=0x0, duration=2.96s, table=19, n_packets=0, n_bytes=0, idle_age=2, priority=0 actions=resubmit(,21)
 cookie=0x0, duration=2.92s, table=20, n_packets=0, n_bytes=0, idle_age=2, priority=0 actions=resubmit(,21)
 cookie=0x0, duration=2.92s, table=21, n_packets=0, n_bytes=0, idle_age=2, priority=0 actions=drop
///// TEST: delete, _controller and not _ovs_bridges (ovsdb) ///////////////////
--- STDOUT from router:openwrt1,platform:openwrt
bridges:
  ovs_bridges: enabled
****************
*** SUCCESS! ***
****************
///// TEST: delete, _ovs_bridges ///////////////////////////////////////////////
///// TEST: delete, _ovs_bridges (ovs-vsctl) ///////////////////////////////////
--- STDOUT from router:openwrt1,platform:openwrt
d4f22fa4-2a1c-4609-9893-54182089c8f8
///// TEST: delete, _ovs_bridges (ovsdb) ///////////////////////////////////////
****************
*** SUCCESS! ***
****************
///// TEST: copy the latest modules to the targets /////////////////////////////
///// TEST: initialization /////////////////////////////////////////////////////
///// TEST: add: _rip and _network /////////////////////////////////////////////
///// TEST: add: _rip and _network (cat) ///////////////////////////////////////
--- STDOUT from router:openwrt1,platform:openwrt
!
! Zebra configuration saved from vty
!   2014/05/13 23:28:23
!
password zebra
!
router rip
 version 2
 redistribute connected
 network eth2
!
access-list vty permit 127.0.0.0/8
access-list vty deny any
!
line vty
 access-class vty
!
!
! Zebra configuration saved from vty
!   2014/05/13 23:28:23
!
password zebra
!
interface bond0
 ipv6 nd suppress-ra
!
interface br-int
 ipv6 nd suppress-ra
!
interface br-tun
 ipv6 nd suppress-ra
!
interface br1
 ipv6 nd suppress-ra
!
interface br2
 ipv6 nd suppress-ra
!
interface br3
 ipv6 nd suppress-ra
!
interface br10
 ipv6 nd suppress-ra
!
interface br101
 ipv6 nd suppress-ra
!
interface br103
 ipv6 nd suppress-ra
!
interface br1001
 ipv6 nd suppress-ra
!
interface eth0
 ipv6 nd suppress-ra
!
interface eth0.2
 ipv6 nd suppress-ra
!
interface eth1
 ipv6 nd suppress-ra
!
interface eth2
 link-detect
 ipv6 nd suppress-ra
!
interface eth3
 ipv6 nd suppress-ra
!
interface gre0
 ipv6 nd suppress-ra
!
interface gretap0
 ipv6 nd suppress-ra
!
interface int-br1
 ipv6 nd suppress-ra
!
interface int-br2
 ipv6 nd suppress-ra
!
interface int-br3
 ipv6 nd suppress-ra
!
interface int-br10
 ipv6 nd suppress-ra
!
interface int-br101
 ipv6 nd suppress-ra
!
interface int-br103
 ipv6 nd suppress-ra
!
interface int-br1001
 ipv6 nd suppress-ra
!
interface int-dvr1
 ipv6 nd suppress-ra
!
interface int-dvr2
 ipv6 nd suppress-ra
!
interface int-dvr3
 ipv6 nd suppress-ra
!
interface int-dvr10
 ipv6 nd suppress-ra
!
interface int-dvr101
 ipv6 nd suppress-ra
!
interface int-dvr103
 ipv6 nd suppress-ra
!
interface int-dvr1001
 ipv6 nd suppress-ra
!
interface ip6gre0
 ipv6 nd suppress-ra
!
interface ip6tnl0
 ipv6 nd suppress-ra
!
interface lo
!
interface ovs-system
 ipv6 nd suppress-ra
!
interface temp
 ipv6 nd suppress-ra
!
interface temp-ns1
 ipv6 nd suppress-ra
!
interface temp-ns2
 ipv6 nd suppress-ra
!
interface temp-ns3
 ipv6 nd suppress-ra
!
interface temp-ns10
 ipv6 nd suppress-ra
!
interface temp-ns101
 ipv6 nd suppress-ra
!
interface temp-ns103
 ipv6 nd suppress-ra
!
interface temp-ns1001
 ipv6 nd suppress-ra
!
interface tunl0
 ipv6 nd suppress-ra
!
interface veth-global
 ipv6 nd suppress-ra
!
interface veth-ns1
 ipv6 nd suppress-ra
!
interface veth-ns2
 ipv6 nd suppress-ra
!
interface veth-ns3
 ipv6 nd suppress-ra
!
interface veth-ns10
 ipv6 nd suppress-ra
!
interface veth-ns101
 ipv6 nd suppress-ra
!
interface veth-ns103
 ipv6 nd suppress-ra
!
interface veth-ns1001
 ipv6 nd suppress-ra
!
interface veth0.1
 ipv6 nd suppress-ra
!
interface veth0.1p
 ipv6 nd suppress-ra
!
interface veth0.3
 ipv6 nd suppress-ra
!
interface veth0.3p
 ipv6 nd suppress-ra
!
access-list vty permit 127.0.0.0/8
access-list vty deny any
!
ip forwarding
!
!
line vty
 access-class vty
!
///// TEST: update: _network ///////////////////////////////////////////////////
///// TEST: update: _rip and _network (cat) ////////////////////////////////////
--- STDOUT from router:openwrt1,platform:openwrt
!
! Zebra configuration saved from vty
!   2014/05/13 23:28:26
!
password zebra
!
router rip
 version 2
 redistribute connected
 network eth1
!
access-list vty permit 127.0.0.0/8
access-list vty deny any
!
line vty
 access-class vty
!
!
! Zebra configuration saved from vty
!   2014/05/13 23:28:26
!
password zebra
!
interface bond0
 ipv6 nd suppress-ra
!
interface br-int
 ipv6 nd suppress-ra
!
interface br-tun
 ipv6 nd suppress-ra
!
interface br1
 ipv6 nd suppress-ra
!
interface br2
 ipv6 nd suppress-ra
!
interface br3
 ipv6 nd suppress-ra
!
interface br10
 ipv6 nd suppress-ra
!
interface br101
 ipv6 nd suppress-ra
!
interface br103
 ipv6 nd suppress-ra
!
interface br1001
 ipv6 nd suppress-ra
!
interface eth0
 ipv6 nd suppress-ra
!
interface eth0.2
 ipv6 nd suppress-ra
!
interface eth1
 link-detect
 ipv6 nd suppress-ra
!
interface eth2
 ipv6 nd suppress-ra
!
interface eth3
 ipv6 nd suppress-ra
!
interface gre0
 ipv6 nd suppress-ra
!
interface gretap0
 ipv6 nd suppress-ra
!
interface int-br1
 ipv6 nd suppress-ra
!
interface int-br2
 ipv6 nd suppress-ra
!
interface int-br3
 ipv6 nd suppress-ra
!
interface int-br10
 ipv6 nd suppress-ra
!
interface int-br101
 ipv6 nd suppress-ra
!
interface int-br103
 ipv6 nd suppress-ra
!
interface int-br1001
 ipv6 nd suppress-ra
!
interface int-dvr1
 ipv6 nd suppress-ra
!
interface int-dvr2
 ipv6 nd suppress-ra
!
interface int-dvr3
 ipv6 nd suppress-ra
!
interface int-dvr10
 ipv6 nd suppress-ra
!
interface int-dvr101
 ipv6 nd suppress-ra
!
interface int-dvr103
 ipv6 nd suppress-ra
!
interface int-dvr1001
 ipv6 nd suppress-ra
!
interface ip6gre0
 ipv6 nd suppress-ra
!
interface ip6tnl0
 ipv6 nd suppress-ra
!
interface lo
!
interface ovs-system
 ipv6 nd suppress-ra
!
interface temp
 ipv6 nd suppress-ra
!
interface temp-ns1
 ipv6 nd suppress-ra
!
interface temp-ns2
 ipv6 nd suppress-ra
!
interface temp-ns3
 ipv6 nd suppress-ra
!
interface temp-ns10
 ipv6 nd suppress-ra
!
interface temp-ns101
 ipv6 nd suppress-ra
!
interface temp-ns103
 ipv6 nd suppress-ra
!
interface temp-ns1001
 ipv6 nd suppress-ra
!
interface tunl0
 ipv6 nd suppress-ra
!
interface veth-global
 ipv6 nd suppress-ra
!
interface veth-ns1
 ipv6 nd suppress-ra
!
interface veth-ns2
 ipv6 nd suppress-ra
!
interface veth-ns3
 ipv6 nd suppress-ra
!
interface veth-ns10
 ipv6 nd suppress-ra
!
interface veth-ns101
 ipv6 nd suppress-ra
!
interface veth-ns103
 ipv6 nd suppress-ra
!
interface veth-ns1001
 ipv6 nd suppress-ra
!
interface veth0.1
 ipv6 nd suppress-ra
!
interface veth0.1p
 ipv6 nd suppress-ra
!
interface veth0.3
 ipv6 nd suppress-ra
!
interface veth0.3p
 ipv6 nd suppress-ra
!
access-list vty permit 127.0.0.0/8
access-list vty deny any
!
ip forwarding
!
!
line vty
 access-class vty
!
///// TEST: delete: _rip and _network //////////////////////////////////////////
///// TEST: delete: _rip and _network (cat) ////////////////////////////////////
--- STDOUT from router:openwrt1,platform:openwrt
!
! Zebra configuration saved from vty
!   2014/05/13 23:28:28
!
password zebra
!
router rip
!
access-list vty permit 127.0.0.0/8
access-list vty deny any
!
line vty
 access-class vty
!
!
! Zebra configuration saved from vty
!   2014/05/13 23:28:28
!
password zebra
!
interface bond0
 ipv6 nd suppress-ra
!
interface br-int
 ipv6 nd suppress-ra
!
interface br-tun
 ipv6 nd suppress-ra
!
interface br1
 ipv6 nd suppress-ra
!
interface br2
 ipv6 nd suppress-ra
!
interface br3
 ipv6 nd suppress-ra
!
interface br10
 ipv6 nd suppress-ra
!
interface br101
 ipv6 nd suppress-ra
!
interface br103
 ipv6 nd suppress-ra
!
interface br1001
 ipv6 nd suppress-ra
!
interface eth0
 ipv6 nd suppress-ra
!
interface eth0.2
 ipv6 nd suppress-ra
!
interface eth1
 ipv6 nd suppress-ra
!
interface eth2
 ipv6 nd suppress-ra
!
interface eth3
 ipv6 nd suppress-ra
!
interface gre0
 ipv6 nd suppress-ra
!
interface gretap0
 ipv6 nd suppress-ra
!
interface int-br1
 ipv6 nd suppress-ra
!
interface int-br2
 ipv6 nd suppress-ra
!
interface int-br3
 ipv6 nd suppress-ra
!
interface int-br10
 ipv6 nd suppress-ra
!
interface int-br101
 ipv6 nd suppress-ra
!
interface int-br103
 ipv6 nd suppress-ra
!
interface int-br1001
 ipv6 nd suppress-ra
!
interface int-dvr1
 ipv6 nd suppress-ra
!
interface int-dvr2
 ipv6 nd suppress-ra
!
interface int-dvr3
 ipv6 nd suppress-ra
!
interface int-dvr10
 ipv6 nd suppress-ra
!
interface int-dvr101
 ipv6 nd suppress-ra
!
interface int-dvr103
 ipv6 nd suppress-ra
!
interface int-dvr1001
 ipv6 nd suppress-ra
!
interface ip6gre0
 ipv6 nd suppress-ra
!
interface ip6tnl0
 ipv6 nd suppress-ra
!
interface lo
!
interface ovs-system
 ipv6 nd suppress-ra
!
interface temp
 ipv6 nd suppress-ra
!
interface temp-ns1
 ipv6 nd suppress-ra
!
interface temp-ns2
 ipv6 nd suppress-ra
!
interface temp-ns3
 ipv6 nd suppress-ra
!
interface temp-ns10
 ipv6 nd suppress-ra
!
interface temp-ns101
 ipv6 nd suppress-ra
!
interface temp-ns103
 ipv6 nd suppress-ra
!
interface temp-ns1001
 ipv6 nd suppress-ra
!
interface tunl0
 ipv6 nd suppress-ra
!
interface veth-global
 ipv6 nd suppress-ra
!
interface veth-ns1
 ipv6 nd suppress-ra
!
interface veth-ns2
 ipv6 nd suppress-ra
!
interface veth-ns3
 ipv6 nd suppress-ra
!
interface veth-ns10
 ipv6 nd suppress-ra
!
interface veth-ns101
 ipv6 nd suppress-ra
!
interface veth-ns103
 ipv6 nd suppress-ra
!
interface veth-ns1001
 ipv6 nd suppress-ra
!
interface veth0.1
 ipv6 nd suppress-ra
!
interface veth0.1p
 ipv6 nd suppress-ra
!
interface veth0.3
 ipv6 nd suppress-ra
!
interface veth0.3p
 ipv6 nd suppress-ra
!
access-list vty permit 127.0.0.0/8
access-list vty deny any
!
ip forwarding
!
!
line vty
 access-class vty
!
///// TEST: copy the latest modules to the targets /////////////////////////////
///// TEST: initialization /////////////////////////////////////////////////////
///// TEST: add ovs_bridges ////////////////////////////////////////////////////
///// TEST: add ovs_bridges (ovsdb) ////////////////////////////////////////////
--- STDOUT from router:openwrt1,platform:openwrt
bridges:
  ovs_bridges: enabled
****************
*** SUCCESS! ***
****************
///// TEST: add: _local_ip and _remote_ips /////////////////////////////////////
///// TEST: add: _local_ip and _remote_ips (ovs-vsctl) /////////////////////////
--- STDOUT from router:openwrt1,platform:openwrt
d4f22fa4-2a1c-4609-9893-54182089c8f8
    Bridge br-int
        Port patch-int
            Interface patch-int
                type: patch
                options: {peer=patch-tun}
        Port br-int
            Interface br-int
                type: internal
    Bridge br-tun
        Port "vxlan_103"
            Interface "vxlan_103"
                type: vxlan
                options: {in_key=flow, local_ip="192.168.1.101", out_key=flow, remote_ip="192.168.1.103"}
        Port patch-tun
            Interface patch-tun
                type: patch
                options: {peer=patch-int}
        Port br-tun
            Interface br-tun
                type: internal
        Port "vxlan_102"
            Interface "vxlan_102"
                type: vxlan
                options: {in_key=flow, local_ip="192.168.1.101", out_key=flow, remote_ip="192.168.1.102"}
///// TEST: add: _local_ip and _remote_ips (ovsdb) /////////////////////////////
--- STDOUT from router:openwrt1,platform:openwrt
local_ip: 192.168.1.101
remote_ips:
- 192.168.1.102
- 192.168.1.103
****************
*** SUCCESS! ***
****************
///// TEST: update: _local_ip //////////////////////////////////////////////////
///// TEST: update: _local_ip (ovsdb) //////////////////////////////////////////
--- STDOUT from router:openwrt1,platform:openwrt
local_ip: 192.168.1.191
remote_ips:
- 192.168.1.102
- 192.168.1.103
****************
*** SUCCESS! ***
****************
///// TEST: update: _remote_ips ////////////////////////////////////////////////
///// TEST: update: _remote_ips (ovs-vsctl) ////////////////////////////////////
--- STDOUT from router:openwrt1,platform:openwrt
d4f22fa4-2a1c-4609-9893-54182089c8f8
    Bridge br-int
        Port patch-int
            Interface patch-int
                type: patch
                options: {peer=patch-tun}
        Port br-int
            Interface br-int
                type: internal
    Bridge br-tun
        Port "vxlan_102"
            Interface "vxlan_102"
                type: vxlan
                options: {in_key=flow, local_ip="192.168.1.191", out_key=flow, remote_ip="192.168.1.102"}
        Port "vxlan_104"
            Interface "vxlan_104"
                type: vxlan
                options: {in_key=flow, local_ip="192.168.1.191", out_key=flow, remote_ip="192.168.1.104"}
        Port "vxlan_103"
            Interface "vxlan_103"
                type: vxlan
                options: {in_key=flow, local_ip="192.168.1.191", out_key=flow, remote_ip="192.168.1.103"}
        Port patch-tun
            Interface patch-tun
                type: patch
                options: {peer=patch-int}
        Port br-tun
            Interface br-tun
                type: internal
///// TEST: update: _remote_ips (ovsdb) ////////////////////////////////////////
--- STDOUT from router:openwrt1,platform:openwrt
local_ip: 192.168.1.191
remote_ips:
- 192.168.1.102
- 192.168.1.103
- 192.168.1.104
****************
*** SUCCESS! ***
****************
///// TEST: delete: _remote_ips ////////////////////////////////////////////////
///// TEST: delete: _remote_ips (ovsdb) ////////////////////////////////////////
--- STDOUT from router:openwrt1,platform:openwrt
local_ip: 192.168.1.191
****************
*** SUCCESS! ***
****************
///// TEST: delete: _local_ip //////////////////////////////////////////////////
///// TEST: delete: _local_ip (ovs-vsctl) //////////////////////////////////////
--- STDOUT from router:openwrt1,platform:openwrt
d4f22fa4-2a1c-4609-9893-54182089c8f8
    Bridge br-int
        Port patch-int
            Interface patch-int
                type: patch
                options: {peer=patch-tun}
        Port br-int
            Interface br-int
                type: internal
    Bridge br-tun
        Port patch-tun
            Interface patch-tun
                type: patch
                options: {peer=patch-int}
        Port br-tun
            Interface br-tun
                type: internal
///// TEST: delete: _local_ip (ovsdb) //////////////////////////////////////////
****************
*** SUCCESS! ***
****************
///// TEST: copy the latest modules to the targets /////////////////////////////
///// TEST: initialization /////////////////////////////////////////////////////
///// TEST: add _name //////////////////////////////////////////////////////////
///// TEST: add _name (lxc-list) ///////////////////////////////////////////////
--- STDOUT from router:rpi1,platform:debian
RUNNING
  snort1

FROZEN

STOPPED
  snort2

1: lo: <LOOPBACK,UP,LOWER_UP> mtu 16436 qdisc noqueue state UNKNOWN mode DEFAULT 
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast master virbr0 state UP mode DEFAULT qlen 1000
    link/ether 08:00:27:e9:e1:82 brd ff:ff:ff:ff:ff:ff
3: eth1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP mode DEFAULT qlen 1000
    link/ether 08:00:27:26:58:8e brd ff:ff:ff:ff:ff:ff
4: eth2: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP mode DEFAULT qlen 1000
    link/ether 08:00:27:d6:37:13 brd ff:ff:ff:ff:ff:ff
5: eth3: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN mode DEFAULT qlen 1000
    link/ether 08:00:27:d3:87:07 brd ff:ff:ff:ff:ff:ff
6: virbr0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT 
    link/ether 08:00:27:e9:e1:82 brd ff:ff:ff:ff:ff:ff
7: ovs-system: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN mode DEFAULT 
    link/ether d2:ac:a1:94:3a:5f brd ff:ff:ff:ff:ff:ff
///// TEST: add _name (ovsdb) //////////////////////////////////////////////////
--- STDOUT from router:rpi1,platform:debian
name: snort1
****************
*** SUCCESS! ***
****************
///// TEST: add _chain /////////////////////////////////////////////////////////
///// TEST: add _chain (lxc-list) //////////////////////////////////////////////
--- STDOUT from router:rpi1,platform:debian
RUNNING
  snort1

FROZEN

STOPPED
  snort2

1: lo: <LOOPBACK,UP,LOWER_UP> mtu 16436 qdisc noqueue state UNKNOWN mode DEFAULT 
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast master virbr0 state UP mode DEFAULT qlen 1000
    link/ether 08:00:27:e9:e1:82 brd ff:ff:ff:ff:ff:ff
3: eth1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast master br0 state UP mode DEFAULT qlen 1000
    link/ether 08:00:27:26:58:8e brd ff:ff:ff:ff:ff:ff
4: eth2: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP mode DEFAULT qlen 1000
    link/ether 08:00:27:d6:37:13 brd ff:ff:ff:ff:ff:ff
5: eth3: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN mode DEFAULT qlen 1000
    link/ether 08:00:27:d3:87:07 brd ff:ff:ff:ff:ff:ff
6: virbr0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT 
    link/ether 08:00:27:e9:e1:82 brd ff:ff:ff:ff:ff:ff
7: ovs-system: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN mode DEFAULT 
    link/ether d2:ac:a1:94:3a:5f brd ff:ff:ff:ff:ff:ff
35: br0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT 
    link/ether 08:00:27:26:58:8e brd ff:ff:ff:ff:ff:ff
37: aaa.101: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP mode DEFAULT qlen 1000
    link/ether fe:26:82:b7:cc:2a brd ff:ff:ff:ff:ff:ff
39: bbb.102: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP mode DEFAULT qlen 1000
    link/ether fe:80:08:14:c8:d7 brd ff:ff:ff:ff:ff:ff
///// TEST: add _chain (ovsdb) /////////////////////////////////////////////////
--- STDOUT from router:rpi1,platform:debian
chain:
- aaa.101
- bbb.102
name: snort1
****************
*** SUCCESS! ***
****************
///// TEST: update _chain //////////////////////////////////////////////////////
///// TEST: update _chain (lxc-list) ///////////////////////////////////////////
--- STDOUT from router:rpi1,platform:debian
RUNNING

FROZEN

STOPPED
  snort1
  snort2

1: lo: <LOOPBACK,UP,LOWER_UP> mtu 16436 qdisc noqueue state UNKNOWN mode DEFAULT 
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast master virbr0 state UP mode DEFAULT qlen 1000
    link/ether 08:00:27:e9:e1:82 brd ff:ff:ff:ff:ff:ff
3: eth1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast master br0 state UP mode DEFAULT qlen 1000
    link/ether 08:00:27:26:58:8e brd ff:ff:ff:ff:ff:ff
4: eth2: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP mode DEFAULT qlen 1000
    link/ether 08:00:27:d6:37:13 brd ff:ff:ff:ff:ff:ff
5: eth3: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN mode DEFAULT qlen 1000
    link/ether 08:00:27:d3:87:07 brd ff:ff:ff:ff:ff:ff
6: virbr0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT 
    link/ether 08:00:27:e9:e1:82 brd ff:ff:ff:ff:ff:ff
7: ovs-system: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN mode DEFAULT 
    link/ether d2:ac:a1:94:3a:5f brd ff:ff:ff:ff:ff:ff
35: br0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT 
    link/ether 08:00:27:26:58:8e brd ff:ff:ff:ff:ff:ff
37: aaa.101: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP mode DEFAULT qlen 1000
    link/ether fe:26:82:b7:cc:2a brd ff:ff:ff:ff:ff:ff
39: bbb.102: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP mode DEFAULT qlen 1000
    link/ether fe:80:08:14:c8:d7 brd ff:ff:ff:ff:ff:ff
///// TEST: update _chain (ovsdb) //////////////////////////////////////////////
--- STDOUT from router:rpi1,platform:debian
chain:
- aaa.101
- bbb.192
name: snort1
****************
*** SUCCESS! ***
****************
///// TEST: delete _chain //////////////////////////////////////////////////////
///// TEST: delete _chain (lxc-list) ///////////////////////////////////////////
--- STDOUT from router:rpi1,platform:debian
RUNNING
  snort1

FROZEN

STOPPED
  snort2

1: lo: <LOOPBACK,UP,LOWER_UP> mtu 16436 qdisc noqueue state UNKNOWN mode DEFAULT 
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast master virbr0 state UP mode DEFAULT qlen 1000
    link/ether 08:00:27:e9:e1:82 brd ff:ff:ff:ff:ff:ff
3: eth1: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast master br0 state UP mode DEFAULT qlen 1000
    link/ether 08:00:27:26:58:8e brd ff:ff:ff:ff:ff:ff
4: eth2: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP mode DEFAULT qlen 1000
    link/ether 08:00:27:d6:37:13 brd ff:ff:ff:ff:ff:ff
5: eth3: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN mode DEFAULT qlen 1000
    link/ether 08:00:27:d3:87:07 brd ff:ff:ff:ff:ff:ff
6: virbr0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT 
    link/ether 08:00:27:e9:e1:82 brd ff:ff:ff:ff:ff:ff
7: ovs-system: <BROADCAST,MULTICAST> mtu 1500 qdisc noop state DOWN mode DEFAULT 
    link/ether d2:ac:a1:94:3a:5f brd ff:ff:ff:ff:ff:ff
35: br0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc noqueue state UP mode DEFAULT 
    link/ether 08:00:27:26:58:8e brd ff:ff:ff:ff:ff:ff
///// TEST: delete _chain (ovsdb) //////////////////////////////////////////////
--- STDOUT from router:rpi1,platform:debian
name: snort1
****************
*** SUCCESS! ***
****************
///// TEST: delete _name ///////////////////////////////////////////////////////
///// TEST: delete _name (ovsdb) ///////////////////////////////////////////////
****************
*** SUCCESS! ***
****************
///// TEST: copy the latest modules to the targets /////////////////////////////
///// TEST: initialization /////////////////////////////////////////////////////
///// TEST: add bridges, vxlan and subnets /////////////////////////////////////
///// TEST: add ip_dvr /////////////////////////////////////////////////////////
///// TEST: update ip_dvr //////////////////////////////////////////////////////
///// TEST: add ip_vhost ///////////////////////////////////////////////////////
///// TEST: delete ip_dvr and ip_vhost /////////////////////////////////////////
///// TEST: add ip_vhost ///////////////////////////////////////////////////////
///// TEST: add ip_dvr /////////////////////////////////////////////////////////
///// TEST: delete ip_dvr and ip_vhost /////////////////////////////////////////
///// TEST: add ip_vhost ///////////////////////////////////////////////////////
///// TEST: add ip_vhost ///////////////////////////////////////////////////////
///// TEST: add ip_dvr(spoke_dvr) //////////////////////////////////////////////
///// TEST: delete ip_dvr and ip_vhost /////////////////////////////////////////
///// TEST: add ip_dvr(hub) and ip_vhost ///////////////////////////////////////
///// TEST: delete ip_dvr //////////////////////////////////////////////////////
///// TEST: add ip_dvr(spoke) //////////////////////////////////////////////////
///// TEST: add ports //////////////////////////////////////////////////////////
///// TEST: add peers //////////////////////////////////////////////////////////
///// TEST: add default_gw /////////////////////////////////////////////////////
///// TEST: update ip_dvr //////////////////////////////////////////////////////
///// TEST: update default_gw //////////////////////////////////////////////////
///// TEST: update peers ///////////////////////////////////////////////////////
///// TEST: update ports ///////////////////////////////////////////////////////
///// TEST: update ports ///////////////////////////////////////////////////////
///// TEST: confrimation ///////////////////////////////////////////////////////
--- STDOUT from router:openwrt1,platform:openwrt
bridges:
  ovs_bridges: enabled
subnets:
- default_gw: 10.0.1.10
  ip_dvr:
    addr: 10.0.1.9/24
    mode: dvr
  ip_vhost: 10.0.1.101/24
  peers:
  - 192.168.1.103
  ports:
  - eth2
  vid: 1
  vni: 10
vxlan:
  local_ip: 192.168.1.101
  remote_ips:
  - 192.168.1.102
  - 192.168.1.103
****************
*** SUCCESS! ***
****************
///// TEST: ovs-vsctl show and ip route show ///////////////////////////////////
--- STDOUT from router:openwrt1,platform:openwrt
d4f22fa4-2a1c-4609-9893-54182089c8f8
    Bridge br-tun
        Port patch-tun
            Interface patch-tun
                type: patch
                options: {peer=patch-int}
        Port br-tun
            Interface br-tun
                type: internal
        Port "vxlan_103"
            Interface "vxlan_103"
                type: vxlan
                options: {in_key=flow, local_ip="192.168.1.101", out_key=flow, remote_ip="192.168.1.103"}
        Port "vxlan_102"
            Interface "vxlan_102"
                type: vxlan
                options: {in_key=flow, local_ip="192.168.1.101", out_key=flow, remote_ip="192.168.1.102"}
    Bridge br-int
        Port br-int
            Interface br-int
                type: internal
        Port patch-int
            Interface patch-int
                type: patch
                options: {peer=patch-tun}
        Port "int-br10"
            tag: 1
            Interface "int-br10"
                type: internal
        Port "int-dvr10"
            tag: 1
            Interface "int-dvr10"
                type: internal
default via 10.0.1.10 dev int-dvr10 
10.0.1.0/24 dev int-dvr10  proto kernel  scope link  src 10.0.1.9 
10.0.2.0/24 dev eth0  proto kernel  scope link  src 10.0.2.15 
192.168.1.0/24 dev eth2  proto kernel  scope link  src 192.168.1.101 
192.168.56.0/24 dev eth1  proto kernel  scope link  src 192.168.56.111 
///// TEST: delete default_gw //////////////////////////////////////////////////
///// TEST: ip route show //////////////////////////////////////////////////////
--- STDOUT from router:openwrt1,platform:openwrt
10.0.1.0/24 dev int-dvr10  proto kernel  scope link  src 10.0.1.9 
10.0.2.0/24 dev eth0  proto kernel  scope link  src 10.0.2.15 
192.168.1.0/24 dev eth2  proto kernel  scope link  src 192.168.1.101 
192.168.56.0/24 dev eth1  proto kernel  scope link  src 192.168.56.111 
///// TEST: delete ports ///////////////////////////////////////////////////////
///// TEST: delete peers ///////////////////////////////////////////////////////
///// TEST: delete ip_dvr //////////////////////////////////////////////////////
///// TEST: delete vid /////////////////////////////////////////////////////////
--- RESPONSE from router:openwrt1,platform:openwrt
exception: ModelError
message: the other params still exits
traceback: Traceback (most recent call last):
  File "/opt/nlan/nlan_agent.py", line 89, in _route
    result = call(m)
  File "/opt/nlan/config/subnets.py", line 286, in delete
    raise ModelError("the other params still exits", model=model.model)
ModelError: the other params still exits
model: {'vid': 9}

exit: 1
operation: delete
progress: OrderedDict([('subnets', {('vni', 10): False})])
****************
*** SUCCESS! ***
****************
///// TEST: delete ip_vhost ////////////////////////////////////////////////////
///// TEST: delete vni /////////////////////////////////////////////////////////
--- RESPONSE from router:openwrt1,platform:openwrt
exception: ModelError
message: vid still exists
traceback: Traceback (most recent call last):
  File "/opt/nlan/nlan_agent.py", line 89, in _route
    result = call(m)
  File "/opt/nlan/config/subnets.py", line 284, in delete
    raise ModelError("vid still exists")
ModelError: vid still exists

exit: 1
operation: delete
progress: OrderedDict([('subnets', {('vni', 10): False})])
****************
*** SUCCESS! ***
****************
///// TEST: delete vid /////////////////////////////////////////////////////////
///// TEST: delete vni /////////////////////////////////////////////////////////
