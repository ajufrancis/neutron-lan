=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
openwrt2         192.168.1.102  OK
rpi1             192.168.1.104  OK
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: init.run
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: init.run
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: init.run
=+=+= NLAN Request to router:rpi1,platform:debian =+=+=+=+=+=+=+=+=+=+=+=+=+=+
command: init.run
--- STDOUT from router:openwrt3,platform:openwrt
[INFO] 2014-05-14 07:36:03,165 module:nlan_agent,function:<module>,router:openwrt3
NLAN Agent initialization completed
[DEBUG] 2014-05-14 07:36:03,168 module:nlan_agent,function:<module>,router:openwrt3
__n__: {'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'platform': 'openwrt', 'share_dir': '/opt/nlan/share', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'logger': <logging.Logger object at 0xb759736c>, 'router': 'openwrt3', 'schema': 'ovsdb_nlan.schema', 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'enum': ['set', ['enabled']], 'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'ip_dvr': {'max': 2, 'value': {'type': 'string'}, 'key': {'enum': ['set', ['addr', 'mode']], 'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}}, 'indexes': {'services': 'name', 'subnets': 'vni'}}
[INFO] 2014-05-14 07:36:03,218 module:nlan_agent,function:_route,router:openwrt3
function:init.run, args:()
[DEBUG] 2014-05-14 07:36:03,220 module:cmdutil,function:_cmd2,router:openwrt3
cmd: lxc-ls
[DEBUG] 2014-05-14 07:36:03,237 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl --if-exists del-br br-tun
[DEBUG] 2014-05-14 07:36:03,276 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl --if-exists del-br br-int
[DEBUG] 2014-05-14 07:36:03,429 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl show
[DEBUG] 2014-05-14 07:36:03,446 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns101 down
[DEBUG] 2014-05-14 07:36:03,461 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delif br101 veth-ns101
[DEBUG] 2014-05-14 07:36:03,494 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns101 up
[DEBUG] 2014-05-14 07:36:03,504 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br101 down
[DEBUG] 2014-05-14 07:36:03,513 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delbr br101
[DEBUG] 2014-05-14 07:36:03,536 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns103 down
[DEBUG] 2014-05-14 07:36:03,601 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delif br103 veth-ns103
[DEBUG] 2014-05-14 07:36:03,639 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns103 up
[DEBUG] 2014-05-14 07:36:03,647 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br103 down
[DEBUG] 2014-05-14 07:36:03,655 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delbr br103
[DEBUG] 2014-05-14 07:36:03,665 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns1 down
[DEBUG] 2014-05-14 07:36:03,680 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delif br1 veth-ns1
[DEBUG] 2014-05-14 07:36:03,693 module--- STDOUT from router:openwrt2,platform:openwrt
[INFO] 2014-05-14 07:36:03,772 module:nlan_agent,function:<module>,router:openwrt2
NLAN Agent initialization completed
[DEBUG] 2014-05-14 07:36:03,774 module:nlan_agent,function:<module>,router:openwrt2
__n__: {'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'platform': 'openwrt', 'share_dir': '/opt/nlan/share', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'logger': <logging.Logger object at 0xb758f6cc>, 'router': 'openwrt2', 'schema': 'ovsdb_nlan.schema', 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'enum': ['set', ['enabled']], 'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'ip_dvr': {'max': 2, 'value': {'type': 'string'}, 'key': {'enum': ['set', ['addr', 'mode']], 'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}}, 'indexes': {'services': 'name', 'subnets': 'vni'}}
[INFO] 2014-05-14 07:36:03,815 module:nlan_agent,function:_route,router:openwrt2
function:init.run, args:()
[DEBUG] 2014-05-14 07:36:03,816 module:cmdutil,function:_cmd2,router:openwrt2
cmd: lxc-ls
[DEBUG] 2014-05-14 07:36:03,833 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl --if-exists del-br br-tun
[DEBUG] 2014-05-14 07:36:03,872 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl --if-exists del-br br-int
[DEBUG] 2014-05-14 07:36:04,002 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl show
[DEBUG] 2014-05-14 07:36:04,013 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns101 down
[DEBUG] 2014-05-14 07:36:04,030 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delif br101 veth-ns101
[DEBUG] 2014-05-14 07:36:04,049 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns101 up
[DEBUG] 2014-05-14 07:36:04,067 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br101 down
[DEBUG] 2014-05-14 07:36:04,074 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delbr br101
[DEBUG] 2014-05-14 07:36:04,093 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns103 down
[DEBUG] 2014-05-14 07:36:04,118 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delif br103 veth-ns103
[DEBUG] 2014-05-14 07:36:04,142 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns103 up
[DEBUG] 2014-05-14 07:36:04,169 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br103 down
[DEBUG] 2014-05-14 07:36:04,196 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delbr br103
[DEBUG] 2014-05-14 07:36:04,214 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns1 down
[DEBUG] 2014-05-14 07:36:04,274 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delif br1 veth-ns1
[DEBUG] 2014-05-14 07:36:04,300 module--- STDOUT from router:openwrt1,platform:openwrt
[INFO] 2014-05-14 07:36:03,878 module:nlan_agent,function:<module>,router:openwrt1
NLAN Agent initialization completed
[DEBUG] 2014-05-14 07:36:03,881 module:nlan_agent,function:<module>,router:openwrt1
__n__: {'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'platform': 'openwrt', 'share_dir': '/opt/nlan/share', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'logger': <logging.Logger object at 0xb763b66c>, 'router': 'openwrt1', 'schema': 'ovsdb_nlan.schema', 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'enum': ['set', ['enabled']], 'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'ip_dvr': {'max': 2, 'value': {'type': 'string'}, 'key': {'enum': ['set', ['addr', 'mode']], 'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}}, 'indexes': {'services': 'name', 'subnets': 'vni'}}
[INFO] 2014-05-14 07:36:03,940 module:nlan_agent,function:_route,router:openwrt1
function:init.run, args:()
[DEBUG] 2014-05-14 07:36:03,941 module:cmdutil,function:_cmd2,router:openwrt1
cmd: lxc-ls
[DEBUG] 2014-05-14 07:36:03,958 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl --if-exists del-br br-tun
[DEBUG] 2014-05-14 07:36:04,002 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl --if-exists del-br br-int
[DEBUG] 2014-05-14 07:36:04,130 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl show
[DEBUG] 2014-05-14 07:36:04,141 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1001 down
[DEBUG] 2014-05-14 07:36:04,161 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delif br1001 veth-ns1001
[DEBUG] 2014-05-14 07:36:04,193 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1001 up
[DEBUG] 2014-05-14 07:36:04,203 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br1001 down
[DEBUG] 2014-05-14 07:36:04,217 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delbr br1001
[DEBUG] 2014-05-14 07:36:04,228 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns103 down
[DEBUG] 2014-05-14 07:36:04,248 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delif br103 veth-ns103
[DEBUG] 2014-05-14 07:36:04,267 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns103 up
[DEBUG] 2014-05-14 07:36:04,280 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br103 down
[DEBUG] 2014-05-14 07:36:04,288 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delbr br103
[DEBUG] 2014-05-14 07:36:04,299 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1 down
[DEBUG] 2014-05-14 07:36:04,317 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delif br1 veth-ns1
[DEBUG] 2014-05-14 07:36:04,328 :cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns1 up
[DEBUG] 2014-05-14 07:36:03,698 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br1 down
[DEBUG] 2014-05-14 07:36:03,704 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delbr br1
[DEBUG] 2014-05-14 07:36:03,715 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns list
[DEBUG] 2014-05-14 07:36:03,724 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns del ns101
[DEBUG] 2014-05-14 07:36:03,732 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns del ns1
[DEBUG] 2014-05-14 07:36:03,740 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns del ns103
[DEBUG] 2014-05-14 07:36:03,773 module:ovsdb,function:_send,router:openwrt3
request:
  id: 93735
  method: transact
  params:
  - Open_vSwitch
  - op: delete
    table: NLAN
    where: []
response:
  error: null
  id: 93735
  result:
  - count: 1
[INFO] 2014-05-14 07:36:03,778 module:nlan_agent,function:<module>,router:openwrt3
NLAN Agent execution completed
--- RESPONSE from router:openwrt3,platform:openwrt
message: Execution completed
exit: 0
:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns1 up
[DEBUG] 2014-05-14 07:36:04,318 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br1 down
[DEBUG] 2014-05-14 07:36:04,329 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delbr br1
[DEBUG] 2014-05-14 07:36:04,349 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns list
[DEBUG] 2014-05-14 07:36:04,359 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns del ns103
[DEBUG] 2014-05-14 07:36:04,381 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns del ns101
[DEBUG] 2014-05-14 07:36:04,393 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns del ns1
[DEBUG] 2014-05-14 07:36:04,430 module:ovsdb,function:_send,router:openwrt2
request:
  id: 151878
  method: transact
  params:
  - Open_vSwitch
  - op: delete
    table: NLAN
    where: []
response:
  error: null
  id: 151878
  result:
  - count: 1
[INFO] 2014-05-14 07:36:04,450 module:nlan_agent,function:<module>,router:openwrt2
NLAN Agent execution completed
--- RESPONSE from router:openwrt2,platform:openwrt
message: Execution completed
exit: 0
module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1 up
[DEBUG] 2014-05-14 07:36:04,334 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br1 down
[DEBUG] 2014-05-14 07:36:04,341 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delbr br1
[DEBUG] 2014-05-14 07:36:04,348 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns list
[DEBUG] 2014-05-14 07:36:04,360 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns del ns-global
[DEBUG] 2014-05-14 07:36:04,368 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns del ns1
[DEBUG] 2014-05-14 07:36:04,377 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns del ns103
[DEBUG] 2014-05-14 07:36:04,383 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns del ns1001
[DEBUG] 2014-05-14 07:36:04,408 module:ovsdb,function:_send,router:openwrt1
request:
  id: 606774
  method: transact
  params:
  - Open_vSwitch
  - op: delete
    table: NLAN
    where: []
response:
  error: null
  id: 606774
  result:
  - count: 1
[INFO] 2014-05-14 07:36:04,412 module:nlan_agent,function:<module>,router:openwrt1
NLAN Agent execution completed
--- RESPONSE from router:openwrt1,platform:openwrt
message: Execution completed
exit: 0
--- STDOUT from router:rpi1,platform:debian
[INFO] 2014-05-14 00:36:05,728 module:nlan_agent,function:<module>,router:rpi1
NLAN Agent initialization completed
[DEBUG] 2014-05-14 00:36:05,733 module:nlan_agent,function:<module>,router:rpi1
__n__: {'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'platform': 'debian', 'share_dir': '/opt/nlan/share', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'logger': <logging.Logger object at 0xb727ebcc>, 'router': 'rpi1', 'schema': 'ovsdb_nlan.schema', 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'enum': ['set', ['enabled']], 'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'ip_dvr': {'max': 2, 'value': {'type': 'string'}, 'key': {'enum': ['set', ['addr', 'mode']], 'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}}, 'indexes': {'services': 'name', 'subnets': 'vni'}}
[INFO] 2014-05-14 00:36:05,775 module:nlan_agent,function:_route,router:rpi1
function:init.run, args:()
[DEBUG] 2014-05-14 00:36:05,776 module:cmdutil,function:_cmd2,router:rpi1
cmd: lxc-ls
[DEBUG] 2014-05-14 00:36:05,873 module:cmdutil,function:_cmd2,router:rpi1
cmd: lxc-stop -n snort1
[DEBUG] 2014-05-14 00:36:05,905 module:cmdutil,function:_cmd2,router:rpi1
cmd: lxc-stop -n snort2
[DEBUG] 2014-05-14 00:36:05,924 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl --if-exists del-br br-tun
[DEBUG] 2014-05-14 00:36:05,995 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl --if-exists del-br br-int
[DEBUG] 2014-05-14 00:36:06,068 module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl show
[DEBUG] 2014-05-14 00:36:06,244 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev br1001 down
[DEBUG] 2014-05-14 00:36:06,279 module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl delbr br1001
[DEBUG] 2014-05-14 00:36:06,307 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev br101 down
[DEBUG] 2014-05-14 00:36:06,331 module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl delbr br101
[DEBUG] 2014-05-14 00:36:06,345 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip netns list
[DEBUG] 2014-05-14 00:36:06,416 module:ovsdb,function:_send,router:rpi1
request:
  id: 48069
  method: transact
  params:
  - Open_vSwitch
  - op: delete
    table: NLAN
    where: []
response:
  error: null
  id: 48069
  result:
  - count: 1
[INFO] 2014-05-14 00:36:06,420 module:nlan_agent,function:<module>,router:rpi1
NLAN Agent execution completed
--- RESPONSE from router:rpi1,platform:debian
message: Execution completed
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-05-14 00:36:04.061741

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         1.79(sec)
openwrt2          :-)         1.81(sec)
openwrt1          :-)         1.82(sec)
rpi1              :-)         1.85(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
rpi1             192.168.1.104  OK
openwrt1         192.168.1.101  OK
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:rpi1,platform:debian =+=+=+=+=+=+=+=+=+=+=+=+=+=+
operation: --add
dict_args: "OrderedDict([('bridges', {'ovs_bridges': 'enabled'}), ('services', [{'name': 'snort1', 'chain': ['mz.101', 'dmz.1001'], '_index': ['name', 'snort1']}]), ('vxlan', {'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.101'], 'local_ip': '192.168.1.104'}), ('subnets', [{'ports': ['dmz.1001'], 'peers': ['192.168.1.101'], 'vni': 1001, 'vid': 111, '_index': ['vni', 1001]}, {'ports': ['mz.101'], 'peers': ['192.168.1.102', '192.168.1.103'], 'vni': 101, 'vid': 1, '_index': ['vni', 101]}])])"
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --add
dict_args: "OrderedDict([('bridges', {'ovs_bridges': 'enabled'}), ('vxlan', {'remote_ips': ['192.168.1.102', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.103'}), ('subnets', [{'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 2, '_index': ['vni', 1], 'ip_vhost': '192.168.100.103/24', 'default_gw': '192.168.100.1', 'ip_dvr': OrderedDict([('addr', '192.168.100.3/24'), ('mode', 'dvr')]), 'vni': 1}, {'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 3, '_index': ['vni', 103], 'ip_vhost': '10.0.3.103/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr')])}, {'peers': ['192.168.1.102', '192.168.1.104'], 'vid': 1, '_index': ['vni', 101], 'ip_vhost': '10.0.1.103/24', 'vni': 101, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'spoke_dvr')])}])])"
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --add
dict_args: "OrderedDict([('bridges', {'ovs_bridges': 'enabled'}), ('vxlan', {'remote_ips': ['192.168.1.103', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.102'}), ('subnets', [{'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 2, '_index': ['vni', 1], 'ip_vhost': '192.168.100.102/24', 'default_gw': '192.168.100.1', 'ip_dvr': OrderedDict([('addr', '192.168.100.2/24'), ('mode', 'dvr')]), 'vni': 1}, {'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 3, '_index': ['vni', 103], 'ip_vhost': '10.0.3.102/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr')])}, {'peers': ['192.168.1.103', '192.168.1.104'], 'vid': 1, '_index': ['vni', 101], 'ip_vhost': '10.0.1.102/24', 'vni': 101, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'spoke_dvr')])}])])"
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --add
dict_args: "OrderedDict([('bridges', {'ovs_bridges': 'enabled'}), ('gateway', {'network': 'eth2', 'rip': 'enabled'}), ('vxlan', {'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.104'], 'local_ip': '192.168.1.101'}), ('subnets', [{'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 2, '_index': ['vni', 1], 'ip_vhost': '192.168.100.101/24', 'vni': 1, 'ip_dvr': OrderedDict([('addr', '192.168.100.1/24'), ('mode', 'dvr')])}, {'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 3, '_index': ['vni', 103], 'ip_vhost': '10.0.3.101/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr')])}, {'peers': ['192.168.1.104'], 'vid': 1, '_index': ['vni', 1001], 'ip_vhost': '10.0.1.101/24', 'vni': 1001, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'hub')])}])])"
--- STDOUT from router:openwrt3,platform:openwrt
[INFO] 2014-05-14 07:36:06,171 module:nlan_agent,function:<module>,router:openwrt3
NLAN Agent initialization completed
[DEBUG] 2014-05-14 07:36:06,173 module:nlan_agent,function:<module>,router:openwrt3
__n__: {'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'platform': 'openwrt', 'share_dir': '/opt/nlan/share', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'logger': <logging.Logger object at 0xb75d8f4c>, 'router': 'openwrt3', 'schema': 'ovsdb_nlan.schema', 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'enum': ['set', ['enabled']], 'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'ip_dvr': {'max': 2, 'value': {'type': 'string'}, 'key': {'enum': ['set', ['addr', 'mode']], 'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}}, 'indexes': {'services': 'name', 'subnets': 'vni'}}
[INFO] 2014-05-14 07:36:06,269 module:nlan_agent,function:_route,router:openwrt3
function:bridges.add, model:{'ovs_bridges': 'enabled'}
[DEBUG] 2014-05-14 07:36:06,290 module:ovsdb,function:_send,router:openwrt3
request:
  id: 816015
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 816015
  result:
  - rows: []
[DEBUG] 2014-05-14 07:36:06,295 module:ovsdb,function:_send,router:openwrt3
request:
  id: 612664
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row: {}
    table: NLAN
response:
  error: null
  id: 612664
  result:
  - uuid:
    - uuid
    - 393e99d6-1e7d-49dc-9963-bffa69065533
[DEBUG] 2014-05-14 07:36:06,299 module:ovsdb,function:_send,router:openwrt3
request:
  id: 359
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Bridges
    where: []
response:
  error: null
  id: 359
  result:
  - rows: []
[INFO] 2014-05-14 07:36:06,302 module:bridges,function:add,router:openwrt3
Adding bridges: br-int and br-tun
[DEBUG] 2014-05-14 07:36:06,350 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-br br-int
[DEBUG] 2014-05-14 07:36:06,391 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-br br-tun
[DEBUG] 2014-05-14 07:36:06,452 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl del-flows br-tun
[DEBUG] 2014-05-14 07:36:06,471 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int patch-int -- set interface patch-int type=patch options:peer=patch-tun
[DEBUG] 2014-05-14 07:36:06,512 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-tun patch-tun -- set interface patch-tun type=patch options:peer=patch-int
[DEBUG] 2014-05-14 07:36:06,545 module:ovsdb,function:_send,router:openwrt3
request:
  id: 280005
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: Interface
    where:
    - - name
      - ==
      - patch-tun
response:
  error: null
  id: 280005
  result:
  - rows:
    - _uuid:
      - uuid
      - fae09b5c-ebcf-4623-a39a-619bfa273f21
      _version:
      - uuid
      - 126ac6cd-2380-4042-8d90-19fcb3de9d9b
      admin_state:
      - set
      - []
      bfd:
      - map
      - []
      bfd_status:
      - map
      - []
      cfm_fault:
      - set
      - []
      cfm_fault_status:
      - set
      - []
      cfm_flap_count:
      - set
      - []
      cfm_health:
      - set
      - []
      cfm_mpid:
      - set
      - []
      cfm_remote_mpids:
      - set
      - []
      cfm_remote_opstate:
      - set
      - []
      duplex:
      - set
      - []
      external_ids:
      - map
      - []
      ifindex: 0
      ingress_policing_burst: 0
      ingress_policing_rate: 0
      lacp_current:
      - set
      - []
      link_resets:
      - set
      - []
      link_speed:
      - set
      - []
      link_state:
      - set
      - []
      mac:
      - set
      - []
      mac_in_use: 6e:19:27:86:c9:d6
      mtu:
      - set
      - []
      name: patch-tun
      ofport: 1
      ofport_request:
      - set
      - []
      options:
      - map
      - - - peer
          - patch-int
      other_config:
      - map
      - []
      statistics:
      - map
      - - - collisions
          - 0
        - - rx_bytes
          - 0
        - - rx_crc_err
          - 0
        - - rx_dropped
          - 0
        - - rx_errors
          - 0
        - - rx_frame_err
          - 0
        - - rx_over_err
          - 0
        - - rx_packets
          - 0
        - - tx_bytes
          - 0
        - - tx_dropped
          - 0
        - - tx_errors
          - 0
        - - tx_packets
          - 0
      status:
      - map
      - []
      type: patch
[DEBUG] 2014-05-14 07:36:06,569 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=1,actions=resubmit(,1)
[DEBUG] 2014-05-14 07:36:06,591 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=0,priority=0,actions=drop
[DEBUG] 2014-05-14 07:36:06,608 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=01:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,19)
[DEBUG] 2014-05-14 07:36:06,624 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=00:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,20)
[DEBUG] 2014-05-14 07:36:06,640 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=2,priority=0,actions=drop
[DEBUG] 2014-05-14 07:36:06,652 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=3,priority=0,actions=drop
[DEBUG] 2014-05-14 07:36:06,667 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=10,priority=1,actions=learn(table=20,hard_timeout=300,priority=1,NXM_OF_VLAN_TCI[0..11],NXM_OF_ETH_DST[]=NXM_OF_ETH_SRC[],load:0->NXM_OF_VLAN_TCI[],load:NXM_NX_TUN_ID[]->NXM_NX_TUN_ID[],output:NXM_OF_IN_PORT[]),output:1
[DEBUG] 2014-05-14 07:36:06,681 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=19,priority=0,actions=resubmit(,21)
[DEBUG] 2014-05-14 07:36:06,694 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=20,priority=0,actions=resubmit(,21)
[DEBUG] 2014-05-14 07:36:06,707 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=21,priority=0,actions=drop
[DEBUG] 2014-05-14 07:36:06,719 module:ovsdb,function:crud,router:openwrt3
CRUD operation (add): {'ovs_bridges': 'enabled'}
[DEBUG] 2014-05-14 07:36:06,723 module:ovsdb,function:_send,router:openwrt3
request:
  id: 111295
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ovs_bridges: enabled
    table: NLAN_Bridges
    uuid-name: temp_537250
  - mutations:
    - - bridges
      - insert
      - - set
        - - - named-uuid
            - temp_537250
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 111295
  result:
  - uuid:
    - uuid
    - d5e90cc0-3979-4b36-bf3b-a5d5d6f96fe3
  - count: 1
[DEBUG] 2014-05-14 07:36:06,730 module:ovsdb,function:_send,router:openwrt3
request:
  id: 380601
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Bridges
    where: []
response:
  error: null
  id: 380601
  result:
  - rows:
    - _uuid:
      - uuid
      - d5e90cc0-3979-4b36-bf3b-a5d5d6f96fe3
      _version:
      - uuid
      - 0861cfa9-f053-4da6-89c5-6229dd4359f6
      controller:
      - set
      - []
      ovs_bridges: enabled
[INFO] 2014-05-14 07:36:06,739 module:nlan_agent,function:_route,router:openwrt3
function:vxlan.add, model:{'remote_ips': ['192.168.1.102', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.103'}
[DEBUG] 2014-05-14 07:36:06,742 module:ovsdb,function:_send,router:openwrt3
request:
  id: 932393
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 932393
  result:
  - rows:
    - _uuid:
      - uuid
      - 393e99d6-1e7d-49dc-9963-bffa69065533
      _version:
      - uuid
      - d6caef4b-196a-4c28-a4b5-c73c922996d4
      bridges:
      - uuid
      - d5e90cc0-3979-4b36-bf3b-a5d5d6f96fe3
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - set
      - []
      vxlan:
      - set
      - []
[DEBUG] 2014-05-14 07:36:06,750 module:ovsdb,function:_send,router:openwrt3
request:
  id: 111798
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_VXLAN
    where: []
response:
  error: null
  id: 111798
  result:
  - rows: []
[INFO] 2014-05-14 07:36:06,756 module:vxlan,function:add,router:openwrt3
Adding a VXLAN tunnel: vxlan_102
[DEBUG] 2014-05-14 07:36:06,757 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-tun vxlan_102 -- set interface vxlan_102 type=vxlan options:in_key=flow options:local_ip=192.168.1.103 options:out_key=flow options:remote_ip=192.168.1.102
[INFO] 2014-05-14 07:36:06,785 module:vxlan,function:add,router:openwrt3
Adding a VXLAN tunnel: vxlan_101
[DEBUG] 2014-05-14 07:36:06,786 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-tun vxlan_101 -- set interface vxlan_101 type=vxlan options:in_key=flow options:local_ip=192.168.1.103 options:out_key=flow options:remote_ip=192.168.1.101
[INFO] 2014-05-14 07:36:06,819 module:vxlan,function:add,router:openwrt3
Adding a VXLAN tunnel: vxlan_104
[DEBUG] 2014-05-14 07:36:06,819 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-tun vxlan_104 -- set interface vxlan_104 type=vxlan options:in_key=flow options:local_ip=192.168.1.103 options:out_key=flow options:remote_ip=192.168.1.104
[DEBUG] 2014-05-14 07:36:06,852 module:ovsdb,function:_send,router:openwrt3
request:
  id: 13630
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 13630
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-14 07:36:06,862 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=3,actions=resubmit(,2)
[DEBUG] 2014-05-14 07:36:06,874 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=2,actions=resubmit(,2)
[DEBUG] 2014-05-14 07:36:06,893 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=4,actions=resubmit(,2)
[DEBUG] 2014-05-14 07:36:06,906 module:ovsdb,function:crud,router:openwrt3
CRUD operation (add): {'remote_ips': ['192.168.1.102', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.103'}
[DEBUG] 2014-05-14 07:36:06,910 module:ovsdb,function:_send,router:openwrt3
request:
  id: 390180
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      local_ip: 192.168.1.103
      remote_ips:
      - set
      - - 192.168.1.102
        - 192.168.1.101
        - 192.168.1.104
    table: NLAN_VXLAN
    uuid-name: temp_974709
  - mutations:
    - - vxlan
      - insert
      - - set
        - - - named-uuid
            - temp_974709
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 390180
  result:
  - uuid:
    - uuid
    - bd3748de-8edc-4631-bddc-e46d681f026d
  - count: 1
[DEBUG] 2014-05-14 07:36:06,915 module:ovsdb,function:_send,router:openwrt3
request:
  id: 971654
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_VXLAN
    where: []
response:
  error: null
  id: 971654
  result:
  - rows:
    - _uuid:
      - uuid
      - bd3748de-8edc-4631-bddc-e46d681f026d
      _version:
      - uuid
      - 086c9284-6a99-4f96-8b68-1a12443732c3
      local_ip: 192.168.1.103
      remote_ips:
      - set
      - - 192.168.1.101
        - 192.168.1.102
        - 192.168.1.104
[INFO] 2014-05-14 07:36:06,935 module:nlan_agent,function:_route,router:openwrt3
function:subnets.add, index:['vni', 1], model:{'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 2, 'ip_vhost': '192.168.100.103/24', 'default_gw': '192.168.100.1', 'ip_dvr': OrderedDict([('addr', '192.168.100.3/24'), ('mode', 'dvr')]), 'vni': 1}
[DEBUG] 2014-05-14 07:36:06,937 module:ovsdb,function:_send,router:openwrt3
request:
  id: 38332
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 38332
  result:
  - rows:
    - _uuid:
      - uuid
      - 393e99d6-1e7d-49dc-9963-bffa69065533
      _version:
      - uuid
      - 0d879e34-fa9c-432f-bdf8-28efa4c9fd2f
      bridges:
      - uuid
      - d5e90cc0-3979-4b36-bf3b-a5d5d6f96fe3
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - set
      - []
      vxlan:
      - uuid
      - bd3748de-8edc-4631-bddc-e46d681f026d
[DEBUG] 2014-05-14 07:36:06,947 module:ovsdb,function:_send,router:openwrt3
request:
  id: 977799
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1
response:
  error: null
  id: 977799
  result:
  - rows: []
[INFO] 2014-05-14 07:36:06,952 module:subnets,function:add,router:openwrt3
Adding a subnet(vlan): 2
[DEBUG] 2014-05-14 07:36:06,953 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addbr br1
[DEBUG] 2014-05-14 07:36:06,966 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int-br1 tag=2 -- set interface int-br1 type=internal
[DEBUG] 2014-05-14 07:36:07,025 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int-dvr1 tag=2 -- set interface int-dvr1 type=internal
[DEBUG] 2014-05-14 07:36:07,078 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br1 int-br1
[DEBUG] 2014-05-14 07:36:07,101 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-br1 promisc on
[DEBUG] 2014-05-14 07:36:07,108 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-br1 up
[DEBUG] 2014-05-14 07:36:07,118 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-dvr1 up
[DEBUG] 2014-05-14 07:36:07,130 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br1 up
[DEBUG] 2014-05-14 07:36:07,146 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns add ns1
[DEBUG] 2014-05-14 07:36:07,160 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link add veth-ns1 type veth peer name temp-ns1
[DEBUG] 2014-05-14 07:36:07,180 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev temp-ns1 netns ns1
[DEBUG] 2014-05-14 07:36:07,194 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns1 ip link set dev temp-ns1 name eth0
[DEBUG] 2014-05-14 07:36:07,206 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br1 veth-ns1
[DEBUG] 2014-05-14 07:36:07,224 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns1 promisc on
[DEBUG] 2014-05-14 07:36:07,235 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns1 up
[DEBUG] 2014-05-14 07:36:07,259 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns1 ip link set dev eth0 up
[DEBUG] 2014-05-14 07:36:07,283 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns1 ip addr add dev eth0 192.168.100.103/24
[DEBUG] 2014-05-14 07:36:07,294 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns1 ip route add default via 192.168.100.3 dev eth0
[DEBUG] 2014-05-14 07:36:07,303 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip addr add dev int-dvr1 192.168.100.3/24
[DEBUG] 2014-05-14 07:36:07,309 module:cmdutil,function:_cmd2,router:openwrt3
cmd: route
[DEBUG] 2014-05-14 07:36:07,315 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip route add default via 192.168.100.1
[DEBUG] 2014-05-14 07:36:07,323 module:ovsdb,function:_send,router:openwrt3
request:
  id: 226314
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 226314
  result:
  - rows: []
[DEBUG] 2014-05-14 07:36:07,325 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=1,actions=mod_vlan_vid:2,resubmit(,10)
[DEBUG] 2014-05-14 07:36:07,336 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=2,nw_dst=192.168.100.3,actions=drop
[DEBUG] 2014-05-14 07:36:07,352 module:ovsdb,function:_send,router:openwrt3
request:
  id: 912217
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 912217
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-14 07:36:07,364 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=2,actions=strip_vlan,set_tunnel:1,output:3,output:2
[DEBUG] 2014-05-14 07:36:07,380 module:ovsdb,function:crud,router:openwrt3
CRUD operation (add): {'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 2, 'ip_vhost': '192.168.100.103/24', 'default_gw': '192.168.100.1', 'ip_dvr': OrderedDict([('addr', '192.168.100.3/24'), ('mode', 'dvr')]), 'vni': 1}
[DEBUG] 2014-05-14 07:36:07,389 module:ovsdb,function:_send,router:openwrt3
request:
  id: 320855
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      default_gw: 192.168.100.1
      ip_dvr:
      - map
      - - - addr
          - 192.168.100.3/24
        - - mode
          - dvr
      ip_vhost: 192.168.100.103/24
      peers:
      - set
      - - 192.168.1.101
        - 192.168.1.102
      vid: 2
      vni: 1
    table: NLAN_Subnet
    uuid-name: temp_252647
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_252647
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 320855
  result:
  - uuid:
    - uuid
    - cdb9858a-eb31-4f31-bdbe-3d4d15f9d1f1
  - count: 1
[DEBUG] 2014-05-14 07:36:07,400 module:ovsdb,function:_send,router:openwrt3
request:
  id: 315434
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1
response:
  error: null
  id: 315434
  result:
  - rows:
    - _uuid:
      - uuid
      - cdb9858a-eb31-4f31-bdbe-3d4d15f9d1f1
      _version:
      - uuid
      - 436500a5-c93c-4ec7-b6a7-40f3e764b7fe
      default_gw: 192.168.100.1
      ip_dvr:
      - map
      - - - addr
          - 192.168.100.3/24
        - - mode
          - dvr
      ip_vhost: 192.168.100.103/24
      peers:
      - set
      - - 192.168.1.101
        - 192.168.1.102
      ports:
      - set
      - []
      vid: 2
      vni: 1
[INFO] 2014-05-14 07:36:07,406 module:nlan_agent,function:_route,router:openwrt3
function:subnets.add, index:['vni', 103], model:{'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 3, 'ip_vhost': '10.0.3.103/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr')])}
[DEBUG] 2014-05-14 07:36:07,409 module:ovsdb,function:_send,router:openwrt3
request:
  id: 438366
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 438366
  result:
  - rows:
    - _uuid:
      - uuid
      - 393e99d6-1e7d-49dc-9963-bffa69065533
      _version:
      - uuid
      - 0391d5c9-2872-4408-8548-d38fe1de92ed
      bridges:
      - uuid
      - d5e90cc0-3979-4b36-bf3b-a5d5d6f96fe3
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - uuid
      - cdb9858a-eb31-4f31-bdbe-3d4d15f9d1f1
      vxlan:
      - uuid
      - bd3748de-8edc-4631-bddc-e46d681f026d
[DEBUG] 2014-05-14 07:36:07,416 module:ovsdb,function:_send,router:openwrt3
request:
  id: 905331
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 103
response:
  error: null
  id: 905331
  result:
  - rows: []
[INFO] 2014-05-14 07:36:07,422 module:subnets,function:add,router:openwrt3
Adding a subnet(vlan): 3
[DEBUG] 2014-05-14 07:36:07,423 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addbr br103
[DEBUG] 2014-05-14 07:36:07,436 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int-br103 tag=3 -- set interface int-br103 type=internal
[DEBUG] 2014-05-14 07:36:07,508 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int-dvr103 tag=3 -- set interface int-dvr103 type=internal
[DEBUG] 2014-05-14 07:36:07,566 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br103 int-br103
[DEBUG] 2014-05-14 07:36:07,577 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-br103 promisc on
[DEBUG] 2014-05-14 07:36:07,585 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-br103 up
[DEBUG] 2014-05-14 07:36:07,596 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-dvr103 up
[DEBUG] 2014-05-14 07:36:07,601 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br103 up
[DEBUG] 2014-05-14 07:36:07,629 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns add ns103
[DEBUG] 2014-05-14 07:36:07,639 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link add veth-ns103 type veth peer name temp-ns103
[DEBUG] 2014-05-14 07:36:07,654 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev temp-ns103 netns ns103
[DEBUG] 2014-05-14 07:36:07,663 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns103 ip link set dev temp-ns103 name eth0
[DEBUG] 2014-05-14 07:36:07,678 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br103 veth-ns103
[DEBUG] 2014-05-14 07:36:07,693 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns103 promisc on
[DEBUG] 2014-05-14 07:36:07,700 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns103 up
[DEBUG] 2014-05-14 07:36:07,723 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns103 ip link set dev eth0 up
[DEBUG] 2014-05-14 07:36:07,737 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns103 ip addr add dev eth0 10.0.3.103/24
[DEBUG] 2014-05-14 07:36:07,746 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns103 ip route add default via 10.0.3.1 dev eth0
[DEBUG] 2014-05-14 07:36:07,754 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip addr add dev int-dvr103 10.0.3.1/24
[DEBUG] 2014-05-14 07:36:07,761 module:ovsdb,function:_send,router:openwrt3
request:
  id: 129018
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 129018
  result:
  - rows: []
[DEBUG] 2014-05-14 07:36:07,764 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=103,actions=mod_vlan_vid:3,resubmit(,10)
[DEBUG] 2014-05-14 07:36:07,774 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=3,nw_dst=10.0.3.1,actions=drop
[DEBUG] 2014-05-14 07:36:07,783 module:ovsdb,function:_send,router:openwrt3
request:
  id: 616901
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 616901
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-14 07:36:07,792 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=3,actions=strip_vlan,set_tunnel:103,output:3,output:2
[DEBUG] 2014-05-14 07:36:07,802 module:ovsdb,function:crud,router:openwrt3
CRUD operation (add): {'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 3, 'ip_vhost': '10.0.3.103/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr')])}
[DEBUG] 2014-05-14 07:36:07,806 module:ovsdb,function:_send,router:openwrt3
request:
  id: 255611
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ip_dvr:
      - map
      - - - addr
          - 10.0.3.1/24
        - - mode
          - dvr
      ip_vhost: 10.0.3.103/24
      peers:
      - set
      - - 192.168.1.101
        - 192.168.1.102
      vid: 3
      vni: 103
    table: NLAN_Subnet
    uuid-name: temp_579638
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_579638
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 255611
  result:
  - uuid:
    - uuid
    - 9ebaccdc-437e-4d2b-914f-c7ace287fe05
  - count: 1
[DEBUG] 2014-05-14 07:36:07,810 module:ovsdb,function:_send,router:openwrt3
request:
  id: 160820
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 103
response:
  error: null
  id: 160820
  result:
  - rows:
    - _uuid:
      - uuid
      - 9ebaccdc-437e-4d2b-914f-c7ace287fe05
      _version:
      - uuid
      - e002f7e6-8976-4dcf-8b99-f307d86d7af5
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - - - addr
          - 10.0.3.1/24
        - - mode
          - dvr
      ip_vhost: 10.0.3.103/24
      peers:
      - set
      - - 192.168.1.101
        - 192.168.1.102
      ports:
      - set
      - []
      vid: 3
      vni: 103
[INFO] 2014-05-14 07:36:07,816 module:nlan_agent,function:_route,router:openwrt3
function:subnets.add, index:['vni', 101], model:{'peers': ['192.168.1.102', '192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.103/24', 'vni': 101, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'spoke_dvr')])}
[DEBUG] 2014-05-14 07:36:07,818 module:ovsdb,function:_send,router:openwrt3
request:
  id: 297568
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 297568
  result:
  - rows:
    - _uuid:
      - uuid
      - 393e99d6-1e7d-49dc-9963-bffa69065533
      _version:
      - uuid
      - fc831e05-3ce0-4da6-a531-78c7c11b5cf6
      bridges:
      - uuid
      - d5e90cc0-3979-4b36-bf3b-a5d5d6f96fe3
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - set
      - - - uuid
          - 9ebaccdc-437e-4d2b-914f-c7ace287fe05
        - - uuid
          - cdb9858a-eb31-4f31-bdbe-3d4d15f9d1f1
      vxlan:
      - uuid
      - bd3748de-8edc-4631-bddc-e46d681f026d
[DEBUG] 2014-05-14 07:36:07,826 module:ovsdb,function:_send,router:openwrt3
request:
  id: 233549
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 101
response:
  error: null
  id: 233549
  result:
  - rows: []
[INFO] 2014-05-14 07:36:07,829 module:subnets,function:add,router:openwrt3
Adding a subnet(vlan): 1
[DEBUG] 2014-05-14 07:36:07,830 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addbr br101
[DEBUG] 2014-05-14 07:36:07,841 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int-br101 tag=1 -- set interface int-br101 type=internal
[DEBUG] 2014-05-14 07:36:07,879 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int-dvr101 tag=1 -- set interface int-dvr101 type=internal
[DEBUG] 2014-05-14 07:36:07,924 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br101 int-br101
[DEBUG] 2014-05-14 07:36:07,934 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-br101 promisc on
[DEBUG] 2014-05-14 07:36:07,946 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-br101 up
[DEBUG] 2014-05-14 07:36:07,951 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-dvr101 up
[DEBUG] 2014-05-14 07:36:07,956 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br101 up
[DEBUG] 2014-05-14 07:36:07,968 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns add ns101
[DEBUG] 2014-05-14 07:36:07,979 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link add veth-ns101 type veth peer name temp-ns101
[DEBUG] 2014-05-14 07:36:07,994 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev temp-ns101 netns ns101
[DEBUG] 2014-05-14 07:36:08,002 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns101 ip link set dev temp-ns101 name eth0
[DEBUG] 2014-05-14 07:36:08,013 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br101 veth-ns101
[DEBUG] 2014-05-14 07:36:08,033 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns101 promisc on
[DEBUG] 2014-05-14 07:36:08,040 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns101 up
[DEBUG] 2014-05-14 07:36:08,062 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns101 ip link set dev eth0 up
[DEBUG] 2014-05-14 07:36:08,081 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns101 ip addr add dev eth0 10.0.1.103/24
[DEBUG] 2014-05-14 07:36:08,090 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns101 ip route add default via 10.0.1.1 dev eth0
[DEBUG] 2014-05-14 07:36:08,100 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip addr add dev int-dvr101 10.0.1.1/24
[DEBUG] 2014-05-14 07:36:08,106 module:ovsdb,function:_send,router:openwrt3
request:
  id: 78657
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 78657
  result:
  - rows: []
[DEBUG] 2014-05-14 07:36:08,109 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=101,actions=mod_vlan_vid:1,resubmit(,10)
[DEBUG] 2014-05-14 07:36:08,125 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link show dev int-dvr101
[DEBUG] 2014-05-14 07:36:08,133 module:ovsdb,function:_send,router:openwrt3
request:
  id: 132914
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: Interface
    where:
    - - name
      - ==
      - int-dvr101
response:
  error: null
  id: 132914
  result:
  - rows:
    - _uuid:
      - uuid
      - ec0356fb-6f93-4f4a-857a-a7d6b54b694c
      _version:
      - uuid
      - cd83f073-9cfd-4f43-be34-4b925b7ccc0d
      admin_state: up
      bfd:
      - map
      - []
      bfd_status:
      - map
      - []
      cfm_fault:
      - set
      - []
      cfm_fault_status:
      - set
      - []
      cfm_flap_count:
      - set
      - []
      cfm_health:
      - set
      - []
      cfm_mpid:
      - set
      - []
      cfm_remote_mpids:
      - set
      - []
      cfm_remote_opstate:
      - set
      - []
      duplex:
      - set
      - []
      external_ids:
      - map
      - []
      ifindex: 44
      ingress_policing_burst: 0
      ingress_policing_rate: 0
      lacp_current:
      - set
      - []
      link_resets: 2
      link_speed:
      - set
      - []
      link_state: up
      mac:
      - set
      - []
      mac_in_use: b2:46:32:81:02:fb
      mtu: 1500
      name: int-dvr101
      ofport: 7
      ofport_request:
      - set
      - []
      options:
      - map
      - []
      other_config:
      - map
      - []
      statistics:
      - map
      - - - collisions
          - 0
        - - rx_bytes
          - 0
        - - rx_crc_err
          - 0
        - - rx_dropped
          - 0
        - - rx_errors
          - 0
        - - rx_frame_err
          - 0
        - - rx_over_err
          - 0
        - - rx_packets
          - 0
        - - tx_bytes
          - 0
        - - tx_dropped
          - 0
        - - tx_errors
          - 0
        - - tx_packets
          - 0
      status:
      - map
      - - - driver_name
          - openvswitch
      type: internal
[DEBUG] 2014-05-14 07:36:08,148 module:ovsdb,function:_send,router:openwrt3
request:
  id: 158926
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: Interface
    where:
    - - name
      - ==
      - int-br101
response:
  error: null
  id: 158926
  result:
  - rows:
    - _uuid:
      - uuid
      - f765e54f-2f57-469c-b928-8293049c831d
      _version:
      - uuid
      - c83f70b2-c67e-4cdc-8870-786546f9ff18
      admin_state: up
      bfd:
      - map
      - []
      bfd_status:
      - map
      - []
      cfm_fault:
      - set
      - []
      cfm_fault_status:
      - set
      - []
      cfm_flap_count:
      - set
      - []
      cfm_health:
      - set
      - []
      cfm_mpid:
      - set
      - []
      cfm_remote_mpids:
      - set
      - []
      cfm_remote_opstate:
      - set
      - []
      duplex:
      - set
      - []
      external_ids:
      - map
      - []
      ifindex: 43
      ingress_policing_burst: 0
      ingress_policing_rate: 0
      lacp_current:
      - set
      - []
      link_resets: 2
      link_speed:
      - set
      - []
      link_state: up
      mac:
      - set
      - []
      mac_in_use: 1a:25:67:f3:5a:0e
      mtu: 1500
      name: int-br101
      ofport: 6
      ofport_request:
      - set
      - []
      options:
      - map
      - []
      other_config:
      - map
      - []
      statistics:
      - map
      - - - collisions
          - 0
        - - rx_bytes
          - 0
        - - rx_crc_err
          - 0
        - - rx_dropped
          - 0
        - - rx_errors
          - 0
        - - rx_frame_err
          - 0
        - - rx_over_err
          - 0
        - - rx_packets
          - 0
        - - tx_bytes
          - 0
        - - tx_dropped
          - 0
        - - tx_errors
          - 0
        - - tx_packets
          - 0
      status:
      - map
      - - - driver_name
          - openvswitch
      type: internal
[DEBUG] 2014-05-14 07:36:08,160 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=0,priority=2,in_port=6,dl_type=0x0800,nw_dst=10.0.1.0/24,actions=normal
[DEBUG] 2014-05-14 07:36:08,170 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=10.0.0.0/8,actions=resubmit(,1)
[DEBUG] 2014-05-14 07:36:08,181 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=172.16.0.0/12,actions=resubmit(,1)
[DEBUG] 2014-05-14 07:36:08,191 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=192.168.0.0/16,actions=resubmit(,1)
[DEBUG] 2014-05-14 07:36:08,201 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=7,dl_type=0x0806,nw_src=10.0.1.1,nw_proto=2,actions=drop
[DEBUG] 2014-05-14 07:36:08,212 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=1,priority=0,in_port=6,actions=set_field:b2:46:32:81:02:fb->dl_dst,output:7
[DEBUG] 2014-05-14 07:36:08,222 module:ovsdb,function:_send,router:openwrt3
request:
  id: 888260
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 888260
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-14 07:36:08,229 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=1,actions=strip_vlan,set_tunnel:101,output:2,output:4
[DEBUG] 2014-05-14 07:36:08,238 module:ovsdb,function:crud,router:openwrt3
CRUD operation (add): {'peers': ['192.168.1.102', '192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.103/24', 'vni': 101, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'spoke_dvr')])}
[DEBUG] 2014-05-14 07:36:08,241 module:ovsdb,function:_send,router:openwrt3
request:
  id: 791555
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ip_dvr:
      - map
      - - - addr
          - 10.0.1.1/24
        - - mode
          - spoke_dvr
      ip_vhost: 10.0.1.103/24
      peers:
      - set
      - - 192.168.1.102
        - 192.168.1.104
      vid: 1
      vni: 101
    table: NLAN_Subnet
    uuid-name: temp_867811
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_867811
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 791555
  result:
  - uuid:
    - uuid
    - 7b0021ed-d138-402d-ba76-cbb8c8fca04c
  - count: 1
[DEBUG] 2014-05-14 07:36:08,244 module:ovsdb,function:_send,router:openwrt3
request:
  id: 924286
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 101
response:
  error: null
  id: 924286
  result:
  - rows:
    - _uuid:
      - uuid
      - 7b0021ed-d138-402d-ba76-cbb8c8fca04c
      _version:
      - uuid
      - 90cd6654-9817-4c70-a793-40ca84ebc199
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - - - addr
          - 10.0.1.1/24
        - - mode
          - spoke_dvr
      ip_vhost: 10.0.1.103/24
      peers:
      - set
      - - 192.168.1.102
        - 192.168.1.104
      ports:
      - set
      - []
      vid: 1
      vni: 101
[INFO] 2014-05-14 07:36:08,250 module:nlan_agent,function:<module>,router:openwr--- STDOUT from router:rpi1,platform:debian
[INFO] 2014-05-14 00:36:09,150 module:nlan_agent,function:<module>,router:rpi1
NLAN Agent initialization completed
[DEBUG] 2014-05-14 00:36:09,155 module:nlan_agent,function:<module>,router:rpi1
__n__: {'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'platform': 'debian', 'share_dir': '/opt/nlan/share', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'logger': <logging.Logger object at 0xb72bb78c>, 'router': 'rpi1', 'schema': 'ovsdb_nlan.schema', 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'enum': ['set', ['enabled']], 'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'ip_dvr': {'max': 2, 'value': {'type': 'string'}, 'key': {'enum': ['set', ['addr', 'mode']], 'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}}, 'indexes': {'services': 'name', 'subnets': 'vni'}}
[INFO] 2014-05-14 00:36:09,284 module:nlan_agent,function:_route,router:rpi1
function:bridges.add, model:{'ovs_bridges': 'enabled'}
[DEBUG] 2014-05-14 00:36:09,313 module:ovsdb,function:_send,router:rpi1
request:
  id: 42152
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 42152
  result:
  - rows: []
[DEBUG] 2014-05-14 00:36:09,316 module:ovsdb,function:_send,router:rpi1
request:
  id: 745169
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row: {}
    table: NLAN
response:
  error: null
  id: 745169
  result:
  - uuid:
    - uuid
    - 62c316ee-9e03-4f1c-b7dc-4b9d455699e3
[DEBUG] 2014-05-14 00:36:09,319 module:ovsdb,function:_send,router:rpi1
request:
  id: 437779
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Bridges
    where: []
response:
  error: null
  id: 437779
  result:
  - rows: []
[INFO] 2014-05-14 00:36:09,322 module:bridges,function:add,router:rpi1
Adding bridges: br-int and br-tun
[DEBUG] 2014-05-14 00:36:09,352 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-br br-int
[DEBUG] 2014-05-14 00:36:09,397 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-br br-tun
[DEBUG] 2014-05-14 00:36:09,453 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl del-flows br-tun
[DEBUG] 2014-05-14 00:36:09,495 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-int patch-int -- set interface patch-int type=patch options:peer=patch-tun
[DEBUG] 2014-05-14 00:36:09,546 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-tun patch-tun -- set interface patch-tun type=patch options:peer=patch-int
[DEBUG] 2014-05-14 00:36:09,584 module:ovsdb,function:_send,router:rpi1
request:
  id: 955352
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: Interface
    where:
    - - name
      - ==
      - patch-tun
response:
  error: null
  id: 955352
  result:
  - rows:
    - _uuid:
      - uuid
      - 563a7c14-c04b-48d5-9348-af2f6c652619
      _version:
      - uuid
      - fc1edcf0-8e58-4697-a126-32a050f9bca8
      admin_state:
      - set
      - []
      bfd:
      - map
      - []
      bfd_status:
      - map
      - []
      cfm_fault:
      - set
      - []
      cfm_fault_status:
      - set
      - []
      cfm_flap_count:
      - set
      - []
      cfm_health:
      - set
      - []
      cfm_mpid:
      - set
      - []
      cfm_remote_mpids:
      - set
      - []
      cfm_remote_opstate:
      - set
      - []
      duplex:
      - set
      - []
      external_ids:
      - map
      - []
      ifindex: 0
      ingress_policing_burst: 0
      ingress_policing_rate: 0
      lacp_current:
      - set
      - []
      link_resets:
      - set
      - []
      link_speed:
      - set
      - []
      link_state:
      - set
      - []
      mac:
      - set
      - []
      mac_in_use: e6:11:aa:35:ac:8f
      mtu:
      - set
      - []
      name: patch-tun
      ofport: 1
      ofport_request:
      - set
      - []
      options:
      - map
      - - - peer
          - patch-int
      other_config:
      - map
      - []
      statistics:
      - map
      - - - collisions
          - 0
        - - rx_bytes
          - 0
        - - rx_crc_err
          - 0
        - - rx_dropped
          - 0
        - - rx_errors
          - 0
        - - rx_frame_err
          - 0
        - - rx_over_err
          - 0
        - - rx_packets
          - 0
        - - tx_bytes
          - 0
        - - tx_dropped
          - 0
        - - tx_errors
          - 0
        - - tx_packets
          - 0
      status:
      - map
      - []
      type: patch
[DEBUG] 2014-05-14 00:36:09,588 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=1,actions=resubmit(,1)
[DEBUG] 2014-05-14 00:36:09,610 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=0,priority=0,actions=drop
[DEBUG] 2014-05-14 00:36:09,624 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=01:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,19)
[DEBUG] 2014-05-14 00:36:09,641 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=00:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,20)
[DEBUG] 2014-05-14 00:36:09,657 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=2,priority=0,actions=drop
[DEBUG] 2014-05-14 00:36:09,675 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=3,priority=0,actions=drop
[DEBUG] 2014-05-14 00:36:09,691 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=10,priority=1,actions=learn(table=20,hard_timeout=300,priority=1,NXM_OF_VLAN_TCI[0..11],NXM_OF_ETH_DST[]=NXM_OF_ETH_SRC[],load:0->NXM_OF_VLAN_TCI[],load:NXM_NX_TUN_ID[]->NXM_NX_TUN_ID[],output:NXM_OF_IN_PORT[]),output:1
[DEBUG] 2014-05-14 00:36:09,706 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=19,priority=0,actions=resubmit(,21)
[DEBUG] 2014-05-14 00:36:09,720 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=20,priority=0,actions=resubmit(,21)
[DEBUG] 2014-05-14 00:36:09,736 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=21,priority=0,actions=drop
[DEBUG] 2014-05-14 00:36:09,750 module:ovsdb,function:crud,router:rpi1
CRUD operation (add): {'ovs_bridges': 'enabled'}
[DEBUG] 2014-05-14 00:36:09,754 module:ovsdb,function:_send,router:rpi1
request:
  id: 234971
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ovs_bridges: enabled
    table: NLAN_Bridges
    uuid-name: temp_620350
  - mutations:
    - - bridges
      - insert
      - - set
        - - - named-uuid
            - temp_620350
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 234971
  result:
  - uuid:
    - uuid
    - 09b95f0a-2t3
NLAN Agent execution completed
--- RESPONSE from router:openwrt3,platform:openwrt
message: Execution completed
exit: 0
cb1-44c1-9763-f7d47aa4ea7b
  - count: 1
[DEBUG] 2014-05-14 00:36:09,758 module:ovsdb,function:_send,router:rpi1
request:
  id: 94267
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Bridges
    where: []
response:
  error: null
  id: 94267
  result:
  - rows:
    - _uuid:
      - uuid
      - 09b95f0a-2cb1-44c1-9763-f7d47aa4ea7b
      _version:
      - uuid
      - bf628118-f935-4f55-8dd4-24e0f519c42e
      controller:
      - set
      - []
      ovs_bridges: enabled
[INFO] 2014-05-14 00:36:09,763 module:nlan_agent,function:_route,router:rpi1
function:services.add, index:['name', 'snort1'], model:{'name': 'snort1', 'chain': ['mz.101', 'dmz.1001']}
[DEBUG] 2014-05-14 00:36:09,766 module:ovsdb,function:_send,router:rpi1
request:
  id: 671035
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 671035
  result:
  - rows:
    - _uuid:
      - uuid
      - 62c316ee-9e03-4f1c-b7dc-4b9d455699e3
      _version:
      - uuid
      - 3b750b5c-8b0b-4071-a0b0-64b1d7217b75
      bridges:
      - uuid
      - 09b95f0a-2cb1-44c1-9763-f7d47aa4ea7b
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - set
      - []
      vxlan:
      - set
      - []
[DEBUG] 2014-05-14 00:36:09,768 module:ovsdb,function:_send,router:rpi1
request:
  id: 824113
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Service
    where:
    - - name
      - ==
      - snort1
response:
  error: null
  id: 824113
  result:
  - rows: []
[DEBUG] 2014-05-14 00:36:09,773 module:cmdutil,function:_cmd2,router:rpi1
cmd: lxc-stop -n snort1
[DEBUG] 2014-05-14 00:36:09,785 module:cmdutil,function:_cmd2,router:rpi1
cmd: lxc-start -d -f /var/lib/lxc/snort1/config_nlan -n snort1
[DEBUG] 2014-05-14 00:36:09,794 module:ovsdb,function:crud,router:rpi1
CRUD operation (add): {'name': 'snort1', 'chain': ['mz.101', 'dmz.1001']}
[DEBUG] 2014-05-14 00:36:09,797 module:ovsdb,function:_send,router:rpi1
request:
  id: 285155
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      chain:
      - set
      - - mz.101
        - dmz.1001
      name: snort1
    table: NLAN_Service
    uuid-name: temp_354057
  - mutations:
    - - services
      - insert
      - - set
        - - - named-uuid
            - temp_354057
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 285155
  result:
  - uuid:
    - uuid
    - c028faa3-88f2-4ed8-bbde-f1c0f0c4391d
  - count: 1
[DEBUG] 2014-05-14 00:36:09,801 module:ovsdb,function:_send,router:rpi1
request:
  id: 495442
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Service
    where:
    - - name
      - ==
      - snort1
response:
  error: null
  id: 495442
  result:
  - rows:
    - _uuid:
      - uuid
      - c028faa3-88f2-4ed8-bbde-f1c0f0c4391d
      _version:
      - uuid
      - 91dec315-5a45-4188-b216-83325728393c
      chain:
      - set
      - - dmz.1001
        - mz.101
      name: snort1
[INFO] 2014-05-14 00:36:09,810 module:nlan_agent,function:_route,router:rpi1
function:vxlan.add, model:{'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.101'], 'local_ip': '192.168.1.104'}
[DEBUG] 2014-05-14 00:36:09,816 module:ovsdb,function:_send,router:rpi1
request:
  id: 232667
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 232667
  result:
  - rows:
    - _uuid:
      - uuid
      - 62c316ee-9e03-4f1c-b7dc-4b9d455699e3
      _version:
      - uuid
      - 38bd859b-52df-4bf6-a696-8fa9751df201
      bridges:
      - uuid
      - 09b95f0a-2cb1-44c1-9763-f7d47aa4ea7b
      gateway:
      - set
      - []
      services:
      - uuid
      - c028faa3-88f2-4ed8-bbde-f1c0f0c4391d
      subnets:
      - set
      - []
      vxlan:
      - set
      - []
[DEBUG] 2014-05-14 00:36:09,819 module:ovsdb,function:_send,router:rpi1
request:
  id: 603123
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_VXLAN
    where: []
response:
  error: null
  id: 603123
  result:
  - rows: []
[INFO] 2014-05-14 00:36:09,824 module:vxlan,function:add,router:rpi1
Adding a VXLAN tunnel: vxlan_103
[DEBUG] 2014-05-14 00:36:09,837 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-tun vxlan_103 -- set interface vxlan_103 type=vxlan options:in_key=flow options:local_ip=192.168.1.104 options:out_key=flow options:remote_ip=192.168.1.103
[INFO] 2014-05-14 00:36:09,959 module:vxlan,function:add,router:rpi1
Adding a VXLAN tunnel: vxlan_102
[DEBUG] 2014-05-14 00:36:09,960 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-tun vxlan_102 -- set interface vxlan_102 type=vxlan options:in_key=flow options:local_ip=192.168.1.104 options:out_key=flow options:remote_ip=192.168.1.102
[INFO] 2014-05-14 00:36:10,060 module:vxlan,function:add,router:rpi1
Adding a VXLAN tunnel: vxlan_101
[DEBUG] 2014-05-14 00:36:10,061 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-tun vxlan_101 -- set interface vxlan_101 type=vxlan options:in_key=flow options:local_ip=192.168.1.104 options:out_key=flow options:remote_ip=192.168.1.101
[DEBUG] 2014-05-14 00:36:10,155 module:ovsdb,function:_send,router:rpi1
request:
  id: 861033
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 861033
  result:
  - rows:
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
[DEBUG] 2014-05-14 00:36:10,164 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=4,actions=resubmit(,2)
[DEBUG] 2014-05-14 00:36:10,202 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=3,actions=resubmit(,2)
[DEBUG] 2014-05-14 00:36:10,216 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=2,actions=resubmit(,2)
[DEBUG] 2014-05-14 00:36:10,227 module:ovsdb,function:crud,router:rpi1
CRUD operation (add): {'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.101'], 'local_ip': '192.168.1.104'}
[DEBUG] 2014-05-14 00:36:10,229 module:ovsdb,function:_send,router:rpi1
request:
  id: 641893
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      local_ip: 192.168.1.104
      remote_ips:
      - set
      - - 192.168.1.103
        - 192.168.1.102
        - 192.168.1.101
    table: NLAN_VXLAN
    uuid-name: temp_620347
  - mutations:
    - - vxlan
      - insert
      - - set
        - - - named-uuid
            - temp_620347
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 641893
  result:
  - uuid:
    - uuid
    - a39319a5-a0d4-4baa-8efd-4aca347fbda8
  - count: 1
[DEBUG] 2014-05-14 00:36:10,232 module:ovsdb,function:_send,router:rpi1
request:
  id: 98929
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_VXLAN
    where: []
response:
  error: null
  id: 98929
  result:
  - rows:
    - _uuid:
      - uuid
      - a39319a5-a0d4-4baa-8efd-4aca347fbda8
      _version:
      - uuid
      - 0078decd-9efc-42cb-9c6b-e7efeb248462
      local_ip: 192.168.1.104
      remote_ips:
      - set
      - - 192.168.1.101
        - 192.168.1.102
        - 192.168.1.103
[INFO] 2014-05-14 00:36:10,244 module:nlan_agent,function:_route,router:rpi1
function:subnets.add, index:['vni', 1001], model:{'peers': ['192.168.1.101'], 'ports': ['dmz.1001'], 'vni': 1001, 'vid': 111}
[DEBUG] 2014-05-14 00:36:10,246 module:ovsdb,function:_send,router:rpi1
request:
  id: 692172
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 692172
  result:
  - rows:
    - _uuid:
      - uuid
      - 62c316ee-9e03-4f1c-b7dc-4b9d455699e3
      _version:
      - uuid
      - 253edf52-d04b-4a78-a03c-831bfc3ba34c
      bridges:
      - uuid
      - 09b95f0a-2cb1-44c1-9763-f7d47aa4ea7b
      gateway:
      - set
      - []
      services:
      - uuid
      - c028faa3-88f2-4ed8-bbde-f1c0f0c4391d
      subnets:
      - set
      - []
      vxlan:
      - uuid
      - a39319a5-a0d4-4baa-8efd-4aca347fbda8
[DEBUG] 2014-05-14 00:36:10,249 module:ovsdb,function:_send,router:rpi1
request:
  id: 654836
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1001
response:
  error: null
  id: 654836
  result:
  - rows: []
[INFO] 2014-05-14 00:36:10,253 module:subnets,function:add,router:rpi1
Adding a subnet(vlan): 111
[DEBUG] 2014-05-14 00:36:10,254 module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addbr br1001
[DEBUG] 2014-05-14 00:36:10,262 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-int int-br1001 tag=111 -- set interface int-br1001 type=internal
[DEBUG] 2014-05-14 00:36:10,328 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-int int-dvr1001 tag=111 -- set interface int-dvr1001 type=internal
[DEBUG] 2014-05-14 00:36:10,424 module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addif br1001 int-br1001
[DEBUG] 2014-05-14 00:36:10,451 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int-br1001 promisc on
[DEBUG] 2014-05-14 00:36:10,472 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int-br1001 up
[DEBUG] 2014-05-14 00:36:10,487 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int-dvr1001 up
[DEBUG] 2014-05-14 00:36:10,499 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev br1001 up
[DEBUG] 2014-05-14 00:36:10,512 module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addif br1001 dmz.1001
[DEBUG] 2014-05-14 00:36:10,529 module:ovsdb,function:_send,router:rpi1
request:
  id: 360059
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 360059
  result:
  - rows: []
[DEBUG] 2014-05-14 00:36:10,532 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=1001,actions=mod_vlan_vid:111,resubmit(,10)
[DEBUG] 2014-05-14 00:36:10,553 module:ovsdb,function:_send,router:rpi1
request:
  id: 989135
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 989135
  result:
  - rows:
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
[DEBUG] 2014-05-14 00:36:10,555 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=111,actions=strip_vlan,set_tunnel:1001,output:4
[DEBUG] 2014-05-14 00:36:10,577 module:ovsdb,function:crud,router:rpi1
CRUD operation (add): {'peers': ['192.168.1.101'], 'ports': ['dmz.1001'], 'vni': 1001, 'vid': 111}
[DEBUG] 2014-05-14 00:36:10,579 module:ovsdb,function:_send,router:rpi1
request:
  id: 791122
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      peers:
      - set
      - - 192.168.1.101
      ports:
      - set
      - - dmz.1001
      vid: 111
      vni: 1001
    table: NLAN_Subnet
    uuid-name: temp_704758
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_704758
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 791122
  result:
  - uuid:
    - uuid
    - 7c20805e-430b-40d1-b96f-fa290bd54b7d
  - count: 1
[DEBUG] 2014-05-14 00:36:10,581 module:ovsdb,function:_send,router:rpi1
request:
  id: 331580
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1001
response:
  error: null
  id: 331580
  result:
  - rows:
    - _uuid:
      - uuid
      - 7c20805e-430b-40d1-b96f-fa290bd54b7d
      _version:
      - uuid
      - 08a2f94f-b74f-4ac5-b0e6-0715f3cbe306
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - []
      ip_vhost:
      - set
      - []
      peers: 192.168.1.101
      ports: dmz.1001
      vid: 111
      vni: 1001
[INFO] 2014-05-14 00:36:10,583 module:nlan_agent,function:_route,router:rpi1
function:subnets.add, index:['vni', 101], model:{'peers': ['192.168.1.102', '192.168.1.103'], 'ports': ['mz.101'], 'vni': 101, 'vid': 1}
[DEBUG] 2014-05-14 00:36:10,585 module:ovsdb,function:_send,router:rpi1
request:
  id: 865730
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 865730
  result:
  - rows:
    - _uuid:
      - uuid
      - 62c316ee-9e03-4f1c-b7dc-4b9d455699e3
      _version:
      - uuid
      - 44a1f4c2-ade3-4438-b6c4-e89241bc8358
      bridges:
      - uuid
      - 09b95f0a-2cb1-44c1-9763-f7d47aa4ea7b
      gateway:
      - set
      - []
      services:
      - uuid
      - c028faa3-88f2-4ed8-bbde-f1c0f0c4391d
      subnets:
      - uuid
      - 7c20805e-430b-40d1-b96f-fa290bd54b7d
      vxlan:
      - uuid
      - a39319a5-a0d4-4baa-8efd-4aca347fbda8
[DEBUG] 2014-05-14 00:36:10,588 module:ovsdb,function:_send,router:rpi1
request:
  id: 333796
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 101
response:
  error: null
  id: 333796
  result:
  - rows: []
[INFO] 2014-05-14 00:36:10,594 module:subnets,function:add,router:rpi1
Adding a subnet(vlan): 1
[DEBUG] 2014-05-14 00:36:10,595 module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addbr br101
[DEBUG] 2014-05-14 00:36:10,614 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-int int-br101 tag=1 -- set interface int-br101 type=internal
[DEBUG] 2014-05-14 00:36:10,695 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-int int-dvr101 tag=1 -- set interface int-dvr101 type=internal
[DEBUG] 2014-05-14 00:36:10,767 module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addif br101 int-br101
[DEBUG] 2014-05-14 00:36:10,787 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int-br101 promisc on
[DEBUG] 2014-05-14 00:36:10,802 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int-br101 up
[DEBUG] 2014-05-14 00:36:10,825 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int-dvr101 up
[DEBUG] 2014-05-14 00:36:10,842 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev br101 up
[DEBUG] 2014-05-14 00:36:10,859 module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addif br101 mz.101
[DEBUG] 2014-05-14 00:36:10,871 module:ovsdb,function:_send,router:rpi1
request:
  id: 189485
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 189485
  result:
  - rows: []
[DEBUG] 2014-05-14 00:36:10,872 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=101,actions=mod_vlan_vid:1,resubmit(,10)
[DEBUG] 2014-05-14 00:36:10,894 module:ovsdb,function:_send,router:rpi1
request:
  id: 653969
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
--- STDOUT from router:openwrt2,platform:openwrt
[INFO] 2014-05-14 07:36:07,040 module:nlan_agent,function:<module>,router:openwrt2
NLAN Agent initialization completed
[DEBUG] 2014-05-14 07:36:07,042 module:nlan_agent,function:<module>,router:openwrt2
__n__: {'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'platform': 'openwrt', 'share_dir': '/opt/nlan/share', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'logger': <logging.Logger object at 0xb757922c>, 'router': 'openwrt2', 'schema': 'ovsdb_nlan.schema', 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'enum': ['set', ['enabled']], 'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'ip_dvr': {'max': 2, 'value': {'type': 'string'}, 'key': {'enum': ['set', ['addr', 'mode']], 'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}}, 'indexes': {'services': 'name', 'subnets': 'vni'}}
[INFO] 2014-05-14 07:36:07,185 module:nlan_agent,function:_route,router:openwrt2
function:bridges.add, model:{'ovs_bridges': 'enabled'}
[DEBUG] 2014-05-14 07:36:07,200 module:ovsdb,function:_send,router:openwrt2
request:
  id: 499906
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 499906
  result:
  - rows: []
[DEBUG] 2014-05-14 07:36:07,205 module:ovsdb,function:_send,router:openwrt2
request:
  id: 195953
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row: {}
    table: NLAN
response:
  error: null
  id: 195953
  result:
  - uuid:
    - uuid
    - 4a692b70-03b1-477c-95b0-ce4574e39cf6
[DEBUG] 2014-05-14 07:36:07,210 module:ovsdb,function:_send,router:openwrt2
request:
  id: 695044
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Bridges
    where: []
response:
  error: null
  id: 695044
  result:
  - rows: []
[INFO] 2014-05-14 07:36:07,213 module:bridges,function:add,router:openwrt2
Adding bridges: br-int and br-tun
[DEBUG] 2014-05-14 07:36:07,269 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-br br-int
[DEBUG] 2014-05-14 07:36:07,331 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-br br-tun
[DEBUG] 2014-05-14 07:36:07,375 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl del-flows br-tun
[DEBUG] 2014-05-14 07:36:07,392 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int patch-int -- set interface patch-int type=patch options:peer=patch-tun
[DEBUG] 2014-05-14 07:36:07,429 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-tun patch-tun -- set interface patch-tun type=patch options:peer=patch-int
[DEBUG] 2014-05-14 07:36:07,459 module:ovsdb,function:_send,router:openwrt2
request:
  id: 305877
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: Interface
    where:
    - - name
      - ==
      - patch-tun
response:
  error: null
  id: 305877
  result:
  - rows:
    - _uuid:
      - uuid
      - aeb4def0-dba2-4fde-96f9-3626a3838fb9
      _version:
      - uuid
      - abe04180-ed2f-423b-bf7e-1fbb17a95bb8
      admin_state:
      - set
      - []
      bfd:
      - map
      - []
      bfd_status:
      - map
      - []
      cfm_fault:
      - set
      - []
      cfm_fault_status:
      - set
      - []
      cfm_flap_count:
      - set
      - []
      cfm_health:
      - set
      - []
      cfm_mpid:
      - set
      - []
      cfm_remote_mpids:
      - set
      - []
      cfm_remote_opstate:
      - set
      - []
      duplex:
      - set
      - []
      external_ids:
      - map
      - []
      ifindex: 0
      ingress_policing_burst: 0
      ingress_policing_rate: 0
      lacp_current:
      - set
      - []
      link_resets:
      - set
      - []
      link_speed:
      - set
      - []
      link_state:
      - set
      - []
      mac:
      - set
      - []
      mac_in_use: 3e:13:02:51:0c:8b
      mtu:
      - set
      - []
      name: patch-tun
      ofport: 1
      ofport_request:
      - set
      - []
      options:
      - map
      - - - peer
          - patch-int
      other_config:
      - map
      - []
      statistics:
      - map
      - - - collisions
          - 0
        - - rx_bytes
          - 0
        - - rx_crc_err
          - 0
        - - rx_dropped
          - 0
        - - rx_errors
          - 0
        - - rx_frame_err
          - 0
        - - rx_over_err
          - 0
        - - rx_packets
          - 0
        - - tx_bytes
          - 0
        - - tx_dropped
          - 0
        - - tx_errors
          - 0
        - - tx_packets
          - 0
      status:
      - map
      - []
      type: patch
[DEBUG] 2014-05-14 07:36:07,479 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=1,actions=resubmit(,1)
[DEBUG] 2014-05-14 07:36:07,492 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=0,priority=0,actions=drop
[DEBUG] 2014-05-14 07:36:07,503 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=01:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,19)
[DEBUG] 2014-05-14 07:36:07,520 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=00:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,20)
[DEBUG] 2014-05-14 07:36:07,534 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=2,priority=0,actions=drop
[DEBUG] 2014-05-14 07:36:07,545 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=3,priority=0,actions=drop
[DEBUG] 2014-05-14 07:36:07,559 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=10,priority=1,actions=learn(table=20,hard_timeout=300,priority=1,NXM_OF_VLAN_TCI[0..11],NXM_OF_ETH_DST[]=NXM_OF_ETH_SRC[],load:0->NXM_OF_VLAN_TCI[],load:NXM_NX_TUN_ID[]->NXM_NX_TUN_ID[],output:NXM_OF_IN_PORT[]),output:1
[DEBUG] 2014-05-14 07:36:07,572 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=19,priority=0,actions=resubmit(,21)
[DEBUG] 2014-05-14 07:36:07,586 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=20,priority=0,actions=resubmit(,21)
[DEBUG] 2014-05-14 07:36:07,597 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=21,priority=0,actions=drop
[DEBUG] 2014-05-14 07:36:07,610 module:ovsdb,function:crud,router:openwrt2
CRUD operation (add): {'ovs_bridges': 'enabled'}
[DEBUG] 2014-05-14 07:36:07,614 module:ovsdb,function:_send,router:openwrt2
request:
  id: 611910
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ovs_bridges: enabled
    table: NLAN_Bridges
    uuid-name: temp_824870
  - mutations:
    - - bridges
      - insert
      - - set
        - - - named-uuid
            - temp_824870
    op: mutate
      where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 653969
  result:
  - rows:
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
[DEBUG] 2014-05-14 00:36:10,895 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=1,actions=strip_vlan,set_tunnel:101,output:3,output:2
[DEBUG] 2014-05-14 00:36:10,916 module:ovsdb,function:crud,router:rpi1
CRUD operation (add): {'peers': ['192.168.1.102', '192.168.1.103'], 'ports': ['mz.101'], 'vni': 101, 'vid': 1}
[DEBUG] 2014-05-14 00:36:10,918 module:ovsdb,function:_send,router:rpi1
request:
  id: 88410
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      peers:
      - set
      - - 192.168.1.102
        - 192.168.1.103
      ports:
      - set
      - - mz.101
      vid: 1
      vni: 101
    table: NLAN_Subnet
    uuid-name: temp_718295
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_718295
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 88410
  result:
  - uuid:
    - uuid
    - 43e7a639-c1c7-45d4-8005-e707b1c7e46f
  - count: 1
[DEBUG] 2014-05-14 00:36:10,920 module:ovsdb,function:_send,router:rpi1
request:
  id: 39496
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 101
response:
  error: null
  id: 39496
  result:
  - rows:
    - _uuid:
      - uuid
      - 43e7a639-c1c7-45d4-8005-e707b1c7e46f
      _version:
      - uuid
      - 5c1ea7d8-a0ca-4f51-aef2-982ddc9ede28
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - []
      ip_vhost:
      - set
      - []
      peers:
      - set
      - - 192.168.1.102
        - 192.168.1.103
      ports: mz.101
      vid: 1
      vni: 101
[INFO] 2014-05-14 00:36:10,924 module:nlan_agent,function:<module>,router:rpi1
NLAN Agent execution completed
--- RESPONSE from router:rpi1,platform:debian
message: Execution completed
exit: 0
  table: NLAN
    where: []
response:
  error: null
  id: 611910
  result:
  - uuid:
    - uuid
    - df4fe8b8-0294-4d69-b0ff-df04d45b2fd1
  - count: 1
[DEBUG] 2014-05-14 07:36:07,619 module:ovsdb,function:_send,router:openwrt2
request:
  id: 175972
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Bridges
    where: []
response:
  error: null
  id: 175972
  result:
  - rows:
    - _uuid:
      - uuid
      - df4fe8b8-0294-4d69-b0ff-df04d45b2fd1
      _version:
      - uuid
      - 9ecfe91b-a02e-492a-8958-e344743f3dd2
      controller:
      - set
      - []
      ovs_bridges: enabled
[INFO] 2014-05-14 07:36:07,628 module:nlan_agent,function:_route,router:openwrt2
function:vxlan.add, model:{'remote_ips': ['192.168.1.103', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.102'}
[DEBUG] 2014-05-14 07:36:07,632 module:ovsdb,function:_send,router:openwrt2
request:
  id: 808086
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 808086
  result:
  - rows:
    - _uuid:
      - uuid
      - 4a692b70-03b1-477c-95b0-ce4574e39cf6
      _version:
      - uuid
      - b23010cc-d2e2-4976-9f08-0789428a8aa2
      bridges:
      - uuid
      - df4fe8b8-0294-4d69-b0ff-df04d45b2fd1
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - set
      - []
      vxlan:
      - set
      - []
[DEBUG] 2014-05-14 07:36:07,640 module:ovsdb,function:_send,router:openwrt2
request:
  id: 430726
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_VXLAN
    where: []
response:
  error: null
  id: 430726
  result:
  - rows: []
[INFO] 2014-05-14 07:36:07,645 module:vxlan,function:add,router:openwrt2
Adding a VXLAN tunnel: vxlan_103
[DEBUG] 2014-05-14 07:36:07,646 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-tun vxlan_103 -- set interface vxlan_103 type=vxlan options:in_key=flow options:local_ip=192.168.1.102 options:out_key=flow options:remote_ip=192.168.1.103
[INFO] 2014-05-14 07:36:07,674 module:vxlan,function:add,router:openwrt2
Adding a VXLAN tunnel: vxlan_101
[DEBUG] 2014-05-14 07:36:07,675 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-tun vxlan_101 -- set interface vxlan_101 type=vxlan options:in_key=flow options:local_ip=192.168.1.102 options:out_key=flow options:remote_ip=192.168.1.101
[INFO] 2014-05-14 07:36:07,761 module:vxlan,function:add,router:openwrt2
Adding a VXLAN tunnel: vxlan_104
[DEBUG] 2014-05-14 07:36:07,763 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-tun vxlan_104 -- set interface vxlan_104 type=vxlan options:in_key=flow options:local_ip=192.168.1.102 options:out_key=flow options:remote_ip=192.168.1.104
[DEBUG] 2014-05-14 07:36:07,801 module:ovsdb,function:_send,router:openwrt2
request:
  id: 586248
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 586248
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-14 07:36:07,810 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=3,actions=resubmit(,2)
[DEBUG] 2014-05-14 07:36:07,823 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=2,actions=resubmit(,2)
[DEBUG] 2014-05-14 07:36:07,836 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=4,actions=resubmit(,2)
[DEBUG] 2014-05-14 07:36:07,849 module:ovsdb,function:crud,router:openwrt2
CRUD operation (add): {'remote_ips': ['192.168.1.103', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.102'}
[DEBUG] 2014-05-14 07:36:07,854 module:ovsdb,function:_send,router:openwrt2
request:
  id: 518402
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      local_ip: 192.168.1.102
      remote_ips:
      - set
      - - 192.168.1.103
        - 192.168.1.101
        - 192.168.1.104
    table: NLAN_VXLAN
    uuid-name: temp_862602
  - mutations:
    - - vxlan
      - insert
      - - set
        - - - named-uuid
            - temp_862602
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 518402
  result:
  - uuid:
    - uuid
    - 08c091d3-0e3e-446f-b980-20f3332b6f28
  - count: 1
[DEBUG] 2014-05-14 07:36:07,866 module:ovsdb,function:_send,router:openwrt2
request:
  id: 748532
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_VXLAN
    where: []
response:
  error: null
  id: 748532
  result:
  - rows:
    - _uuid:
      - uuid
      - 08c091d3-0e3e-446f-b980-20f3332b6f28
      _version:
      - uuid
      - 1d00bd30-b11a-4803-9442-b5313424e77d
      local_ip: 192.168.1.102
      remote_ips:
      - set
      - - 192.168.1.101
        - 192.168.1.103
        - 192.168.1.104
[INFO] 2014-05-14 07:36:07,886 module:nlan_agent,function:_route,router:openwrt2
function:subnets.add, index:['vni', 1], model:{'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 2, 'ip_vhost': '192.168.100.102/24', 'default_gw': '192.168.100.1', 'ip_dvr': OrderedDict([('addr', '192.168.100.2/24'), ('mode', 'dvr')]), 'vni': 1}
[DEBUG] 2014-05-14 07:36:07,891 module:ovsdb,function:_send,router:openwrt2
request:
  id: 38622
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 38622
  result:
  - rows:
    - _uuid:
      - uuid
      - 4a692b70-03b1-477c-95b0-ce4574e39cf6
      _version:
      - uuid
      - f69fa748-0216-43ce-9a8b-01d323571679
      bridges:
      - uuid
      - df4fe8b8-0294-4d69-b0ff-df04d45b2fd1
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - set
      - []
      vxlan:
      - uuid
      - 08c091d3-0e3e-446f-b980-20f3332b6f28
[DEBUG] 2014-05-14 07:36:07,899 module:ovsdb,function:_send,router:openwrt2
request:
  id: 745176
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1
response:
  error: null
  id: 745176
  result:
  - rows: []
[INFO] 2014-05-14 07:36:07,906 module:subnets,function:add,router:openwrt2
Adding a subnet(vlan): 2
[DEBUG] 2014-05-14 07:36:07,907 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addbr br1
[DEBUG] 2014-05-14 07:36:07,921 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int-br1 tag=2 -- set interface int-br1 type=internal
[DEBUG] 2014-05-14 07:36:07,967 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int-dvr1 tag=2 -- set interface int-dvr1 type=internal
[DEBUG] 2014-05-14 07:36:08,020 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br1 int-br1
[DEBUG] 2014-05-14 07:36:08,033 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-br1 promisc on
[DEBUG] 2014-05-14 07:36:08,041 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-br1 up
[DEBUG] 2014-05-14 07:36:08,049 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-dvr1 up
[DEBUG] 2014-05-14 07:36:08,054 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br1 up
[DEBUG] 2014-05-14 07:36:08,068 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns add ns1
[DEBUG] 2014-05-14 07:36:08,082 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link add veth-ns1 type veth peer name temp-ns1
[DEBUG] 2014-05-14 07:36:08,097 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev temp-ns1 netns ns1
[DEBUG] 2014-05-14 07:36:08,120 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns1 ip link set dev temp-ns1 name eth0
[DEBUG] 2014-05-14 07:36:08,126 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br1 veth-ns1
[DEBUG] 2014-05-14 07:36:08,138 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns1 promisc on
[DEBUG] 2014-05-14 07:36:08,180 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns1 up
[DEBUG] 2014-05-14 07:36:08,201 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns1 ip link set dev eth0 up
[DEBUG] 2014-05-14 07:36:08,220 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns1 ip addr add dev eth0 192.168.100.102/24
[DEBUG] 2014-05-14 07:36:08,226 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns1 ip route add default via 192.168.100.2 dev eth0
[DEBUG] 2014-05-14 07:36:08,236 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip addr add dev int-dvr1 192.168.100.2/24
[DEBUG] 2014-05-14 07:36:08,243 module:cmdutil,function:_cmd2,router:openwrt2
cmd: route
[DEBUG] 2014-05-14 07:36:08,249 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip route add default via 192.168.100.1
[DEBUG] 2014-05-14 07:36:08,256 module:ovsdb,function:_send,router:openwrt2
request:
  id: 497735
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 497735
  result:
  - rows: []
[DEBUG] 2014-05-14 07:36:08,259 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=1,actions=mod_vlan_vid:2,resubmit(,10)
[DEBUG] 2014-05-14 07:36:08,272 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=2,nw_dst=192.168.100.2,actions=drop
[DEBUG] 2014-05-14 07:36:08,286 module:ovsdb,function:_send,router:openwrt2
request:
  id: 836784
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 836784
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-14 07:36:08,295 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=2,actions=strip_vlan,set_tunnel:1,output:3,output:2
[DEBUG] 2014-05-14 07:36:08,306 module:ovsdb,function:crud,router:openwrt2
CRUD operation (add): {'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 2, 'ip_vhost': '192.168.100.102/24', 'default_gw': '192.168.100.1', 'ip_dvr': OrderedDict([('addr', '192.168.100.2/24'), ('mode', 'dvr')]), 'vni': 1}
[DEBUG] 2014-05-14 07:36:08,311 module:ovsdb,function:_send,router:openwrt2
request:
  id: 414153
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      default_gw: 192.168.100.1
      ip_dvr:
      - map
      - - - addr
          - 192.168.100.2/24
        - - mode
          - dvr
      ip_vhost: 192.168.100.102/24
      peers:
      - set
      - - 192.168.1.101
        - 192.168.1.103
      vid: 2
      vni: 1
    table: NLAN_Subnet
    uuid-name: temp_689264
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_689264
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 414153
  result:
  - uuid:
    - uuid
    - d30bd589-b205-4e96-92f5-7f4237775bc8
  - count: 1
[DEBUG] 2014-05-14 07:36:08,315 module:ovsdb,function:_send,router:openwrt2
request:
  id: 621277
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1
response:
  error: null
  id: 621277
  result:
  - rows:
    - _uuid:
      - uuid
      - d30bd589-b205-4e96-92f5-7f4237775bc8
      _version:
      - uuid
      - 435b456c-1b3e-4abf-82a7-116863497c8b
      default_gw: 192.168.100.1
      ip_dvr:
      - map
      - - - addr
          - 192.168.100.2/24
        - - mode
          - dvr
      ip_vhost: 192.168.100.102/24
      peers:
      - set
      - - 192.168.1.101
        - 192.168.1.103
      ports:
      - set
      - []
      vid: 2
      vni: 1
[INFO] 2014-05-14 07:36:08,322 module:nlan_agent,function:_route,router:openwrt2
function:subnets.add, index:['vni', 103], model:{'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 3, 'ip_vhost': '10.0.3.102/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr')])}
[DEBUG] 2014-05-14 07:36:08,325 module:ovsdb,function:_send,router:openwrt2
request:
  id: 501488
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 501488
  result:
  - rows:
    - _uuid:
      - uuid
      - 4a692b70-03b1-477c-95b0-ce4574e39cf6
      _version:
      - uuid
      - a032f445-183d-4a29-8089-a7b6cc42d0d4
      bridges:
      - uuid
      - df4fe8b8-0294-4d69-b0ff-df04d45b2fd1
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - uuid
      - d30bd589-b205-4e96-92f5-7f4237775bc8
      vxlan:
      - uuid
      - 08c091d3-0e3e-446f-b980-20f3332b6f28
[DEBUG] 2014-05-14 07:36:08,333 module:ovsdb,function:_send,router:openwrt2
request:
  id: 503820
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 103
response:
  error: null
  id: 503820
  result:
  - rows: []
[INFO] 2014-05-14 07:36:08,337 module:subnets,function:add,router:openwrt2
Adding a subnet(vlan): 3
[DEBUG] 2014-05-14 07:36:08,338 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addbr br103
[DEBUG] 2014-05-14 07:36:08,351 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int-br103 tag=3 -- set interface int-br103 type=internal
[DEBUG] 2014-05-14 07:36:08,392 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int-dvr103 tag=3 -- set interface int-dvr103 type=internal
[DEBUG] 2014-05-14 07:36:08,445 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br103 int-br103
[DEBUG] 2014-05-14 07:36:08,455 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-br103 promisc on
[DEBUG] 2014-05-14 07:36:08,465 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-br103 up
[DEBUG] 2014-05-14 07:36:08,476 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-dvr103 up
[DEBUG] 2014-05-14 07:36:08,481 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br103 up
[DEBUG] 2014-05-14 07:36:08,494 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns add ns103
[DEBUG] 2014-05-14 07:36:08,502 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link add veth-ns103 type veth peer name temp-ns103
[DEBUG] 2014-05-14 07:36:08,517 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev temp-ns103 netns ns103
[DEBUG] 2014-05-14 07:36:08,525 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns103 ip link set dev temp-ns103 name eth0
[DEBUG] 2014-05-14 07:36:08,535 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br103 veth-ns103
[DEBUG] 2014-05-14 07:36:08,551 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns103 promisc on
[DEBUG] 2014-05-14 07:36:08,557 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns103 up
[DEBUG] 2014-05-14 07:36:08,577 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns103 ip link set dev eth0 up
[DEBUG] 2014-05-14 07:36:08,593 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns103 ip addr add dev eth0 10.0.3.102/24
[DEBUG] 2014-05-14 07:36:08,601 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns103 ip route add default via 10.0.3.1 dev eth0
[DEBUG] 2014-05-14 07:36:08,607 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip addr add dev int-dvr103 10.0.3.1/24
[DEBUG] 2014-05-14 07:36:08,614 module:ovsdb,function:_send,router:openwrt2
request:
  id: 633022
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 633022
  result:
  - rows: []
[DEBUG] 2014-05-14 07:36:08,616 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=103,actions=mod_vlan_vid:3,resubmit(,10)
[DEBUG] 2014-05-14 07:36:08,628 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=3,nw_dst=10.0.3.1,actions=drop
[DEBUG] 2014-05-14 07:36:08,641 module:ovsdb,function:_send,router:openwrt2
request:
  id: 51599
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 51599
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-14 07:36:08,649 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=3,actions=strip_vlan,set_tunnel:103,output:3,output:2
[DEBUG] 2014-05-14 07:36:08,657 module:ovsdb,function:crud,router:openwrt2
CRUD operation (add): {'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 3, 'ip_vhost': '10.0.3.102/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr')])}
[DEBUG] 2014-05-14 07:36:08,662 module:ovsdb,function:_send,router:openwrt2
request:
  id: 95750
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ip_dvr:
      - map
      - - - addr
          - 10.0.3.1/24
        - - mode
          - dvr
      ip_vhost: 10.0.3.102/24
      peers:
      - set
      - - 192.168.1.101
        - 192.168.1.103
      vid: 3
      vni: 103
    table: NLAN_Subnet
    uuid-name: temp_443531
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_443531
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 95750
  result:
  - uuid:
    - uuid
    - e9a46791-873a-4c16-bb64-ae1b7bb3d5f7
  - count: 1
[DEBUG] 2014-05-14 07:36:08,666 module:ovsdb,function:_send,router:openwrt2
request:
  id: 702775
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 103
response:
  error: null
  id: 702775
  result:
  - rows:
    - _uuid:
      - uuid
      - e9a46791-873a-4c16-bb64-ae1b7bb3d5f7
      _version:
      - uuid
      - f372f282-d424-4d04-bd24-bba880ba761e
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - - - addr
          - 10.0.3.1/24
        - - mode
          - dvr
      ip_vhost: 10.0.3.102/24
      peers:
      - set
      - - 192.168.1.101
        - 192.168.1.103
      ports:
      - set
      - []
      vid: 3
      vni: 103
[INFO] 2014-05-14 07:36:08,673 module:nlan_agent,function:_route,router:openwrt2
function:subnets.add, index:['vni', 101], model:{'peers': ['192.168.1.103', '192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.102/24', 'vni': 101, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'spoke_dvr')])}
[DEBUG] 2014-05-14 07:36:08,676 module:ovsdb,function:_send,router:openwrt2
request:
  id: 605443
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 605443
  result:
  - rows:
    - _uuid:
      - uuid
      - 4a692b70-03b1-477c-95b0-ce4574e39cf6
      _version:
      - uuid
      - 1dc7d5e7-289d-40ab-beb6-c802e8215af9
      bridges:
      - uuid
      - df4fe8b8-0294-4d69-b0ff-df04d45b2fd1
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - set
      - - - uuid
          - d30bd589-b205-4e96-92f5-7f4237775bc8
        - - uuid
          - e9a46791-873a-4c16-bb64-ae1b7bb3d5f7
      vxlan:
      - uuid
      - 08c091d3-0e3e-446f-b980-20f3332b6f28
[DEBUG] 2014-05-14 07:36:08,687 module:ovsdb,function:_send,router:openwrt2
request:
  id: 321922
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 101
response:
  error: null
  id: 321922
  result:
  - rows: []
[INFO] 2014-05-14 07:36:08,691 module:subnets,function:add,router:openwrt2
Adding a subnet(vlan): 1
[DEBUG] 2014-05-14 07:36:08,692 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addbr br101
[DEBUG] 2014-05-14 07:36:08,706 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int-br101 tag=1 -- set interface int-br101 type=internal
[DEBUG] 2014-05-14 07:36:08,787 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int-dvr101 tag=1 -- set interface int-dvr101 type=internal
[DEBUG] 2014-05-14 07:36:08,833 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br101 int-br101
[DEBUG] 2014-05-14 07:36:08,842 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-br101 promisc on
[DEBUG] 2014-05-14 07:36:08,853 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-br101 up
[DEBUG] 2014-05-14 07:36:08,857 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-dvr101 up
[DEBUG] 2014-05-14 07:36:08,862 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br101 up
[DEBUG] 2014-05-14 07:36:08,876 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns add ns101
[DEBUG] 2014-05-14 07:36:08,887 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link add veth-ns101 type veth peer name temp-ns101
[DEBUG] 2014-05-14 07:36:08,904 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev temp-ns101 netns ns101
[DEBUG] 2014-05-14 07:36:08,912 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns101 ip link set dev temp-ns101 name eth0
[DEBUG] 2014-05-14 07:36:08,925 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br101 veth-ns101
[DEBUG] 2014-05-14 07:36:08,940 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns101 promisc on
[DEBUG] 2014-05-14 07:36:08,945 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns101 up
[DEBUG] 2014-05-14 07:36:08,962 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns101 ip link set dev eth0 up
[DEBUG] 2014-05-14 07:36:08,980 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns101 ip addr add dev eth0 10.0.1.102/24
[DEBUG] 2014-05-14 07:36:08,990 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns101 ip route add default via 10.0.1.1 dev eth0
[DEBUG] 2014-05-14 07:36:08,998 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip addr add dev int-dvr101 10.0.1.1/24
[DEBUG] 2014-05-14 07:36:09,006 module:ovsdb,function:_send,router:openwrt2
request:
  id: 79163
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 79163
  result:
  - rows: []
[DEBUG] 2014-05-14 07:36:09,009 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=101,actions=mod_vlan_vid:1,resubmit(,10)
[DEBUG] 2014-05-14 07:36:09,020 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link show dev int-dvr101
[DEBUG] 2014-05-14 07:36:09,028 module:ovsdb,function:_send,router:openwrt2
request:
  id: 371677
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: Interface
    where:
    - - name
      - ==
      - int-dvr101
response:
  error: null
  id: 371677
  result:
  - rows:
    - _uuid:
      - uuid
      - 1a81a886-9e89-4aed-9171-bceb954cc9fb
      _version:
      - uuid
      - a6f6587f-b770-471e-8c98-129fada4fc07
      admin_state: up
      bfd:
      - map
      - []
      bfd_status:
      - map
      - []
      cfm_fault:
      - set
      - []
      cfm_fault_status:
      - set
      - []
      cfm_flap_count:
      - set
      - []
      cfm_health:
      - set
      - []
      cfm_mpid:
      - set
      - []
      cfm_remote_mpids:
      - set
      - []
      cfm_remote_opstate:
      - set
      - []
      duplex:
      - set
      - []
      external_ids:
      - map
      - []
      ifindex: 44
      ingress_policing_burst: 0
      ingress_policing_rate: 0
      lacp_current:
      - set
      - []
      link_resets: 2
      link_speed:
      - set
      - []
      link_state: up
      mac:
      - set
      - []
      mac_in_use: ea:09:be:d0:e9:63
      mtu: 1500
      name: int-dvr101
      ofport: 7
      ofport_request:
      - set
      - []
      options:
      - map
      - []
      other_config:
      - map
      - []
      statistics:
      - map
      - - - collisions
          - 0
        - - rx_bytes
          - 0
        - - rx_crc_err
          - 0
        - - rx_dropped
          - 0
        - - rx_errors
          - 0
        - - rx_frame_err
          - 0
        - - rx_over_err
          - 0
        - - rx_packets
          - 0
        - - tx_bytes
          - 0
        - - tx_dropped
          - 0
        - - tx_errors
          - 0
        - - tx_packets
          - 0
      status:
      - map
      - - - driver_name
          - openvswitch
      type: internal
[DEBUG] 2014-05-14 07:36:09,045 module:ovsdb,function:_send,router:openwrt2
request:
  id: 262770
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: Interface
    where:
    - - name
      - ==
      - int-br101
response:
  error: null
  id: 262770
  result:
  - rows:
    - _uuid:
      - uuid
      - 4562777d-dfaf-422a-a33d-edbc10452b98
      _version:
      - uuid
      - 92095e59-b316-47b9-8b5d-54558f2483ff
      admin_state: up
      bfd:
      - map
      - []
      bfd_status:
      - map
      - []
      cfm_fault:
      - set
      - []
      cfm_fault_status:
      - set
      - []
      cfm_flap_count:
      - set
      - []
      cfm_health:
      - set
      - []
      cfm_mpid:
      - set
      - []
      cfm_remote_mpids:
      - set
      - []
      cfm_remote_opstate:
      - set
      - []
      duplex:
      - set
      - []
      external_ids:
      - map
      - []
      ifindex: 43
      ingress_policing_burst: 0
      ingress_policing_rate: 0
      lacp_current:
      - set
      - []
      link_resets: 2
      link_speed:
      - set
      - []
      link_state: up
      mac:
      - set
      - []
      mac_in_use: ca:2e:0c:e5:2f:a8
      mtu: 1500
      name: int-br101
      ofport: 6
      ofport_request:
      - set
      - []
      options:
      - map
      - []
      other_config:
      - map
      - []
      statistics:
      - map
      - - - collisions
          - 0
        - - rx_bytes
          - 0
        - - rx_crc_err
          - 0
        - - rx_dropped
          - 0
        - - rx_errors
          - 0
        - - rx_frame_err
          - 0
        - - rx_over_err
          - 0
        - - rx_packets
          - 0
        - - tx_bytes
          - 0
        - - tx_dropped
          - 0
        - - tx_errors
          - 0
        - - tx_packets
          - 0
      status:
      - map
      - - - driver_name
          - openvswitch
      type: internal
[DEBUG] 2014-05-14 07:36:09,056 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=0,priority=2,in_port=6,dl_type=0x0800,nw_dst=10.0.1.0/24,actions=normal
[DEBUG] 2014-05-14 07:36:09,064 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=10.0.0.0/8,actions=resubmit(,1)
[DEBUG] 2014-05-14 07:36:09,070 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=172.16.0.0/12,actions=resubmit(,1)
[DEBUG] 2014-05-14 07:36:09,078 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=192.168.0.0/16,actions=resubmit(,1)
[DEBUG] 2014-05-14 07:36:09,087 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=7,dl_type=0x0806,nw_src=10.0.1.1,nw_proto=2,actions=drop
[DEBUG] 2014-05-14 07:36:09,096 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=1,priority=0,in_port=6,actions=set_field:ea:09:be:d0:e9:63->dl_dst,output:7
[DEBUG] 2014-05-14 07:36:09,108 module:ovsdb,function:_send,router:openwrt2
request:
  id: 203344
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 203344
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-14 07:36:09,118 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=1,actions=strip_vlan,set_tunnel:101,output:2,output:4
[DEBUG] 2014-05-14 07:36:09,133 module:ovsdb,function:crud,router:openwrt2
CRUD operation (add): {'peers': ['192.168.1.103', '192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.102/24', 'vni': 101, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'spoke_dvr')])}
[DEBUG] 2014-05-14 07:36:09,137 module:ovsdb,function:_send,router:openwrt2
request:
  id: 837798
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ip_dvr:
      - map
      - - - addr
          - 10.0.1.1/24
        - - mode
          - spoke_dvr
      ip_vhost: 10.0.1.102/24
      peers:
      - set
      - - 192.168.1.103
        - 192.168.1.104
      vid: 1
      vni: 101
    table: NLAN_Subnet
    uuid-name: temp_39955
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_39955
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 837798
  result:
  - uuid:
    - uuid
    - f8c00495-876e-482f-93b0-a6829b08423f
  - count: 1
[DEBUG] 2014-05-14 07:36:09,146 module:ovsdb,function:_send,router:openwrt2
request:
  id: 739990
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 101
response:
  error: null
  id: 739990
  result:
  - rows:
    - _uuid:
      - uuid
      - f8c00495-876e-482f-93b0-a6829b08423f
      _version:
      - uuid
      - 1ae3e1c9-c6fe-4488-b902-19e2e9fa0802
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - - - addr
          - 10.0.1.1/24
        - - mode
          - spoke_dvr
      ip_vhost: 10.0.1.102/24
      peers:
      - set
      - - 192.168.1.103
        - 192.168.1.104
      ports:
      - set
      - []
      vid: 1
      vni: 101
[INFO] 2014-05-14 07:36:09,161 module:nlan_agent,function:<module>,router:openwrt2
NLAN Agent execution completed
--- RESPONSE from router:openwrt2,platform:openwrt
message: Execution completed
exit: 0
--- STDOUT from router:openwrt1,platform:openwrt
[INFO] 2014-05-14 07:36:07,019 module:nlan_agent,function:<module>,router:openwrt1
NLAN Agent initialization completed
[DEBUG] 2014-05-14 07:36:07,021 module:nlan_agent,function:<module>,router:openwrt1
__n__: {'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'platform': 'openwrt', 'share_dir': '/opt/nlan/share', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'logger': <logging.Logger object at 0xb75c31cc>, 'router': 'openwrt1', 'schema': 'ovsdb_nlan.schema', 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'enum': ['set', ['enabled']], 'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'ip_dvr': {'max': 2, 'value': {'type': 'string'}, 'key': {'enum': ['set', ['addr', 'mode']], 'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}}, 'indexes': {'services': 'name', 'subnets': 'vni'}}
[INFO] 2014-05-14 07:36:07,164 module:nlan_agent,function:_route,router:openwrt1
function:bridges.add, model:{'ovs_bridges': 'enabled'}
[DEBUG] 2014-05-14 07:36:07,181 module:ovsdb,function:_send,router:openwrt1
request:
  id: 669538
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 669538
  result:
  - rows: []
[DEBUG] 2014-05-14 07:36:07,186 module:ovsdb,function:_send,router:openwrt1
request:
  id: 907439
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row: {}
    table: NLAN
response:
  error: null
  id: 907439
  result:
  - uuid:
    - uuid
    - 1e7d36cf-bab6-4ec7-b6bb-61911e48845d
[DEBUG] 2014-05-14 07:36:07,195 module:ovsdb,function:_send,router:openwrt1
request:
  id: 291780
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Bridges
    where: []
response:
  error: null
  id: 291780
  result:
  - rows: []
[INFO] 2014-05-14 07:36:07,198 module:bridges,function:add,router:openwrt1
Adding bridges: br-int and br-tun
[DEBUG] 2014-05-14 07:36:07,249 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-br br-int
[DEBUG] 2014-05-14 07:36:07,302 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-br br-tun
[DEBUG] 2014-05-14 07:36:07,391 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl del-flows br-tun
[DEBUG] 2014-05-14 07:36:07,431 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int patch-int -- set interface patch-int type=patch options:peer=patch-tun
[DEBUG] 2014-05-14 07:36:07,464 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-tun patch-tun -- set interface patch-tun type=patch options:peer=patch-int
[DEBUG] 2014-05-14 07:36:07,509 module:ovsdb,function:_send,router:openwrt1
request:
  id: 195078
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: Interface
    where:
    - - name
      - ==
      - patch-tun
response:
  error: null
  id: 195078
  result:
  - rows:
    - _uuid:
      - uuid
      - 9472d8d7-50b9-4daf-8db8-a101efba61bc
      _version:
      - uuid
      - c9c71e5e-46a8-4315-8a1f-3a82ea39b821
      admin_state:
      - set
      - []
      bfd:
      - map
      - []
      bfd_status:
      - map
      - []
      cfm_fault:
      - set
      - []
      cfm_fault_status:
      - set
      - []
      cfm_flap_count:
      - set
      - []
      cfm_health:
      - set
      - []
      cfm_mpid:
      - set
      - []
      cfm_remote_mpids:
      - set
      - []
      cfm_remote_opstate:
      - set
      - []
      duplex:
      - set
      - []
      external_ids:
      - map
      - []
      ifindex: 0
      ingress_policing_burst: 0
      ingress_policing_rate: 0
      lacp_current:
      - set
      - []
      link_resets:
      - set
      - []
      link_speed:
      - set
      - []
      link_state:
      - set
      - []
      mac:
      - set
      - []
      mac_in_use: ca:e9:27:20:86:4f
      mtu:
      - set
      - []
      name: patch-tun
      ofport: 1
      ofport_request:
      - set
      - []
      options:
      - map
      - - - peer
          - patch-int
      other_config:
      - map
      - []
      statistics:
      - map
      - - - collisions
          - 0
        - - rx_bytes
          - 0
        - - rx_crc_err
          - 0
        - - rx_dropped
          - 0
        - - rx_errors
          - 0
        - - rx_frame_err
          - 0
        - - rx_over_err
          - 0
        - - rx_packets
          - 0
        - - tx_bytes
          - 0
        - - tx_dropped
          - 0
        - - tx_errors
          - 0
        - - tx_packets
          - 0
      status:
      - map
      - []
      type: patch
[DEBUG] 2014-05-14 07:36:07,549 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=1,actions=resubmit(,1)
[DEBUG] 2014-05-14 07:36:07,569 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=0,actions=drop
[DEBUG] 2014-05-14 07:36:07,600 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=01:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,19)
[DEBUG] 2014-05-14 07:36:07,627 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=00:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,20)
[DEBUG] 2014-05-14 07:36:07,642 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=2,priority=0,actions=drop
[DEBUG] 2014-05-14 07:36:07,686 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=3,priority=0,actions=drop
[DEBUG] 2014-05-14 07:36:07,704 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=10,priority=1,actions=learn(table=20,hard_timeout=300,priority=1,NXM_OF_VLAN_TCI[0..11],NXM_OF_ETH_DST[]=NXM_OF_ETH_SRC[],load:0->NXM_OF_VLAN_TCI[],load:NXM_NX_TUN_ID[]->NXM_NX_TUN_ID[],output:NXM_OF_IN_PORT[]),output:1
[DEBUG] 2014-05-14 07:36:07,721 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=19,priority=0,actions=resubmit(,21)
[DEBUG] 2014-05-14 07:36:07,747 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=20,priority=0,actions=resubmit(,21)
[DEBUG] 2014-05-14 07:36:07,765 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=21,priority=0,actions=drop
[DEBUG] 2014-05-14 07:36:07,791 module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'ovs_bridges': 'enabled'}
[DEBUG] 2014-05-14 07:36:07,795 module:ovsdb,function:_send,router:openwrt1
request:
  id: 769742
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ovs_bridges: enabled
    table: NLAN_Bridges
    uuid-name: temp_3965
  - mutations:
    - - bridges
      - insert
      - - set
        - - - named-uuid
            - temp_3965
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 769742
  result:
  - uuid:
    - uuid
    - 3c0dfdfb-cc76-403b-9dfb-c84c739d4b35
  - count: 1
[DEBUG] 2014-05-14 07:36:07,806 module:ovsdb,function:_send,router:openwrt1
request:
  id: 519491
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Bridges
    where: []
response:
  error: null
  id: 519491
  result:
  - rows:
    - _uuid:
      - uuid
      - 3c0dfdfb-cc76-403b-9dfb-c84c739d4b35
      _version:
      - uuid
      - ebd2bb83-e614-41af-8bb2-3c15e11851a3
      controller:
      - set
      - []
      ovs_bridges: enabled
[INFO] 2014-05-14 07:36:07,827 module:nlan_agent,function:_route,router:openwrt1
function:gateway.add, model:{'network': 'eth2', 'rip': 'enabled'}
[DEBUG] 2014-05-14 07:36:07,840 module:ovsdb,function:_send,router:openwrt1
request:
  id: 759233
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 759233
  result:
  - rows:
    - _uuid:
      - uuid
      - 1e7d36cf-bab6-4ec7-b6bb-61911e48845d
      _version:
      - uuid
      - d80e1b5d-1283-444b-816a-c6b6dc467c63
      bridges:
      - uuid
      - 3c0dfdfb-cc76-403b-9dfb-c84c739d4b35
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - set
      - []
      vxlan:
      - set
      - []
[DEBUG] 2014-05-14 07:36:07,855 module:ovsdb,function:_send,router:openwrt1
request:
  id: 371192
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Gateway
    where: []
response:
  error: null
  id: 371192
  result:
  - rows: []
[INFO] 2014-05-14 07:36:07,880 module:gateway,function:add,router:openwrt1
Adding a gateway router: rip
[DEBUG] 2014-05-14 07:36:07,887 module:cmdutil,function:_cmd2,router:openwrt1
cmd: vtysh -c configure terminal -c interface eth2 -c link-detect -c exit -c router rip -c version 2 -c redistribute connected -c network eth2 -c exit -c exit -c write -c exit
[DEBUG] 2014-05-14 07:36:07,983 module:cmdutil,function:_cmd2,router:openwrt1
cmd: /etc/init.d/quagga start
[DEBUG] 2014-05-14 07:36:08,067 module:cmdutil,function:_cmd2,router:openwrt1
cmd: vtysh -c configure terminal -c interface eth2 -c link-detect -c exit -c router rip -c version 2 -c redistribute connected -c network eth2 -c exit -c exit -c write -c exit
[DEBUG] 2014-05-14 07:36:08,193 module:cmdutil,function:_cmd2,router:openwrt1
cmd: /etc/init.d/quagga restart
[DEBUG] 2014-05-14 07:36:10,323 module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'network': 'eth2', 'rip': 'enabled'}
[DEBUG] 2014-05-14 07:36:10,327 module:ovsdb,function:_send,router:openwrt1
request:
  id: 995409
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      network: eth2
      rip: enabled
    table: NLAN_Gateway
    uuid-name: temp_885944
  - mutations:
    - - gateway
      - insert
      - - set
        - - - named-uuid
            - temp_885944
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 995409
  result:
  - uuid:
    - uuid
    - 63bcd534-de77-4ee2-879a-80e6a869b4b2
  - count: 1
[DEBUG] 2014-05-14 07:36:10,332 module:ovsdb,function:_send,router:openwrt1
request:
  id: 595351
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Gateway
    where: []
response:
  error: null
  id: 595351
  result:
  - rows:
    - _uuid:
      - uuid
      - 63bcd534-de77-4ee2-879a-80e6a869b4b2
      _version:
      - uuid
      - 6d96cf1a-1dfa-4295-89ab-b3a216c47923
      network: eth2
      rip: enabled
[INFO] 2014-05-14 07:36:10,337 module:nlan_agent,function:_route,router:openwrt1
function:vxlan.add, model:{'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.104'], 'local_ip': '192.168.1.101'}
[DEBUG] 2014-05-14 07:36:10,341 module:ovsdb,function:_send,router:openwrt1
request:
  id: 329317
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 329317
  result:
  - rows:
    - _uuid:
      - uuid
      - 1e7d36cf-bab6-4ec7-b6bb-61911e48845d
      _version:
      - uuid
      - 535054ed-174e-4a13-bd1f-ba1a70363e98
      bridges:
      - uuid
      - 3c0dfdfb-cc76-403b-9dfb-c84c739d4b35
      gateway:
      - uuid
      - 63bcd534-de77-4ee2-879a-80e6a869b4b2
      services:
      - set
      - []
      subnets:
      - set
      - []
      vxlan:
      - set
      - []
[DEBUG] 2014-05-14 07:36:10,346 module:ovsdb,function:_send,router:openwrt1
request:
  id: 94671
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_VXLAN
    where: []
response:
  error: null
  id: 94671
  result:
  - rows: []
[INFO] 2014-05-14 07:36:10,350 module:vxlan,function:add,router:openwrt1
Adding a VXLAN tunnel: vxlan_103
[DEBUG] 2014-05-14 07:36:10,350 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-tun vxlan_103 -- set interface vxlan_103 type=vxlan options:in_key=flow options:local_ip=192.168.1.101 options:out_key=flow options:remote_ip=192.168.1.103
[INFO] 2014-05-14 07:36:10,367 module:vxlan,function:add,router:openwrt1
Adding a VXLAN tunnel: vxlan_102
[DEBUG] 2014-05-14 07:36:10,369 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-tun vxlan_102 -- set interface vxlan_102 type=vxlan options:in_key=flow options:local_ip=192.168.1.101 options:out_key=flow options:remote_ip=192.168.1.102
[INFO] 2014-05-14 07:36:10,390 module:vxlan,function:add,router:openwrt1
Adding a VXLAN tunnel: vxlan_104
[DEBUG] 2014-05-14 07:36:10,391 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-tun vxlan_104 -- set interface vxlan_104 type=vxlan options:in_key=flow options:local_ip=192.168.1.101 options:out_key=flow options:remote_ip=192.168.1.104
[DEBUG] 2014-05-14 07:36:10,407 module:ovsdb,function:_send,router:openwrt1
request:
  id: 507441
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 507441
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-14 07:36:10,410 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=3,actions=resubmit(,2)
[DEBUG] 2014-05-14 07:36:10,417 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=2,actions=resubmit(,2)
[DEBUG] 2014-05-14 07:36:10,422 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=4,actions=resubmit(,2)
[DEBUG] 2014-05-14 07:36:10,428 module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.104'], 'local_ip': '192.168.1.101'}
[DEBUG] 2014-05-14 07:36:10,430 module:ovsdb,function:_send,router:openwrt1
request:
  id: 602277
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      local_ip: 192.168.1.101
      remote_ips:
      - set
      - - 192.168.1.103
        - 192.168.1.102
        - 192.168.1.104
    table: NLAN_VXLAN
    uuid-name: temp_404708
  - mutations:
    - - vxlan
      - insert
      - - set
        - - - named-uuid
            - temp_404708
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 602277
  result:
  - uuid:
    - uuid
    - bce4fbd4-b57d-4e1e-b3af-53f358133c9b
  - count: 1
[DEBUG] 2014-05-14 07:36:10,432 module:ovsdb,function:_send,router:openwrt1
request:
  id: 643931
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_VXLAN
    where: []
response:
  error: null
  id: 643931
  result:
  - rows:
    - _uuid:
      - uuid
      - bce4fbd4-b57d-4e1e-b3af-53f358133c9b
      _version:
      - uuid
      - 24674f21-9ba0-4c54-94ab-fb48f6de0c90
      local_ip: 192.168.1.101
      remote_ips:
      - set
      - - 192.168.1.102
        - 192.168.1.103
        - 192.168.1.104
[INFO] 2014-05-14 07:36:10,442 module:nlan_agent,function:_route,router:openwrt1
function:subnets.add, index:['vni', 1], model:{'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 2, 'ip_vhost': '192.168.100.101/24', 'vni': 1, 'ip_dvr': OrderedDict([('addr', '192.168.100.1/24'), ('mode', 'dvr')])}
[DEBUG] 2014-05-14 07:36:10,443 module:ovsdb,function:_send,router:openwrt1
request:
  id: 405901
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 405901
  result:
  - rows:
    - _uuid:
      - uuid
      - 1e7d36cf-bab6-4ec7-b6bb-61911e48845d
      _version:
      - uuid
      - c691a342-937c-4298-9fab-9cd6bc1fa440
      bridges:
      - uuid
      - 3c0dfdfb-cc76-403b-9dfb-c84c739d4b35
      gateway:
      - uuid
      - 63bcd534-de77-4ee2-879a-80e6a869b4b2
      services:
      - set
      - []
      subnets:
      - set
      - []
      vxlan:
      - uuid
      - bce4fbd4-b57d-4e1e-b3af-53f358133c9b
[DEBUG] 2014-05-14 07:36:10,447 module:ovsdb,function:_send,router:openwrt1
request:
  id: 140666
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1
response:
  error: null
  id: 140666
  result:
  - rows: []
[INFO] 2014-05-14 07:36:10,450 module:subnets,function:add,router:openwrt1
Adding a subnet(vlan): 2
[DEBUG] 2014-05-14 07:36:10,450 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addbr br1
[DEBUG] 2014-05-14 07:36:10,460 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int-br1 tag=2 -- set interface int-br1 type=internal
[DEBUG] 2014-05-14 07:36:10,487 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int-dvr1 tag=2 -- set interface int-dvr1 type=internal
[DEBUG] 2014-05-14 07:36:10,515 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br1 int-br1
[DEBUG] 2014-05-14 07:36:10,521 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-br1 promisc on
[DEBUG] 2014-05-14 07:36:10,526 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-br1 up
[DEBUG] 2014-05-14 07:36:10,532 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-dvr1 up
[DEBUG] 2014-05-14 07:36:10,535 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br1 up
[DEBUG] 2014-05-14 07:36:10,543 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns add ns1
[DEBUG] 2014-05-14 07:36:10,550 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link add veth-ns1 type veth peer name temp-ns1
[DEBUG] 2014-05-14 07:36:10,559 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev temp-ns1 netns ns1
[DEBUG] 2014-05-14 07:36:10,566 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1 ip link set dev temp-ns1 name eth0
[DEBUG] 2014-05-14 07:36:10,573 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br1 veth-ns1
[DEBUG] 2014-05-14 07:36:10,581 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1 promisc on
[DEBUG] 2014-05-14 07:36:10,590 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1 up
[DEBUG] 2014-05-14 07:36:10,603 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1 ip link set dev eth0 up
[DEBUG] 2014-05-14 07:36:10,612 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1 ip addr add dev eth0 192.168.100.101/24
[DEBUG] 2014-05-14 07:36:10,616 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1 ip route add default via 192.168.100.1 dev eth0
[DEBUG] 2014-05-14 07:36:10,620 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip addr add dev int-dvr1 192.168.100.1/24
[DEBUG] 2014-05-14 07:36:10,625 module:ovsdb,function:_send,router:openwrt1
request:
  id: 748175
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 748175
  result:
  - rows: []
[DEBUG] 2014-05-14 07:36:10,626 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=1,actions=mod_vlan_vid:2,resubmit(,10)
[DEBUG] 2014-05-14 07:36:10,634 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=2,nw_dst=192.168.100.1,actions=drop
[DEBUG] 2014-05-14 07:36:10,641 module:ovsdb,function:_send,router:openwrt1
request:
  id: 358690
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 358690
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-14 07:36:10,645 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=2,actions=strip_vlan,set_tunnel:1,output:3,output:2
[DEBUG] 2014-05-14 07:36:10,652 module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 2, 'ip_vhost': '192.168.100.101/24', 'vni': 1, 'ip_dvr': OrderedDict([('addr', '192.168.100.1/24'), ('mode', 'dvr')])}
[DEBUG] 2014-05-14 07:36:10,654 module:ovsdb,function:_send,router:openwrt1
request:
  id: 300434
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ip_dvr:
      - map
      - - - addr
          - 192.168.100.1/24
        - - mode
          - dvr
      ip_vhost: 192.168.100.101/24
      peers:
      - set
      - - 192.168.1.102
        - 192.168.1.103
      vid: 2
      vni: 1
    table: NLAN_Subnet
    uuid-name: temp_738371
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_738371
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 300434
  result:
  - uuid:
    - uuid
    - e1b67127-4330-472b-8ce4-a019af560e86
  - count: 1
[DEBUG] 2014-05-14 07:36:10,656 module:ovsdb,function:_send,router:openwrt1
request:
  id: 904773
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1
response:
  error: null
  id: 904773
  result:
  - rows:
    - _uuid:
      - uuid
      - e1b67127-4330-472b-8ce4-a019af560e86
      _version:
      - uuid
      - 8d8733b9-294e-49d6-b349-a9559e64cecd
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - - - addr
          - 192.168.100.1/24
        - - mode
          - dvr
      ip_vhost: 192.168.100.101/24
      peers:
      - set
      - - 192.168.1.102
        - 192.168.1.103
      ports:
      - set
      - []
      vid: 2
      vni: 1
[INFO] 2014-05-14 07:36:10,659 module:nlan_agent,function:_route,router:openwrt1
function:subnets.add, index:['vni', 103], model:{'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 3, 'ip_vhost': '10.0.3.101/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr')])}
[DEBUG] 2014-05-14 07:36:10,661 module:ovsdb,function:_send,router:openwrt1
request:
  id: 653407
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 653407
  result:
  - rows:
    - _uuid:
      - uuid
      - 1e7d36cf-bab6-4ec7-b6bb-61911e48845d
      _version:
      - uuid
      - 58bf9723-37e3-4fb3-b6bb-f4e59f4e670b
      bridges:
      - uuid
      - 3c0dfdfb-cc76-403b-9dfb-c84c739d4b35
      gateway:
      - uuid
      - 63bcd534-de77-4ee2-879a-80e6a869b4b2
      services:
      - set
      - []
      subnets:
      - uuid
      - e1b67127-4330-472b-8ce4-a019af560e86
      vxlan:
      - uuid
      - bce4fbd4-b57d-4e1e-b3af-53f358133c9b
[DEBUG] 2014-05-14 07:36:10,665 module:ovsdb,function:_send,router:openwrt1
request:
  id: 989133
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 103
response:
  error: null
  id: 989133
  result:
  - rows: []
[INFO] 2014-05-14 07:36:10,667 module:subnets,function:add,router:openwrt1
Adding a subnet(vlan): 3
[DEBUG] 2014-05-14 07:36:10,667 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addbr br103
[DEBUG] 2014-05-14 07:36:10,674 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int-br103 tag=3 -- set interface int-br103 type=internal
[DEBUG] 2014-05-14 07:36:10,701 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int-dvr103 tag=3 -- set interface int-dvr103 type=internal
[DEBUG] 2014-05-14 07:36:10,734 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br103 int-br103
[DEBUG] 2014-05-14 07:36:10,744 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-br103 promisc on
[DEBUG] 2014-05-14 07:36:10,751 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-br103 up
[DEBUG] 2014-05-14 07:36:10,753 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-dvr103 up
[DEBUG] 2014-05-14 07:36:10,756 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br103 up
[DEBUG] 2014-05-14 07:36:10,764 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns add ns103
[DEBUG] 2014-05-14 07:36:10,769 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link add veth-ns103 type veth peer name temp-ns103
[DEBUG] 2014-05-14 07:36:10,780 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev temp-ns103 netns ns103
[DEBUG] 2014-05-14 07:36:10,789 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns103 ip link set dev temp-ns103 name eth0
[DEBUG] 2014-05-14 07:36:10,796 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br103 veth-ns103
[DEBUG] 2014-05-14 07:36:10,808 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns103 promisc on
[DEBUG] 2014-05-14 07:36:10,816 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns103 up
[DEBUG] 2014-05-14 07:36:10,829 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns103 ip link set dev eth0 up
[DEBUG] 2014-05-14 07:36:10,841 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns103 ip addr add dev eth0 10.0.3.101/24
[DEBUG] 2014-05-14 07:36:10,850 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns103 ip route add default via 10.0.3.1 dev eth0
[DEBUG] 2014-05-14 07:36:10,855 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip addr add dev int-dvr103 10.0.3.1/24
[DEBUG] 2014-05-14 07:36:10,860 module:ovsdb,function:_send,router:openwrt1
request:
  id: 909186
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 909186
  result:
  - rows: []
[DEBUG] 2014-05-14 07:36:10,861 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=103,actions=mod_vlan_vid:3,resubmit(,10)
[DEBUG] 2014-05-14 07:36:10,867 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=3,nw_dst=10.0.3.1,actions=drop
[DEBUG] 2014-05-14 07:36:10,875 module:ovsdb,function:_send,router:openwrt1
request:
  id: 26327
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 26327
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-14 07:36:10,879 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=3,actions=strip_vlan,set_tunnel:103,output:3,output:2
[DEBUG] 2014-05-14 07:36:10,885 module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 3, 'ip_vhost': '10.0.3.101/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr')])}
[DEBUG] 2014-05-14 07:36:10,887 module:ovsdb,function:_send,router:openwrt1
request:
  id: 73106
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ip_dvr:
      - map
      - - - addr
          - 10.0.3.1/24
        - - mode
          - dvr
      ip_vhost: 10.0.3.101/24
      peers:
      - set
      - - 192.168.1.102
        - 192.168.1.103
      vid: 3
      vni: 103
    table: NLAN_Subnet
    uuid-name: temp_752489
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_752489
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 73106
  result:
  - uuid:
    - uuid
    - 4a65a52f-8679-4143-9564-66e9a64ea6a3
  - count: 1
[DEBUG] 2014-05-14 07:36:10,889 module:ovsdb,function:_send,router:openwrt1
request:
  id: 617919
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 103
response:
  error: null
  id: 617919
  result:
  - rows:
    - _uuid:
      - uuid
      - 4a65a52f-8679-4143-9564-66e9a64ea6a3
      _version:
      - uuid
      - 8d52e364-ac8c-4ad9-a00c-00e69b855395
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - - - addr
          - 10.0.3.1/24
        - - mode
          - dvr
      ip_vhost: 10.0.3.101/24
      peers:
      - set
      - - 192.168.1.102
        - 192.168.1.103
      ports:
      - set
      - []
      vid: 3
      vni: 103
[INFO] 2014-05-14 07:36:10,893 module:nlan_agent,function:_route,router:openwrt1
function:subnets.add, index:['vni', 1001], model:{'peers': ['192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.101/24', 'vni': 1001, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'hub')])}
[DEBUG] 2014-05-14 07:36:10,894 module:ovsdb,function:_send,router:openwrt1
request:
  id: 18454
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 18454
  result:
  - rows:
    - _uuid:
      - uuid
      - 1e7d36cf-bab6-4ec7-b6bb-61911e48845d
      _version:
      - uuid
      - 7f18ffbf-dab7-44c1-bf15-fe58b2f07132
      bridges:
      - uuid
      - 3c0dfdfb-cc76-403b-9dfb-c84c739d4b35
      gateway:
      - uuid
      - 63bcd534-de77-4ee2-879a-80e6a869b4b2
      services:
      - set
      - []
      subnets:
      - set
      - - - uuid
          - 4a65a52f-8679-4143-9564-66e9a64ea6a3
        - - uuid
          - e1b67127-4330-472b-8ce4-a019af560e86
      vxlan:
      - uuid
      - bce4fbd4-b57d-4e1e-b3af-53f358133c9b
[DEBUG] 2014-05-14 07:36:10,899 module:ovsdb,function:_send,router:openwrt1
request:
  id: 64520
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1001
response:
  error: null
  id: 64520
  result:
  - rows: []
[INFO] 2014-05-14 07:36:10,902 module:subnets,function:add,router:openwrt1
Adding a subnet(vlan): 1
[DEBUG] 2014-05-14 07:36:10,902 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addbr br1001
[DEBUG] 2014-05-14 07:36:10,909 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int-br1001 tag=1 -- set interface int-br1001 type=internal
[DEBUG] 2014-05-14 07:36:10,932 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int-dvr1001 tag=1 -- set interface int-dvr1001 type=internal
[DEBUG] 2014-05-14 07:36:10,959 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br1001 int-br1001
[DEBUG] 2014-05-14 07:36:10,968 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-br1001 promisc on
[DEBUG] 2014-05-14 07:36:10,976 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-br1001 up
[DEBUG] 2014-05-14 07:36:10,984 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-dvr1001 up
[DEBUG] 2014-05-14 07:36:10,990 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br1001 up
[DEBUG] 2014-05-14 07:36:11,001 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns add ns1001
[DEBUG] 2014-05-14 07:36:11,009 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link add veth-ns1001 type veth peer name temp-ns1001
[DEBUG] 2014-05-14 07:36:11,018 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev temp-ns1001 netns ns1001
[DEBUG] 2014-05-14 07:36:11,024 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1001 ip link set dev temp-ns1001 name eth0
[DEBUG] 2014-05-14 07:36:11,031 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br1001 veth-ns1001
[DEBUG] 2014-05-14 07:36:11,038 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1001 promisc on
[DEBUG] 2014-05-14 07:36:11,041 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1001 up
[DEBUG] 2014-05-14 07:36:11,054 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1001 ip link set dev eth0 up
[DEBUG] 2014-05-14 07:36:11,063 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1001 ip addr add dev eth0 10.0.1.101/24
[DEBUG] 2014-05-14 07:36:11,068 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1001 ip route add default via 10.0.1.1 dev eth0
[DEBUG] 2014-05-14 07:36:11,071 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip addr add dev int-dvr1001 10.0.1.1/24
[DEBUG] 2014-05-14 07:36:11,078 module:ovsdb,function:_send,router:openwrt1
request:
  id: 578613
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 578613
  result:
  - rows: []
[DEBUG] 2014-05-14 07:36:11,079 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=1001,actions=mod_vlan_vid:1,resubmit(,10)
[DEBUG] 2014-05-14 07:36:11,087 module:ovsdb,function:_send,router:openwrt1
request:
  id: 532991
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 532991
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-14 07:36:11,092 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=1,actions=strip_vlan,set_tunnel:1001,output:4
[DEBUG] 2014-05-14 07:36:11,099 module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'peers': ['192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.101/24', 'vni': 1001, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'hub')])}
[DEBUG] 2014-05-14 07:36:11,101 module:ovsdb,function:_send,router:openwrt1
request:
  id: 447179
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ip_dvr:
      - map
      - - - addr
          - 10.0.1.1/24
        - - mode
          - hub
      ip_vhost: 10.0.1.101/24
      peers:
      - set
      - - 192.168.1.104
      vid: 1
      vni: 1001
    table: NLAN_Subnet
    uuid-name: temp_810259
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_810259
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 447179
  result:
  - uuid:
    - uuid
    - 5b27f278-f707-425f-83cd-b8f4e78aac47
  - count: 1
[DEBUG] 2014-05-14 07:36:11,103 module:ovsdb,function:_send,router:openwrt1
request:
  id: 517740
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1001
response:
  error: null
  id: 517740
  result:
  - rows:
    - _uuid:
      - uuid
      - 5b27f278-f707-425f-83cd-b8f4e78aac47
      _version:
      - uuid
      - 8333c310-9d32-4531-a340-a61d047c72ed
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - - - addr
          - 10.0.1.1/24
        - - mode
          - hub
      ip_vhost: 10.0.1.101/24
      peers: 192.168.1.104
      ports:
      - set
      - []
      vid: 1
      vni: 1001
[INFO] 2014-05-14 07:36:11,107 module:nlan_agent,function:<module>,router:openwrt1
NLAN Agent execution completed
--- RESPONSE from router:openwrt1,platform:openwrt
message: Execution completed
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-05-14 00:36:07.200989

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         3.57(sec)
rpi1              :-)         3.84(sec)
openwrt2          :-)         4.22(sec)
openwrt1          :-)         5.59(sec)
--- STDOUT from router:openwrt2,platform:openwrt
Hello World!
--- STDOUT from router:openwrt3,platform:openwrt
Hello World!
--- STDOUT from router:openwrt1,platform:openwrt
Hello World!
--- STDOUT from router:rpi1,platform:debian
Hello World!
--- STDOUT from router:openwrt1,platform:openwrt
PING 10.0.1.102 (10.0.1.102): 56 data bytes
64 bytes from 10.0.1.102: seq=0 ttl=64 time=10.264 ms

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 10.264/10.264/10.264 ms
--- STDOUT from router:openwrt1,platform:openwrt
PING 10.0.1.102 (10.0.1.102): 56 data bytes
64 bytes from 10.0.1.102: seq=0 ttl=64 time=3.467 ms

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 3.467/3.467/3.467 ms
--- STDOUT from router:openwrt1,platform:openwrt
PING 10.0.3.103 (10.0.3.103): 56 data bytes
64 bytes from 10.0.3.103: seq=0 ttl=64 time=6.896 ms

--- 10.0.3.103 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 6.896/6.896/6.896 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 10.0.1.101 (10.0.1.101): 56 data bytes
64 bytes from 10.0.1.101: seq=0 ttl=63 time=15.816 ms

--- 10.0.1.101 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 15.816/15.816/15.816 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=21.034 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 21.034/21.034/21.034 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=15.618 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 15.618/15.618/15.618 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=8.362 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 8.362/8.362/8.362 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=2.760 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 2.760/2.760/2.760 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 10.0.1.102 (10.0.1.102): 56 data bytes
64 bytes from 10.0.1.102: seq=0 ttl=63 time=6.551 ms

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 6.551/6.551/6.551 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 10.0.1.1 (10.0.1.1): 56 data bytes
64 bytes from 10.0.1.1: seq=0 ttl=64 time=3.935 ms

--- 10.0.1.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 3.935/3.935/3.935 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 10.0.1.1 (10.0.1.1): 56 data bytes
64 bytes from 10.0.1.1: seq=0 ttl=64 time=1.430 ms

--- 10.0.1.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 1.430/1.430/1.430 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=7.560 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 7.560/7.560/7.560 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=2.889 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 2.889/2.889/2.889 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=6.718 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 6.718/6.718/6.718 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=6.180 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 6.180/6.180/6.180 ms
--- STDOUT from router:openwrt2,platform:openwrt
Hello World!
--- STDOUT from router:openwrt3,platform:openwrt
Hello World!
--- STDOUT from router:openwrt1,platform:openwrt
Hello World!
--- STDOUT from router:rpi1,platform:debian
Hello World!
--- STDOUT from router:openwrt1,platform:openwrt
PING 10.0.1.102 (10.0.1.102): 56 data bytes
64 bytes from 10.0.1.102: seq=0 ttl=64 time=16.795 ms

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 16.795/16.795/16.795 ms
--- STDOUT from router:openwrt1,platform:openwrt
PING 10.0.1.102 (10.0.1.102): 56 data bytes
64 bytes from 10.0.1.102: seq=0 ttl=64 time=2.613 ms

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 2.613/2.613/2.613 ms
--- STDOUT from router:openwrt1,platform:openwrt
PING 10.0.3.103 (10.0.3.103): 56 data bytes
64 bytes from 10.0.3.103: seq=0 ttl=64 time=9.022 ms

--- 10.0.3.103 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 9.022/9.022/9.022 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 10.0.1.101 (10.0.1.101): 56 data bytes
64 bytes from 10.0.1.101: seq=0 ttl=63 time=13.700 ms

--- 10.0.1.101 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 13.700/13.700/13.700 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=13.101 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 13.101/13.101/13.101 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=14.059 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 14.059/14.059/14.059 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=7.641 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 7.641/7.641/7.641 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=2.064 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 2.064/2.064/2.064 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 10.0.1.102 (10.0.1.102): 56 data bytes
64 bytes from 10.0.1.102: seq=0 ttl=63 time=8.704 ms

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 8.704/8.704/8.704 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 10.0.1.1 (10.0.1.1): 56 data bytes
64 bytes from 10.0.1.1: seq=0 ttl=64 time=3.031 ms

--- 10.0.1.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 3.031/3.031/3.031 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 10.0.1.1 (10.0.1.1): 56 data bytes
64 bytes from 10.0.1.1: seq=0 ttl=64 time=1.421 ms

--- 10.0.1.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 1.421/1.421/1.421 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=5.265 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 5.265/5.265/5.265 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=3.986 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 3.986/3.986/3.986 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=7.664 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 7.664/7.664/7.664 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=6.342 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 6.342/6.342/6.342 ms
