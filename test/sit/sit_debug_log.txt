=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
rpi1             192.168.1.104  OK
openwrt1         192.168.1.101  OK
openwrt2         192.168.1.102  OK
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: init.run
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: init.run
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: init.run
=+=+= NLAN Request to router:rpi1,platform:debian =+=+=+=+=+=+=+=+=+=+=+=+=+=+
command: init.run
--- STDOUT from router:openwrt3,platform:openwrt
[INFO] 2014-05-27 09:31:57,088 module:nlan_agent,function:<module>,router:openwrt3
NLAN Agent initialization completed
[DEBUG] 2014-05-27 09:31:57,089 module:nlan_agent,function:<module>,router:openwrt3
__n__: {'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'platform': 'openwrt', 'share_dir': '/opt/nlan/share', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'logger': <logging.Logger object at 0xb75b124c>, 'router': 'openwrt3', 'schema': 'ovsdb_nlan.schema', 'types': {'services': {'name': {'max': 1, '_description': 'Name of the network function', 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', '_description': 'Logical network interfaces to which the Network Function is attached', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, '_description': 'IP address of an OpenFlow Controller', 'key': {'_pattern': 'ofc_address', 'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, '_description': 'Virtual bridges: br-int and br-tun', 'key': {'enum': 'enabled', 'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, '_description': 'Network interface to which routing info is advertised', 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, '_description': 'Quagga/Zebra RIP daemon', 'key': {'enum': 'enabled', 'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', '_description': 'IP addresses of the remote hosts', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, '_description': 'IP address of the local host', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}}, 'subnets': {'peers': {'max': 'unlimited', '_description': 'Broadcast/Multicast trees for this subnet: IP addresses of the peer hosts', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}, 'vid': {'max': 1, '_description': 'VLAN ID', 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, '_description': 'Virtual host in a linux network namespace', 'key': {'_pattern': 'ipv4_prefix', 'type': 'string'}, 'min': 0}, 'vni': {'max': 1, '_description': 'Virtual network identifier', 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'ip_dvr': {'max': 3, '_description': 'Distributed Virtual Router setting', 'value': {'_pattern': {'dhcp': 'string', 'addr': 'ipv4_prefix', 'mode': 'dvr_mode'}, 'type': 'string'}, 'key': {'enum': ['set', ['addr', 'mode', 'dhcp']], 'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, '_description': 'Default GW address for this subnet', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', '_description': 'Physical/logical ports attached to this subnet', 'key': {'type': 'string'}, 'min': 0}}}, 'indexes': {'services': 'name', 'subnets': 'vni'}}
[INFO] 2014-05-27 09:31:57,104 module:nlan_agent,function:_route,router:openwrt3
function:init.run, args:(), kwargs:{}
[DEBUG] 2014-05-27 09:31:57,105 module:cmdutil,function:_cmd2,router:openwrt3
cmd: lxc-ls
[DEBUG] 2014-05-27 09:31:57,119 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl --if-exists del-br br-tun
[DEBUG] 2014-05-27 09:31:57,134 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl --if-exists del-br br-int
[DEBUG] 2014-05-27 09:31:57,177 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl show
[DEBUG] 2014-05-27 09:31:57,182 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns101 down
[DEBUG] 2014-05-27 09:31:57,188 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delif br101 veth-ns101
[DE--- STDOUT from router:openwrt2,platform:openwrt
[INFO] 2014-05-27 09:31:57,126 module:nlan_agent,function:<module>,router:openwrt2
NLAN Agent initialization completed
[DEBUG] 2014-05-27 09:31:57,128 module:nlan_agent,function:<module>,router:openwrt2
__n__: {'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'platform': 'openwrt', 'share_dir': '/opt/nlan/share', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'logger': <logging.Logger object at 0xb756496c>, 'router': 'openwrt2', 'schema': 'ovsdb_nlan.schema', 'types': {'services': {'name': {'max': 1, '_description': 'Name of the network function', 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', '_description': 'Logical network interfaces to which the Network Function is attached', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, '_description': 'IP address of an OpenFlow Controller', 'key': {'_pattern': 'ofc_address', 'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, '_description': 'Virtual bridges: br-int and br-tun', 'key': {'enum': 'enabled', 'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, '_description': 'Network interface to which routing info is advertised', 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, '_description': 'Quagga/Zebra RIP daemon', 'key': {'enum': 'enabled', 'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', '_description': 'IP addresses of the remote hosts', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, '_description': 'IP address of the local host', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}}, 'subnets': {'peers': {'max': 'unlimited', '_description': 'Broadcast/Multicast trees for this subnet: IP addresses of the peer hosts', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}, 'vid': {'max': 1, '_description': 'VLAN ID', 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, '_description': 'Virtual host in a linux network namespace', 'key': {'_pattern': 'ipv4_prefix', 'type': 'string'}, 'min': 0}, 'vni': {'max': 1, '_description': 'Virtual network identifier', 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'ip_dvr': {'max': 3, '_description': 'Distributed Virtual Router setting', 'value': {'_pattern': {'dhcp': 'string', 'addr': 'ipv4_prefix', 'mode': 'dvr_mode'}, 'type': 'string'}, 'key': {'enum': ['set', ['addr', 'mode', 'dhcp']], 'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, '_description': 'Default GW address for this subnet', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', '_description': 'Physical/logical ports attached to this subnet', 'key': {'type': 'string'}, 'min': 0}}}, 'indexes': {'services': 'name', 'subnets': 'vni'}}
[INFO] 2014-05-27 09:31:57,154 module:nlan_agent,function:_route,router:openwrt2
function:init.run, args:(), kwargs:{}
[DEBUG] 2014-05-27 09:31:57,155 module:cmdutil,function:_cmd2,router:openwrt2
cmd: lxc-ls
[DEBUG] 2014-05-27 09:31:57,163 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl --if-exists del-br br-tun
[DEBUG] 2014-05-27 09:31:57,175 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl --if-exists del-br br-int
[DEBUG] 2014-05-27 09:31:57,225 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl show
[DEBUG] 2014-05-27 09:31:57,228 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns101 down
[DEBUG] 2014-05-27 09:31:57,233 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delif br101 veth-ns101
[DEBUG] 2014-05-27 09:31:57,195 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns101 up
[DEBUG] 2014-05-27 09:31:57,199 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br101 down
[DEBUG] 2014-05-27 09:31:57,202 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delbr br101
[DEBUG] 2014-05-27 09:31:57,206 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns103 down
[DEBUG] 2014-05-27 09:31:57,212 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delif br103 veth-ns103
[DEBUG] 2014-05-27 09:31:57,218 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns103 up
[DEBUG] 2014-05-27 09:31:57,223 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br103 down
[DEBUG] 2014-05-27 09:31:57,226 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delbr br103
[DEBUG] 2014-05-27 09:31:57,231 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns1 down
[DEBUG] 2014-05-27 09:31:57,235 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delif br1 veth-ns1
[DEBUG] 2014-05-27 09:31:57,240 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns1 up
[DEBUG] 2014-05-27 09:31:57,242 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br1 down
[DEBUG] 2014-05-27 09:31:57,245 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delbr br1
[DEBUG] 2014-05-27 09:31:57,249 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns list
[DEBUG] 2014-05-27 09:31:57,252 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns del ns103
[DEBUG] 2014-05-27 09:31:57,254 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns del ns1
[DEBUG] 2014-05-27 09:31:57,257 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns del ns101
[DEBUG] 2014-05-27 09:31:57,269 module:ovsdb,function:_send,router:openwrt3
request:
  id: 472152
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - vni
    - ip_dvr
    op: select
    table: NLAN_Subnet
    where: []
response:
  error: null
  id: 472152
  result:
  - rows:
    - ip_dvr:
      - map
      - - - addr
          - 10.0.1.1/24
        - - mode
          - spoke_dvr
      vni: 101
    - ip_dvr:
      - map
      - - - addr
          - 192.168.100.3/24
        - - mode
          - dvr
      vni: 1
    - ip_dvr:
      - map
      - - - addr
          - 10.0.3.1/24
        - - mode
          - dvr
      vni: 103
[DEBUG] 2014-05-27 09:31:57,272 module:ovsdb,function:_send,router:openwrt3
request:
  id: 639959
  method: transact
  params:
  - Open_vSwitch
  - op: delete
    table: NLAN
    where: []
response:
  error: null
  id: 639959
  result:
  - count: 1
[INFO] 2014-05-27 09:31:57,275 module:nlan_agent,function:<module>,router:openwrt3
NLAN Agent execution completed
--- RESPONSE from router:openwrt3,platform:openwrt
message: Execution completed
exit: 0
BUG] 2014-05-27 09:31:57,239 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns101 up
[DEBUG] 2014-05-27 09:31:57,244 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br101 down
[DEBUG] 2014-05-27 09:31:57,247 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delbr br101
[DEBUG] 2014-05-27 09:31:57,253 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns103 down
[DEBUG] 2014-05-27 09:31:57,260 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delif br103 veth-ns103
[DEBUG] 2014-05-27 09:31:57,265 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns103 up
[DEBUG] 2014-05-27 09:31:57,270 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br103 down
[DEBUG] 2014-05-27 09:31:57,273 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delbr br103
[DEBUG] 2014-05-27 09:31:57,277 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns1 down
[DEBUG] 2014-05-27 09:31:57,286 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delif br1 veth-ns1
[DEBUG] 2014-05-27 09:31:57,290 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns1 up
[DEBUG] 2014-05-27 09:31:57,292 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br1 down
[DEBUG] 2014-05-27 09:31:57,295 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delbr br1
[DEBUG] 2014-05-27 09:31:57,298 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns list
[DEBUG] 2014-05-27 09:31:57,303 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns del ns101
[DEBUG] 2014-05-27 09:31:57,306 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns del ns103
[DEBUG] 2014-05-27 09:31:57,308 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns del ns1
[DEBUG] 2014-05-27 09:31:57,314 module:ovsdb,function:_send,router:openwrt2
request:
  id: 438119
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - vni
    - ip_dvr
    op: select
    table: NLAN_Subnet
    where: []
response:
  error: null
  id: 438119
  result:
  - rows:
    - ip_dvr:
      - map
      - - - addr
          - 192.168.100.2/24
        - - mode
          - dvr
      vni: 1
    - ip_dvr:
      - map
      - - - addr
          - 10.0.3.1/24
        - - mode
          - dvr
      vni: 103
    - ip_dvr:
      - map
      - - - addr
          - 10.0.1.1/24
        - - mode
          - spoke_dvr
      vni: 101
[DEBUG] 2014-05-27 09:31:57,317 module:ovsdb,function:_send,router:openwrt2
request:
  id: 639895
  method: transact
  params:
  - Open_vSwitch
  - op: delete
    table: NLAN
    where: []
response:
  error: null
  id: 639895
  result:
  - count: 1
[INFO] 2014-05-27 09:31:57,320 module:nlan_agent,function:<module>,router:openwrt2
NLAN Agent execution completed
--- RESPONSE from router:openwrt2,platform:openwrt
message: Execution completed
exit: 0
--- STDOUT from router:rpi1,platform:debian
[INFO] 2014-05-27 02:31:57,997 module:nlan_agent,function:<module>,router:rpi1
NLAN Agent initialization completed
[DEBUG] 2014-05-27 02:31:57,998 module:nlan_agent,function:<module>,router:rpi1
__n__: {'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'platform': 'debian', 'share_dir': '/opt/nlan/share', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'logger': <logging.Logger object at 0x9b2f8ec>, 'router': 'rpi1', 'schema': 'ovsdb_nlan.schema', 'types': {'services': {'name': {'max': 1, '_description': 'Name of the network function', 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', '_description': 'Logical network interfaces to which the Network Function is attached', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, '_description': 'IP address of an OpenFlow Controller', 'key': {'_pattern': 'ofc_address', 'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, '_description': 'Virtual bridges: br-int and br-tun', 'key': {'enum': 'enabled', 'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, '_description': 'Network interface to which routing info is advertised', 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, '_description': 'Quagga/Zebra RIP daemon', 'key': {'enum': 'enabled', 'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', '_description': 'IP addresses of the remote hosts', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, '_description': 'IP address of the local host', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}}, 'subnets': {'peers': {'max': 'unlimited', '_description': 'Broadcast/Multicast trees for this subnet: IP addresses of the peer hosts', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}, 'vid': {'max': 1, '_description': 'VLAN ID', 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, '_description': 'Virtual host in a linux network namespace', 'key': {'_pattern': 'ipv4_prefix', 'type': 'string'}, 'min': 0}, 'vni': {'max': 1, '_description': 'Virtual network identifier', 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'ip_dvr': {'max': 3, '_description': 'Distributed Virtual Router setting', 'value': {'_pattern': {'dhcp': 'string', 'addr': 'ipv4_prefix', 'mode': 'dvr_mode'}, 'type': 'string'}, 'key': {'enum': ['set', ['addr', 'mode', 'dhcp']], 'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, '_description': 'Default GW address for this subnet', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', '_description': 'Physical/logical ports attached to this subnet', 'key': {'type': 'string'}, 'min': 0}}}, 'indexes': {'services': 'name', 'subnets': 'vni'}}
[INFO] 2014-05-27 02:31:58,013 module:nlan_agent,function:_route,router:rpi1
function:init.run, args:(), kwargs:{}
[DEBUG] 2014-05-27 02:31:58,013 module:cmdutil,function:_cmd2,router:rpi1
cmd: lxc-ls
[DEBUG] 2014-05-27 02:31:58,108 module:cmdutil,function:_cmd2,router:rpi1
cmd: lxc-stop -n snort1
[DEBUG] 2014-05-27 02:31:58,160 module:cmdutil,function:_cmd2,router:rpi1
cmd: lxc-stop -n snort2
[DEBUG] 2014-05-27 02:31:58,161 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl --if-exists del-br br-tun
[DEBUG] 2014-05-27 02:31:58,168 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl --if-exists del-br br-int
[DEBUG] 2014-05-27 02:31:58,178 module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl show
[DEBUG] 2014-05-27 02:31:58,193 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip netns list
[DEBUG] 2014-05-27 02:31:58,238 module:ovsdb,function:_send,router:rpi1
request:
  id: 458356
  method: transact
  params:
  - Open_vSwitch
  - op: delete
    table: NLAN
    where: []
response:
  error: null
  id: 458356
  result:
  - count: 1
[INFO] 2014-05-27 02:31:58,239 module:nlan_agent,function:<module>,router:rpi1
NLAN Agent execution completed
--- RESPONSE from router:rpi1,platform:debian
message: Execution completed
exit: 0
--- STDOUT from router:openwrt1,platform:openwrt
[INFO] 2014-05-27 09:31:57,127 module:nlan_agent,function:<module>,router:openwrt1
NLAN Agent initialization completed
[DEBUG] 2014-05-27 09:31:57,127 module:nlan_agent,function:<module>,router:openwrt1
__n__: {'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'platform': 'openwrt', 'share_dir': '/opt/nlan/share', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'logger': <logging.Logger object at 0xb75a38ec>, 'router': 'openwrt1', 'schema': 'ovsdb_nlan.schema', 'types': {'services': {'name': {'max': 1, '_description': 'Name of the network function', 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', '_description': 'Logical network interfaces to which the Network Function is attached', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, '_description': 'IP address of an OpenFlow Controller', 'key': {'_pattern': 'ofc_address', 'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, '_description': 'Virtual bridges: br-int and br-tun', 'key': {'enum': 'enabled', 'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, '_description': 'Network interface to which routing info is advertised', 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, '_description': 'Quagga/Zebra RIP daemon', 'key': {'enum': 'enabled', 'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', '_description': 'IP addresses of the remote hosts', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, '_description': 'IP address of the local host', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}}, 'subnets': {'peers': {'max': 'unlimited', '_description': 'Broadcast/Multicast trees for this subnet: IP addresses of the peer hosts', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}, 'vid': {'max': 1, '_description': 'VLAN ID', 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, '_description': 'Virtual host in a linux network namespace', 'key': {'_pattern': 'ipv4_prefix', 'type': 'string'}, 'min': 0}, 'vni': {'max': 1, '_description': 'Virtual network identifier', 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'ip_dvr': {'max': 3, '_description': 'Distributed Virtual Router setting', 'value': {'_pattern': {'dhcp': 'string', 'addr': 'ipv4_prefix', 'mode': 'dvr_mode'}, 'type': 'string'}, 'key': {'enum': ['set', ['addr', 'mode', 'dhcp']], 'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, '_description': 'Default GW address for this subnet', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', '_description': 'Physical/logical ports attached to this subnet', 'key': {'type': 'string'}, 'min': 0}}}, 'indexes': {'services': 'name', 'subnets': 'vni'}}
[INFO] 2014-05-27 09:31:57,142 module:nlan_agent,function:_route,router:openwrt1
function:init.run, args:(), kwargs:{}
[DEBUG] 2014-05-27 09:31:57,143 module:cmdutil,function:_cmd2,router:openwrt1
cmd: lxc-ls
[DEBUG] 2014-05-27 09:31:57,149 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl --if-exists del-br br-tun
[DEBUG] 2014-05-27 09:31:57,164 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl --if-exists del-br br-int
[DEBUG] 2014-05-27 09:31:57,210 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl show
[DEBUG] 2014-05-27 09:31:57,217 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1001 down
[DEBUG] 2014-05-27 09:31:57,228 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delif br1001 veth-ns1001
[DEBUG] 2014-05-27 09:31:57,241 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1001 up
[DEBUG] 2014-05-27 09:31:57,243 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br1001 down
[DEBUG] 2014-05-27 09:31:57,251 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delbr br1001
[DEBUG] 2014-05-27 09:31:57,257 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns103 down
[DEBUG] 2014-05-27 09:31:57,262 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delif br103 veth-ns103
[DEBUG] 2014-05-27 09:31:57,273 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns103 up
[DEBUG] 2014-05-27 09:31:57,276 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br103 down
[DEBUG] 2014-05-27 09:31:57,281 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delbr br103
[DEBUG] 2014-05-27 09:31:57,289 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1 down
[DEBUG] 2014-05-27 09:31:57,293 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delif br1 veth-ns1
[DEBUG] 2014-05-27 09:31:57,300 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1 up
[DEBUG] 2014-05-27 09:31:57,303 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br1 down
[DEBUG] 2014-05-27 09:31:57,305 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delbr br1
[DEBUG] 2014-05-27 09:31:57,310 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns list
[DEBUG] 2014-05-27 09:31:57,314 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns del ns-global
[DEBUG] 2014-05-27 09:31:57,317 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns del ns1001
[DEBUG] 2014-05-27 09:31:57,320 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns del ns1
[DEBUG] 2014-05-27 09:31:57,323 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns del ns103
[DEBUG] 2014-05-27 09:31:57,329 module:ovsdb,function:_send,router:openwrt1
request:
  id: 269202
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - vni
    - ip_dvr
    op: select
    table: NLAN_Subnet
    where: []
response:
  error: null
  id: 269202
  result:
  - rows:
    - ip_dvr:
      - map
      - - - addr
          - 10.0.3.1/24
        - - dhcp
          - enabled
        - - mode
          - dvr
      vni: 103
    - ip_dvr:
      - map
      - - - addr
          - 192.168.100.1/24
        - - mode
          - dvr
      vni: 1
    - ip_dvr:
      - map
      - - - addr
          - 10.0.1.1/24
        - - dhcp
          - enabled
        - - mode
          - hub
      vni: 1001
[DEBUG] 2014-05-27 09:31:57,332 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci delete network.int_dvr103
[DEBUG] 2014-05-27 09:31:57,336 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci delete dhcp.int_dvr103
[DEBUG] 2014-05-27 09:31:57,340 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci commit
[DEBUG] 2014-05-27 09:31:57,370 module:cmdutil,function:_cmd2,router:openwrt1
cmd: /etc/init.d/network restart
[DEBUG] 2014-05-27 09:31:58,410 module:cmdutil,function:_cmd2,router:openwrt1
cmd: /etc/init.d/dnsmasq restart
[DEBUG] 2014-05-27 09:31:58,487 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci delete network.int_dvr1001
[DEBUG] 2014-05-27 09:31:58,491 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci delete dhcp.int_dvr1001
[DEBUG] 2014-05-27 09:31:58,499 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci commit
[DEBUG] 2014-05-27 09:31:58,512 module:cmdutil,function:_cmd2,router:openwrt1
cmd: /etc/init.d/network restart
[DEBUG] 2014-05-27 09:31:59,561 module:cmdutil,function:_cmd2,router:openwrt1
cmd: /etc/init.d/dnsmasq restart
[DEBUG] 2014-05-27 09:31:59,634 module:ovsdb,function:_send,router:openwrt1
request:
  id: 581547
  method: transact
  params:
  - Open_vSwitch
  - op: delete
    table: NLAN
    where: []
response:
  error: null
  id: 581547
  result:
  - count: 1
[INFO] 2014-05-27 09:31:59,635 module:nlan_agent,function:<module>,router:openwrt1
NLAN Agent execution completed
--- STDERR from router:openwrt1,platform:openwrt
Command failed: Not found
Command failed: Not found
--- RESPONSE from router:openwrt1,platform:openwrt
message: Execution completed
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-05-27 02:31:58.306113

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.61(sec)
openwrt2          :-)         0.64(sec)
rpi1              :-)         0.88(sec)
openwrt1          :-)         2.89(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
rpi1             192.168.1.104  OK
openwrt1         192.168.1.101  OK
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:rpi1,platform:debian =+=+=+=+=+=+=+=+=+=+=+=+=+=+
operation: --add
dict_args: "OrderedDict([('bridges', {'ovs_bridges': 'enabled'}), ('services', [{'name': 'snort1', 'chain': ['mz.101', 'dmz.1001'], '_index': ['name', 'snort1']}]), ('vxlan', {'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.101'], 'local_ip': '192.168.1.104'}), ('subnets', [{'ports': ['dmz.1001'], 'peers': ['192.168.1.101'], 'vni': 1001, 'vid': 111, '_index': ['vni', 1001]}, {'ports': ['mz.101'], 'peers': ['192.168.1.102', '192.168.1.103'], 'vni': 101, 'vid': 1, '_index': ['vni', 101]}])])"
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --add
dict_args: "OrderedDict([('bridges', {'ovs_bridges': 'enabled'}), ('vxlan', {'remote_ips': ['192.168.1.102', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.103'}), ('subnets', [{'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 2, '_index': ['vni', 1], 'ip_vhost': '192.168.100.103/24', 'default_gw': '192.168.100.1', 'ip_dvr': OrderedDict([('addr', '192.168.100.3/24'), ('mode', 'dvr')]), 'vni': 1}, {'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 3, '_index': ['vni', 103], 'ip_vhost': '10.0.3.103/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr')])}, {'peers': ['192.168.1.102', '192.168.1.104'], 'vid': 1, '_index': ['vni', 101], 'ip_vhost': '10.0.1.103/24', 'vni': 101, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'spoke_dvr')])}])])"
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --add
dict_args: "OrderedDict([('bridges', {'ovs_bridges': 'enabled'}), ('vxlan', {'remote_ips': ['192.168.1.103', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.102'}), ('subnets', [{'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 2, '_index': ['vni', 1], 'ip_vhost': '192.168.100.102/24', 'default_gw': '192.168.100.1', 'ip_dvr': OrderedDict([('addr', '192.168.100.2/24'), ('mode', 'dvr')]), 'vni': 1}, {'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 3, '_index': ['vni', 103], 'ip_vhost': '10.0.3.102/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr')])}, {'peers': ['192.168.1.103', '192.168.1.104'], 'vid': 1, '_index': ['vni', 101], 'ip_vhost': '10.0.1.102/24', 'vni': 101, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'spoke_dvr')])}])])"
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --add
dict_args: "OrderedDict([('bridges', {'ovs_bridges': 'enabled'}), ('gateway', {'network': 'eth2', 'rip': 'enabled'}), ('vxlan', {'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.104'], 'local_ip': '192.168.1.101'}), ('subnets', [{'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 2, '_index': ['vni', 1], 'ip_vhost': '192.168.100.101/24', 'vni': 1, 'ip_dvr': OrderedDict([('addr', '192.168.100.1/24'), ('mode', 'dvr')])}, {'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 3, '_index': ['vni', 103], 'ip_vhost': '10.0.3.101/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr'), ('dhcp', 'enabled')])}, {'peers': ['192.168.1.104'], 'vid': 1, '_index': ['vni', 1001], 'ip_vhost': '10.0.1.101/24', 'vni': 1001, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'hub'), ('dhcp', 'enabled')])}])])"
--- STDOUT from router:rpi1,platform:debian
[INFO] 2014-05-27 02:32:01,505 module:nlan_agent,function:<module>,router:rpi1
NLAN Agent initialization completed
[DEBUG] 2014-05-27 02:32:01,507 module:nlan_agent,function:<module>,router:rpi1
__n__: {'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'platform': 'debian', 'share_dir': '/opt/nlan/share', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'logger': <logging.Logger object at 0x98b76cc>, 'router': 'rpi1', 'schema': 'ovsdb_nlan.schema', 'types': {'services': {'name': {'max': 1, '_description': 'Name of the network function', 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', '_description': 'Logical network interfaces to which the Network Function is attached', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, '_description': 'IP address of an OpenFlow Controller', 'key': {'_pattern': 'ofc_address', 'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, '_description': 'Virtual bridges: br-int and br-tun', 'key': {'enum': 'enabled', 'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, '_description': 'Network interface to which routing info is advertised', 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, '_description': 'Quagga/Zebra RIP daemon', 'key': {'enum': 'enabled', 'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', '_description': 'IP addresses of the remote hosts', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, '_description': 'IP address of the local host', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}}, 'subnets': {'peers': {'max': 'unlimited', '_description': 'Broadcast/Multicast trees for this subnet: IP addresses of the peer hosts', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}, 'vid': {'max': 1, '_description': 'VLAN ID', 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, '_description': 'Virtual host in a linux network namespace', 'key': {'_pattern': 'ipv4_prefix', 'type': 'string'}, 'min': 0}, 'vni': {'max': 1, '_description': 'Virtual network identifier', 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'ip_dvr': {'max': 3, '_description': 'Distributed Virtual Router setting', 'value': {'_pattern': {'dhcp': 'string', 'addr': 'ipv4_prefix', 'mode': 'dvr_mode'}, 'type': 'string'}, 'key': {'enum': ['set', ['addr', 'mode', 'dhcp']], 'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, '_description': 'Default GW address for this subnet', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', '_description': 'Physical/logical ports attached to this subnet', 'key': {'type': 'string'}, 'min': 0}}}, 'indexes': {'services': 'name', 'subnets': 'vni'}}
[INFO] 2014-05-27 02:32:01,563 module:nlan_agent,function:_route,router:rpi1
function:bridges.add, model:{'ovs_bridges': 'enabled'}
[DEBUG] 2014-05-27 02:32:01,578 module:ovsdb,function:_send,router:rpi1
request:
  id: 624632
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 624632
  result:
  - rows: []
[DEBUG] 2014-05-27 02:32:01,580 module:ovsdb,function:_send,router:rpi1
request:
  id: 563084
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row: {}
    table: NLAN
response:
  error: null
  id: 563084
  result:
  - uuid:
    - uuid
    - ec906988-4b9a-40c4-b1b9-cdc25f703cb3
[DEBUG] 2014-05-27 02:32:01,580 module:ovsdb,function:_send,router:rpi1
request:
  id: 254353
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Bridges
    where: []
response:
  error: null
  id: 254353
  result:
  - rows: []
[INFO] 2014-05-27 02:32:01,581 module:bridges,function:add,router:rpi1
Adding bridges: br-int and br-tun
[DEBUG] 2014-05-27 02:32:01,584 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-br br-int
[DEBUG] 2014-05-27 02:32:01,599 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-br br-tun
[DEBUG] 2014-05-27 02:32:01,646 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl del-flows br-tun
[DEBUG] 2014-05-27 02:32:01,768 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-int patch-int -- set interface patch-int type=patch options:peer=patch-tun
[DEBUG] 2014-05-27 02:32:01,777 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-tun patch-tun -- set interface patch-tun type=patch options:peer=patch-int
[DEBUG] 2014-05-27 02:32:01,786 module:ovsdb,function:_send,router:rpi1
request:
  id: 886120
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: Interface
    where:
    - - name
      - ==
      - patch-tun
response:
  error: null
  id: 886120
  result:
  - rows:
    - _uuid:
      - uuid
      - a6e591f8-a1f9-429a-930e-a8241620fa77
      _version:
      - uuid
      - a8db0ffd-e39a-4cb0-bc35-80f2bb1accdc
      admin_state:
      - set
      - []
      bfd:
      - map
      - []
      bfd_status:
      - map
      - []
      cfm_fault:
      - set
      - []
      cfm_fault_status:
      - set
      - []
      cfm_flap_count:
      - set
      - []
      cfm_health:
      - set
      - []
      cfm_mpid:
      - set
      - []
      cfm_remote_mpids:
      - set
      - []
      cfm_remote_opstate:
      - set
      - []
      duplex:
      - set
      - []
      external_ids:
      - map
      - []
      ifindex: 0
      ingress_policing_burst: 0
      ingress_policing_rate: 0
      lacp_current:
      - set
      - []
      link_resets:
      - set
      - []
      link_speed:
      - set
      - []
      link_state:
      - set
      - []
      mac:
      - set
      - []
      mac_in_use: ba:25:b5:0d:19:56
      mtu:
      - set
      - []
      name: patch-tun
      ofport: 1
      ofport_request:
      - set
      - []
      options:
      - map
      - - - peer
          - patch-int
      other_config:
      - map
      - []
      statistics:
      - map
      - - - collisions
          - 0
        - - rx_bytes
          - 0
        - - rx_crc_err
          - 0
        - - rx_dropped
          - 0
        - - rx_errors
          - 0
        - - rx_frame_err
          - 0
        - - rx_over_err
          - 0
        - - rx_packets
          - 0
        - - tx_bytes
          - 0
        - - tx_dropped
          - 0
        - - tx_errors
          - 0
        - - tx_packets
          - 0
      status:
      - map
      - []
      type: patch
[DEBUG] 2014-05-27 02:32:01,787 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=1,actions=resubmit(,1)
[DEBUG] 2014-05-27 02:32:01,793 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=0,priority=0,actions=drop
[DEBUG] 2014-05-27 02:32:01,798 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=01:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,19)
[DEBUG] 2014-05-27 02:32:01,804 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=00:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,20)
[DEBUG] 2014-05-27 02:32:01,809 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=2,priority=0,actions=drop
[DEBUG] 2014-05-27 02:32:01,814 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=3,priority=0,actions=drop
[DEBUG] 2014-05-27 02:32:01,819 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=10,priority=1,actions=learn(table=20,hard_timeout=300,priority=1,NXM_OF_VLAN_TCI[0..11],NXM_OF_ETH_DST[]=NXM_OF_ETH_SRC[],load:0->NXM_OF_VLAN_TCI[],load:NXM_NX_TUN_ID[]->NXM_NX_TUN_ID[],output:NXM_OF_IN_PORT[]),output:1
[DEBUG] 2014-05-27 02:32:01,826 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=19,priority=0,actions=resubmit(,21)
[DEBUG] 2014-05-27 02:32:01,831 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=20,priority=0,actions=resubmit(,21)
[DEBUG] 2014-05-27 02:32:01,837 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=21,priority=0,actions=drop
[DEBUG] 2014-05-27 02:32:01,844 module:ovsdb,function:crud,router:rpi1
CRUD operation (add): {'ovs_bridges': 'enabled'}
[DEBUG] 2014-05-27 02:32:01,845 module:ovsdb,function:_send,router:rpi1
request:
  id: 808380
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ovs_bridges: enabled
    table: NLAN_Bridges
    uuid-name: temp_984823
  - mutations:
    - - bridges
      - insert
      - - set
        - - - named-uuid
            - temp_984823
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 808380
  result:
  - uuid:
    - uuid
    - faa38ba5-b90c-4206-9323-aa6ffafd86db
  - count: 1
[DEBUG] 2014-05-27 02:32:01,846 module:ovsdb,function:_send,router:rpi1
request:
  id: 8896
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Bridges
    where: []
response:
  error: null
  id: 8896
  result:
  - rows:
    - _uuid:
      - uuid
      - faa38ba5-b90c-4206-9323-aa6ffafd86db
      _version:
      - uuid
      - 00b12cbb-c8c5-4a42-a3d4-62cca921e4be
      controller:
      - set
      - []
      ovs_bridges: enabled
[INFO] 2014-05-27 02:32:01,848 module:nlan_agent,function:_route,router:rpi1
function:services.add, index:['name', 'snort1'], model:{'name': 'snort1', 'chain': ['mz.101', 'dmz.1001']}
[DEBUG] 2014-05-27 02:32:01,850 module:ovsdb,function:_send,router:rpi1
request:
  id: 615148
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 615148
  result:
  - rows:
    - _uuid:
      - uuid
      - ec906988-4b9a-40c4-b1b9-cdc25f703cb3
      _version:
      - uuid
      - 9e1cd562-5ff8-414d-b8fe-f514a9a59bab
      bridges:
      - uuid
      - faa38ba5-b90c-4206-9323-aa6ffafd86db
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - set
      - []
      vxlan:
      - set
      - []
[DEBUG] 2014-05-27 02:32:01,851 module:ovsdb,function:_send,router:rpi1
request:
  id: 73356
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Service
    where:
    - - name
      - ==
      - snort1
response:
  error: null
  id: 73356
  result:
  - rows: []
[DEBUG] 2014-05-27 02:32:01,851 module:cmdutil,function:_cmd2,router:rpi1
cmd: lxc-stop -n snort1
[DEBUG] 2014-05-27 02:32:01,886 module:cmdutil,function:_cmd2,router:rpi1
cmd: lxc-start -d -f /var/lib/lxc/snort1/config_nlan -n snort1
[DEBUG] 2014-05-27 02:32:01,903 module:ovsdb,function:crud,router:rpi1
CRUD operation (add): {'name': 'snort1', 'chain': ['mz.101', 'dmz.1001']}
[DEBUG] 2014-05-27 02:32:01,904 module:ovsdb,function:_send,router:rpi1
request:
  id: 816771
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      chain:
      - set
      - - mz.101
        - dmz.1001
      name: snort1
    table: NLAN_Service
    uuid-name: temp_69161
  - mutations:
    - - services
      - insert
      - - set
        - - - named-uuid
            - temp_69161
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 816771
  result:
  - uuid:
    - uuid
    - 237b7210-d9ea-4e3b-a47a-bb7d057987f1
  - count: 1
[DEBUG] 2014-05-27 02:32:01,906 module:ovsdb,function:_send,router:rpi1
request:
  id: 314171
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Service
    where:
    - - name
      - ==
      - snort1
response:
  error: null
  id: 314171
  result:
  - rows:
    - _uuid:
      - uuid
      - 237b7210-d9ea-4e3b-a47a-bb7d057987f1
      _version:
      - uuid
      - 844be1e0-3122-4a1e-b687-f95210688bfd
      chain:
      - set
      - - dmz.1001
        - mz.101
      name: snort1
[INFO] 2014-05-27 02:32:01,908 module:nlan_agent,function:_route,router:rpi1
function:vxlan.add, model:{'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.101'], 'local_ip': '192.168.1.104'}
[DEBUG] 2014-05-27 02:32:01,908 module:ovsdb,function:_send,router:rpi1
request:
  id: 970482
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 970482
  result:
  - rows:
    - _uuid:
      - uuid
      - ec906988-4b9a-40c4-b1b9-cdc25f703cb3
      _version:
      - uuid
      - df67ea35-eb0f-4b23-afde-7a65f8799b38
      bridges:
      - uuid
      - faa38ba5-b90c-4206-9323-aa6ffafd86db
      gateway:
      - set
      - []
      services:
      - uuid
      - 237b7210-d9ea-4e3b-a47a-bb7d057987f1
      subnets:
      - set
      - []
      vxlan:
      - set
      - []
[DEBUG] 2014-05-27 02:32:01,909 module:ovsdb,function:_send,router:rpi1
request:
  id: 138017
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_VXLAN
    where: []
response:
  error: null
  id: 138017
  result:
  - rows: []
[INFO] 2014-05-27 02:32:01,910 module:vxlan,function:add,router:rpi1
Adding a VXLAN tunnel: vxlan_192.168.1.103
[DEBUG] 2014-05-27 02:32:01,910 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-tun vxlan_192.168.1.103 -- set interface vxlan_192.168.1.103 type=vxlan options:in_key=flow options:local_ip=192.168.1.104 options:out_key=flow options:remote_ip=192.168.1.103
[INFO] 2014-05-27 02:32:01,921 module:vxlan,function:add,router:rpi1
Adding a VXLAN tunnel: vxlan_192.168.1.102
[DEBUG] 2014-05-27 02:32:01,921 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-tun vxlan_192.168.1.102 -- set interface vxlan_192.168.1.102 type=vxlan options:in_key=flow options:local_ip=192.168.1.104 options:out_key=flow options:remote_ip=192.168.1.102
[INFO] 2014-05-27 02:32:01,939 module:vxlan,function:add,router:rpi1
Adding a VXLAN tunnel: vxlan_192.168.1.101
[DEBUG] 2014-05-27 02:32:01,939 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-tun vxlan_192.168.1.101 -- set interface vxlan_192.168.1.101 type=vxlan options:in_key=flow options:local_ip=192.168.1.104 options:out_key=flow options:remote_ip=192.168.1.101
[DEBUG] 2014-05-27 02:32:01,959 module:ovsdb,function:_send,router:rpi1
request:
  id: 581218
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 581218
  result:
  - rows:
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
[DEBUG] 2014-05-27 02:32:01,960 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=4,actions=resubmit(,2)
[DEBUG] 2014-05-27 02:32:01,990 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=3,actions=resubmit(,2)
[DEBUG] 2014-05-27 02:32:02,018 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=2,actions=resubmit(,2)
[DEBUG] 2014-05-27 02:32:02,082 module:ovsdb,function:crud,router:rpi1
CRUD operation (add): {'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.101'], 'local_ip': '192.168.1.104'}
[DEBUG] 2014-05-27 02:32:02,083 module:ovsdb,function:_send,router:rpi1
request:
  id: 522950
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      local_ip: 192.168.1.104
      remote_ips:
      - set
      - - 192.168.1.103
        - 192.168.1.102
        - 192.168.1.101
    table: NLAN_VXLAN
    uuid-name: temp_828691
  - mutations:
    - - vxlan
      - insert
      - - set
        - - - named-uuid
            - temp_828691
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 522950
  result:
  - uuid:
    - uuid
    - a4d0b0e8-3068-4f3d-b181-d78c612fcd3a
  - count: 1
[DEBUG] 2014-05-27 02:32:02,084 module:ovsdb,function:_send,router:rpi1
request:
  id: 670941
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_VXLAN
    where: []
response:
  error: null
  id: 670941
  result:
  - rows:
    - _uuid:
      - uuid
      - a4d0b0e8-3068-4f3d-b181-d78c612fcd3a
      _version:
      - uuid
      - 17b0815c-2ac3-43a0-8333-fedb325e6ad5
      local_ip: 192.168.1.104
      remote_ips:
      - set
      - - 192.168.1.101
        - 192.168.1.102
        - 192.168.1.103
[INFO] 2014-05-27 02:32:02,095 module:nlan_agent,function:_route,router:rpi1
function:subnets.add, index:['vni', 1001], model:{'peers': ['192.168.1.101'], 'ports': ['dmz.1001'], 'vni': 1001, 'vid': 111}
[DEBUG] 2014-05-27 02:32:02,100 module:ovsdb,function:_send,router:rpi1
request:
  id: 679605
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 679605
  result:
  - rows:
    - _uuid:
      - uuid
      - ec906988-4b9a-40c4-b1b9-cdc25f703cb3
      _version:
      - uuid
      - 3c9b6cfc-ab54-45f1-bdf8-fdad4976fab5
      bridges:
      - uuid
      - faa38ba5-b90c-4206-9323-aa6ffafd86db
      gateway:
      - set
      - []
      services:
      - uuid
      - 237b7210-d9ea-4e3b-a47a-bb7d057987f1
      subnets:
      - set
      - []
      vxlan:
      - uuid
      - a4d0b0e8-3068-4f3d-b181-d78c612fcd3a
[DEBUG] 2014-05-27 02:32:02,104 module:ovsdb,function:_send,router:rpi1
request:
  id: 467847
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1001
response:
  error: null
  id: 467847
  result:
  - rows: []
[INFO] 2014-05-27 02:32:02,104 module:subnets,function:add,router:rpi1
Adding a subnet(vlan): 111
[DEBUG] 2014-05-27 02:32:02,106 module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addbr br1001
[DEBUG] 2014-05-27 02:32:02,112 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-int int_br1001 tag=111 -- set interface int_br1001 type=internal
[DEBUG] 2014-05-27 02:32:02,154 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-int int_dvr1001 tag=111 -- set interface int_dvr1001 type=internal
[DEBUG] 2014-05-27 02:32:02,182 module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addif br1001 int_br1001
[DEBUG] 2014-05-27 02:32:02,191 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int_br1001 promisc on
[DEBUG] 2014-05-27 02:32:02,195 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int_br1001 up
[DEBUG] 2014-05-27 02:32:02,201 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int_dvr1001 up
[DEBUG] 2014-05-27 02:32:02,214 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev br1001 up
[DEBUG] 2014-05-27 02:32:02,218 module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addif br1001 dmz.1001
[DEBUG] 2014-05-27 02:32:02,226 module:ovsdb,function:_send,router:rpi1
request:
  id: 902669
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 902669
  result:
  - rows: []
[DEBUG] 2014-05-27 02:32:02,226 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=1001,actions=mod_vlan_vid:111,resubmit(,10)
[DEBUG] 2014-05-27 02:32:02,235 module:ovsdb,function:_send,router:rpi1
request:
  id: 78124
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 78124
  result:
  - rows:
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
[DEBUG] 2014-05-27 02:32:02,237 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=111,actions=strip_vlan,set_tunnel:1001,output:4
[DEBUG] 2014-05-27 02:32:02,243 module:ovsdb,function:crud,router:rpi1
CRUD operation (add): {'peers': ['192.168.1.101'], 'ports': ['dmz.1001'], 'vni': 1001, 'vid': 111}
[DEBUG] 2014-05-27 02:32:02,244 module:ovsdb,function:_send,router:rpi1
request:
  id: 173042
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      peers:
      - set
      - - 192.168.1.101
      ports:
      - set
      - - dmz.1001
      vid: 111
      vni: 1001
    table: NLAN_Subnet
    uuid-name: temp_315763
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_315763
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 173042
  result:
  - uuid:
    - uuid
    - 93dd4e69-f585-4b76-96bb-689fc44dc777
  - count: 1
[DEBUG] 2014-05-27 02:32:02,246 module:ovsdb,function:_send,router:rpi1
request:
  id: 959049
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1001
response:
  error: null
  id: 959049
  result:
  - rows:
    - _uuid:
      - uuid
      - 93dd4e69-f585-4b76-96bb-689fc44dc777
      _version:
      - uuid
      - f339fe54-a7af-447d-ae09-2c9a8cac31be
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - []
      ip_vhost:
      - set
      - []
      peers: 192.168.1.101
      ports: dmz.1001
      vid: 111
      vni: 1001
[INFO] 2014-05-27 02:32:02,246 module:nlan_agent,function:_route,router:rpi1
function:subnets.add, index:['vni', 101], model:{'peers': ['192.168.1.102', '192.168.1.103'], 'ports': ['mz.101'], 'vni': 101, 'vid': 1}
[DEBUG] 2014-05-27 02:32:02,247 module:ovsdb,function:_send,router:rpi1
request:
  id: 24999
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 24999
  result:
  - rows:
    - _uuid:
      - uuid
      - ec906988-4b9a-40c4-b1b9-cdc25f703cb3
      _version:
      - uuid
      - fb040a5c-b907-4fd2-9319-0dba6a375d26
      bridges:
      - uuid
      - faa38ba5-b90c-4206-9323-aa6ffafd86db
      gateway:
      - set
      - []
      services:
      - uuid
      - 237b7210-d9ea-4e3b-a47a-bb7d057987f1
      subnets:
      - uuid
      - 93dd4e69-f585-4b76-96bb-689fc44dc777
      vxlan:
      - uuid
      - a4d0b0e8-3068-4f3d-b181-d78c612fcd3a
[DEBUG] 2014-05-27 02:32:02,248 module:ovsdb,function:_send,router:rpi1
request:
  id: 643950
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 101
response:
  error: null
  id: 643950
  result:
  - rows: []
[INFO] 2014-05-27 02:32:02,249 module:subnets,function:add,router:rpi1
Adding a subnet(vlan): 1
[DEBUG] 2014-05-27 02:32:02,249 module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addbr br101
[DEBUG] 2014-05-27 02:32:02,258 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-int int_br101 tag=1 -- set interface int_br101 type=internal
[DEBUG] 2014-05-27 02:32:02,290 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-int int_dvr101 tag=1 -- set interface int_dvr101 type=internal
[DEBUG] 2014-05-27 02:32:02,319 module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addif br101 int_br101
[DE--- STDOUT from router:openwrt3,platform:openwrt
[INFO] 2014-05-27 09:32:00,873 module:nlan_agent,function:<module>,router:openwrt3
NLAN Agent initialization completed
[DEBUG] 2014-05-27 09:32:00,874 module:nlan_agent,function:<module>,router:openwrt3
__n__: {'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'platform': 'openwrt', 'share_dir': '/opt/nlan/share', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'logger': <logging.Logger object at 0xb7506b0c>, 'router': 'openwrt3', 'schema': 'ovsdb_nlan.schema', 'types': {'services': {'name': {'max': 1, '_description': 'Name of the network function', 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', '_description': 'Logical network interfaces to which the Network Function is attached', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, '_description': 'IP address of an OpenFlow Controller', 'key': {'_pattern': 'ofc_address', 'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, '_description': 'Virtual bridges: br-int and br-tun', 'key': {'enum': 'enabled', 'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, '_description': 'Network interface to which routing info is advertised', 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, '_description': 'Quagga/Zebra RIP daemon', 'key': {'enum': 'enabled', 'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', '_description': 'IP addresses of the remote hosts', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, '_description': 'IP address of the local host', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}}, 'subnets': {'peers': {'max': 'unlimited', '_description': 'Broadcast/Multicast trees for this subnet: IP addresses of the peer hosts', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}, 'vid': {'max': 1, '_description': 'VLAN ID', 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, '_description': 'Virtual host in a linux network namespace', 'key': {'_pattern': 'ipv4_prefix', 'type': 'string'}, 'min': 0}, 'vni': {'max': 1, '_description': 'Virtual network identifier', 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'ip_dvr': {'max': 3, '_description': 'Distributed Virtual Router setting', 'value': {'_pattern': {'dhcp': 'string', 'addr': 'ipv4_prefix', 'mode': 'dvr_mode'}, 'type': 'string'}, 'key': {'enum': ['set', ['addr', 'mode', 'dhcp']], 'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, '_description': 'Default GW address for this subnet', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', '_description': 'Physical/logical ports attached to this subnet', 'key': {'type': 'string'}, 'min': 0}}}, 'indexes': {'services': 'name', 'subnets': 'vni'}}
[INFO] 2014-05-27 09:32:00,930 module:nlan_agent,function:_route,router:openwrt3
function:bridges.add, model:{'ovs_bridges': 'enabled'}
[DEBUG] 2014-05-27 09:32:00,937 module:ovsdb,function:_send,router:openwrt3
request:
  id: 529629
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 529629
  result:
  - rows: []
[DEBUG] 2014-05-27 09:32:00,939 module:ovsdb,function:_send,router:openwrt3
request:
  id: 33481
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row: {}
    table: NLAN
response:
  error: null
  id: 33481
  result:
  - uuid:
    - uuid
    - 62b13f58-af42-4b90-9c13-a01b07808e21
[DEBUG] 2014-05-27 09:32:00,940 module:ovsdb,function:_send,router:openwrt3
request:
  id: 375587
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Bridges
    where: []
response:
  error: null
  id: 375587
  result:
  - rows: []
[INFO] 2014-05-27 09:32:00,941 module:bridges,function:add,router:openwrt3
Adding bridges: br-int and br-tun
[DEBUG] 2014-05-27 09:32:00,942 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-br br-int
[DEBUG] 2014-05-27 09:32:00,955 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-br br-tun
[DEBUG] 2014-05-27 09:32:00,997 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl del-flows br-tun
[DEBUG] 2014-05-27 09:32:01,002 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int patch-int -- set interface patch-int type=patch options:peer=patch-tun
[DEBUG] 2014-05-27 09:32:01,025 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-tun patch-tun -- set interface patch-tun type=patch options:peer=patch-int
[DEBUG] 2014-05-27 09:32:01,038 module:ovsdb,function:_send,router:openwrt3
request:
  id: 840674
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: Interface
    where:
    - - name
      - ==
      - patch-tun
response:
  error: null
  id: 840674
  result:
  - rows:
    - _uuid:
      - uuid
      - 381aba33-2109-4b19-adc5-0790e99c04da
      _version:
      - uuid
      - 2bb4bc74-a140-4133-955e-57bcc3fb39a4
      admin_state:
      - set
      - []
      bfd:
      - map
      - []
      bfd_status:
      - map
      - []
      cfm_fault:
      - set
      - []
      cfm_fault_status:
      - set
      - []
      cfm_flap_count:
      - set
      - []
      cfm_health:
      - set
      - []
      cfm_mpid:
      - set
      - []
      cfm_remote_mpids:
      - set
      - []
      cfm_remote_opstate:
      - set
      - []
      duplex:
      - set
      - []
      external_ids:
      - map
      - []
      ifindex: 0
      ingress_policing_burst: 0
      ingress_policing_rate: 0
      lacp_current:
      - set
      - []
      link_resets:
      - set
      - []
      link_speed:
      - set
      - []
      link_state:
      - set
      - []
      mac:
      - set
      - []
      mac_in_use: 26:42:89:57:c0:05
      mtu:
      - set
      - []
      name: patch-tun
      ofport: 1
      ofport_request:
      - set
      - []
      options:
      - map
      - - - peer
          - patch-int
      other_config:
      - map
      - []
      statistics:
      - map
      - - - collisions
          - 0
        - - rx_bytes
          - 0
        - - rx_crc_err
          - 0
        - - rx_dropped
          - 0
        - - rx_errors
          - 0
        - - rx_frame_err
          - 0
        - - rx_over_err
          - 0
        - - rx_packets
          - 0
        - - tx_bytes
          - 0
        - - tx_dropped
          - 0
        - - tx_errors
          - 0
        - - tx_packets
          - 0
      status:
      - map
      - []
      type: patch
[DEBUG] 2014-05-27 09:32:01,043 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=1,actions=resubmit(,1)
[DEBUG] 2014-05-27 09:32:01,048 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=0,priority=0,actions=drop
[DEBUG] 2014-05-27 09:32:01,055 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=01:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,19)
[DEBUG] 2014-05-27 09:32:01,059 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=00:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,20)
[DEBUG] 2014-05-27 09:32:01,068 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=2,priority=0,actions=drop
[DEBUG] 2014-05-27 09:32:01,080 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=3,priority=0,actions=drop
[DEBUG] 2014-05-27 09:32:01,084 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=10,priority=1,actions=learn(table=20,hard_timeout=300,priority=1,NXM_OF_VLAN_TCI[0..11],NXM_OF_ETH_DST[]=NXM_OF_ETH_SRC[],load:0->NXM_OF_VLAN_TCI[],load:NXM_NX_TUN_ID[]->NXM_NX_TUN_ID[],output:NXM_OF_IN_PORT[]),output:1
[DEBUG] 2014-05-27 09:32:01,092 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=19,priority=0,actions=resubmit(,21)
[DEBUG] 2014-05-27 09:32:01,097 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=20,priority=0,actions=resubmit(,21)
[DEBUG] 2014-05-27 09:32:01,101 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=21,priority=0,actions=drop
[DEBUG] 2014-05-27 09:32:01,105 module:ovsdb,function:crud,router:openwrt3
CRUD operation (add): {'ovs_bridges': 'enabled'}
[DEBUG] 2014-05-27 09:32:01,106 module:ovsdb,function:_send,router:openwrt3
request:
  id: 518848
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ovs_bridges: enabled
    table: NLAN_Bridges
    uuid-name: temp_611182
  - mutations:
    - - bridges
      - insert
      - - set
        - - - named-uuid
            - temp_611182
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 518848
  result:
  - uuid:
    - uuid
    - b1bd910c-f4bf-4aba-aceb-c8b9e20752f6
  - count: 1
[DEBUG] 2014-05-27 09:32:01,108 module:ovsdb,function:_send,router:openwrt3
request:
  id: 132071
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Bridges
    where: []
response:
  error: null
  id: 132071
  result:
  - rows:
    - _uuid:
      - uuid
      - b1bd910c-f4bf-4aba-aceb-c8b9e20752f6
      _version:
      - uuid
      - 4fc8488a-6dc1-409f-93ec-cdbfbf002592
      controller:
      - set
      - []
      ovs_bridges: enabled
[INFO] 2014-05-27 09:32:01,111 module:nlan_agent,function:_route,router:openwrt3
function:vxlan.add, model:{'remote_ips': ['192.168.1.102', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.103'}
[DEBUG] 2014-05-27 09:32:01,112 module:ovsdb,function:_send,router:openwrt3
request:
  id: 123863
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 123863
  result:
  - rows:
    - _uuid:
      - uuid
      - 62b13f58-af42-4b90-9c13-a01b07808e21
      _version:
      - uuid
      - 6a53bf15-abf6-428e-ac2c-e86a5cfd52d0
      bridges:
      - uuid
      - b1bd910c-f4bf-4aba-aceb-c8b9e20752f6
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - set
      - []
      vxlan:
      - set
      - []
[DEBUG] 2014-05-27 09:32:01,115 module:ovsdb,function:_send,router:openwrt3
request:
  id: 28608
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_VXLAN
    where: []
response:
  error: null
  id: 28608
  result:
  - rows: []
[INFO] 2014-05-27 09:32:01,116 module:vxlan,function:add,router:openwrt3
Adding a VXLAN tunnel: vxlan_192.168.1.102
[DEBUG] 2014-05-27 09:32:01,117 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-tun vxlan_192.168.1.102 -- set interface vxlan_192.168.1.102 type=vxlan options:in_key=flow options:local_ip=192.168.1.103 options:out_key=flow options:remote_ip=192.168.1.102
[INFO] 2014-05-27 09:32:01,127 module:vxlan,function:add,router:openwrt3
Adding a VXLAN tunnel: vxlan_192.168.1.101
[DEBUG] 2014-05-27 09:32:01,127 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-tun vxlan_192.168.1.101 -- set interface vxlan_192.168.1.101 type=vxlan options:in_key=flow options:local_ip=192.168.1.103 options:out_key=flow options:remote_ip=192.168.1.101
[INFO] 2014-05-27 09:32:01,138 module:vxlan,function:add,router:openwrt3
Adding a VXLAN tunnel: vxlan_192.168.1.104
[DEBUG] 2014-05-27 09:32:01,138 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-tun vxlan_192.168.1.104 -- set interface vxlan_192.168.1.104 type=vxlan options:in_key=flow options:local_ip=192.168.1.103 options:out_key=flow options:remote_ip=192.168.1.104
[DEBUG] 2014-05-27 09:32:01,149 module:ovsdb,function:_send,router:openwrt3
request:
  id: 50321BUG] 2014-05-27 02:32:02,334 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int_br101 promisc on
[DEBUG] 2014-05-27 02:32:02,340 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int_br101 up
[DEBUG] 2014-05-27 02:32:02,349 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int_dvr101 up
[DEBUG] 2014-05-27 02:32:02,357 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev br101 up
[DEBUG] 2014-05-27 02:32:02,364 module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addif br101 mz.101
[DEBUG] 2014-05-27 02:32:02,367 module:ovsdb,function:_send,router:rpi1
request:
  id: 353256
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 353256
  result:
  - rows: []
[DEBUG] 2014-05-27 02:32:02,367 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=101,actions=mod_vlan_vid:1,resubmit(,10)
[DEBUG] 2014-05-27 02:32:02,376 module:ovsdb,function:_send,router:rpi1
request:
  id: 318658
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 318658
  result:
  - rows:
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
[DEBUG] 2014-05-27 02:32:02,376 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=1,actions=strip_vlan,set_tunnel:101,output:3,output:2
[DEBUG] 2014-05-27 02:32:02,380 module:ovsdb,function:crud,router:rpi1
CRUD operation (add): {'peers': ['192.168.1.102', '192.168.1.103'], 'ports': ['mz.101'], 'vni': 101, 'vid': 1}
[DEBUG] 2014-05-27 02:32:02,382 module:ovsdb,function:_send,router:rpi1
request:
  id: 962788
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      peers:
      - set
      - - 192.168.1.102
        - 192.168.1.103
      ports:
      - set
      - - mz.101
      vid: 1
      vni: 101
    table: NLAN_Subnet
    uuid-name: temp_621295
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_621295
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 962788
  result:
  - uuid:
    - uuid
    - 9a93b842-1337-40ec-8ac4-3c21d488249a
  - count: 1
[DEBUG] 2014-05-27 02:32:02,383 module:ovsdb,function:_send,router:rpi1
request:
  id: 904670
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 101
response:
  error: null
  id: 904670
  result:
  - rows:
    - _uuid:
      - uuid
      - 9a93b842-1337-40ec-8ac4-3c21d488249a
      _version:
      - uuid
      - 3312dacf-4f9c-4cf5-88fe-7bfa70c0d733
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - []
      ip_vhost:
      - set
      - []
      peers:
      - set
      - - 192.168.1.102
        - 192.168.1.103
      ports: mz.101
      vid: 1
      vni: 101
[INFO] 2014-05-27 02:32:02,383 module:nlan_agent,function:<module>,router:rpi1
NLAN Agent execution completed
--- RESPONSE from router:rpi1,platform:debian
message: Execution completed
exit: 0
9
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 503219
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-27 09:32:01,151 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=3,actions=resubmit(,2)
[DEBUG] 2014-05-27 09:32:01,159 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=2,actions=resubmit(,2)
[DEBUG] 2014-05-27 09:32:01,164 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=4,actions=resubmit(,2)
[DEBUG] 2014-05-27 09:32:01,168 module:ovsdb,function:crud,router:openwrt3
CRUD operation (add): {'remote_ips': ['192.168.1.102', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.103'}
[DEBUG] 2014-05-27 09:32:01,171 module:ovsdb,function:_send,router:openwrt3
request:
  id: 570706
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      local_ip: 192.168.1.103
      remote_ips:
      - set
      - - 192.168.1.102
        - 192.168.1.101
        - 192.168.1.104
    table: NLAN_VXLAN
    uuid-name: temp_942779
  - mutations:
    - - vxlan
      - insert
      - - set
        - - - named-uuid
            - temp_942779
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 570706
  result:
  - uuid:
    - uuid
    - f310e0bb-7886-4235-ab0f-dbb6f0970d65
  - count: 1
[DEBUG] 2014-05-27 09:32:01,174 module:ovsdb,function:_send,router:openwrt3
request:
  id: 352940
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_VXLAN
    where: []
response:
  error: null
  id: 352940
  result:
  - rows:
    - _uuid:
      - uuid
      - f310e0bb-7886-4235-ab0f-dbb6f0970d65
      _version:
      - uuid
      - 1a8932ec-b50d-4916-bfd2-aa6dc4dbc212
      local_ip: 192.168.1.103
      remote_ips:
      - set
      - - 192.168.1.101
        - 192.168.1.102
        - 192.168.1.104
[INFO] 2014-05-27 09:32:01,183 module:nlan_agent,function:_route,router:openwrt3
function:subnets.add, index:['vni', 1], model:{'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 2, 'ip_vhost': '192.168.100.103/24', 'default_gw': '192.168.100.1', 'ip_dvr': OrderedDict([('addr', '192.168.100.3/24'), ('mode', 'dvr')]), 'vni': 1}
[DEBUG] 2014-05-27 09:32:01,186 module:ovsdb,function:_send,router:openwrt3
request:
  id: 489409
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 489409
  result:
  - rows:
    - _uuid:
      - uuid
      - 62b13f58-af42-4b90-9c13-a01b07808e21
      _version:
      - uuid
      - 841ed767-5a96-4a4f-8a78-3c5e7e870854
      bridges:
      - uuid
      - b1bd910c-f4bf-4aba-aceb-c8b9e20752f6
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - set
      - []
      vxlan:
      - uuid
      - f310e0bb-7886-4235-ab0f-dbb6f0970d65
[DEBUG] 2014-05-27 09:32:01,192 module:ovsdb,function:_send,router:openwrt3
request:
  id: 312752
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1
response:
  error: null
  id: 312752
  result:
  - rows: []
[INFO] 2014-05-27 09:32:01,194 module:subnets,function:add,router:openwrt3
Adding a subnet(vlan): 2
[DEBUG] 2014-05-27 09:32:01,194 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addbr br1
[DEBUG] 2014-05-27 09:32:01,206 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int_br1 tag=2 -- set interface int_br1 type=internal
[DEBUG] 2014-05-27 09:32:01,237 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int_dvr1 tag=2 -- set interface int_dvr1 type=internal
[DEBUG] 2014-05-27 09:32:01,269 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br1 int_br1
[DEBUG] 2014-05-27 09:32:01,277 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int_br1 promisc on
[DEBUG] 2014-05-27 09:32:01,281 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int_br1 up
[DEBUG] 2014-05-27 09:32:01,285 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int_dvr1 up
[DEBUG] 2014-05-27 09:32:01,292 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br1 up
[DEBUG] 2014-05-27 09:32:01,298 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns add ns1
[DEBUG] 2014-05-27 09:32:01,305 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link add veth-ns1 type veth peer name temp-ns1
[DEBUG] 2014-05-27 09:32:01,315 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev temp-ns1 netns ns1
[DEBUG] 2014-05-27 09:32:01,327 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns1 ip link set dev temp-ns1 name eth0
[DEBUG] 2014-05-27 09:32:01,332 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br1 veth-ns1
[DEBUG] 2014-05-27 09:32:01,342 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns1 promisc on
[DEBUG] 2014-05-27 09:32:01,349 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns1 up
[DEBUG] 2014-05-27 09:32:01,359 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns1 ip link set dev eth0 up
[DEBUG] 2014-05-27 09:32:01,369 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns1 ip addr add dev eth0 192.168.100.103/24
[DEBUG] 2014-05-27 09:32:01,373 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns1 ip route add default via 192.168.100.3 dev eth0
[DEBUG] 2014-05-27 09:32:01,379 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip addr add dev int_dvr1 192.168.100.3/24
[DEBUG] 2014-05-27 09:32:01,383 module:cmdutil,function:_cmd2,router:openwrt3
cmd: route
[DEBUG] 2014-05-27 09:32:01,386 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip route add default via 192.168.100.1
[DEBUG] 2014-05-27 09:32:01,395 module:ovsdb,function:_send,router:openwrt3
request:
  id: 58097
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 58097
  result:
  - rows: []
[DEBUG] 2014-05-27 09:32:01,398 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=1,actions=mod_vlan_vid:2,resubmit(,10)
[DEBUG] 2014-05-27 09:32:01,402 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=2,nw_dst=192.168.100.3,actions=drop
[DEBUG] 2014-05-27 09:32:01,408 module:ovsdb,function:_send,router:openwrt3
request:
  id: 649517
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 649517
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-27 09:32:01,411 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=2,actions=strip_vlan,set_tunnel:1,output:3,output:2
[DEBUG] 2014-05-27 09:32:01,418 module:ovsdb,function:crud,router:openwrt3
CRUD operation (add): {'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 2, 'ip_vhost': '192.168.100.103/24', 'default_gw': '192.168.100.1', 'ip_dvr': OrderedDict([('addr', '192.168.100.3/24'), ('mode', 'dvr')]), 'vni': 1}
[DEBUG] 2014-05-27 09:32:01,420 module:ovsdb,function:_send,router:openwrt3
request:
  id: 659975
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      default_gw: 192.168.100.1
      ip_dvr:
      - map
      - - - addr
          - 192.168.100.3/24
        - - mode
          - dvr
      ip_vhost: 192.168.100.103/24
      peers:
      - set
      - - 192.168.1.101
        - 192.168.1.102
      vid: 2
      vni: 1
    table: NLAN_Subnet
    uuid-name: temp_552565
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_552565
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 659975
  result:
  - uuid:
    - uuid
    - ab363cde-e620-4f5a-b873-0535e6edeb22
  - count: 1
[DEBUG] 2014-05-27 09:32:01,422 module:ovsdb,function:_send,router:openwrt3
request:
  id: 447813
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1
response:
  error: null
  id: 447813
  result:
  - rows:
    - _uuid:
      - uuid
      - ab363cde-e620-4f5a-b873-0535e6edeb22
      _version:
      - uuid
      - 2fd061c7-06b3-430b-9e5c-288e0dc7fb7f
      default_gw: 192.168.100.1
      ip_dvr:
      - map
      - - - addr
          - 192.168.100.3/24
        - - mode
          - dvr
      ip_vhost: 192.168.100.103/24
      peers:
      - set
      - - 192.168.1.101
        - 192.168.1.102
      ports:
      - set
      - []
      vid: 2
      vni: 1
[INFO] 2014-05-27 09:32:01,424 module:nlan_agent,function:_route,router:openwrt3
function:subnets.add, index:['vni', 103], model:{'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 3, 'ip_vhost': '10.0.3.103/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr')])}
[DEBUG] 2014-05-27 09:32:01,425 module:ovsdb,function:_send,router:openwrt3
request:
  id: 928684
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 928684
  result:
  - rows:
    - _uuid:
      - uuid
      - 62b13f58-af42-4b90-9c13-a01b07808e21
      _version:
      - uuid
      - 0dd7c0c5-2e03-42df-99e0-d15d96d48892
      bridges:
      - uuid
      - b1bd910c-f4bf-4aba-aceb-c8b9e20752f6
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - uuid
      - ab363cde-e620-4f5a-b873-0535e6edeb22
      vxlan:
      - uuid
      - f310e0bb-7886-4235-ab0f-dbb6f0970d65
[DEBUG] 2014-05-27 09:32:01,428 module:ovsdb,function:_send,router:openwrt3
request:
  id: 175460
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 103
response:
  error: null
  id: 175460
  result:
  - rows: []
[INFO] 2014-05-27 09:32:01,430 module:subnets,function:add,router:openwrt3
Adding a subnet(vlan): 3
[DEBUG] 2014-05-27 09:32:01,430 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addbr br103
[DEBUG] 2014-05-27 09:32:01,435 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int_br103 tag=3 -- set interface int_br103 type=internal
[DEBUG] 2014-05-27 09:32:01,459 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int_dvr103 tag=3 -- set interface int_dvr103 type=internal
[DEBUG] 2014-05-27 09:32:01,492 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br103 int_br103
[DEBUG] 2014-05-27 09:32:01,498 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int_br103 promisc on
[DEBUG] 2014-05-27 09:32:01,505 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int_br103 up
[DEBUG] 2014-05-27 09:32:01,507 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int_dvr103 up
[DEBUG] 2014-05-27 09:32:01,510 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br103 up
[DEBUG] 2014-05-27 09:32:01,517 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns add ns103
[DEBUG] 2014-05-27 09:32:01,521 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link add veth-ns103 type veth peer name temp-ns103
[DEBUG] 2014-05-27 09:32:01,528 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev temp-ns103 netns ns103
[DEBUG] 2014-05-27 09:32:01,534 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns103 ip link set dev temp-ns103 name eth0
[DEBUG] 2014-05-27 09:32:01,542 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br103 veth-ns103
[DEBUG] 2014-05-27 09:32:01,547 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns103 promisc on
[DEBUG] 2014-05-27 09:32:01,550 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns103 up
[DEBUG] 2014-05-27 09:32:01,565 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns103 ip link set dev eth0 up
[DEBUG] 2014-05-27 09:32:01,574 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns103 ip addr add dev eth0 10.0.3.103/24
[DEBUG] 2014-05-27 09:32:01,579 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns103 ip route add default via 10.0.3.1 dev eth0
[DEBUG] 2014-05-27 09:32:01,581 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip addr add dev int_dvr103 10.0.3.1/24
[DEBUG] 2014-05-27 09:32:01,584 module:ovsdb,function:_send,router:openwrt3
request:
  id: 449818
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 449818
  result:
  - rows: []
[DEBUG] 2014-05-27 09:32:01,585 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=103,actions=mod_vlan_vid:3,resubmit(,10)
[DEBUG] 2014-05-27 09:32:01,592 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=3,nw_dst=10.0.3.1,actions=drop
[DEBUG] 2014-05-27 09:32:01,598 module:ovsdb,function:_send,router:openwrt3
request:
  id: 944584
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 944584
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-27 09:32:01,601 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=3,actions=strip_vlan,set_tunnel:103,output:3,output:2
[DEBUG] 2014-05-27 09:32:01,606 module:ovsdb,function:crud,router:openwrt3
CRUD operation (add): {'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 3, 'ip_vhost': '10.0.3.103/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr')])}
[DEBUG] 2014-05-27 09:32:01,608 module:ovsdb,function:_send,router:openwrt3
request:
  id: 418315
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ip_dvr:
      - map
      - - - addr
          - 10.0.3.1/24
        - - mode
          - dvr
      ip_vhost: 10.0.3.103/24
      peers:
      - set
      - - 192.168.1.101
        - 192.168.1.102
      vid: 3
      vni: 103
    table: NLAN_Subnet
    uuid-name: temp_15682
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_15682
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 418315
  result:
  - uuid:
    - uuid
    - 6adb1355-0b69-4bc9-ab14-66273a3c8c7a
  - count: 1
[DEBUG] 2014-05-27 09:32:01,610 module:ovsdb,function:_send,router:openwrt3
request:
  id: 989820
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 103
response:
  error: null
  id: 989820
  result:
  - rows:
    - _uuid:
      - uuid
      - 6adb1355-0b69-4bc9-ab14-66273a3c8c7a
      _version:
      - uuid
      - 6f60eb48-5a81-4944-a788-b538217e06ad
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - - - addr
          - 10.0.3.1/24
        - - mode
          - dvr
      ip_vhost: 10.0.3.103/24
      peers:
      - set
      - - 192.168.1.101
        - 192.168.1.102
      ports:
      - set
      - []
      vid: 3
      vni: 103
[INFO] 2014-05-27 09:32:01,614 module:nlan_agent,function:_route,router:openwrt3
function:subnets.add, index:['vni', 101], model:{'peers': ['192.168.1.102', '192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.103/24', 'vni': 101, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'spoke_dvr')])}
[DEBUG] 2014-05-27 09:32:01,615 module:ovsdb,function:_send,router:openwrt3
request:
  id: 415517
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 415517
  result:
  - rows:
    - _uuid:
      - uuid
      - 62b13f58-af42-4b90-9c13-a01b07808e21
      _version:
      - uuid
      - 87e1e59e-0e8c-451c-8ec8-ff6688702022
      bridges:
      - uuid
      - b1bd910c-f4bf-4aba-aceb-c8b9e20752f6
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - set
      - - - uuid
          - 6adb1355-0b69-4bc9-ab14-66273a3c8c7a
        - - uuid
          - ab363cde-e620-4f5a-b873-0535e6edeb22
      vxlan:
      - uuid
      - f310e0bb-7886-4235-ab0f-dbb6f0970d65
[DEBUG] 2014-05-27 09:32:01,619 module:ovsdb,function:_send,router:openwrt3
request:
  id: 784621
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 101
response:
  error: null
  id: 784621
  result:
  - rows: []
[INFO] 2014-05-27 09:32:01,620 module:subnets,function:add,router:openwrt3
Adding a subnet(vlan): 1
[DEBUG] 2014-05-27 09:32:01,620 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addbr br101
[DEBUG] 2014-05-27 09:32:01,625 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int_br101 tag=1 -- set interface int_br101 type=internal
[DEBUG] 2014-05-27 09:32:01,644 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int_dvr101 tag=1 -- set interface int_dvr101 type=internal
[DEBUG] 2014-05-27 09:32:01,670 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br101 int_br101
[DEBUG] 2014-05-27 09:32:01,676 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int_br101 promisc on
[DEBUG] 2014-05-27 09:32:01,679 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int_br101 up
[DEBUG] 2014-05-27 09:32:01,683 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int_dvr101 up
[DEBUG] 2014-05-27 09:32:01,686 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br101 up
[DEBUG] 2014-05-27 09:32:01,693 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns add ns101
[DEBUG] 2014-05-27 09:32:01,696 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link add veth-ns101 type veth peer name temp-ns101
[DEBUG] 2014-05-27 09:32:01,703 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev temp-ns101 netns ns101
[DEBUG] 2014-05-27 09:32:01,710 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns101 ip link set dev temp-ns101 name eth0
[DEBUG] 2014-05-27 09:32:01,714 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br101 veth-ns101
[DEBUG] 2014-05-27 09:32:01,717 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns101 promisc on
[DEBUG] 2014-05-27 09:32:01,722 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns101 up
[DEBUG] 2014-05-27 09:32:01,728 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns101 ip link set dev eth0 up
[DEBUG] 2014-05-27 09:32:01,734 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns101 ip addr add dev eth0 10.0.1.103/24
[DEBUG] 2014-05-27 09:32:01,738 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns101 ip route add default via 10.0.1.1 dev eth0
[DEBUG] 2014-05-27 09:32:01,741 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip addr add dev int_dvr101 10.0.1.1/24
[DEBUG] 2014-05-27 09:32:01,746 module:ovsdb,function:_send,router:openwrt3
request:
  id: 196642
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 196642
  result:
  - rows: []
[DEBUG] 2014-05-27 09:32:01,747 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=101,actions=mod_vlan_vid:1,resubmit(,10)
[DEBUG] 2014-05-27 09:32:01,753 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link show dev int_dvr101
[DEBUG] 2014-05-27 09:32:01,756 module:ovsdb,function:_send,router:openwrt3
request:
  id: 843701
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: Interface
    where:
    - - name
      - ==
      - int_dvr101
response:
  error: null
  id: 843701
  result:
  - rows:
    - _uuid:
      - uuid
      - b87d63da-2992-420c-b132-516e5e5e0e66
      _version:
      - uuid
      - 536aa121-dc9a-47db-8557-6cd9081a7689
      admin_state: up
      bfd:
      - map
      - []
      bfd_status:
      - map
      - []
      cfm_fault:
      - set
      - []
      cfm_fault_status:
      - set
      - []
      cfm_flap_count:
      - set
      - []
      cfm_health:
      - set
      - []
      cfm_mpid:
      - set
      - []
      cfm_remote_mpids:
      - set
      - []
      cfm_remote_opstate:
      - set
      - []
      duplex:
      - set
      - []
      external_ids:
      - map
      - []
      ifindex: 44
      ingress_policing_burst: 0
      ingress_policing_rate: 0
      lacp_current:
      - set
      - []
      link_resets: 2
      link_speed:
      - set
      - []
      link_state: up
      mac:
      - set
      - []
      mac_in_use: 7a:94:77:6a:18:c8
      mtu: 1500
      name: int_dvr101
      ofport: 7
      ofport_request:
      - set
      - []
      options:
      - map
      - []
      other_config:
      - map
      - []
      statistics:
      - map
      - - - collisions
          - 0
        - - rx_bytes
          - 0
        - - rx_crc_err
          - 0
        - - rx_dropped
          - 0
        - - rx_errors
          - 0
        - - rx_frame_err
          - 0
        - - rx_over_err
          - 0
        - - rx_packets
          - 0
        - - tx_bytes
          - 0
        - - tx_dropped
          - 0
        - - tx_errors
          - 0
        - - tx_packets
          - 0
      status:
      - map
      - - - driver_name
          - openvswitch
      type: internal
[DEBUG] 2014-05-27 09:32:01,764 module:ovsdb,function:_send,router:openwrt3
request:
  id: 661715
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: Interface
    where:
    - - name
      - ==
      - int_br101
response:
  error: null
  id: 661715
  result:
  - rows:
    - _uuid:
      - uuid
      - 7bf5e2a8-9a97-43a2-9d9c-4642d343bae7
      _version:
      - uuid
      - 2ee39d20-886c-4604-b932-4c70415e9585
      admin_state: up
      bfd:
      - map
      - []
      bfd_status:
      - map
      - []
      cfm_fault:
      - set
      - []
      cfm_fault_status:
      - set
      - []
      cfm_flap_count:
      - set
      - []
      cfm_health:
      - set
      - []
      cfm_mpid:
      - set
      - []
      cfm_remote_mpids:
      - set
      - []
      cfm_remote_opstate:
      - set
      - []
      duplex:
      - set
      - []
      external_ids:
      - map
      - []
      ifindex: 43
      ingress_policing_burst: 0
      ingress_policing_rate: 0
      lacp_current:
      - set
      - []
      link_resets: 2
      link_speed:
      - set
      - []
      link_state: up
      mac:
      - set
      - []
      mac_in_use: 82:20:2d:b9:96:2f
      mtu: 1500
      name: int_br101
      ofport: 6
      ofport_request:
      - set
      - []
      options:
      - map
      - []
      other_config:
      - map
      - []
      statistics:
      - map
      - - - collisions
          - 0
        - - rx_bytes
          - 0
        - - rx_crc_err
          - 0
        - - rx_dropped
          - 0
        - - rx_errors
          - 0
        - - rx_frame_err
          - 0
        - - rx_over_err
          - 0
        - - rx_packets
          - 0
        - - tx_bytes
          - 0
        - - tx_dropped
          - 0
        - - tx_errors
          - 0
        - - tx_packets
          - 0
      status:
      - map
      - - - driver_name
          - openvswitch
      type: internal
[DEBUG] 2014-05-27 09:32:01,771 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=0,priority=2,in_port=6,dl_type=0x0800,nw_dst=10.0.1.0/24,actions=normal
[DEBUG] 2014-05-27 09:32:01,776 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=10.0.0.0/8,actions=resubmit(,1)
[DEBUG] 2014-05-27 09:32:01,780 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=172.16.0.0/12,actions=resubmit(,1)
[DEBUG] 2014-05-27 09:32:01,783 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=192.168.0.0/16,actions=resubmit(,1)
[DEBUG] 2014-05-27 09:32:01,787 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=7,dl_type=0x0806,nw_src=10.0.1.1,nw_proto=2,actions=drop
[DEBUG] 2014-05-27 09:32:01,791 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=1,priority=0,in_port=6,actions=set_field:7a:94:77:6a:18:c8->dl_dst,output:7
[DEBUG] 2014-05-27 09:32:01,796 module:ovsdb,function:_send,router:openwrt3
request:
  id: 124
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 124
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-27 09:32:01,799 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=1,actions=strip_vlan,set_tunnel:101,output:2,output:4
[DEBUG] 2014-05-27 09:32:01,803 module:ovsdb,function:crud,router:openwrt3
CRUD operation (add): {'peers': ['192.168.1.102', '192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.103/24', 'vni': 101, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'spoke_dvr')])}
[DEBUG] 2014-05-27 09:32:01,805 module:ovsdb,function:_send,router:openwrt3
request:
  id: 374422
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ip_dvr:
      - map
      - - - addr
          - 10.0.1.1/24
        - - mode
          - spoke_dvr
      ip_vhost: 10.0.1.103/24
      peers:
      - set
      - - 192.168.1.10--- STDOUT from router:openwrt2,platform:openwrt
[INFO] 2014-05-27 09:32:00,945 module:nlan_agent,function:<module>,router:openwrt2
NLAN Agent initialization completed
[DEBUG] 2014-05-27 09:32:00,975 module:nlan_agent,function:<module>,router:openwrt2
__n__: {'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'platform': 'openwrt', 'share_dir': '/opt/nlan/share', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'logger': <logging.Logger object at 0xb754720c>, 'router': 'openwrt2', 'schema': 'ovsdb_nlan.schema', 'types': {'services': {'name': {'max': 1, '_description': 'Name of the network function', 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', '_description': 'Logical network interfaces to which the Network Function is attached', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, '_description': 'IP address of an OpenFlow Controller', 'key': {'_pattern': 'ofc_address', 'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, '_description': 'Virtual bridges: br-int and br-tun', 'key': {'enum': 'enabled', 'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, '_description': 'Network interface to which routing info is advertised', 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, '_description': 'Quagga/Zebra RIP daemon', 'key': {'enum': 'enabled', 'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', '_description': 'IP addresses of the remote hosts', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, '_description': 'IP address of the local host', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}}, 'subnets': {'peers': {'max': 'unlimited', '_description': 'Broadcast/Multicast trees for this subnet: IP addresses of the peer hosts', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}, 'vid': {'max': 1, '_description': 'VLAN ID', 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, '_description': 'Virtual host in a linux network namespace', 'key': {'_pattern': 'ipv4_prefix', 'type': 'string'}, 'min': 0}, 'vni': {'max': 1, '_description': 'Virtual network identifier', 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'ip_dvr': {'max': 3, '_description': 'Distributed Virtual Router setting', 'value': {'_pattern': {'dhcp': 'string', 'addr': 'ipv4_prefix', 'mode': 'dvr_mode'}, 'type': 'string'}, 'key': {'enum': ['set', ['addr', 'mode', 'dhcp']], 'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, '_description': 'Default GW address for this subnet', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', '_description': 'Physical/logical ports attached to this subnet', 'key': {'type': 'string'}, 'min': 0}}}, 'indexes': {'services': 'name', 'subnets': 'vni'}}
[INFO] 2014-05-27 09:32:01,049 module:nlan_agent,function:_route,router:openwrt2
function:bridges.add, model:{'ovs_bridges': 'enabled'}
[DEBUG] 2014-05-27 09:32:01,053 module:ovsdb,function:_send,router:openwrt2
request:
  id: 416610
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 416610
  result:
  - rows: []
[DEBUG] 2014-05-27 09:32:01,055 module:ovsdb,function:_send,router:openwrt2
request:
  id: 513185
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row: {}
    table: NLAN
response:
  error: null
  id: 513185
  result:
  - uuid:
    - uuid
    - dc6f10cf-7b46-4c7f-b832-7237c0ce5ea6
[DEBUG] 2014-05-27 09:32:01,056 module:ovsdb,function:_send,router:openwrt2
request:
  id: 276418
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Bridges
    where: []
response:
  error: null
  id: 276418
  result:
  - rows: []
[INFO] 2014-05-27 09:32:01,057 module:bridges,function:add,router:openwrt2
Adding bridges: br-int and br-tun
[DEBUG] 2014-05-27 09:32:01,057 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-br br-int
[DEBUG] 2014-05-27 09:32:01,072 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-br br-tun
[DEBUG] 2014-05-27 09:32:01,089 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl del-flows br-tun
[DEBUG] 2014-05-27 09:32:01,097 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int patch-int -- set interface patch-int type=patch options:peer=patch-tun
[DEBUG] 2014-05-27 09:32:01,201 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-tun patch-tun -- set interface patch-tun type=patch options:peer=patch-int
[DEBUG] 2014-05-27 09:32:01,212 module:ovsdb,function:_send,router:openwrt2
request:
  id: 358534
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: Interface
    where:
    - - name
      - ==
      - patch-tun
response:
  error: null
  id: 358534
  result:
  - rows:
    - _uuid:
      - uuid
      - 6a2a7f76-c0d4-4a71-a2d2-21c0602c1f14
      _version:
      - uuid
      - 3a3a5237-943c-468d-b39c-42030fbbe0c5
      admin_state:
      - set
      - []
      bfd:
      - map
      - []
      bfd_status:
      - map
      - []
      cfm_fault:
      - set
      - []
      cfm_fault_status:
      - set
      - []
      cfm_flap_count:
      - set
      - []
      cfm_health:
      - set
      - []
      cfm_mpid:
      - set
      - []
      cfm_remote_mpids:
      - set
      - []
      cfm_remote_opstate:
      - set
      - []
      duplex:
      - set
      - []
      external_ids:
      - map
      - []
      ifindex: 0
      ingress_policing_burst: 0
      ingress_policing_rate: 0
      lacp_current:
      - set
      - []
      link_resets:
      - set
      - []
      link_speed:
      - set
      - []
      link_state:
      - set
      - []
      mac:
      - set
      - []
      mac_in_use: de:84:dc:d1:fc:cb
      mtu:
      - set
      - []
      name: patch-tun
      ofport: 1
      ofport_request:
      - set
      - []
      options:
      - map
      - - - peer
          - patch-int
      other_config:
      - map
      - []
      statistics:
      - map
      - - - collisions
          - 0
        - - rx_bytes
          - 0
        - - rx_crc_err
          - 0
        - - rx_dropped
          - 0
        - - rx_errors
          - 0
        - - rx_frame_err
          - 0
        - - rx_over_err
          - 0
        - - rx_packets
          - 0
        - - tx_bytes
          - 0
        - - tx_dropped
          - 0
        - - tx_errors
          - 0
        - - tx_packets
          - 0
      status:
      - map
      - []
      type: patch
[DEBUG] 2014-05-27 09:32:01,221 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=1,actions=resubmit(,1)
[DEBUG] 2014-05-27 09:32:01,225 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=0,priority=0,actions=drop
[DEBUG] 2014-05-27 09:32:01,230 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=01:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,19)
[DEBUG] 2014-05-27 09:32:01,234 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=00:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,20)
[DEBUG] 2014-05-27 09:32:01,238 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=2,priority=0,actions=drop
[DEBUG] 2014-05-27 09:32:01,242 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=3,priority=0,actions=drop
[DEBUG] 2014-05-27 09:32:01,246 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=10,priority=1,actions=learn(table=20,hard_timeout=300,priority=1,NXM_OF_VLAN_TCI[0..11],NXM_OF_ETH_DST[]=NXM_OF_ETH_SRC[],load:0->NXM_OF_VLAN_TCI[],load:NXM_NX_TUN_ID[]->NXM_NX_TUN_ID[],output:NXM_OF_IN_PORT[]),output:1
[DEBUG] 2014-05-27 09:32:01,251 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=19,priority=0,actions=resubmit(,21)
[DEBUG] 2014-05-27 09:32:01,255 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=20,priority=0,actions=resubmit(,21)
[DEBUG] 2014-05-27 09:32:01,260 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=21,priority=0,actions=drop
[DEBUG] 2014-05-27 09:32:01,266 module:ovsdb,function:crud,router:openwrt2
CRUD operation (add): {'ovs_bridges': 'enabled'}
[DEBUG] 2014-05-27 09:32:01,267 module:ovsdb,function:_send,router:openwrt2
request:
  id: 568069
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ovs_bridges: enabled
    table: NLAN_Bridges
    uuid-name: temp_531776
  - mutations:
    - - bridges
      - insert
      - - set
        - - - named-uuid
            - temp_531776
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 568069
  result:
  - uuid:
    - uuid
    - c10449ad-0d80-4037-a2e4-b14b23b55361
  - count: 1
[DEBUG] 2014-05-27 09:32:01,269 module:ovsdb,function:_send,router:openwrt2
request:
  id: 45001
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Bridges
    where: []
response:
  error: null
  id: 45001
  result:
  - rows:
    - _uuid:
      - uuid
      - c10449ad-0d80-4037-a2e4-b14b23b55361
      _version:
      - uuid
      - 69696167-cc7f-4bf7-8f83-bdd6e0cbe829
      controller:
      - set
      - []
      ovs_bridges: enabled
[INFO] 2014-05-27 09:32:01,272 module:nlan_agent,function:_route,router:openwrt2
function:vxlan.add, model:{'remote_ips': ['192.168.1.103', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.102'}
[DEBUG] 2014-05-27 09:32:01,274 module:ovsdb,function:_send,router:openwrt2
request:
  id: 87620
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 87620
  result:
  - rows:
    - _uuid:
      - uuid
      - dc6f10cf-7b46-4c7f-b832-7237c0ce5ea6
      _version:
      - uuid
      - 17318e8c-f3fe-4226-8e58-a8d09002c1e8
      bridges:
      - uuid
      - c10449ad-0d80-4037-a2e4-b14b23b55361
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - set
      - []
      vxlan:
      - set
      - []
[DEBUG] 2014-05-27 09:32:01,276 module:ovsdb,function:_send,router:openwrt2
request:
  id: 995264
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_VXLAN
    where: []
response:
  error: null
  id: 995264
  result:
  - rows: []
[INFO] 2014-05-27 09:32:01,277 module:vxlan,function:add,router:openwrt2
Adding a VXLAN tunnel: vxlan_192.168.1.103
[DEBUG] 2014-05-27 09:32:01,278 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-tun vxlan_192.168.1.103 -- set interface vxlan_192.168.1.103 type=vxlan options:in_key=flow options:local_ip=192.168.1.102 options:out_key=flow options:remote_ip=192.168.1.103
[INFO] 2014-05-27 09:32:01,288 module:vxlan,function:add,router:openwrt2
Adding a VXLAN tunnel: vxlan_192.168.1.101
[DEBUG] 2014-05-27 09:32:01,288 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-tun vxlan_192.168.1.101 -- set interface vxlan_192.168.1.101 type=vxlan options:in_key=flow options:local_ip=192.168.1.102 options:out_key=flow options:remote_ip=192.168.1.101
[INFO] 2014-05-27 09:32:01,300 module:vxlan,function:add,router:openwrt2
Adding a VXLAN tunnel: vxlan_192.168.1.104
[DEBUG] 2014-05-27 09:32:01,300 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-tun vxlan_192.168.1.104 -- set interface vxlan_192.168.1.104 type=vxlan options:in_key=flow options:local_ip=192.168.1.102 options:out_key=flow options:remote_ip=192.168.1.104
[DEBUG] 2014-05-27 09:32:01,311 module:ovsdb,function:_send,router:openwrt2
request:
  id: 830914
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 830914
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-27 09:32:01,314 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=3,actions=resubmit(,2)
[DEBUG] 2014-05-27 09:32:01,318 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=2,actions=resubmit(,2)
[DEBUG] 2014-05-27 09:32:01,324 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=4,actions=resubmit(,2)
[DEBUG] 2014-05-27 09:32:01,329 module:ovsdb,function:crud,router:openwrt2
CRUD operation (add): {'remote_ips': ['192.168.1.103', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.102'}
[DEBUG] 2014-05-27 09:32:01,330 module:ovsdb,function:_send,router:openwrt2
request:
  id: 310179
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      local_ip: 192.168.1.102
      remote_ips:
      - set
      - - 192.168.1.103
        - 192.168.1.101
        - 192.168.1.104
    table: NLAN_VXLAN
    uuid-name: temp_669237
  - mutations:
    - - vxlan
      - insert
      - - set
        - - - named-uuid
            - temp_669237
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 310179
  result:
  - uuid:
    - uuid
    - 39bb020a-772a-459d-96e5-cfb2f832b267
  - count: 1
[DEBUG] 2014-05-27 09:32:01,333 module:ovsdb,function:_send,router:openwrt2
request:
  id: 900350
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_VXLAN
    where: []
response:
  error: null
  id: 900350
  result:
  - rows:
    - _uuid:
      - uuid
      - 39bb020a-772a-459d-96e5-cfb2f832b267
      _version:
      - uuid
      - 454415d5-3768-4082-9969-4d4816a6f60f
      local_ip: 192.168.1.102
      remote_ips:
      - set
      - - 192.168.1.101
        - 192.168.1.103
        - 192.168.1.104
[INFO] 2014-05-27 09:32:01,341 module:nlan_agent,function:_route,router:openwrt2
function:subnets.add, index:['vni', 1], model:{'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 2, 'ip_vhost': '192.168.100.102/24', 'default_gw': '192.168.100.1', 'ip_dvr': OrderedDict([('addr', '192.168.100.2/24'), ('mode', 'dvr')]), 'vni': 1}
[DEBUG] 2014-05-27 09:32:01,342 module:ovsdb,function:_send,router:openwrt2
request:
  id: 19856
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 19856
  result:
  - rows:
    - _uuid:
      - uuid
      - dc6f10cf-7b46-4c7f-b832-7237c0ce5ea6
      _version:
      - uuid
      - 7342892a-52f8-4b83-ae34-05687e2abc35
      bridges:
      - uuid
      - c10449ad-0d80-4037-a2e4-b14b23b55361
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - set
      - []
      vxlan:
      - uuid
      - 39bb020a-772a-459d-96e5-cfb2f832b267
[DEBUG] 2014-05-27 09:32:01,345 module:ovsdb,function:_send,router:openwrt2
request:
  id: 8066
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1
response:
  error: null
  id: 8066
  result:
  - rows: []
[INFO] 2014-05-27 09:32:01,347 module:subnets,function:add,router:openwrt2
Adding a subnet(vlan): 2
[DEBUG] 2014-05-27 09:32:01,347 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addbr br1
[DEBUG] 2014-05-27 09:32:01,355 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int_br1 tag=2 -- set interface int_br1 type=internal
[DEBUG] 2014-05-27 09:32:01,374 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int_dvr1 tag=2 -- set interface int_dvr1 type=internal
[DEBUG] 2014-05-27 09:32:01,395 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br1 int_br1
[DEBUG] 2014-05-27 09:32:01,401 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int_br1 promisc on
[DEBUG] 2014-05-27 09:32:01,403 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int_br1 up
[DEBUG] 2014-05-27 09:32:01,408 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int_dvr1 up
[DEBUG] 2014-05-27 09:32:01,412 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br1 up
[DEBUG] 2014-05-27 09:32:01,417 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns add ns1
[DEBUG] 2014-05-27 09:32:01,422 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link add veth-ns1 type veth peer name temp-ns1
[DEBUG] 2014-05-27 09:32:01,430 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev temp-ns1 netns ns1
[DEBUG] 2014-05-27 09:32:01,436 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns1 ip link set dev temp-ns1 name eth0
[DEBUG] 2014-05-27 09:32:01,441 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br1 veth-ns1
[DEBUG] 2014-05-27 09:32:01,446 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns1 promisc on
[DEBUG] 2014-05-27 09:32:01,450 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns1 up
[DEBUG] 2014-05-27 09:32:01,462 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns1 ip link set dev eth0 up
[DEBUG] 2014-05-27 09:32:01,467 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns1 ip addr add dev eth0 192.168.100.102/24
[DEBUG] 2014-05-27 09:32:01,471 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns1 ip route add default via 192.168.100.2 dev eth0
[DEBUG] 2014-05-27 09:32:01,476 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip addr add dev int_dvr1 192.168.100.2/24
[DEBUG] 2014-05-27 09:32:01,481 module:cmdutil,function:_cmd2,router:openwrt2
cmd: route
[DEBUG] 2014-05-27 09:32:01,484 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip route add default via 192.168.100.1
[DEBUG] 2014-05-27 09:32:01,487 module:ovsdb,function:_send,router:openwrt2
request:
  id: 899852
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 899852
  result:
  - rows: []
[DEBUG] 2014-05-27 09:32:01,488 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=1,actions=mod_vlan_vid:2,resubmit(,10)
[DEBUG] 2014-05-27 09:32:01,494 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=2,nw_dst=192.168.100.2,actions=drop
[DEBUG] 2014-05-27 09:32:01,500 module:ovsdb,function:_send,router:openwrt2
request:
  id: 809540
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 809540
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-27 09:32:01,504 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=2,actions=strip_vlan,set_tunnel:1,output:3,output:2
[DEBUG] 2014-05-27 09:32:01,508 module:ovsdb,function:crud,router:openwrt2
CRUD operation (add): {'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 2, 'ip_vhost': '192.168.100.102/24', 'default_gw': '192.168.100.1', 'ip_dvr': OrderedDict([('addr', '192.168.100.2/24'), ('mode', 'dvr')]), 'vni': 1}
[DEBUG] 2014-05-27 09:32:01,510 module:ovsdb,function:_send,router:openwrt2
request:
  id: 772456
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      default_gw: 192.168.100.1
      ip_dvr:
      - map
      - - - addr
          - 192.168.100.2/24
        - - mode
          - dvr
      ip_vhost: 192.168.100.102/24
      peers:
      - set
      - - 192.168.1.101
        - 192.168.1.103
      vid: 2
      vni: 1
    table: NLAN_Subnet
    uuid-name: temp_993851
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_993851
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 772456
  result:
  - uuid:
    - uuid
    - 1ac1ef59-5670-4a74-9050-14d97d6907e0
  - count: 1
[DEBUG] 2014-05-27 09:32:01,513 module:ovsdb,function:_send,router:openwrt2
request:
  id: 430079
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1
response:
  error: null
  id: 430079
  result:
  - rows:
    - _uuid:
      - uuid
      - 1ac1ef59-5670-4a74-9050-14d97d6907e0
      _version:
      - uuid
      - 86da802f-8541-4441-b598-f62b7aa08b7a
      default_gw: 192.168.100.1
      ip_dvr:
      - map
      - - - addr
          - 192.168.100.2/24
        - - mode
          - dvr
      ip_vhost: 192.168.100.102/24
      peers:
      - set
      - - 192.168.1.101
        - 192.168.1.103
      ports:
      - set
      - []
      vid: 2
      vni: 1
[INFO] 2014-05-27 09:32:01,517 module:nlan_agent,function:_route,router:openwrt2
function:subnets.add, index:['vni', 103], model:{'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 3, 'ip_vhost': '10.0.3.102/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr')])}
[DEBUG] 2014-05-27 09:32:01,518 module:ovsdb,function:_send,router:openwrt2
request:
  id: 473216
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 473216
  result:
  - rows:
    - _uuid:
      - uuid
      - dc6f10cf-7b46-4c7f-b832-7237c0ce5ea6
      _version:
      - uuid
      - dd2fdaa5-f72c-4e87-b4a5-03f50322aefe
      bridges:
      - uuid
      - c10449ad-0d80-4037-a2e4-b14b23b55361
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - uuid
      - 1ac1ef59-5670-4a74-9050-14d97d6907e0
      vxlan:
      - uuid
      - 39bb020a-772a-459d-96e5-cfb2f832b267
[DEBUG] 2014-05-27 09:32:01,521 module:ovsdb,function:_send,router:openwrt2
request:
  id: 678180
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 103
response:
  error: null
  id: 678180
  result:
  - rows: []
[INFO] 2014-05-27 09:32:01,522 module:subnets,function:add,router:openwrt2
Adding a subnet(vlan): 3
[DEBUG] 2014-05-27 09:32:01,522 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addbr br103
[DEBUG] 2014-05-27 09:32:01,527 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int_br103 tag=3 -- set interface int_br103 type=internal
[DEBUG] 2014-05-27 09:32:01,547 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int_dvr103 tag=3 -- set interface int_dvr103 type=internal
[DEBUG] 2014-05-27 09:32:01,567 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br103 int_br103
[DEBUG] 2014-05-27 09:32:01,573 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int_br103 promisc on
[DEBUG] 2014-05-27 09:32:01,575 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int_br103 up
[DEBUG] 2014-05-27 09:32:01,581 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int_dvr103 up
[DEBUG] 2014-05-27 09:32:01,584 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br103 up
[DEBUG] 2014-05-27 09:32:01,590 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns add ns103
[DEBUG] 2014-05-27 09:32:01,597 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link add veth-ns103 type veth peer name temp-ns103
[DEBUG] 2014-05-27 09:32:01,607 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev temp-ns103 netns ns103
[DEBUG] 2014-05-27 09:32:01,612 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns103 ip link set dev temp-ns103 name eth0
[DEBUG] 2014-05-27 09:32:01,622 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br103 veth-ns103
[DEBUG] 2014-05-27 09:32:01,629 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns103 promisc on
[DEBUG] 2014-05-27 09:32:01,634 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns103 up
[DEBUG] 2014-05-27 09:32:01,642 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns103 ip link set dev eth0 up
[DEBUG] 2014-05-27 09:32:01,647 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns103 ip addr add dev eth0 10.0.3.102/24
[DEBUG] 2014-05-27 09:32:01,649 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns103 ip route add default via 10.0.3.1 dev eth0
[DEBUG] 2014-05-27 09:32:01,652 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip addr add dev int_dvr103 10.0.3.1/24
[DEBUG] 2014-05-27 09:32:01,655 module:ovsdb,function:_send,router:openwrt2
request:
  id: 423659
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 423659
  result:
  - rows: []
[DEBUG] 2014-05-27 09:32:01,656 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=103,actions=mod_vlan_vid:3,resubmit(,10)
[DEBUG] 2014-05-27 09:32:01,663 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=3,nw_dst=10.0.3.1,actions=drop
[DEBUG] 2014-05-27 09:32:01,671 module:ovsdb,function:_send,router:openwrt2
request:
  id: 97125
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 97125
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-27 09:32:01,674 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=3,actions=strip_vlan,set_tunnel:103,output:3,output:2
[DEBUG] 2014-05-27 09:32:01,681 module:ovsdb,function:crud,router:openwrt2
CRUD operation (add): {'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 3, 'ip_vhost': '10.0.3.102/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr')])}
[DEBUG] 2014-05-27 09:32:01,683 module:ovsdb,function:_send,router:openwrt2
request:
  id: 443522
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ip_dvr:
      - map
      - - - addr
          - 10.0.3.1/24
        - - mode
          - dvr
      ip_vhost: 10.0.3.102/24
      peers:
      - set
      - - 192.168.1.101
        - 192.168.1.103
      vid: 3
      vni: 103
    table: NLAN_Subnet
    uuid-name: temp_997199
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_997199
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 443522
  result:
  - uuid:
    - uuid
    - 92f88ced-bd5d-41e5-8a74-91c6fee6dbd3
  - count: 1
[DEBUG] 2014-05-27 09:32:01,685 module:ovsdb,function:_send,router:openwrt2
request:
  id: 999021
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 103
response:
  error: null
  id: 999021
  result:
  - rows:
    - _uuid:
      - uuid
      - 92f88ced-bd5d-41e5-8a74-91c6fee6dbd3
      _version:
      - uuid
      - d4389b0f-8761-492f-a620-5670c27d23e7
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - - - addr
          - 10.0.3.1/24
        - - mode
          - dvr
      ip_vhost: 10.0.3.102/24
      peers:
      - set
      - - 192.168.1.101
        - 192.168.1.103
      ports:
      - set
      - []
      vid: 3
      vni: 103
[INFO] 2014-05-27 09:32:01,687 module:nlan_agent,function:_route,router:openwrt2
function:subnets.add, index:['vni', 101], model:{'peers': ['192.168.1.103', '192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.102/24', 'vni': 101, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'spoke_dvr')])}
[DEBUG] 2014-05-27 09:32:01,688 module:ovsdb,function:_send,router:openwrt2
request:
  id: 39080
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 39080
  result:
  - rows:
    - _uuid:
      - uuid
      - dc6f10cf-7b46-4c7f-b832-7237c0ce5ea6
      _version:
      - uuid
      - 0527957f-331a-4a9a-9b8b-4f871a64b9ea
      bridges:
      - uuid
      - c10449ad-0d80-4037-a2e4-b14b23b55361
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - set
      - - - uuid
          - 1ac1ef59-5670-4a74-9050-14d97d6907e0
        - - uuid
          - 92f88ced-bd5d-41e5-8a74-91c6fee6dbd3
      vxlan:
      - uuid
      - 39bb020a-772a-459d-96e5-cfb2f832b267
[DEBUG] 2014-05-27 09:32:01,692 module:ovsdb,function:_send,router:openwrt2
request:
  id: 74627
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 101
response:
  error: null
  id: 74627
  result:
  - rows: []
[INFO] 2014-05-27 09:32:01,692 module:subnets,function:add,router:openwrt2
Adding a subnet(vlan): 1
[DEBUG] 2014-05-27 09:32:01,693 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addbr br101
[DEBUG] 2014-05-27 09:32:01,697 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int_br101 tag=1 -- set interface int_br101 type=internal
[DEBUG] 2014-05-27 09:32:01,715 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int_dvr101 tag=1 -- set interface int_dvr101 type=internal
[DEBUG] 2014-05-27 09:32:01,735 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br101 int_br101
[DEBUG] 2014-05-27 09:32:01,737 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int_br101 promisc on
[DEBUG] 2014-05-27 09:32:01,741 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int_br101 up
[DEBUG] 2014-05-27 09:32:01,744 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int_dvr101 up
[DEBUG] 2014-05-27 09:32:01,746 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br101 up
[DEBUG] 2014-05-27 09:32:01,752 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns add ns101
[DEBUG] 2014-05-27 09:32:01,756 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link add veth-ns101 type veth peer name temp-ns101
[DEBUG] 2014-05-27 09:32:01,763 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev temp-ns101 netns ns101
[DEBUG] 2014-05-27 09:32:01,768 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns101 ip link set dev temp-ns101 name eth0
[DEBUG] 2014-05-27 09:32:01,773 module:cmdutil,function:_cmd2,route2
        - 192.168.1.104
      vid: 1
      vni: 101
    table: NLAN_Subnet
    uuid-name: temp_895170
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_895170
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 374422
  result:
  - uuid:
    - uuid
    - ccfb3dc1-0da3-49db-8376-7e6d3da14005
  - count: 1
[DEBUG] 2014-05-27 09:32:01,807 module:ovsdb,function:_send,router:openwrt3
request:
  id: 896522
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 101
response:
  error: null
  id: 896522
  result:
  - rows:
    - _uuid:
      - uuid
      - ccfb3dc1-0da3-49db-8376-7e6d3da14005
      _version:
      - uuid
      - efa50236-8752-46cd-bf20-1d3b4bc19748
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - - - addr
          - 10.0.1.1/24
        - - mode
          - spoke_dvr
      ip_vhost: 10.0.1.103/24
      peers:
      - set
      - - 192.168.1.102
        - 192.168.1.104
      ports:
      - set
      - []
      vid: 1
      vni: 101
[INFO] 2014-05-27 09:32:01,809 module:nlan_agent,function:<module>,router:openwrt3
NLAN Agent execution completed
--- RESPONSE from router:openwrt3,platform:openwrt
message: Execution completed
exit: 0
r:openwrt2
cmd: brctl addif br101 veth-ns101
[DEBUG] 2014-05-27 09:32:01,778 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns101 promisc on
[DEBUG] 2014-05-27 09:32:01,782 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns101 up
[DEBUG] 2014-05-27 09:32:01,788 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns101 ip link set dev eth0 up
[DEBUG] 2014-05-27 09:32:01,796 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns101 ip addr add dev eth0 10.0.1.102/24
[DEBUG] 2014-05-27 09:32:01,800 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns101 ip route add default via 10.0.1.1 dev eth0
[DEBUG] 2014-05-27 09:32:01,803 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip addr add dev int_dvr101 10.0.1.1/24
[DEBUG] 2014-05-27 09:32:01,808 module:ovsdb,function:_send,router:openwrt2
request:
  id: 968928
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 968928
  result:
  - rows: []
[DEBUG] 2014-05-27 09:32:01,812 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=101,actions=mod_vlan_vid:1,resubmit(,10)
[DEBUG] 2014-05-27 09:32:01,816 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link show dev int_dvr101
[DEBUG] 2014-05-27 09:32:01,819 module:ovsdb,function:_send,router:openwrt2
request:
  id: 431435
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: Interface
    where:
    - - name
      - ==
      - int_dvr101
response:
  error: null
  id: 431435
  result:
  - rows:
    - _uuid:
      - uuid
      - 9299d66d-c048-4ac7-9f41-3caa3a70daaa
      _version:
      - uuid
      - e3263ae5-a147-4487-8152-2131027477d6
      admin_state: up
      bfd:
      - map
      - []
      bfd_status:
      - map
      - []
      cfm_fault:
      - set
      - []
      cfm_fault_status:
      - set
      - []
      cfm_flap_count:
      - set
      - []
      cfm_health:
      - set
      - []
      cfm_mpid:
      - set
      - []
      cfm_remote_mpids:
      - set
      - []
      cfm_remote_opstate:
      - set
      - []
      duplex:
      - set
      - []
      external_ids:
      - map
      - []
      ifindex: 44
      ingress_policing_burst: 0
      ingress_policing_rate: 0
      lacp_current:
      - set
      - []
      link_resets: 2
      link_speed:
      - set
      - []
      link_state: up
      mac:
      - set
      - []
      mac_in_use: 3a:53:cd:2d:73:8e
      mtu: 1500
      name: int_dvr101
      ofport: 7
      ofport_request:
      - set
      - []
      options:
      - map
      - []
      other_config:
      - map
      - []
      statistics:
      - map
      - - - collisions
          - 0
        - - rx_bytes
          - 0
        - - rx_crc_err
          - 0
        - - rx_dropped
          - 0
        - - rx_errors
          - 0
        - - rx_frame_err
          - 0
        - - rx_over_err
          - 0
        - - rx_packets
          - 0
        - - tx_bytes
          - 0
        - - tx_dropped
          - 0
        - - tx_errors
          - 0
        - - tx_packets
          - 0
      status:
      - map
      - - - driver_name
          - openvswitch
      type: internal
[DEBUG] 2014-05-27 09:32:01,826 module:ovsdb,function:_send,router:openwrt2
request:
  id: 343687
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: Interface
    where:
    - - name
      - ==
      - int_br101
response:
  error: null
  id: 343687
  result:
  - rows:
    - _uuid:
      - uuid
      - 2f755ebb-b8b0-4b4b-83d3-bb656aa340db
      _version:
      - uuid
      - aa76c445-0f67-4a76-a046-a6ccaf643040
      admin_state: up
      bfd:
      - map
      - []
      bfd_status:
      - map
      - []
      cfm_fault:
      - set
      - []
      cfm_fault_status:
      - set
      - []
      cfm_flap_count:
      - set
      - []
      cfm_health:
      - set
      - []
      cfm_mpid:
      - set
      - []
      cfm_remote_mpids:
      - set
      - []
      cfm_remote_opstate:
      - set
      - []
      duplex:
      - set
      - []
      external_ids:
      - map
      - []
      ifindex: 43
      ingress_policing_burst: 0
      ingress_policing_rate: 0
      lacp_current:
      - set
      - []
      link_resets: 2
      link_speed:
      - set
      - []
      link_state: up
      mac:
      - set
      - []
      mac_in_use: 02:26:8c:d3:f7:20
      mtu: 1500
      name: int_br101
      ofport: 6
      ofport_request:
      - set
      - []
      options:
      - map
      - []
      other_config:
      - map
      - []
      statistics:
      - map
      - - - collisions
          - 0
        - - rx_bytes
          - 0
        - - rx_crc_err
          - 0
        - - rx_dropped
          - 0
        - - rx_errors
          - 0
        - - rx_frame_err
          - 0
        - - rx_over_err
          - 0
        - - rx_packets
          - 0
        - - tx_bytes
          - 0
        - - tx_dropped
          - 0
        - - tx_errors
          - 0
        - - tx_packets
          - 0
      status:
      - map
      - - - driver_name
          - openvswitch
      type: internal
[DEBUG] 2014-05-27 09:32:01,834 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=0,priority=2,in_port=6,dl_type=0x0800,nw_dst=10.0.1.0/24,actions=normal
[DEBUG] 2014-05-27 09:32:01,839 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=10.0.0.0/8,actions=resubmit(,1)
[DEBUG] 2014-05-27 09:32:01,844 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=172.16.0.0/12,actions=resubmit(,1)
[DEBUG] 2014-05-27 09:32:01,848 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=192.168.0.0/16,actions=resubmit(,1)
[DEBUG] 2014-05-27 09:32:01,853 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=7,dl_type=0x0806,nw_src=10.0.1.1,nw_proto=2,actions=drop
[DEBUG] 2014-05-27 09:32:01,855 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=1,priority=0,in_port=6,actions=set_field:3a:53:cd:2d:73:8e->dl_dst,output:7
[DEBUG] 2014-05-27 09:32:01,860 module:ovsdb,function:_send,router:openwrt2
request:
  id: 374229
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 374229
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-27 09:32:01,863 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=1,actions=strip_vlan,set_tunnel:101,output:2,output:4
[DEBUG] 2014-05-27 09:32:01,867 module:ovsdb,function:crud,router:openwrt2
CRUD operation (add): {'peers': ['192.168.1.103', '192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.102/24', 'vni': 101, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'spoke_dvr')])}
[DEBUG] 2014-05-27 09:32:01,868 module:ovsdb,function:_send,router:openwrt2
request:
  id: 471169
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ip_dvr:
      - map
      - - - addr
          - 10.0.1.1/24
        - - mode
          - spoke_dvr
      ip_vhost: 10.0.1.102/24
      peers:
      - set
      - - 192.168.1.103
        - 192.168.1.104
      vid: 1
      vni: 101
    table: NLAN_Subnet
    uuid-name: temp_197731
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_197731
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 471169
  result:
  - uuid:
    - uuid
    - 5a2ea4c2-11bc-4024-a20e-de5dab667d8f
  - count: 1
[DEBUG] 2014-05-27 09:32:01,869 module:ovsdb,function:_send,router:openwrt2
request:
  id: 825939
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 101
response:
  error: null
  id: 825939
  result:
  - rows:
    - _uuid:
      - uuid
      - 5a2ea4c2-11bc-4024-a20e-de5dab667d8f
      _version:
      - uuid
      - 6edc1309-82ff-4c49-ad74-b32ab94bb3fa
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - - - addr
          - 10.0.1.1/24
        - - mode
          - spoke_dvr
      ip_vhost: 10.0.1.102/24
      peers:
      - set
      - - 192.168.1.103
        - 192.168.1.104
      ports:
      - set
      - []
      vid: 1
      vni: 101
[INFO] 2014-05-27 09:32:01,871 module:nlan_agent,function:<module>,router:openwrt2
NLAN Agent execution completed
--- RESPONSE from router:openwrt2,platform:openwrt
message: Execution completed
exit: 0
--- STDOUT from router:openwrt1,platform:openwrt
[INFO] 2014-05-27 09:32:00,931 module:nlan_agent,function:<module>,router:openwrt1
NLAN Agent initialization completed
[DEBUG] 2014-05-27 09:32:00,932 module:nlan_agent,function:<module>,router:openwrt1
__n__: {'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'platform': 'openwrt', 'share_dir': '/opt/nlan/share', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'logger': <logging.Logger object at 0xb75261ac>, 'router': 'openwrt1', 'schema': 'ovsdb_nlan.schema', 'types': {'services': {'name': {'max': 1, '_description': 'Name of the network function', 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', '_description': 'Logical network interfaces to which the Network Function is attached', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, '_description': 'IP address of an OpenFlow Controller', 'key': {'_pattern': 'ofc_address', 'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, '_description': 'Virtual bridges: br-int and br-tun', 'key': {'enum': 'enabled', 'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, '_description': 'Network interface to which routing info is advertised', 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, '_description': 'Quagga/Zebra RIP daemon', 'key': {'enum': 'enabled', 'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', '_description': 'IP addresses of the remote hosts', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, '_description': 'IP address of the local host', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}}, 'subnets': {'peers': {'max': 'unlimited', '_description': 'Broadcast/Multicast trees for this subnet: IP addresses of the peer hosts', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}, 'vid': {'max': 1, '_description': 'VLAN ID', 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, '_description': 'Virtual host in a linux network namespace', 'key': {'_pattern': 'ipv4_prefix', 'type': 'string'}, 'min': 0}, 'vni': {'max': 1, '_description': 'Virtual network identifier', 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'ip_dvr': {'max': 3, '_description': 'Distributed Virtual Router setting', 'value': {'_pattern': {'dhcp': 'string', 'addr': 'ipv4_prefix', 'mode': 'dvr_mode'}, 'type': 'string'}, 'key': {'enum': ['set', ['addr', 'mode', 'dhcp']], 'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, '_description': 'Default GW address for this subnet', 'key': {'_pattern': 'ipv4_address', 'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', '_description': 'Physical/logical ports attached to this subnet', 'key': {'type': 'string'}, 'min': 0}}}, 'indexes': {'services': 'name', 'subnets': 'vni'}}
[INFO] 2014-05-27 09:32:00,985 module:nlan_agent,function:_route,router:openwrt1
function:bridges.add, model:{'ovs_bridges': 'enabled'}
[DEBUG] 2014-05-27 09:32:00,991 module:ovsdb,function:_send,router:openwrt1
request:
  id: 736916
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 736916
  result:
  - rows: []
[DEBUG] 2014-05-27 09:32:00,993 module:ovsdb,function:_send,router:openwrt1
request:
  id: 822181
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row: {}
    table: NLAN
response:
  error: null
  id: 822181
  result:
  - uuid:
    - uuid
    - cdb2c6ec-eb8e-468c-b6fe-0646f2a79654
[DEBUG] 2014-05-27 09:32:00,994 module:ovsdb,function:_send,router:openwrt1
request:
  id: 672919
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Bridges
    where: []
response:
  error: null
  id: 672919
  result:
  - rows: []
[INFO] 2014-05-27 09:32:00,995 module:bridges,function:add,router:openwrt1
Adding bridges: br-int and br-tun
[DEBUG] 2014-05-27 09:32:00,995 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-br br-int
[DEBUG] 2014-05-27 09:32:01,007 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-br br-tun
[DEBUG] 2014-05-27 09:32:01,028 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl del-flows br-tun
[DEBUG] 2014-05-27 09:32:01,042 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int patch-int -- set interface patch-int type=patch options:peer=patch-tun
[DEBUG] 2014-05-27 09:32:01,051 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-tun patch-tun -- set interface patch-tun type=patch options:peer=patch-int
[DEBUG] 2014-05-27 09:32:01,062 module:ovsdb,function:_send,router:openwrt1
request:
  id: 263259
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: Interface
    where:
    - - name
      - ==
      - patch-tun
response:
  error: null
  id: 263259
  result:
  - rows:
    - _uuid:
      - uuid
      - ac112139-35df-4414-a529-c5e171585337
      _version:
      - uuid
      - 4c2115ef-a1f2-4de9-b65d-3f527e70b833
      admin_state:
      - set
      - []
      bfd:
      - map
      - []
      bfd_status:
      - map
      - []
      cfm_fault:
      - set
      - []
      cfm_fault_status:
      - set
      - []
      cfm_flap_count:
      - set
      - []
      cfm_health:
      - set
      - []
      cfm_mpid:
      - set
      - []
      cfm_remote_mpids:
      - set
      - []
      cfm_remote_opstate:
      - set
      - []
      duplex:
      - set
      - []
      external_ids:
      - map
      - []
      ifindex: 0
      ingress_policing_burst: 0
      ingress_policing_rate: 0
      lacp_current:
      - set
      - []
      link_resets:
      - set
      - []
      link_speed:
      - set
      - []
      link_state:
      - set
      - []
      mac:
      - set
      - []
      mac_in_use: 2a:d0:8b:2d:6c:e6
      mtu:
      - set
      - []
      name: patch-tun
      ofport: 1
      ofport_request:
      - set
      - []
      options:
      - map
      - - - peer
          - patch-int
      other_config:
      - map
      - []
      statistics:
      - map
      - - - collisions
          - 0
        - - rx_bytes
          - 0
        - - rx_crc_err
          - 0
        - - rx_dropped
          - 0
        - - rx_errors
          - 0
        - - rx_frame_err
          - 0
        - - rx_over_err
          - 0
        - - rx_packets
          - 0
        - - tx_bytes
          - 0
        - - tx_dropped
          - 0
        - - tx_errors
          - 0
        - - tx_packets
          - 0
      status:
      - map
      - []
      type: patch
[DEBUG] 2014-05-27 09:32:01,068 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=1,actions=resubmit(,1)
[DEBUG] 2014-05-27 09:32:01,072 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=0,actions=drop
[DEBUG] 2014-05-27 09:32:01,077 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=01:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,19)
[DEBUG] 2014-05-27 09:32:01,082 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=00:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,20)
[DEBUG] 2014-05-27 09:32:01,087 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=2,priority=0,actions=drop
[DEBUG] 2014-05-27 09:32:01,091 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=3,priority=0,actions=drop
[DEBUG] 2014-05-27 09:32:01,097 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=10,priority=1,actions=learn(table=20,hard_timeout=300,priority=1,NXM_OF_VLAN_TCI[0..11],NXM_OF_ETH_DST[]=NXM_OF_ETH_SRC[],load:0->NXM_OF_VLAN_TCI[],load:NXM_NX_TUN_ID[]->NXM_NX_TUN_ID[],output:NXM_OF_IN_PORT[]),output:1
[DEBUG] 2014-05-27 09:32:01,101 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=19,priority=0,actions=resubmit(,21)
[DEBUG] 2014-05-27 09:32:01,109 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=20,priority=0,actions=resubmit(,21)
[DEBUG] 2014-05-27 09:32:01,113 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=21,priority=0,actions=drop
[DEBUG] 2014-05-27 09:32:01,116 module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'ovs_bridges': 'enabled'}
[DEBUG] 2014-05-27 09:32:01,118 module:ovsdb,function:_send,router:openwrt1
request:
  id: 283859
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ovs_bridges: enabled
    table: NLAN_Bridges
    uuid-name: temp_771977
  - mutations:
    - - bridges
      - insert
      - - set
        - - - named-uuid
            - temp_771977
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 283859
  result:
  - uuid:
    - uuid
    - e9a6dc9b-9a44-4e66-9a45-2d76d5cc73f8
  - count: 1
[DEBUG] 2014-05-27 09:32:01,121 module:ovsdb,function:_send,router:openwrt1
request:
  id: 550168
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Bridges
    where: []
response:
  error: null
  id: 550168
  result:
  - rows:
    - _uuid:
      - uuid
      - e9a6dc9b-9a44-4e66-9a45-2d76d5cc73f8
      _version:
      - uuid
      - 68188873-d005-4f9f-b368-796f4449bc01
      controller:
      - set
      - []
      ovs_bridges: enabled
[INFO] 2014-05-27 09:32:01,125 module:nlan_agent,function:_route,router:openwrt1
function:gateway.add, model:{'network': 'eth2', 'rip': 'enabled'}
[DEBUG] 2014-05-27 09:32:01,126 module:ovsdb,function:_send,router:openwrt1
request:
  id: 836472
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 836472
  result:
  - rows:
    - _uuid:
      - uuid
      - cdb2c6ec-eb8e-468c-b6fe-0646f2a79654
      _version:
      - uuid
      - c32b26cf-7a62-44d4-8872-2de9d2f598e6
      bridges:
      - uuid
      - e9a6dc9b-9a44-4e66-9a45-2d76d5cc73f8
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - set
      - []
      vxlan:
      - set
      - []
[DEBUG] 2014-05-27 09:32:01,128 module:ovsdb,function:_send,router:openwrt1
request:
  id: 273864
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Gateway
    where: []
response:
  error: null
  id: 273864
  result:
  - rows: []
[INFO] 2014-05-27 09:32:01,129 module:gateway,function:add,router:openwrt1
Adding a gateway router: rip
[DEBUG] 2014-05-27 09:32:01,130 module:cmdutil,function:_cmd2,router:openwrt1
cmd: vtysh -c configure terminal -c interface eth2 -c link-detect -c exit -c router rip -c version 2 -c redistribute connected -c network eth2 -c exit -c exit -c write -c exit
[DEBUG] 2014-05-27 09:32:01,168 module:cmdutil,function:_cmd2,router:openwrt1
cmd: /etc/init.d/quagga start
[DEBUG] 2014-05-27 09:32:01,203 module:cmdutil,function:_cmd2,router:openwrt1
cmd: vtysh -c configure terminal -c interface eth2 -c link-detect -c exit -c router rip -c version 2 -c redistribute connected -c network eth2 -c exit -c exit -c write -c exit
[DEBUG] 2014-05-27 09:32:01,251 module:cmdutil,function:_cmd2,router:openwrt1
cmd: /etc/init.d/quagga restart
[DEBUG] 2014-05-27 09:32:03,305 module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'network': 'eth2', 'rip': 'enabled'}
[DEBUG] 2014-05-27 09:32:03,306 module:ovsdb,function:_send,router:openwrt1
request:
  id: 355501
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      network: eth2
      rip: enabled
    table: NLAN_Gateway
    uuid-name: temp_160518
  - mutations:
    - - gateway
      - insert
      - - set
        - - - named-uuid
            - temp_160518
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 355501
  result:
  - uuid:
    - uuid
    - 212b91d8-7088-48fb-8e82-65cbde8777a5
  - count: 1
[DEBUG] 2014-05-27 09:32:03,307 module:ovsdb,function:_send,router:openwrt1
request:
  id: 332896
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Gateway
    where: []
response:
  error: null
  id: 332896
  result:
  - rows:
    - _uuid:
      - uuid
      - 212b91d8-7088-48fb-8e82-65cbde8777a5
      _version:
      - uuid
      - afb924da-64ee-411c-8d24-c46c7b108cc0
      network: eth2
      rip: enabled
[INFO] 2014-05-27 09:32:03,309 module:nlan_agent,function:_route,router:openwrt1
function:vxlan.add, model:{'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.104'], 'local_ip': '192.168.1.101'}
[DEBUG] 2014-05-27 09:32:03,309 module:ovsdb,function:_send,router:openwrt1
request:
  id: 588769
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 588769
  result:
  - rows:
    - _uuid:
      - uuid
      - cdb2c6ec-eb8e-468c-b6fe-0646f2a79654
      _version:
      - uuid
      - 1eff86d5-f83d-46ec-9684-b6bdc78d9341
      bridges:
      - uuid
      - e9a6dc9b-9a44-4e66-9a45-2d76d5cc73f8
      gateway:
      - uuid
      - 212b91d8-7088-48fb-8e82-65cbde8777a5
      services:
      - set
      - []
      subnets:
      - set
      - []
      vxlan:
      - set
      - []
[DEBUG] 2014-05-27 09:32:03,312 module:ovsdb,function:_send,router:openwrt1
request:
  id: 59484
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_VXLAN
    where: []
response:
  error: null
  id: 59484
  result:
  - rows: []
[INFO] 2014-05-27 09:32:03,312 module:vxlan,function:add,router:openwrt1
Adding a VXLAN tunnel: vxlan_192.168.1.103
[DEBUG] 2014-05-27 09:32:03,313 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-tun vxlan_192.168.1.103 -- set interface vxlan_192.168.1.103 type=vxlan options:in_key=flow options:local_ip=192.168.1.101 options:out_key=flow options:remote_ip=192.168.1.103
[INFO] 2014-05-27 09:32:03,320 module:vxlan,function:add,router:openwrt1
Adding a VXLAN tunnel: vxlan_192.168.1.102
[DEBUG] 2014-05-27 09:32:03,320 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-tun vxlan_192.168.1.102 -- set interface vxlan_192.168.1.102 type=vxlan options:in_key=flow options:local_ip=192.168.1.101 options:out_key=flow options:remote_ip=192.168.1.102
[INFO] 2014-05-27 09:32:03,342 module:vxlan,function:add,router:openwrt1
Adding a VXLAN tunnel: vxlan_192.168.1.104
[DEBUG] 2014-05-27 09:32:03,343 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-tun vxlan_192.168.1.104 -- set interface vxlan_192.168.1.104 type=vxlan options:in_key=flow options:local_ip=192.168.1.101 options:out_key=flow options:remote_ip=192.168.1.104
[DEBUG] 2014-05-27 09:32:03,351 module:ovsdb,function:_send,router:openwrt1
request:
  id: 796775
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 796775
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-27 09:32:03,353 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=3,actions=resubmit(,2)
[DEBUG] 2014-05-27 09:32:03,356 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=2,actions=resubmit(,2)
[DEBUG] 2014-05-27 09:32:03,359 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=4,actions=resubmit(,2)
[DEBUG] 2014-05-27 09:32:03,362 module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.104'], 'local_ip': '192.168.1.101'}
[DEBUG] 2014-05-27 09:32:03,362 module:ovsdb,function:_send,router:openwrt1
request:
  id: 286902
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      local_ip: 192.168.1.101
      remote_ips:
      - set
      - - 192.168.1.103
        - 192.168.1.102
        - 192.168.1.104
    table: NLAN_VXLAN
    uuid-name: temp_406221
  - mutations:
    - - vxlan
      - insert
      - - set
        - - - named-uuid
            - temp_406221
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 286902
  result:
  - uuid:
    - uuid
    - f13c0cd1-e933-4442-982f-588e045535c6
  - count: 1
[DEBUG] 2014-05-27 09:32:03,363 module:ovsdb,function:_send,router:openwrt1
request:
  id: 808611
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_VXLAN
    where: []
response:
  error: null
  id: 808611
  result:
  - rows:
    - _uuid:
      - uuid
      - f13c0cd1-e933-4442-982f-588e045535c6
      _version:
      - uuid
      - c6703d3e-67ba-4490-b32c-4ced680e664c
      local_ip: 192.168.1.101
      remote_ips:
      - set
      - - 192.168.1.102
        - 192.168.1.103
        - 192.168.1.104
[INFO] 2014-05-27 09:32:03,368 module:nlan_agent,function:_route,router:openwrt1
function:subnets.add, index:['vni', 1], model:{'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 2, 'ip_vhost': '192.168.100.101/24', 'vni': 1, 'ip_dvr': OrderedDict([('addr', '192.168.100.1/24'), ('mode', 'dvr')])}
[DEBUG] 2014-05-27 09:32:03,368 module:ovsdb,function:_send,router:openwrt1
request:
  id: 663847
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 663847
  result:
  - rows:
    - _uuid:
      - uuid
      - cdb2c6ec-eb8e-468c-b6fe-0646f2a79654
      _version:
      - uuid
      - 1471d916-4984-45ae-970b-acd0f4c4fba7
      bridges:
      - uuid
      - e9a6dc9b-9a44-4e66-9a45-2d76d5cc73f8
      gateway:
      - uuid
      - 212b91d8-7088-48fb-8e82-65cbde8777a5
      services:
      - set
      - []
      subnets:
      - set
      - []
      vxlan:
      - uuid
      - f13c0cd1-e933-4442-982f-588e045535c6
[DEBUG] 2014-05-27 09:32:03,370 module:ovsdb,function:_send,router:openwrt1
request:
  id: 932818
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1
response:
  error: null
  id: 932818
  result:
  - rows: []
[INFO] 2014-05-27 09:32:03,370 module:subnets,function:add,router:openwrt1
Adding a subnet(vlan): 2
[DEBUG] 2014-05-27 09:32:03,371 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addbr br1
[DEBUG] 2014-05-27 09:32:03,375 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int_br1 tag=2 -- set interface int_br1 type=internal
[DEBUG] 2014-05-27 09:32:03,386 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int_dvr1 tag=2 -- set interface int_dvr1 type=internal
[DEBUG] 2014-05-27 09:32:03,400 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br1 int_br1
[DEBUG] 2014-05-27 09:32:03,405 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int_br1 promisc on
[DEBUG] 2014-05-27 09:32:03,407 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int_br1 up
[DEBUG] 2014-05-27 09:32:03,411 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int_dvr1 up
[DEBUG] 2014-05-27 09:32:03,413 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br1 up
[DEBUG] 2014-05-27 09:32:03,421 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns add ns1
[DEBUG] 2014-05-27 09:32:03,429 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link add veth-ns1 type veth peer name temp-ns1
[DEBUG] 2014-05-27 09:32:03,437 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev temp-ns1 netns ns1
[DEBUG] 2014-05-27 09:32:03,444 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1 ip link set dev temp-ns1 name eth0
[DEBUG] 2014-05-27 09:32:03,448 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br1 veth-ns1
[DEBUG] 2014-05-27 09:32:03,452 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1 promisc on
[DEBUG] 2014-05-27 09:32:03,455 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1 up
[DEBUG] 2014-05-27 09:32:03,463 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1 ip link set dev eth0 up
[DEBUG] 2014-05-27 09:32:03,467 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1 ip addr add dev eth0 192.168.100.101/24
[DEBUG] 2014-05-27 09:32:03,469 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1 ip route add default via 192.168.100.1 dev eth0
[DEBUG] 2014-05-27 09:32:03,471 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip addr add dev int_dvr1 192.168.100.1/24
[DEBUG] 2014-05-27 09:32:03,473 module:ovsdb,function:_send,router:openwrt1
request:
  id: 613795
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 613795
  result:
  - rows: []
[DEBUG] 2014-05-27 09:32:03,474 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=1,actions=mod_vlan_vid:2,resubmit(,10)
[DEBUG] 2014-05-27 09:32:03,478 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=2,nw_dst=192.168.100.1,actions=drop
[DEBUG] 2014-05-27 09:32:03,482 module:ovsdb,function:_send,router:openwrt1
request:
  id: 244272
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 244272
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-27 09:32:03,484 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=2,actions=strip_vlan,set_tunnel:1,output:3,output:2
[DEBUG] 2014-05-27 09:32:03,487 module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 2, 'ip_vhost': '192.168.100.101/24', 'vni': 1, 'ip_dvr': OrderedDict([('addr', '192.168.100.1/24'), ('mode', 'dvr')])}
[DEBUG] 2014-05-27 09:32:03,488 module:ovsdb,function:_send,router:openwrt1
request:
  id: 573872
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ip_dvr:
      - map
      - - - addr
          - 192.168.100.1/24
        - - mode
          - dvr
      ip_vhost: 192.168.100.101/24
      peers:
      - set
      - - 192.168.1.102
        - 192.168.1.103
      vid: 2
      vni: 1
    table: NLAN_Subnet
    uuid-name: temp_976484
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_976484
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 573872
  result:
  - uuid:
    - uuid
    - f60a52eb-3c24-41b7-ae12-d6ed12bc3aa1
  - count: 1
[DEBUG] 2014-05-27 09:32:03,489 module:ovsdb,function:_send,router:openwrt1
request:
  id: 608368
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1
response:
  error: null
  id: 608368
  result:
  - rows:
    - _uuid:
      - uuid
      - f60a52eb-3c24-41b7-ae12-d6ed12bc3aa1
      _version:
      - uuid
      - 51032184-ff36-40fb-9597-89ae0425e229
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - - - addr
          - 192.168.100.1/24
        - - mode
          - dvr
      ip_vhost: 192.168.100.101/24
      peers:
      - set
      - - 192.168.1.102
        - 192.168.1.103
      ports:
      - set
      - []
      vid: 2
      vni: 1
[INFO] 2014-05-27 09:32:03,491 module:nlan_agent,function:_route,router:openwrt1
function:subnets.add, index:['vni', 103], model:{'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 3, 'ip_vhost': '10.0.3.101/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr'), ('dhcp', 'enabled')])}
[DEBUG] 2014-05-27 09:32:03,492 module:ovsdb,function:_send,router:openwrt1
request:
  id: 963192
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 963192
  result:
  - rows:
    - _uuid:
      - uuid
      - cdb2c6ec-eb8e-468c-b6fe-0646f2a79654
      _version:
      - uuid
      - 7d9c64fd-4fc0-40a7-92d2-7394e630575b
      bridges:
      - uuid
      - e9a6dc9b-9a44-4e66-9a45-2d76d5cc73f8
      gateway:
      - uuid
      - 212b91d8-7088-48fb-8e82-65cbde8777a5
      services:
      - set
      - []
      subnets:
      - uuid
      - f60a52eb-3c24-41b7-ae12-d6ed12bc3aa1
      vxlan:
      - uuid
      - f13c0cd1-e933-4442-982f-588e045535c6
[DEBUG] 2014-05-27 09:32:03,494 module:ovsdb,function:_send,router:openwrt1
request:
  id: 465025
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 103
response:
  error: null
  id: 465025
  result:
  - rows: []
[INFO] 2014-05-27 09:32:03,495 module:subnets,function:add,router:openwrt1
Adding a subnet(vlan): 3
[DEBUG] 2014-05-27 09:32:03,495 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addbr br103
[DEBUG] 2014-05-27 09:32:03,500 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int_br103 tag=3 -- set interface int_br103 type=internal
[DEBUG] 2014-05-27 09:32:03,513 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int_dvr103 tag=3 -- set interface int_dvr103 type=internal
[DEBUG] 2014-05-27 09:32:03,529 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br103 int_br103
[DEBUG] 2014-05-27 09:32:03,532 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int_br103 promisc on
[DEBUG] 2014-05-27 09:32:03,534 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int_br103 up
[DEBUG] 2014-05-27 09:32:03,536 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int_dvr103 up
[DEBUG] 2014-05-27 09:32:03,541 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br103 up
[DEBUG] 2014-05-27 09:32:03,546 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns add ns103
[DEBUG] 2014-05-27 09:32:03,550 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link add veth-ns103 type veth peer name temp-ns103
[DEBUG] 2014-05-27 09:32:03,555 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev temp-ns103 netns ns103
[DEBUG] 2014-05-27 09:32:03,559 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns103 ip link set dev temp-ns103 name eth0
[DEBUG] 2014-05-27 09:32:03,561 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br103 veth-ns103
[DEBUG] 2014-05-27 09:32:03,565 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns103 promisc on
[DEBUG] 2014-05-27 09:32:03,568 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns103 up
[DEBUG] 2014-05-27 09:32:03,576 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns103 ip link set dev eth0 up
[DEBUG] 2014-05-27 09:32:03,580 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns103 ip addr add dev eth0 10.0.3.101/24
[DEBUG] 2014-05-27 09:32:03,583 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns103 ip route add default via 10.0.3.1 dev eth0
[DEBUG] 2014-05-27 09:32:03,585 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip addr add dev int_dvr103 10.0.3.1/24
[DEBUG] 2014-05-27 09:32:03,588 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci set network.int_dvr103=interface
[DEBUG] 2014-05-27 09:32:03,590 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci set network.int_dvr103.ifname=int_dvr103
[DEBUG] 2014-05-27 09:32:03,591 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci set network.int_dvr103.proto=static
[DEBUG] 2014-05-27 09:32:03,592 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci set network.int_dvr103.ipaddr=10.0.3.1
[DEBUG] 2014-05-27 09:32:03,594 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci set network.int_dvr103.netmask=255.255.255.0
[DEBUG] 2014-05-27 09:32:03,596 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci set dhcp.int_dvr103=dhcp
[DEBUG] 2014-05-27 09:32:03,598 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci set dhcp.int_dvr103.interface=int_dvr103
[DEBUG] 2014-05-27 09:32:03,600 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci set dhcp.int_dvr103.start=100
[DEBUG] 2014-05-27 09:32:03,602 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci set dhcp.int_dvr103.limit=150
[DEBUG] 2014-05-27 09:32:03,604 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci set dhcp.int_dvr103.leasetime=12h
[DEBUG] 2014-05-27 09:32:03,606 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci commit
[DEBUG] 2014-05-27 09:32:03,615 module:cmdutil,function:_cmd2,router:openwrt1
cmd: /etc/init.d/network restart
[DEBUG] 2014-05-27 09:32:04,646 module:cmdutil,function:_cmd2,router:openwrt1
cmd: /etc/init.d/dnsmasq restart
[DEBUG] 2014-05-27 09:32:07,762 module:ovsdb,function:_send,router:openwrt1
request:
  id: 531073
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 531073
  result:
  - rows: []
[DEBUG] 2014-05-27 09:32:07,762 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=103,actions=mod_vlan_vid:3,resubmit(,10)
[DEBUG] 2014-05-27 09:32:07,769 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=3,nw_dst=10.0.3.1,actions=drop
[DEBUG] 2014-05-27 09:32:07,774 module:ovsdb,function:_send,router:openwrt1
request:
  id: 405061
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 405061
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-27 09:32:07,776 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=3,actions=strip_vlan,set_tunnel:103,output:3,output:2
[DEBUG] 2014-05-27 09:32:07,779 module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 3, 'ip_vhost': '10.0.3.101/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr'), ('dhcp', 'enabled')])}
[DEBUG] 2014-05-27 09:32:07,780 module:ovsdb,function:_send,router:openwrt1
request:
  id: 525172
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ip_dvr:
      - map
      - - - addr
          - 10.0.3.1/24
        - - mode
          - dvr
        - - dhcp
          - enabled
      ip_vhost: 10.0.3.101/24
      peers:
      - set
      - - 192.168.1.102
        - 192.168.1.103
      vid: 3
      vni: 103
    table: NLAN_Subnet
    uuid-name: temp_925318
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_925318
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 525172
  result:
  - uuid:
    - uuid
    - 1c1248b9-61f4-4b97-b02e-079b4ee5d23a
  - count: 1
[DEBUG] 2014-05-27 09:32:07,781 module:ovsdb,function:_send,router:openwrt1
request:
  id: 346668
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 103
response:
  error: null
  id: 346668
  result:
  - rows:
    - _uuid:
      - uuid
      - 1c1248b9-61f4-4b97-b02e-079b4ee5d23a
      _version:
      - uuid
      - 8cdb591b-400a-4517-ac5f-79b1d748c0f5
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - - - addr
          - 10.0.3.1/24
        - - dhcp
          - enabled
        - - mode
          - dvr
      ip_vhost: 10.0.3.101/24
      peers:
      - set
      - - 192.168.1.102
        - 192.168.1.103
      ports:
      - set
      - []
      vid: 3
      vni: 103
[INFO] 2014-05-27 09:32:07,782 module:nlan_agent,function:_route,router:openwrt1
function:subnets.add, index:['vni', 1001], model:{'peers': ['192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.101/24', 'vni': 1001, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'hub'), ('dhcp', 'enabled')])}
[DEBUG] 2014-05-27 09:32:07,783 module:ovsdb,function:_send,router:openwrt1
request:
  id: 613522
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 613522
  result:
  - rows:
    - _uuid:
      - uuid
      - cdb2c6ec-eb8e-468c-b6fe-0646f2a79654
      _version:
      - uuid
      - a97b4fc5-0f77-4db6-b12b-62576424b5f1
      bridges:
      - uuid
      - e9a6dc9b-9a44-4e66-9a45-2d76d5cc73f8
      gateway:
      - uuid
      - 212b91d8-7088-48fb-8e82-65cbde8777a5
      services:
      - set
      - []
      subnets:
      - set
      - - - uuid
          - 1c1248b9-61f4-4b97-b02e-079b4ee5d23a
        - - uuid
          - f60a52eb-3c24-41b7-ae12-d6ed12bc3aa1
      vxlan:
      - uuid
      - f13c0cd1-e933-4442-982f-588e045535c6
[DEBUG] 2014-05-27 09:32:07,785 module:ovsdb,function:_send,router:openwrt1
request:
  id: 750891
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1001
response:
  error: null
  id: 750891
  result:
  - rows: []
[INFO] 2014-05-27 09:32:07,785 module:subnets,function:add,router:openwrt1
Adding a subnet(vlan): 1
[DEBUG] 2014-05-27 09:32:07,786 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addbr br1001
[DEBUG] 2014-05-27 09:32:07,790 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int_br1001 tag=1 -- set interface int_br1001 type=internal
[DEBUG] 2014-05-27 09:32:07,801 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int_dvr1001 tag=1 -- set interface int_dvr1001 type=internal
[DEBUG] 2014-05-27 09:32:07,814 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br1001 int_br1001
[DEBUG] 2014-05-27 09:32:07,816 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int_br1001 promisc on
[DEBUG] 2014-05-27 09:32:07,819 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int_br1001 up
[DEBUG] 2014-05-27 09:32:07,820 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int_dvr1001 up
[DEBUG] 2014-05-27 09:32:07,822 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br1001 up
[DEBUG] 2014-05-27 09:32:07,826 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns add ns1001
[DEBUG] 2014-05-27 09:32:07,829 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link add veth-ns1001 type veth peer name temp-ns1001
[DEBUG] 2014-05-27 09:32:07,834 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev temp-ns1001 netns ns1001
[DEBUG] 2014-05-27 09:32:07,839 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1001 ip link set dev temp-ns1001 name eth0
[DEBUG] 2014-05-27 09:32:07,842 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br1001 veth-ns1001
[DEBUG] 2014-05-27 09:32:07,847 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1001 promisc on
[DEBUG] 2014-05-27 09:32:07,850 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1001 up
[DEBUG] 2014-05-27 09:32:07,857 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1001 ip link set dev eth0 up
[DEBUG] 2014-05-27 09:32:07,863 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1001 ip addr add dev eth0 10.0.1.101/24
[DEBUG] 2014-05-27 09:32:07,865 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1001 ip route add default via 10.0.1.1 dev eth0
[DEBUG] 2014-05-27 09:32:07,870 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip addr add dev int_dvr1001 10.0.1.1/24
[DEBUG] 2014-05-27 09:32:07,876 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci set network.int_dvr1001=interface
[DEBUG] 2014-05-27 09:32:07,880 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci set network.int_dvr1001.ifname=int_dvr1001
[DEBUG] 2014-05-27 09:32:07,883 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci set network.int_dvr1001.proto=static
[DEBUG] 2014-05-27 09:32:07,885 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci set network.int_dvr1001.ipaddr=10.0.1.1
[DEBUG] 2014-05-27 09:32:07,889 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci set network.int_dvr1001.netmask=255.255.255.0
[DEBUG] 2014-05-27 09:32:07,891 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci set dhcp.int_dvr1001=dhcp
[DEBUG] 2014-05-27 09:32:07,892 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci set dhcp.int_dvr1001.interface=int_dvr1001
[DEBUG] 2014-05-27 09:32:07,894 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci set dhcp.int_dvr1001.start=100
[DEBUG] 2014-05-27 09:32:07,895 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci set dhcp.int_dvr1001.limit=150
[DEBUG] 2014-05-27 09:32:07,897 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci set dhcp.int_dvr1001.leasetime=12h
[DEBUG] 2014-05-27 09:32:07,899 module:cmdutil,function:_cmd2,router:openwrt1
cmd: uci commit
[DEBUG] 2014-05-27 09:32:07,906 module:cmdutil,function:_cmd2,router:openwrt1
cmd: /etc/init.d/network restart
[DEBUG] 2014-05-27 09:32:08,940 module:cmdutil,function:_cmd2,router:openwrt1
cmd: /etc/init.d/dnsmasq restart
[DEBUG] 2014-05-27 09:32:12,065 module:ovsdb,function:_send,router:openwrt1
request:
  id: 399627
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 399627
  result:
  - rows: []
[DEBUG] 2014-05-27 09:32:12,065 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=1001,actions=mod_vlan_vid:1,resubmit(,10)
[DEBUG] 2014-05-27 09:32:12,074 module:ovsdb,function:_send,router:openwrt1
request:
  id: 179130
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 179130
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-27 09:32:12,075 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=1,actions=strip_vlan,set_tunnel:1001,output:4
[DEBUG] 2014-05-27 09:32:12,080 module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'peers': ['192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.101/24', 'vni': 1001, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'hub'), ('dhcp', 'enabled')])}
[DEBUG] 2014-05-27 09:32:12,080 module:ovsdb,function:_send,router:openwrt1
request:
  id: 505068
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ip_dvr:
      - map
      - - - addr
          - 10.0.1.1/24
        - - mode
          - hub
        - - dhcp
          - enabled
      ip_vhost: 10.0.1.101/24
      peers:
      - set
      - - 192.168.1.104
      vid: 1
      vni: 1001
    table: NLAN_Subnet
    uuid-name: temp_40535
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_40535
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 505068
  result:
  - uuid:
    - uuid
    - 6ab6a9b7-bcdd-479c-b3a6-11a4ae8c7625
  - count: 1
[DEBUG] 2014-05-27 09:32:12,081 module:ovsdb,function:_send,router:openwrt1
request:
  id: 967803
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1001
response:
  error: null
  id: 967803
  result:
  - rows:
    - _uuid:
      - uuid
      - 6ab6a9b7-bcdd-479c-b3a6-11a4ae8c7625
      _version:
      - uuid
      - 78dbb2d7-82e9-4e67-a7bb-4bdd75fc3ad1
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - - - addr
          - 10.0.1.1/24
        - - dhcp
          - enabled
        - - mode
          - hub
      ip_vhost: 10.0.1.101/24
      peers: 192.168.1.104
      ports:
      - set
      - []
      vid: 1
      vni: 1001
[INFO] 2014-05-27 09:32:12,083 module:nlan_agent,function:<module>,router:openwrt1
NLAN Agent execution completed
--- STDERR from router:openwrt1,platform:openwrt
Command failed: Not found
Command failed: Not found
--- RESPONSE from router:openwrt1,platform:openwrt
message: Execution completed
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-05-27 02:32:02.043085

Router           Result    Elapsed Time
---------------------------------------
rpi1              :-)         1.46(sec)
openwrt3          :-)         1.60(sec)
openwrt2          :-)         1.74(sec)
openwrt1          :-)        11.73(sec)
--- STDOUT from router:openwrt2,platform:openwrt
Hello World!
--- STDOUT from router:openwrt3,platform:openwrt
Hello World!
--- STDOUT from router:openwrt1,platform:openwrt
Hello World!
--- STDOUT from router:rpi1,platform:debian
Hello World!
--- STDOUT from router:openwrt1,platform:openwrt
PING 10.0.1.102 (10.0.1.102): 56 data bytes
64 bytes from 10.0.1.102: seq=0 ttl=64 time=4.231 ms

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 4.231/4.231/4.231 ms
--- STDOUT from router:openwrt1,platform:openwrt
PING 10.0.1.102 (10.0.1.102): 56 data bytes
64 bytes from 10.0.1.102: seq=0 ttl=64 time=0.813 ms

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 0.813/0.813/0.813 ms
--- STDOUT from router:openwrt1,platform:openwrt
PING 10.0.3.103 (10.0.3.103): 56 data bytes
64 bytes from 10.0.3.103: seq=0 ttl=64 time=2.096 ms

--- 10.0.3.103 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 2.096/2.096/2.096 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 10.0.1.101 (10.0.1.101): 56 data bytes
64 bytes from 10.0.1.101: seq=0 ttl=63 time=4.155 ms

--- 10.0.1.101 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 4.155/4.155/4.155 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=3.384 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 3.384/3.384/3.384 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=3.947 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 3.947/3.947/3.947 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=1.927 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 1.927/1.927/1.927 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=0.876 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 0.876/0.876/0.876 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 10.0.1.102 (10.0.1.102): 56 data bytes
64 bytes from 10.0.1.102: seq=0 ttl=63 time=2.426 ms

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 2.426/2.426/2.426 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 10.0.1.1 (10.0.1.1): 56 data bytes
64 bytes from 10.0.1.1: seq=0 ttl=64 time=0.284 ms

--- 10.0.1.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 0.284/0.284/0.284 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 10.0.1.1 (10.0.1.1): 56 data bytes
64 bytes from 10.0.1.1: seq=0 ttl=64 time=0.481 ms

--- 10.0.1.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 0.481/0.481/0.481 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=1.965 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 1.965/1.965/1.965 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=1.125 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 1.125/1.125/1.125 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=1.915 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 1.915/1.915/1.915 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=2.169 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 2.169/2.169/2.169 ms
--- STDOUT from router:openwrt2,platform:openwrt
Hello World!
--- STDOUT from router:openwrt3,platform:openwrt
Hello World!
--- STDOUT from router:openwrt1,platform:openwrt
Hello World!
--- STDOUT from router:rpi1,platform:debian
Hello World!
--- STDOUT from router:openwrt1,platform:openwrt
PING 10.0.1.102 (10.0.1.102): 56 data bytes

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 0 packets received, 100% packet loss
--- STDOUT from router:openwrt1,platform:openwrt
PING 10.0.1.102 (10.0.1.102): 56 data bytes

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 0 packets received, 100% packet loss
--- STDOUT from router:openwrt1,platform:openwrt
PING 10.0.3.103 (10.0.3.103): 56 data bytes
64 bytes from 10.0.3.103: seq=0 ttl=64 time=1.955 ms

--- 10.0.3.103 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 1.955/1.955/1.955 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 10.0.1.101 (10.0.1.101): 56 data bytes

--- 10.0.1.101 ping statistics ---
1 packets transmitted, 0 packets received, 100% packet loss
--- STDOUT from router:openwrt2,platform:openwrt
PING 192.168.100.1 (192.168.100.1): 56 data bytes

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 0 packets received, 100% packet loss
--- STDOUT from router:openwrt3,platform:openwrt
PING 192.168.100.1 (192.168.100.1): 56 data bytes

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 0 packets received, 100% packet loss
--- STDOUT from router:openwrt2,platform:openwrt
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=2.064 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 2.064/2.064/2.064 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=0.912 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 0.912/0.912/0.912 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 10.0.1.102 (10.0.1.102): 56 data bytes

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 0 packets received, 100% packet loss
--- STDOUT from router:openwrt3,platform:openwrt
PING 10.0.1.1 (10.0.1.1): 56 data bytes
64 bytes from 10.0.1.1: seq=0 ttl=64 time=0.458 ms

--- 10.0.1.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 0.458/0.458/0.458 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 10.0.1.1 (10.0.1.1): 56 data bytes
64 bytes from 10.0.1.1: seq=0 ttl=64 time=0.480 ms

--- 10.0.1.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 0.480/0.480/0.480 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 8.8.8.8 (8.8.8.8): 56 data bytes

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 0 packets received, 100% packet loss
--- STDOUT from router:openwrt2,platform:openwrt
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=1.161 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 1.161/1.161/1.161 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 8.8.8.8 (8.8.8.8): 56 data bytes

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 0 packets received, 100% packet loss
--- STDOUT from router:openwrt3,platform:openwrt
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=1.959 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 1.959/1.959/1.959 ms
