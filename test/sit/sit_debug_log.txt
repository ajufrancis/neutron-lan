=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
openwrt2         192.168.1.102  OK
rpi1             192.168.1.104  OK
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: init.run
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: init.run
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: init.run
=+=+= NLAN Request to router:rpi1,platform:debian =+=+=+=+=+=+=+=+=+=+=+=+=+=+
command: init.run
--- STDOUT from router:openwrt2,platform:openwrt
[INFO] 2014-05-19 05:15:01,136 module:nlan_agent,function:<module>,router:openwrt2
NLAN Agent initialization completed
[DEBUG] 2014-05-19 05:15:01,138 module:nlan_agent,function:<module>,router:openwrt2
__n__: {'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'platform': 'openwrt', 'share_dir': '/opt/nlan/share', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'logger': <logging.Logger object at 0xb75767ac>, 'router': 'openwrt2', 'schema': 'ovsdb_nlan.schema', 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'enum': ['set', ['enabled']], 'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'ip_dvr': {'max': 2, 'value': {'type': 'string'}, 'key': {'enum': ['set', ['addr', 'mode']], 'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}}, 'indexes': {'services': 'name', 'subnets': 'vni'}}
[INFO] 2014-05-19 05:15:01,184 module:nlan_agent,function:_route,router:openwrt2
function:init.run, args:()
[DEBUG] 2014-05-19 05:15:01,185 module:cmdutil,function:_cmd2,router:openwrt2
cmd: lxc-ls
[DEBUG] 2014-05-19 05:15:01,201 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl --if-exists del-br br-tun
[DEBUG] 2014-05-19 05:15:01,237 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl --if-exists del-br br-int
[DEBUG] 2014-05-19 05:15:01,376 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl show
[DEBUG] 2014-05-19 05:15:01,387 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns101 down
[DEBUG] 2014-05-19 05:15:01,404 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delif br101 veth-ns101
[DEBUG] 2014-05-19 05:15:01,422 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns101 up
[DEBUG] 2014-05-19 05:15:01,431 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br101 down
[DEBUG] 2014-05-19 05:15:01,443 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delbr br101
[DEBUG] 2014-05-19 05:15:01,456 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns103 down
[DEBUG] 2014-05-19 05:15:01,469 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delif br103 veth-ns103
[DEBUG] 2014-05-19 05:15:01,487 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns103 up
[DEBUG] 2014-05-19 05:15:01,494 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br103 down
[DEBUG] 2014-05-19 05:15:01,504 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delbr br103
[DEBUG] 2014-05-19 05:15:01,530 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns1 down
[DEBUG] 2014-05-19 05:15:01,554 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delif br1 veth-ns1
[DEBUG] 2014-05-19 05:15:01,584 module--- STDOUT from router:openwrt1,platform:openwrt
[INFO] 2014-05-19 05:15:01,826 module:nlan_agent,function:<module>,router:openwrt1
NLAN Agent initialization completed
[DEBUG] 2014-05-19 05:15:01,827 module:nlan_agent,function:<module>,router:openwrt1
__n__: {'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'platform': 'openwrt', 'share_dir': '/opt/nlan/share', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'logger': <logging.Logger object at 0xb763b74c>, 'router': 'openwrt1', 'schema': 'ovsdb_nlan.schema', 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'enum': ['set', ['enabled']], 'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'ip_dvr': {'max': 2, 'value': {'type': 'string'}, 'key': {'enum': ['set', ['addr', 'mode']], 'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}}, 'indexes': {'services': 'name', 'subnets': 'vni'}}
[INFO] 2014-05-19 05:15:01,873 module:nlan_agent,function:_route,router:openwrt1
function:init.run, args:()
[DEBUG] 2014-05-19 05:15:01,875 module:cmdutil,function:_cmd2,router:openwrt1
cmd: lxc-ls
[DEBUG] 2014-05-19 05:15:01,889 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl --if-exists del-br br-tun
[DEBUG] 2014-05-19 05:15:01,932 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl --if-exists del-br br-int
[DEBUG] 2014-05-19 05:15:02,048 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl show
[DEBUG] 2014-05-19 05:15:02,059 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1001 down
[DEBUG] 2014-05-19 05:15:02,077 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delif br1001 veth-ns1001
[DEBUG] 2014-05-19 05:15:02,096 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1001 up
[DEBUG] 2014-05-19 05:15:02,107 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br1001 down
[DEBUG] 2014-05-19 05:15:02,120 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delbr br1001
[DEBUG] 2014-05-19 05:15:02,130 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns103 down
[DEBUG] 2014-05-19 05:15:02,149 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delif br103 veth-ns103
[DEBUG] 2014-05-19 05:15:02,163 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns103 up
[DEBUG] 2014-05-19 05:15:02,176 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br103 down
[DEBUG] 2014-05-19 05:15:02,183 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delbr br103
[DEBUG] 2014-05-19 05:15:02,194 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1 down
[DEBUG] 2014-05-19 05:15:02,207 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delif br1 veth-ns1
[DEBUG] 2014-05-19 05:15:02,221 --- STDOUT from router:openwrt3,platform:openwrt
[INFO] 2014-05-19 05:15:01,255 module:nlan_agent,function:<module>,router:openwrt3
NLAN Agent initialization completed
[DEBUG] 2014-05-19 05:15:01,261 module:nlan_agent,function:<module>,router:openwrt3
__n__: {'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'platform': 'openwrt', 'share_dir': '/opt/nlan/share', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'logger': <logging.Logger object at 0xb754a94c>, 'router': 'openwrt3', 'schema': 'ovsdb_nlan.schema', 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'enum': ['set', ['enabled']], 'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'ip_dvr': {'max': 2, 'value': {'type': 'string'}, 'key': {'enum': ['set', ['addr', 'mode']], 'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}}, 'indexes': {'services': 'name', 'subnets': 'vni'}}
[INFO] 2014-05-19 05:15:01,356 module:nlan_agent,function:_route,router:openwrt3
function:init.run, args:()
[DEBUG] 2014-05-19 05:15:01,357 module:cmdutil,function:_cmd2,router:openwrt3
cmd: lxc-ls
[DEBUG] 2014-05-19 05:15:01,371 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl --if-exists del-br br-tun
[DEBUG] 2014-05-19 05:15:01,408 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl --if-exists del-br br-int
[DEBUG] 2014-05-19 05:15:01,555 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl show
[DEBUG] 2014-05-19 05:15:01,571 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns101 down
[DEBUG] 2014-05-19 05:15:01,670 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delif br101 veth-ns101
[DEBUG] 2014-05-19 05:15:01,688 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns101 up
[DEBUG] 2014-05-19 05:15:01,697 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br101 down
[DEBUG] 2014-05-19 05:15:01,709 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delbr br101
[DEBUG] 2014-05-19 05:15:01,717 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns103 down
[DEBUG] 2014-05-19 05:15:01,735 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delif br103 veth-ns103
[DEBUG] 2014-05-19 05:15:01,747 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns103 up
[DEBUG] 2014-05-19 05:15:01,754 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br103 down
[DEBUG] 2014-05-19 05:15:01,759 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delbr br103
[DEBUG] 2014-05-19 05:15:01,772 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns1 down
[DEBUG] 2014-05-19 05:15:01,786 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delif br1 veth-ns1
[DEBUG] 2014-05-19 05:15:01,796 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns1 up
[DEBUG] 2014-05-19 05:15:01,595 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br1 down
[DEBUG] 2014-05-19 05:15:01,615 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delbr br1
[DEBUG] 2014-05-19 05:15:01,653 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns list
[DEBUG] 2014-05-19 05:15:01,676 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns del ns1
[DEBUG] 2014-05-19 05:15:01,680 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns del ns101
[DEBUG] 2014-05-19 05:15:01,704 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns del ns103
[DEBUG] 2014-05-19 05:15:01,751 module:ovsdb,function:_send,router:openwrt2
request:
  id: 260609
  method: transact
  params:
  - Open_vSwitch
  - op: delete
    table: NLAN
    where: []
response:
  error: null
  id: 260609
  result:
  - count: 1
[INFO] 2014-05-19 05:15:01,761 module:nlan_agent,function:<module>,router:openwrt2
NLAN Agent execution completed
--- RESPONSE from router:openwrt2,platform:openwrt
message: Execution completed
exit: 0
module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1 up
[DEBUG] 2014-05-19 05:15:02,228 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br1 down
[DEBUG] 2014-05-19 05:15:02,235 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delbr br1
[DEBUG] 2014-05-19 05:15:02,244 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns list
[DEBUG] 2014-05-19 05:15:02,256 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns del ns-global
[DEBUG] 2014-05-19 05:15:02,263 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns del ns1
[DEBUG] 2014-05-19 05:15:02,271 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns del ns1001
[DEBUG] 2014-05-19 05:15:02,278 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns del ns103
[DEBUG] 2014-05-19 05:15:02,301 module:ovsdb,function:_send,router:openwrt1
request:
  id: 139284
  method: transact
  params:
  - Open_vSwitch
  - op: delete
    table: NLAN
    where: []
response:
  error: null
  id: 139284
  result:
  - count: 1
[INFO] 2014-05-19 05:15:02,307 module:nlan_agent,function:<module>,router:openwrt1
NLAN Agent execution completed
--- RESPONSE from router:openwrt1,platform:openwrt
message: Execution completed
exit: 0
:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns1 up
[DEBUG] 2014-05-19 05:15:01,802 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br1 down
[DEBUG] 2014-05-19 05:15:01,809 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delbr br1
[DEBUG] 2014-05-19 05:15:01,820 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns list
[DEBUG] 2014-05-19 05:15:01,823 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns del ns101
[DEBUG] 2014-05-19 05:15:01,828 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns del ns103
[DEBUG] 2014-05-19 05:15:01,833 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns del ns1
[DEBUG] 2014-05-19 05:15:01,859 module:ovsdb,function:_send,router:openwrt3
request:
  id: 48471
  method: transact
  params:
  - Open_vSwitch
  - op: delete
    table: NLAN
    where: []
response:
  error: null
  id: 48471
  result:
  - count: 1
[INFO] 2014-05-19 05:15:01,862 module:nlan_agent,function:<module>,router:openwrt3
NLAN Agent execution completed
--- RESPONSE from router:openwrt3,platform:openwrt
message: Execution completed
exit: 0
--- STDOUT from router:rpi1,platform:debian
[INFO] 2014-05-18 22:15:03,510 module:nlan_agent,function:<module>,router:rpi1
NLAN Agent initialization completed
[DEBUG] 2014-05-18 22:15:03,512 module:nlan_agent,function:<module>,router:rpi1
__n__: {'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'platform': 'debian', 'share_dir': '/opt/nlan/share', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'logger': <logging.Logger object at 0xb72d31cc>, 'router': 'rpi1', 'schema': 'ovsdb_nlan.schema', 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'enum': ['set', ['enabled']], 'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'ip_dvr': {'max': 2, 'value': {'type': 'string'}, 'key': {'enum': ['set', ['addr', 'mode']], 'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}}, 'indexes': {'services': 'name', 'subnets': 'vni'}}
[INFO] 2014-05-18 22:15:03,575 module:nlan_agent,function:_route,router:rpi1
function:init.run, args:()
[DEBUG] 2014-05-18 22:15:03,576 module:cmdutil,function:_cmd2,router:rpi1
cmd: lxc-ls
[DEBUG] 2014-05-18 22:15:03,718 module:cmdutil,function:_cmd2,router:rpi1
cmd: lxc-stop -n snort1
[DEBUG] 2014-05-18 22:15:03,744 module:cmdutil,function:_cmd2,router:rpi1
cmd: lxc-stop -n snort2
[DEBUG] 2014-05-18 22:15:03,761 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl --if-exists del-br br-tun
[DEBUG] 2014-05-18 22:15:03,841 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl --if-exists del-br br-int
[DEBUG] 2014-05-18 22:15:03,899 module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl show
[DEBUG] 2014-05-18 22:15:03,978 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev br1001 down
[DEBUG] 2014-05-18 22:15:04,016 module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl delbr br1001
[DEBUG] 2014-05-18 22:15:04,046 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev br101 down
[DEBUG] 2014-05-18 22:15:04,071 module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl delbr br101
[DEBUG] 2014-05-18 22:15:04,111 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip netns list
[DEBUG] 2014-05-18 22:15:04,159 module:ovsdb,function:_send,router:rpi1
request:
  id: 882105
  method: transact
  params:
  - Open_vSwitch
  - op: delete
    table: NLAN
    where: []
response:
  error: null
  id: 882105
  result:
  - count: 1
[INFO] 2014-05-18 22:15:04,162 module:nlan_agent,function:<module>,router:rpi1
NLAN Agent execution completed
--- RESPONSE from router:rpi1,platform:debian
message: Execution completed
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-05-18 22:15:01.782571

Router           Result    Elapsed Time
---------------------------------------
openwrt2          :-)         1.76(sec)
openwrt1          :-)         1.82(sec)
openwrt3          :-)         1.87(sec)
rpi1              :-)         1.90(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
openwrt2         192.168.1.102  OK
openwrt1         192.168.1.101  OK
rpi1             192.168.1.104  OK
=+=+= NLAN Request to router:rpi1,platform:debian =+=+=+=+=+=+=+=+=+=+=+=+=+=+
operation: --add
dict_args: "OrderedDict([('bridges', {'ovs_bridges': 'enabled'}), ('services', [{'name': 'snort1', 'chain': ['mz.101', 'dmz.1001'], '_index': ['name', 'snort1']}]), ('vxlan', {'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.101'], 'local_ip': '192.168.1.104'}), ('subnets', [{'ports': ['dmz.1001'], 'peers': ['192.168.1.101'], 'vni': 1001, 'vid': 111, '_index': ['vni', 1001]}, {'ports': ['mz.101'], 'peers': ['192.168.1.102', '192.168.1.103'], 'vni': 101, 'vid': 1, '_index': ['vni', 101]}])])"
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --add
dict_args: "OrderedDict([('bridges', {'ovs_bridges': 'enabled'}), ('vxlan', {'remote_ips': ['192.168.1.102', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.103'}), ('subnets', [{'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 2, '_index': ['vni', 1], 'ip_vhost': '192.168.100.103/24', 'default_gw': '192.168.100.1', 'ip_dvr': OrderedDict([('addr', '192.168.100.3/24'), ('mode', 'dvr')]), 'vni': 1}, {'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 3, '_index': ['vni', 103], 'ip_vhost': '10.0.3.103/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr')])}, {'peers': ['192.168.1.102', '192.168.1.104'], 'vid': 1, '_index': ['vni', 101], 'ip_vhost': '10.0.1.103/24', 'vni': 101, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'spoke_dvr')])}])])"
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --add
dict_args: "OrderedDict([('bridges', {'ovs_bridges': 'enabled'}), ('vxlan', {'remote_ips': ['192.168.1.103', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.102'}), ('subnets', [{'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 2, '_index': ['vni', 1], 'ip_vhost': '192.168.100.102/24', 'default_gw': '192.168.100.1', 'ip_dvr': OrderedDict([('addr', '192.168.100.2/24'), ('mode', 'dvr')]), 'vni': 1}, {'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 3, '_index': ['vni', 103], 'ip_vhost': '10.0.3.102/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr')])}, {'peers': ['192.168.1.103', '192.168.1.104'], 'vid': 1, '_index': ['vni', 101], 'ip_vhost': '10.0.1.102/24', 'vni': 101, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'spoke_dvr')])}])])"
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --add
dict_args: "OrderedDict([('bridges', {'ovs_bridges': 'enabled'}), ('gateway', {'network': 'eth2', 'rip': 'enabled'}), ('vxlan', {'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.104'], 'local_ip': '192.168.1.101'}), ('subnets', [{'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 2, '_index': ['vni', 1], 'ip_vhost': '192.168.100.101/24', 'vni': 1, 'ip_dvr': OrderedDict([('addr', '192.168.100.1/24'), ('mode', 'dvr')])}, {'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 3, '_index': ['vni', 103], 'ip_vhost': '10.0.3.101/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr')])}, {'peers': ['192.168.1.104'], 'vid': 1, '_index': ['vni', 1001], 'ip_vhost': '10.0.1.101/24', 'vni': 1001, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'hub')])}])])"
--- STDOUT from router:rpi1,platform:debian
[INFO] 2014-05-18 22:15:06,119 module:nlan_agent,function:<module>,router:rpi1
NLAN Agent initialization completed
[DEBUG] 2014-05-18 22:15:06,121 module:nlan_agent,function:<module>,router:rpi1
__n__: {'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'platform': 'debian', 'share_dir': '/opt/nlan/share', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'logger': <logging.Logger object at 0xb730f04c>, 'router': 'rpi1', 'schema': 'ovsdb_nlan.schema', 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'enum': ['set', ['enabled']], 'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'ip_dvr': {'max': 2, 'value': {'type': 'string'}, 'key': {'enum': ['set', ['addr', 'mode']], 'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}}, 'indexes': {'services': 'name', 'subnets': 'vni'}}
[INFO] 2014-05-18 22:15:06,245 module:nlan_agent,function:_route,router:rpi1
function:bridges.add, model:{'ovs_bridges': 'enabled'}
[DEBUG] 2014-05-18 22:15:06,309 module:ovsdb,function:_send,router:rpi1
request:
  id: 890238
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 890238
  result:
  - rows: []
[DEBUG] 2014-05-18 22:15:06,312 module:ovsdb,function:_send,router:rpi1
request:
  id: 961407
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row: {}
    table: NLAN
response:
  error: null
  id: 961407
  result:
  - uuid:
    - uuid
    - 3cb633fd-2870-4eae-90cb-5719c0db8119
[DEBUG] 2014-05-18 22:15:06,314 module:ovsdb,function:_send,router:rpi1
request:
  id: 317005
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Bridges
    where: []
response:
  error: null
  id: 317005
  result:
  - rows: []
[INFO] 2014-05-18 22:15:06,316 module:bridges,function:add,router:rpi1
Adding bridges: br-int and br-tun
[DEBUG] 2014-05-18 22:15:06,346 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-br br-int
[DEBUG] 2014-05-18 22:15:06,381 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-br br-tun
[DEBUG] 2014-05-18 22:15:06,448 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl del-flows br-tun
[DEBUG] 2014-05-18 22:15:06,486 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-int patch-int -- set interface patch-int type=patch options:peer=patch-tun
[DEBUG] 2014-05-18 22:15:06,525 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-tun patch-tun -- set interface patch-tun type=patch options:peer=patch-int
[DEBUG] 2014-05-18 22:15:06,553 module:ovsdb,function:_send,router:rpi1
request:
  id: 618152
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: Interface
    where:
    - - name
      - ==
      - patch-tun
response:
  error: null
  id: 618152
  result:
  - rows:
    - _uuid:
      - uuid
      - e569ecdf-3ae5-4835-8e3b-a73f49e11531
      _version:
      - uuid
      - d96b330e-230a-4204-8f35-29092a0163ae
      admin_state:
      - set
      - []
      bfd:
      - map
      - []
      bfd_status:
      - map
      - []
      cfm_fault:
      - set
      - []
      cfm_fault_status:
      - set
      - []
      cfm_flap_count:
      - set
      - []
      cfm_health:
      - set
      - []
      cfm_mpid:
      - set
      - []
      cfm_remote_mpids:
      - set
      - []
      cfm_remote_opstate:
      - set
      - []
      duplex:
      - set
      - []
      external_ids:
      - map
      - []
      ifindex: 0
      ingress_policing_burst: 0
      ingress_policing_rate: 0
      lacp_current:
      - set
      - []
      link_resets:
      - set
      - []
      link_speed:
      - set
      - []
      link_state:
      - set
      - []
      mac:
      - set
      - []
      mac_in_use: ee:65:c2:f1:71:91
      mtu:
      - set
      - []
      name: patch-tun
      ofport: 1
      ofport_request:
      - set
      - []
      options:
      - map
      - - - peer
          - patch-int
      other_config:
      - map
      - []
      statistics:
      - map
      - - - collisions
          - 0
        - - rx_bytes
          - 0
        - - rx_crc_err
          - 0
        - - rx_dropped
          - 0
        - - rx_errors
          - 0
        - - rx_frame_err
          - 0
        - - rx_over_err
          - 0
        - - rx_packets
          - 0
        - - tx_bytes
          - 0
        - - tx_dropped
          - 0
        - - tx_errors
          - 0
        - - tx_packets
          - 0
      status:
      - map
      - []
      type: patch
[DEBUG] 2014-05-18 22:15:06,556 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=1,actions=resubmit(,1)
[DEBUG] 2014-05-18 22:15:06,570 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=0,priority=0,actions=drop
[DEBUG] 2014-05-18 22:15:06,583 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=01:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,19)
[DEBUG] 2014-05-18 22:15:06,595 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=00:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,20)
[DEBUG] 2014-05-18 22:15:06,607 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=2,priority=0,actions=drop
[DEBUG] 2014-05-18 22:15:06,627 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=3,priority=0,actions=drop
[DEBUG] 2014-05-18 22:15:06,639 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=10,priority=1,actions=learn(table=20,hard_timeout=300,priority=1,NXM_OF_VLAN_TCI[0..11],NXM_OF_ETH_DST[]=NXM_OF_ETH_SRC[],load:0->NXM_OF_VLAN_TCI[],load:NXM_NX_TUN_ID[]->NXM_NX_TUN_ID[],output:NXM_OF_IN_PORT[]),output:1
[DEBUG] 2014-05-18 22:15:06,651 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=19,priority=0,actions=resubmit(,21)
[DEBUG] 2014-05-18 22:15:06,662 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=20,priority=0,actions=resubmit(,21)
[DEBUG] 2014-05-18 22:15:06,672 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=21,priority=0,actions=drop
[DEBUG] 2014-05-18 22:15:06,686 module:ovsdb,function:crud,router:rpi1
CRUD operation (add): {'ovs_bridges': 'enabled'}
[DEBUG] 2014-05-18 22:15:06,688 module:ovsdb,function:_send,router:rpi1
request:
  id: 414150
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ovs_bridges: enabled
    table: NLAN_Bridges
    uuid-name: temp_658607
  - mutations:
    - - bridges
      - insert
      - - set
        - - - named-uuid
            - temp_658607
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 414150
  result:
  - uuid:
    - uuid
    - 2fba2b5b-eb49-479a-af1f-a6198118d31c
  - count: 1
[DEBUG] 2014-05-18 22:15:06,691 module:ovsdb,function:_send,router:rpi1
request:
  id: 965315
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Bridges
    where: []
response:
  error: null
  id: 965315
  result:
  - rows:
    - _uuid:
      - uuid
      - 2fba2b5b-eb49-479a-af1f-a6198118d31c
      _version:
      - uuid
      - 44a2465d-b117-4345-bff9-1b452857c43e
      controller:
      - set
      - []
      ovs_bridges: enabled
[INFO] 2014-05-18 22:15:06,696 module:nlan_agent,function:_route,router:rpi1
function:services.add, index:['name', 'snort1'], model:{'name': 'snort1', 'chain': ['mz.101', 'dmz.1001']}
[DEBUG] 2014-05-18 22:15:06,698 module:ovsdb,function:_send,router:rpi1
request:
  id: 118016
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 118016
  result:
  - rows:
    - _uuid:
      - uuid
      - 3cb633fd-2870-4eae-90cb-5719c0db8119
      _version:
      - uuid
      - a3fdff23-736e-4ae1-acf0-ccab61479468
      bridges:
      - uuid
      - 2fba2b5b-eb49-479a-af1f-a6198118d31c
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - set
      - []
      vxlan:
      - set
      - []
[DEBUG] 2014-05-18 22:15:06,701 module:ovsdb,function:_send,router:rpi1
request:
  id: 6963
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Service
    where:
    - - name
      - ==
      - snort1
response:
  error: null
  id: 6963
  result:
  - rows: []
[DEBUG] 2014-05-18 22:15:06,705 module:cmdutil,function:_cmd2,router:rpi1
cmd: lxc-stop -n snort1
[DEBUG] 2014-05-18 22:15:06,711 module:cmdutil,function:_cmd2,router:rpi1
cmd: lxc-start -d -f /var/lib/lxc/snort1/config_nlan -n snort1
[DEBUG] 2014-05-18 22:15:06,718 module:ovsdb,function:crud,router:rpi1
CRUD operation (add): {'name': 'snort1', 'chain': ['mz.101', 'dmz.1001']}
[DEBUG] 2014-05-18 22:15:06,721 module:ovsdb,function:_send,router:rpi1
request:
  id: 761660
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      chain:
      - set
      - - mz.101
        - dmz.1001
      name: snort1
    table: NLAN_Service
    uuid-name: temp_773814
  - mutations:
    - - services
      - insert
      - - set
        - - - named-uuid
            - temp_773814
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 761660
  result:
  - uuid:
    - uuid
    - ef76bc05-3902-40ef-8eca-9c66af07516c
  - count: 1
[DEBUG] 2014-05-18 22:15:06,726 module:ovsdb,function:_send,router:rpi1
request:
  id: 519596
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Service
    where:
    - - name
      - ==
      - snort1
response:
  error: null
  id: 519596
  result:
  - rows:
    - _uuid:
      - uuid
      - ef76bc05-3902-40ef-8eca-9c66af07516c
      _version:
      - uuid
      - 68dc643f-f9c0-47fa-84fb-b2c2d0dc23f0
      chain:
      - set
      - - dmz.1001
        - mz.101
      name: snort1
[INFO] 2014-05-18 22:15:06,731 module:nlan_agent,function:_route,router:rpi1
function:vxlan.add, model:{'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.101'], 'local_ip': '192.168.1.104'}
[DEBUG] 2014-05-18 22:15:06,738 module:ovsdb,function:_send,router:rpi1
request:
  id: 760828
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 760828
  result:
  - rows:
    - _uuid:
      - uuid
      - 3cb633fd-2870-4eae-90cb-5719c0db8119
      _version:
      - uuid
      - 614decb0-d0e1-4a7e-bf51-eae1b14129a8
      bridges:
      - uuid
      - 2fba2b5b-eb49-479a-af1f-a6198118d31c
      gateway:
      - set
      - []
      services:
      - uuid
      - ef76bc05-3902-40ef-8eca-9c66af07516c
      subnets:
      - set
      - []
      vxlan:
      - set
      - []
[DEBUG] 2014-05-18 22:15:06,743 module:ovsdb,function:_send,router:rpi1
request:
  id: 846722
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_VXLAN
    where: []
response:
  error: null
  id: 846722
  result:
  - rows: []
[INFO] 2014-05-18 22:15:06,752 module:vxlan,function:add,router:rpi1
Adding a VXLAN tunnel: vxlan_103
[DEBUG] 2014-05-18 22:15:06,767 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-tun vxlan_103 -- set interface vxlan_103 type=vxlan options:in_key=flow options:local_ip=192.168.1.104 options:out_key=flow options:remote_ip=192.168.1.103
[INFO] 2014-05-18 22:15:06,909 module:vxlan,function:add,router:rpi1
Adding a VXLAN tunnel: vxlan_102
[DEBUG] 2014-05-18 22:15:06,910 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-tun vxlan_102 -- set interface vxlan_102 type=vxlan options:in_key=flow options:local_ip=192.168.1.104 options:out_key=flow options:remote_ip=192.168.1.102
[INFO] 2014-05-18 22:15:06,989 module:vxlan,function:add,router:rpi1
Adding a VXLAN tunnel: vxlan_101
[DEBUG] 2014-05-18 22:15:06,990 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-tun vxlan_101 -- set interface vxlan_101 type=vxlan options:in_key=flow options:local_ip=192.168.1.104 options:out_key=flow options:remote_ip=192.168.1.101
[DEBUG] 2014-05-18 22:15:07,044 module:ovsdb,function:_send,router:rpi1
request:
  id: 549249
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 549249
  result:
  - rows:
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
[DEBUG] 2014-05-18 22:15:07,045 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=4,actions=resubmit(,2)
[DEBUG] 2014-05-18 22:15:07,067 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=3,actions=resubmit(,2)
[DEBUG] 2014-05-18 22:15:07,092 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=2,actions=resubmit(,2)
[DEBUG] 2014-05-18 22:15:07,111 module:ovsdb,function:crud,router:rpi1
CRUD operation (add): {'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.101'], 'local_ip': '192.168.1.104'}
[DEBUG] 2014-05-18 22:15:07,113 module:ovsdb,function:_send,router:rpi1
request:
  id: 672671
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      local_ip: 192.168.1.104
      remote_ips:
      - set
      - - 192.168.1.103
        - 192.168.1.102
        - 192.168.1.101
    table: NLAN_VXLAN
    uuid-name: temp_246757
  - mutations:
    - - vxlan
      - insert
      - - set
        - - - named-uuid
            - temp_246757
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 672671
  result:
  - uuid:
    - uuid
    - 032197a9-c3aa-4e5d-a687-acf264fcb6ee
  - count: 1
[DEBUG] 2014-05-18 22:15:07,117 module:ovsdb,function:_send,router:rpi1
request:
  id: 5420
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_VXLAN
    where: []
response:
  error: null
  id: 5420
  result:
  - rows:
    - _uuid:
      - uuid
      - 032197a9-c3aa-4e5d-a687-acf264fcb6ee
      _version:
      - uuid
      - 632163e3-b572-43da-8001-86bd1cb469cb
      local_ip: 192.168.1.104
      remote_ips:
      - set
      - - 192.168.1.101
        - 192.168.1.102
        - 192.168.1.103
[INFO] 2014-05-18 22:15:07,154 module:nlan_agent,function:_route,router:rpi1
function:subnets.add, index:['vni', 1001], model:{'peers': ['192.168.1.101'], 'ports': ['dmz.1001'], 'vni': 1001, 'vid': 111}
[DEBUG] 2014-05-18 22:15:07,162 module:ovsdb,function:_send,router:rpi1
request:
  id: 105736
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 105736
  result:
  - rows:
    - _uuid:
      - uuid
      - 3cb633fd-2870-4eae-90cb-5719c0db8119
      _version:
      - uuid
      - 90e4c660-c345-48ad-9f11-651f98dca420
      bridges:
      - uuid
      - 2fba2b5b-eb49-479a-af1f-a6198118d31c
      gateway:
      - set
      - []
      services:
      - uuid
      - ef76bc05-3902-40ef-8eca-9c66af07516c
      subnets:
      - set
      - []
      vxlan:
      - uuid
      - 032197a9-c3aa-4e5d-a687-acf264fcb6ee
[DEBUG] 2014-05-18 22:15:07,164 module:ovsdb,function:_send,router:rpi1
request:
  id: 890731
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1001
response:
  error: null
  id: 890731
  result:
  - rows: []
[INFO] 2014-05-18 22:15:07,169 module:subnets,function:add,router:rpi1
Adding a subnet(vlan): 111
[DEBUG] 2014-05-18 22:15:07,174 module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addbr br1001
[DEBUG] 2014-05-18 22:15:07,186 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-int int-br1001 tag=111 -- set interface int-br1001 type=internal
[DEBUG] 2014-05-18 22:15:07,263 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-int int-dvr1001 tag=111 -- set interface int-dvr1001 type=internal
[DEBUG] 2014-05-18 22:15:07,346 module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addif br1001 int-br1001
[DEBUG] 2014-05-18 22:15:07,371 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int-br1001 promisc on
[DEBUG] 2014-05-18 22:15:07,382 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int-br1001 up
[DEBUG] 2014-05-18 22:15:07,404 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int-dvr1001 up
[DEBUG] 2014-05-18 22:15:07,421 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev br1001 up
[DEBUG] 2014-05-18 22:15:07,438 module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addif br1001 dmz.1001
[DEBUG] 2014-05-18 22:15:07,454 module:ovsdb,function:_send,router:rpi1
request:
  id: 468152
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 468152
  result:
  - rows: []
[DEBUG] 2014-05-18 22:15:07,456 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=1001,actions=mod_vlan_vid:111,resubmit(,10)
[DEBUG] 2014-05-18 22:15:07,480 module:ovsdb,function:_send,router:rpi1
request:
  id: 276421
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 276421
  result:
  - rows:
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
[DEBUG] 2014-05-18 22:15:07,483 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=111,actions=strip_vlan,set_tunnel:1001,output:4
[DEBUG] 2014-05-18 22:15:07,504 module:ovsdb,function:crud,router:rpi1
CRUD operation (add): {'peers': ['192.168.1.101'], 'ports': ['dmz.1001'], 'vni': 1001, 'vid': 111}
[DEBUG] 2014-05-18 22:15:07,507 module:ovsdb,function:_send,router:rpi1
request:
  id: 434456
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      peers:
      - set
      - - 192.168.1.101
      ports:
      - set
      - - dmz.1001
      vid: 111
      vni: 1001
    table: NLAN_Subnet
    uuid-name: temp_432314
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_432314
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 434456
  result:
  - uuid:
    - uuid
    - 907bf2eb-b7ce-4ae2-a938-09af35734d38
  - count: 1
[DEBUG] 2014-05-18 22:15:07,509 module:ovsdb,function:_send,router:rpi1
request:
  id: 467743
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1001
response:
  error: null
  id: 467743
  result:
  - rows:
    - _uuid:
      - uuid
      - 907bf2eb-b7ce-4ae2-a938-09af35734d38
      _version:
      - uuid
      - 3de420bd-5f42-4a48-b54b-14614810e56f
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - []
      ip_vhost:
      - set
      - []
      peers: 192.168.1.101
      ports: dmz.1001
      vid: 111
      vni: 1001
[INFO] 2014-05-18 22:15:07,510 module:nlan_agent,function:_route,router:rpi1
function:subnets.add, index:['vni', 101], model:{'peers': ['192.168.1.102', '192.168.1.103'], 'ports': ['mz.101'], 'vni': 101, 'vid': 1}
[DEBUG] 2014-05-18 22:15:07,512 module:ovsdb,function:_send,router:rpi1
request:
  id: 375231
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 375231
  result:
  - rows:
    - _uuid:
      - uuid
      - 3cb633fd-2870-4eae-90cb-5719c0db8119
      _version:
      - uuid
      - c283608e-7303-46b2-999c-57695c8c7111
      bridges:
      - uuid
      - 2fba2b5b-eb49-479a-af1f-a6198118d31c
      gateway:
      - set
      - []
      services:
      - uuid
      - ef76bc05-3902-40ef-8eca-9c66af07516c
      subnets:
      - uuid
      - 907bf2eb-b7ce-4ae2-a938-09af35734d38
      vxlan:
      - uuid
      - 032197a9-c3aa-4e5d-a687-acf264fcb6ee
[DEBUG] 2014-05-18 22:15:07,513 module:ovsdb,function:_send,router:rpi1
request:
  id: 862711
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 101
response:
  error: null
  id: 862711
  result:
  - rows: []
[INFO] 2014-05-18 22:15:07,518 module:subnets,function:add,router:rpi1
Adding a subnet(vlan): 1
[DEBUG] 2014-05-18 22:15:07,521 module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addbr br101
[DEBUG] 2014-05-18 22:15:07,540 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-int int-br101 tag=1 -- set interface int-br101 type=internal
[DEBUG] 2014-05-18 22:15:07,603 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-int int-dvr101 tag=1 -- set interface int-dvr101 type=internal
[DEBUG] 2014-05-18 22:15:07,678 module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addif br101 int-br101
[DEBUG] 2014-05-18 22:15:07,692 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int-br101 promisc on
[DEBUG] 2014-05-18 22:15:07,712 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int-br101 up
[DEBUG] 2014-05-18 22:15:07,729 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int-dvr101 up
[DEBUG] 2014-05-18 22:15:07,740 module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev br101 up
[DEBUG] 2014-05-18 22:15:07,763 module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addif br101 mz.101
[DEBUG] 2014-05-18 22:15:07,774 module:ovsdb,function:_send,router:rpi1
request:
  id: 623139
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 623139
  result:
  - rows: []
[DEBUG] 2014-05-18 22:15:07,775 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=101,actions=mod_vlan_vid:1,resubmit(,10)
[DEBUG] 2014-05-18 22:15:07,800 module:ovsdb,function:_send,router:rpi1
request:
  id: 617768
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
  --- STDOUT from router:openwrt3,platform:openwrt
[INFO] 2014-05-19 05:15:04,022 module:nlan_agent,function:<module>,router:openwrt3
NLAN Agent initialization completed
[DEBUG] 2014-05-19 05:15:04,024 module:nlan_agent,function:<module>,router:openwrt3
__n__: {'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'platform': 'openwrt', 'share_dir': '/opt/nlan/share', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'logger': <logging.Logger object at 0xb74db7cc>, 'router': 'openwrt3', 'schema': 'ovsdb_nlan.schema', 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'enum': ['set', ['enabled']], 'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'ip_dvr': {'max': 2, 'value': {'type': 'string'}, 'key': {'enum': ['set', ['addr', 'mode']], 'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}}, 'indexes': {'services': 'name', 'subnets': 'vni'}}
[INFO] 2014-05-19 05:15:04,153 module:nlan_agent,function:_route,router:openwrt3
function:bridges.add, model:{'ovs_bridges': 'enabled'}
[DEBUG] 2014-05-19 05:15:04,173 module:ovsdb,function:_send,router:openwrt3
request:
  id: 445902
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 445902
  result:
  - rows: []
[DEBUG] 2014-05-19 05:15:04,179 module:ovsdb,function:_send,router:openwrt3
request:
  id: 667592
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row: {}
    table: NLAN
response:
  error: null
  id: 667592
  result:
  - uuid:
    - uuid
    - af98a92a-7720-466f-a8e0-cad6d102a05c
[DEBUG] 2014-05-19 05:15:04,183 module:ovsdb,function:_send,router:openwrt3
request:
  id: 665320
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Bridges
    where: []
response:
  error: null
  id: 665320
  result:
  - rows: []
[INFO] 2014-05-19 05:15:04,186 module:bridges,function:add,router:openwrt3
Adding bridges: br-int and br-tun
[DEBUG] 2014-05-19 05:15:04,227 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-br br-int
[DEBUG] 2014-05-19 05:15:04,257 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-br br-tun
[DEBUG] 2014-05-19 05:15:04,300 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl del-flows br-tun
[DEBUG] 2014-05-19 05:15:04,316 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int patch-int -- set interface patch-int type=patch options:peer=patch-tun
[DEBUG] 2014-05-19 05:15:04,343 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-tun patch-tun -- set interface patch-tun type=patch options:peer=patch-int
[DEBUG] 2014-05-19 05:15:04,371 module:ovsdb,function:_send,router:openwrt3
request:
  id: 585280
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: Interface
    where:
    - - name
      - ==
      - patch-tun
response:
  error: null
  id: 585280
  result:
  - rows:
    - _uuid:
      - uuid
      - 91311c97-58ca-4a17-9c5f-9028be5bd517
      _version:
      - uuid
      - 738ddc25-6494-42d1-bdd3-ca37e7bcc8f4
      admin_state:
      - set
      - []
      bfd:
      - map
      - []
      bfd_status:
      - map
      - []
      cfm_fault:
      - set
      - []
      cfm_fault_status:
      - set
      - []
      cfm_flap_count:
      - set
      - []
      cfm_health:
      - set
      - []
      cfm_mpid:
      - set
      - []
      cfm_remote_mpids:
      - set
      - []
      cfm_remote_opstate:
      - set
      - []
      duplex:
      - set
      - []
      external_ids:
      - map
      - []
      ifindex: 0
      ingress_policing_burst: 0
      ingress_policing_rate: 0
      lacp_current:
      - set
      - []
      link_resets:
      - set
      - []
      link_speed:
      - set
      - []
      link_state:
      - set
      - []
      mac:
      - set
      - []
      mac_in_use: 5e:26:db:d4:f5:14
      mtu:
      - set
      - []
      name: patch-tun
      ofport: 1
      ofport_request:
      - set
      - []
      options:
      - map
      - - - peer
          - patch-int
      other_config:
      - map
      - []
      statistics:
      - map
      - - - collisions
          - 0
        - - rx_bytes
          - 0
        - - rx_crc_err
          - 0
        - - rx_dropped
          - 0
        - - rx_errors
          - 0
        - - rx_frame_err
          - 0
        - - rx_over_err
          - 0
        - - rx_packets
          - 0
        - - tx_bytes
          - 0
        - - tx_dropped
          - 0
        - - tx_errors
          - 0
        - - tx_packets
          - 0
      status:
      - map
      - []
      type: patch
[DEBUG] 2014-05-19 05:15:04,388 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=1,actions=resubmit(,1)
[DEBUG] 2014-05-19 05:15:04,398 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=0,priority=0,actions=drop
[DEBUG] 2014-05-19 05:15:04,408 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=01:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,19)
[DEBUG] 2014-05-19 05:15:04,419 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=00:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,20)
[DEBUG] 2014-05-19 05:15:04,430 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=2,priority=0,actions=drop
[DEBUG] 2014-05-19 05:15:04,440 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=3,priority=0,actions=drop
[DEBUG] 2014-05-19 05:15:04,450 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=10,priority=1,actions=learn(table=20,hard_timeout=300,priority=1,NXM_OF_VLAN_TCI[0..11],NXM_OF_ETH_DST[]=NXM_OF_ETH_SRC[],load:0->NXM_OF_VLAN_TCI[],load:NXM_NX_TUN_ID[]->NXM_NX_TUN_ID[],output:NXM_OF_IN_PORT[]),output:1
[DEBUG] 2014-05-19 05:15:04,465 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=19,priority=0,actions=resubmit(,21)
[DEBUG] 2014-05-19 05:15:04,476 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=20,priority=0,actions=resubmit(,21)
[DEBUG] 2014-05-19 05:15:04,485 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=21,priority=0,actions=drop
[DEBUG] 2014-05-19 05:15:04,495 module:ovsdb,function:crud,router:openwrt3
CRUD operation (add): {'ovs_bridges': 'enabled'}
[DEBUG] 2014-05-19 05:15:04,498 module:ovsdb,function:_send,router:openwrt3
request:
  id: 220676
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ovs_bridges: enabled
    table: NLAN_Bridges
    uuid-name: temp_745403
  - mutations:
    - - bridges
      - insert
      - - set
        - - - named-uuid
            - temp_745403
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 220676
  result:
  - uuid:
    - uuid
    - c5b625b8-0676-4ff9-997a-3902a38d68ac
  - count: 1
[DEBUG] 2014-05-19 05:15:04,503 module:ovsdb,function:_send,router:openwrt3
request:
  id: 455091
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Bridges
    where: []
response:
  error: null
  id: 455091
  result:
  - rows:
    - _uuid:
      - uuid
      - c5b625b8-0676-4ff9-997a-3902a38d68ac
      _version:
      - uuid
      - 4b6f1c12-3864-429c-96bf-69d0697a6b67
      controller:
      - set
      - []
      ovs_bridges: enabled
[INFO] 2014-05-19 05:15:04,509 module:nlan_agent,function:_route,router:openwrt3
function:vxlan.add, model:{'remote_ips': ['192.168.1.102', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.103'}
[DEBUG] 2014-05-19 05:15:04,512 module:ovsdb,function:_send,router:openwrt3
request:
  id: 257074
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 257074
  result:
  - rows:
    - _uuid:
      - uuid
      - af98a92a-7720-466f-a8e0-cad6d102a05c
      _version:
      - uuid
      - 4c41841b-30fc-4f3e-aab4-8aa30be8e375
      bridges:
      - uuid
      - c5b625b8-0676-4ff9-997a-3902a38d68ac
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - set
      - []
      vxlan:
      - set
      - []
[DEBUG] 2014-05-19 05:15:04,518 module:ovsdb,function:_send,router:openwrt3
request:
  id: 658007
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_VXLAN
    where: []
response:
  error: null
  id: 658007
  result:
  - rows: []
[INFO] 2014-05-19 05:15:04,523 module:vxlan,function:add,router:openwrt3
Adding a VXLAN tunnel: vxlan_102
[DEBUG] 2014-05-19 05:15:04,524 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-tun vxlan_102 -- set interface vxlan_102 type=vxlan options:in_key=flow options:local_ip=192.168.1.103 options:out_key=flow options:remote_ip=192.168.1.102
[INFO] 2014-05-19 05:15:04,545 module:vxlan,function:add,router:openwrt3
Adding a VXLAN tunnel: vxlan_101
[DEBUG] 2014-05-19 05:15:04,546 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-tun vxlan_101 -- set interface vxlan_101 type=vxlan options:in_key=flow options:local_ip=192.168.1.103 options:out_key=flow options:remote_ip=192.168.1.101
[INFO] 2014-05-19 05:15:04,573 module:vxlan,function:add,router:openwrt3
Adding a VXLAN tunnel: vxlan_104
[DEBUG] 2014-05-19 05:15:04,573 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-tun vxlan_104 -- set interface vxlan_104 type=vxlan options:in_key=flow options:local_ip=192.168.1.103 options:out_key=flow options:remote_ip=192.168.1.104
[DEBUG] 2014-05-19 05:15:04,602 module:ovsdb,function:_send,router:openwrt3
request:
  id: 389930
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 389930
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-19 05:15:04,609 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=3,actions=resubmit(,2)
[DEBUG] 2014-05-19 05:15:04,620 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=2,actions=resubmit(,2)
[DEBUG] 2014-05-19 05:15:  where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 617768
  result:
  - rows:
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.104
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
[DEBUG] 2014-05-18 22:15:07,802 module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=1,actions=strip_vlan,set_tunnel:101,output:3,output:2
[DEBUG] 2014-05-18 22:15:07,815 module:ovsdb,function:crud,router:rpi1
CRUD operation (add): {'peers': ['192.168.1.102', '192.168.1.103'], 'ports': ['mz.101'], 'vni': 101, 'vid': 1}
[DEBUG] 2014-05-18 22:15:07,817 module:ovsdb,function:_send,router:rpi1
request:
  id: 188867
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      peers:
      - set
      - - 192.168.1.102
        - 192.168.1.103
      ports:
      - set
      - - mz.101
      vid: 1
      vni: 101
    table: NLAN_Subnet
    uuid-name: temp_279241
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_279241
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 188867
  result:
  - uuid:
    - uuid
    - 503c25cd-7141-4549-b04c-382c709e180a
  - count: 1
[DEBUG] 2014-05-18 22:15:07,819 module:ovsdb,function:_send,router:rpi1
request:
  id: 718960
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 101
response:
  error: null
  id: 718960
  result:
  - rows:
    - _uuid:
      - uuid
      - 503c25cd-7141-4549-b04c-382c709e180a
      _version:
      - uuid
      - d7b410df-6a84-48e8-91f7-1e53bdb54d8b
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - []
      ip_vhost:
      - set
      - []
      peers:
      - set
      - - 192.168.1.102
        - 192.168.1.103
      ports: mz.101
      vid: 1
      vni: 101
[INFO] 2014-05-18 22:15:07,822 module:nlan_agent,function:<module>,router:rpi1
NLAN Agent execution completed
--- RESPONSE from router:rpi1,platform:debian
message: Execution completed
exit: 0
04,630 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=4,actions=resubmit(,2)
[DEBUG] 2014-05-19 05:15:04,642 module:ovsdb,function:crud,router:openwrt3
CRUD operation (add): {'remote_ips': ['192.168.1.102', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.103'}
[DEBUG] 2014-05-19 05:15:04,645 module:ovsdb,function:_send,router:openwrt3
request:
  id: 559187
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      local_ip: 192.168.1.103
      remote_ips:
      - set
      - - 192.168.1.102
        - 192.168.1.101
        - 192.168.1.104
    table: NLAN_VXLAN
    uuid-name: temp_196081
  - mutations:
    - - vxlan
      - insert
      - - set
        - - - named-uuid
            - temp_196081
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 559187
  result:
  - uuid:
    - uuid
    - 8594c3e8-f87b-4080-9738-00ca17575d7f
  - count: 1
[DEBUG] 2014-05-19 05:15:04,650 module:ovsdb,function:_send,router:openwrt3
request:
  id: 740515
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_VXLAN
    where: []
response:
  error: null
  id: 740515
  result:
  - rows:
    - _uuid:
      - uuid
      - 8594c3e8-f87b-4080-9738-00ca17575d7f
      _version:
      - uuid
      - 8b050c04-8eac-4254-9739-bba81bf54c9a
      local_ip: 192.168.1.103
      remote_ips:
      - set
      - - 192.168.1.101
        - 192.168.1.102
        - 192.168.1.104
[INFO] 2014-05-19 05:15:04,671 module:nlan_agent,function:_route,router:openwrt3
function:subnets.add, index:['vni', 1], model:{'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 2, 'ip_vhost': '192.168.100.103/24', 'default_gw': '192.168.100.1', 'ip_dvr': OrderedDict([('addr', '192.168.100.3/24'), ('mode', 'dvr')]), 'vni': 1}
[DEBUG] 2014-05-19 05:15:04,673 module:ovsdb,function:_send,router:openwrt3
request:
  id: 825676
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 825676
  result:
  - rows:
    - _uuid:
      - uuid
      - af98a92a-7720-466f-a8e0-cad6d102a05c
      _version:
      - uuid
      - 655e3d77-1151-4584-b89b-db4814ab73b7
      bridges:
      - uuid
      - c5b625b8-0676-4ff9-997a-3902a38d68ac
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - set
      - []
      vxlan:
      - uuid
      - 8594c3e8-f87b-4080-9738-00ca17575d7f
[DEBUG] 2014-05-19 05:15:04,681 module:ovsdb,function:_send,router:openwrt3
request:
  id: 797578
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1
response:
  error: null
  id: 797578
  result:
  - rows: []
[INFO] 2014-05-19 05:15:04,686 module:subnets,function:add,router:openwrt3
Adding a subnet(vlan): 2
[DEBUG] 2014-05-19 05:15:04,687 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addbr br1
[DEBUG] 2014-05-19 05:15:04,700 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int-br1 tag=2 -- set interface int-br1 type=internal
[DEBUG] 2014-05-19 05:15:04,740 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int-dvr1 tag=2 -- set interface int-dvr1 type=internal
[DEBUG] 2014-05-19 05:15:04,785 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br1 int-br1
[DEBUG] 2014-05-19 05:15:04,797 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-br1 promisc on
[DEBUG] 2014-05-19 05:15:04,803 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-br1 up
[DEBUG] 2014-05-19 05:15:04,810 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-dvr1 up
[DEBUG] 2014-05-19 05:15:04,823 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br1 up
[DEBUG] 2014-05-19 05:15:04,839 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns add ns1
[DEBUG] 2014-05-19 05:15:04,848 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link add veth-ns1 type veth peer name temp-ns1
[DEBUG] 2014-05-19 05:15:04,864 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev temp-ns1 netns ns1
[DEBUG] 2014-05-19 05:15:04,870 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns1 ip link set dev temp-ns1 name eth0
[DEBUG] 2014-05-19 05:15:04,880 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br1 veth-ns1
[DEBUG] 2014-05-19 05:15:04,896 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns1 promisc on
[DEBUG] 2014-05-19 05:15:04,901 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns1 up
[DEBUG] 2014-05-19 05:15:04,920 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns1 ip link set dev eth0 up
[DEBUG] 2014-05-19 05:15:04,935 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns1 ip addr add dev eth0 192.168.100.103/24
[DEBUG] 2014-05-19 05:15:04,943 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns1 ip route add default via 192.168.100.3 dev eth0
[DEBUG] 2014-05-19 05:15:04,949 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip addr add dev int-dvr1 192.168.100.3/24
[DEBUG] 2014-05-19 05:15:04,953 module:cmdutil,function:_cmd2,router:openwrt3
cmd: route
[DEBUG] 2014-05-19 05:15:04,959 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip route add default via 192.168.100.1
[DEBUG] 2014-05-19 05:15:04,965 module:ovsdb,function:_send,router:openwrt3
request:
  id: 247068
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 247068
  result:
  - rows: []
[DEBUG] 2014-05-19 05:15:04,967 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=1,actions=mod_vlan_vid:2,resubmit(,10)
[DEBUG] 2014-05-19 05:15:04,975 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=2,nw_dst=192.168.100.3,actions=drop
[DEBUG] 2014-05-19 05:15:04,988 module:ovsdb,function:_send,router:openwrt3
request:
  id: 190727
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 190727
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-19 05:15:04,994 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=2,actions=strip_vlan,set_tunnel:1,output:3,output:2
[DEBUG] 2014-05-19 05:15:05,004 module:ovsdb,function:crud,router:openwrt3
CRUD operation (add): {'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 2, 'ip_vhost': '192.168.100.103/24', 'default_gw': '192.168.100.1', 'ip_dvr': OrderedDict([('addr', '192.168.100.3/24'), ('mode', 'dvr')]), 'vni': 1}
[DEBUG] 2014-05-19 05:15:05,007 module:ovsdb,function:_send,router:openwrt3
request:
  id: 606104
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      default_gw: 192.168.100.1
      ip_dvr:
      - map
      - - - addr
          - 192.168.100.3/24
        - - mode
          - dvr
      ip_vhost: 192.168.100.103/24
      peers:
      - set
      - - 192.168.1.101
        - 192.168.1.102
      vid: 2
      vni: 1
    table: NLAN_Subnet
    uuid-name: temp_108060
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_108060
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 606104
  result:
  - uuid:
    - uuid
    - c00dfd51-4c78-42e2-a9da-3e1952c6b389
  - count: 1
[DEBUG] 2014-05-19 05:15:05,011 module:ovsdb,function:_send,router:openwrt3
request:
  id: 91534
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1
response:
  error: null
  id: 91534
  result:
  - rows:
    - _uuid:
      - uuid
      - c00dfd51-4c78-42e2-a9da-3e1952c6b389
      _version:
      - uuid
      - d5a2f549-2b8b-4792-905c-9377792a8d91
      default_gw: 192.168.100.1
      ip_dvr:
      - map
      - - - addr
          - 192.168.100.3/24
        - - mode
          - dvr
      ip_vhost: 192.168.100.103/24
      peers:
      - set
      - - 192.168.1.101
        - 192.168.1.102
      ports:
      - set
      - []
      vid: 2
      vni: 1
[INFO] 2014-05-19 05:15:05,017 module:nlan_agent,function:_route,router:openwrt3
function:subnets.add, index:['vni', 103], model:{'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 3, 'ip_vhost': '10.0.3.103/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr')])}
[DEBUG] 2014-05-19 05:15:05,019 module:ovsdb,function:_send,router:openwrt3
request:
  id: 535507
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 535507
  result:
  - rows:
    - _uuid:
      - uuid
      - af98a92a-7720-466f-a8e0-cad6d102a05c
      _version:
      - uuid
      - c5903f8b-7cd7-4787-91be-6d090a52227a
      bridges:
      - uuid
      - c5b625b8-0676-4ff9-997a-3902a38d68ac
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - uuid
      - c00dfd51-4c78-42e2-a9da-3e1952c6b389
      vxlan:
      - uuid
      - 8594c3e8-f87b-4080-9738-00ca17575d7f
[DEBUG] 2014-05-19 05:15:05,026 module:ovsdb,function:_send,router:openwrt3
request:
  id: 205665
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 103
response:
  error: null
  id: 205665
  result:
  - rows: []
[INFO] 2014-05-19 05:15:05,029 module:subnets,function:add,router:openwrt3
Adding a subnet(vlan): 3
[DEBUG] 2014-05-19 05:15:05,029 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addbr br103
[DEBUG] 2014-05-19 05:15:05,039 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int-br103 tag=3 -- set interface int-br103 type=internal
[DEBUG] 2014-05-19 05:15:05,080 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int-dvr103 tag=3 -- set interface int-dvr103 type=internal
[DEBUG] 2014-05-19 05:15:05,125 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br103 int-br103
[DEBUG] 2014-05-19 05:15:05,135 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-br103 promisc on
[DEBUG] 2014-05-19 05:15:05,140 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-br103 up
[DEBUG] 2014-05-19 05:15:05,149 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-dvr103 up
[DEBUG] 2014-05-19 05:15:05,157 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br103 up
[DEBUG] 2014-05-19 05:15:05,168 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns add ns103
[DEBUG] 2014-05-19 05:15:05,178 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link add veth-ns103 type veth peer name temp-ns103
[DEBUG] 2014-05-19 05:15:05,192 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev temp-ns103 netns ns103
[DEBUG] 2014-05-19 05:15:05,197 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns103 ip link set dev temp-ns103 name eth0
[DEBUG] 2014-05-19 05:15:05,206 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br103 veth-ns103
[DEBUG] 2014-05-19 05:15:05,220 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns103 promisc on
[DEBUG] 2014-05-19 05:15:05,229 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns103 up
[DEBUG] 2014-05-19 05:15:05,250 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns103 ip link set dev eth0 up
[DEBUG] 2014-05-19 05:15:05,263 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns103 ip addr add dev eth0 10.0.3.103/24
[DEBUG] 2014-05-19 05:15:05,275 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns103 ip route add default via 10.0.3.1 dev eth0
[DEBUG] 2014-05-19 05:15:05,281 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip addr add dev int-dvr103 10.0.3.1/24
[DEBUG] 2014-05-19 05:15:05,289 module:ovsdb,function:_send,router:openwrt3
request:
  id: 210788
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 210788
  result:
  - rows: []
[DEBUG] 2014-05-19 05:15:05,291 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=103,actions=mod_vlan_vid:3,resubmit(,10)
[DEBUG] 2014-05-19 05:15:05,301 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=3,nw_dst=10.0.3.1,actions=drop
[DEBUG] 2014-05-19 05:15:05,312 module:ovsdb,function:_send,router:openwrt3
request:
  id: 872747
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 872747
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-19 05:15:05,318 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=3,actions=strip_vlan,set_tunnel:103,output:3,output:2
[DEBUG] 2014-05-19 05:15:05,328 module:ovsdb,function:crud,router:openwrt3
CRUD operation (add): {'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 3, 'ip_vhost': '10.0.3.103/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr')])}
[DEBUG] 2014-05-19 05:15:05,333 module:ovsdb,function:_send,router:openwrt3
request:
  id: 166810
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ip_dvr:
      - map
      - - - addr
          - 10.0.3.1/24
        - - mode
          - dvr
      ip_vhost: 10.0.3.103/24
      peers:
      - set
      - - 192.168.1.101
        - 192.168.1.102
      vid: 3
      vni: 103
    table: NLAN_Subnet
    uuid-name: temp_672567
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_672567
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 166810
  result:
  - uuid:
    - uuid
    - 9458d913-f019-419d-af20-08287cc32acc
  - count: 1
[DEBUG] 2014-05-19 05:15:05,337 module:ovsdb,function:_send,router:openwrt3
request:
  id: 286648
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 103
response:
  error: null
  id: 286648
  result:
  - rows:
    - _uuid:
      - uuid
      - 9458d913-f019-419d-af20-08287cc32acc
      _version:
      - uuid
      - bab1138b-10bc-4d53-acd7-17d24de63dda
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - - - addr
          - 10.0.3.1/24
        - - mode
          - dvr
      ip_vhost: 10.0.3.103/24
      peers:
      - set
      - - 192.168.1.101
        - 192.168.1.102
      ports:
      - set
      - []
      vid: 3
      vni: 103
[INFO] 2014-05-19 05:15:05,342 module:nlan_agent,function:_route,router:openwrt3
function:subnets.add, index:['vni', 101], model:{'peers': ['192.168.1.102', '192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.103/24', 'vni': 101, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'spoke_dvr')])}
[DEBUG] 2014-05-19 05:15:05,345 module:ovsdb,function:_send,router:openwrt3
request:
  id: 598596
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 598596
  result:
  - rows:
    - _uuid:
      - uuid
      - af98a92a-7720-466f-a8e0-cad6d102a05c
      _version:
      - uuid
      - f947c636-ce9b-448b-a02c-f7a0c1d3683a
      bridges:
      - uuid
      - c5b625b8-0676-4ff9-997a-3902a38d68ac
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - set
      - - - uuid
          - 9458d913-f019-419d-af20-08287cc32acc
        - - uuid
          - c00dfd51-4c78-42e2-a9da-3e1952c6b389
      vxlan:
      - uuid
      - 8594c3e8-f87b-4080-9738-00ca17575d7f
[DEBUG] 2014-05-19 05:15:05,351 module:ovsdb,function:_send,router:openwrt3
request:
  id: 627208
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 101
response:
  error: null
  id: 627208
  result:
  - rows: []
[INFO] 2014-05-19 05:15:05,354 module:subnets,function:add,router:openwrt3
Adding a subnet(vlan): 1
[DEBUG] 2014-05-19 05:15:05,355 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addbr br101
[DEBUG] 2014-05-19 05:15:05,364 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int-br101 tag=1 -- set interface int-br101 type=internal
[DEBUG] 2014-05-19 05:15:05,401 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int-dvr101 tag=1 -- set interface int-dvr101 type=internal
[DEBUG] 2014-05-19 05:15:05,438 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br101 int-br101
[DEBUG] 2014-05-19 05:15:05,445 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-br101 promisc on
[DEBUG] 2014-05-19 05:15:05,450 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-br101 up
[DEBUG] 2014-05-19 05:15:05,457 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-dvr101 up
[DEBUG] 2014-05-19 05:15:05,460 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br101 up
[DEBUG] 2014-05-19 05:15:05,469 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns add ns101
[DEBUG] 2014-05-19 05:15:05,477 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link add veth-ns101 type veth peer name temp-ns101
[DEBUG] 2014-05-19 05:15:05,491 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev temp-ns101 netns ns101
[DEBUG] 2014-05-19 05:15:05,499 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns101 ip link set dev temp-ns101 name eth0
[DEBUG] 2014-05-19 05:15:05,510 module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br101 veth-ns101
[DEBUG] 2014-05-19 05:15:05,519 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns101 promisc on
[DEBUG] 2014-05-19 05:15:05,527 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns101 up
[DEBUG] 2014-05-19 05:15:05,545 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns101 ip link set dev eth0 up
[DEBUG] 2014-05-19 05:15:05,555 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns101 ip addr add dev eth0 10.0.1.103/24
[DEBUG] 2014-05-19 05:15:05,561 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns101 ip route add default via 10.0.1.1 dev eth0
[DEBUG] 2014-05-19 05:15:05,567 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip addr add dev int-dvr101 10.0.1.1/24
[DEBUG] 2014-05-19 05:15:05,573 module:ovsdb,function:_send,router:openwrt3
request:
  id: 678978
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 678978
  result:
  - rows: []
[DEBUG] 2014-05-19 05:15:05,576 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=101,actions=mod_vlan_vid:1,resubmit(,10)
[DEBUG] 2014-05-19 05:15:05,586 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link show dev int-dvr101
[DEBUG] 2014-05-19 05:15:05,592 module:ovsdb,function:_send,router:openwrt3
request:
  id: 601711
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: Interface
    where:
    - - name
      - ==
      - int-dvr101
response:
  error: null
  id: 601711
  result:
  - rows:
    - _uuid:
      - uuid
      - adde37c6-317b-4115-b08e-ea2fcef66a2f
      _version:
      - uuid
      - 8925ecf0-2c35-483c-9a33-2a2ae0d895b6
      admin_state: up
      bfd:
      - map
      - []
      bfd_status:
      - map
      - []
      cfm_fault:
      - set
      - []
      cfm_fault_status:
      - set
      - []
      cfm_flap_count:
      - set
      - []
      cfm_health:
      - set
      - []
      cfm_mpid:
      - set
      - []
      cfm_remote_mpids:
      - set
      - []
      cfm_remote_opstate:
      - set
      - []
      duplex:
      - set
      - []
      external_ids:
      - map
      - []
      ifindex: 44
      ingress_policing_burst: 0
      ingress_policing_rate: 0
      lacp_current:
      - set
      - []
      link_resets: 2
      link_speed:
      - set
      - []
      link_state: up
      mac:
      - set
      - []
      mac_in_use: 72:65:4a:f2:40:32
      mtu: 1500
      name: int-dvr101
      ofport: 7
      ofport_request:
      - set
      - []
      options:
      - map
      - []
      other_config:
      - map
      - []
      statistics:
      - map
      - - - collisions
          - 0
        - - rx_bytes
          - 0
        - - rx_crc_err
          - 0
        - - rx_dropped
          - 0
        - - rx_errors
          - 0
        - - rx_frame_err
          - 0
        - - rx_over_err
          - 0
        - - rx_packets
          - 0
        - - tx_bytes
          - 0
        - - tx_dropped
          - 0
        - - tx_errors
          - 0
        - - tx_packets
          - 0
      status:
      - map
      - - - driver_name
          - openvswitch
      type: internal
[DEBUG] 2014-05-19 05:15:05,606 module:ovsdb,function:_send,router:openwrt3
request:
  id: 538038
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: Interface
    where:
    - - name
      - ==
      - int-br101
response:
  error: null
  id: 538038
  result:
  - rows:
    - _uuid:
      - uuid
      - 7646e704-a527-43c8-958f-f3673faa4b80
      _version:
      - uuid
      - b5a0b0f9-9d37-474f-a6cc-3c6efcd8ea6b
      admin_state: up
      bfd:
      - map
      - []
      bfd_status:
      - map
      - []
      cfm_fault:
      - set
      - []
      cfm_fault_status:
      - set
      - []
      cfm_flap_count:
      - set
      - []
      cfm_health:
      - set
      - []
      cfm_mpid:
      - set
      - []
      cfm_remote_mpids:
      - set
      - []
      cfm_remote_opstate:
      - set
      - []
      duplex:
      - set
      - []
      external_ids:
      - map
      - []
      ifindex: 43
      ingress_policing_burst: 0
      ingress_policing_rate: 0
      lacp_current:
      - set
      - []
      link_resets: 2
      link_speed:
      - set
      - []
      link_state: up
      mac:
      - set
      - []
      mac_in_use: ba:fb:de:3e:2b:d2
      mtu: 1500
      name: int-br101
      ofport: 6
      ofport_request:
      - set
      - []
      options:
      - map
      - []
      other_config:
      - map
      - []
      statistics:
      - map
      - - - collisions
          - 0
        - - rx_bytes
          - 0
        - - rx_crc_err
          - 0
        - - rx_dropped
          - 0
        - - rx_errors
          - 0
        - - rx_frame_err
          - 0
        - - rx_over_err
          - 0
        - - rx_packets
          - 0
        - - tx_bytes
          - 0
        - - tx_dropped
          - 0
        - - tx_errors
          - 0
        - - tx_packets
          - 0
      status:
      - map
      - - - driver_name
          - openvswitch
      type: internal
[DEBUG] 2014-05-19 05:15:05,618 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=0,priority=2,in_port=6,dl_type=0x0800,nw_dst=10.0.1.0/24,actions=normal
[DEBUG] 2014-05-19 05:15:05,626 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=10.0.0.0/8,actions=resubmit(,1)
[DEBUG] 2014-05-19 05:15:05,635 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=172.16.0.0/12,actions=resubmit(,1)
[DEBUG] 2014-05-19 05:15:05,644 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=192.168.0.0/16,actions=resubmit(,1)
[DEBUG] 2014-05-19 05:15:05,652 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=7,dl_type=0x0806,nw_src=10.0.1.1,nw_proto=2,actions=drop
[DEBUG] 2014-05-19 05:15:05,663 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=1,priority=0,in_port=6,actions=set_field:72:65:4a:f2:40:32->dl_dst,output:7
[DEBUG] 2014-05-19 05:15:05,675 module:ovsdb,function:_send,router:openwrt3
request:
  id: 327298
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 327298
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.103
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-19 05:15:05,682 module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=1,actions=strip_vlan,set_tunnel:101,output:2,output:4
[DEBUG] 2014-05-19 05:15:05,691 module:ovsdb,function:crud,router:openwrt3
CRUD operation (add): {'peers': ['192.168.1.102', '192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.103/24', 'vni': 101, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'spoke_dvr')])}
[DEBUG] 2014-05-19 05:15:05,695 module:ovsdb,function:_send,router:openwrt3
request:
  id: 549427
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ip_dvr:
      - map
      - - - addr
          - 10.0.1.1/24
        - - mode
          - spoke_dvr
      ip_vhost: 10.0.1.103/24
      peers:
      - set
      - - 192.168.1.102
        - 192.168.1.104
      vid: 1
      vni: 101
    table: NLAN_Subnet
    uuid-name: temp_277013
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_277013
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 549427
  result:
  - uuid:
    - uuid
    - 120f64cf-82c3-4312-a8d0-07df3adf8664
  - count: 1
[DEBUG] 2014-05-19 05:15:05,698 module:ovsdb,function:_send,router:openwrt3
request:
  id: 585839
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 101
response:
  error: null
  id: 585839
  result:
  - rows:
    - _uuid:
      - uuid
      - 120f64cf-82c3-4312-a8d0-07df3adf8664
      _version:
      - uuid
      - 30279811-a13d-457d-ad7d-3c2e720b24ed
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - - - addr
          - 10.0.1.1/24
        - - mode
          - spoke_dvr
      ip_vhost: 10.0.1.103/24
      peers:
      - set
      - - 192.168.1.102
        - 192.168.1.104
      ports:
      - set
      - []
      vid: 1
      vni: 101
[INFO] 2014-05-19 05:15:05,704 module:nlan_agent,function:<module>,rou--- STDOUT from router:openwrt2,platform:openwrt
[INFO] 2014-05-19 05:15:04,220 module:nlan_agent,function:<module>,router:openwrt2
NLAN Agent initialization completed
[DEBUG] 2014-05-19 05:15:04,226 module:nlan_agent,function:<module>,router:openwrt2
__n__: {'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'platform': 'openwrt', 'share_dir': '/opt/nlan/share', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'logger': <logging.Logger object at 0xb75f8acc>, 'router': 'openwrt2', 'schema': 'ovsdb_nlan.schema', 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'enum': ['set', ['enabled']], 'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'ip_dvr': {'max': 2, 'value': {'type': 'string'}, 'key': {'enum': ['set', ['addr', 'mode']], 'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}}, 'indexes': {'services': 'name', 'subnets': 'vni'}}
[INFO] 2014-05-19 05:15:04,462 module:nlan_agent,function:_route,router:openwrt2
function:bridges.add, model:{'ovs_bridges': 'enabled'}
[DEBUG] 2014-05-19 05:15:04,481 module:ovsdb,function:_send,router:openwrt2
request:
  id: 278367
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 278367
  result:
  - rows: []
[DEBUG] 2014-05-19 05:15:04,488 module:ovsdb,function:_send,router:openwrt2
request:
  id: 9564
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row: {}
    table: NLAN
response:
  error: null
  id: 9564
  result:
  - uuid:
    - uuid
    - 7acda763-620b-4421-83c6-c07597e92248
[DEBUG] 2014-05-19 05:15:04,491 module:ovsdb,function:_send,router:openwrt2
request:
  id: 931210
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Bridges
    where: []
response:
  error: null
  id: 931210
  result:
  - rows: []
[INFO] 2014-05-19 05:15:04,495 module:bridges,function:add,router:openwrt2
Adding bridges: br-int and br-tun
[DEBUG] 2014-05-19 05:15:04,576 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-br br-int
[DEBUG] 2014-05-19 05:15:04,622 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-br br-tun
[DEBUG] 2014-05-19 05:15:04,687 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl del-flows br-tun
[DEBUG] 2014-05-19 05:15:04,710 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int patch-int -- set interface patch-int type=patch options:peer=patch-tun
[DEBUG] 2014-05-19 05:15:04,779 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-tun patch-tun -- set interface patch-tun type=patch options:peer=patch-int
[DEBUG] 2014-05-19 05:15:04,815 module:ovsdb,function:_send,router:openwrt2
request:
  id: 866231
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: Interface
    where:
    - - name
      - ==
      - patch-tun
response:
  error: null
  id: 866231
  result:
  - rows:
    - _uuid:
      - uuid
      - 074e07f9-857d-4aa1-b730-59f1618f8dad
      _version:
      - uuid
      - 0de2368a-3d57-427a-8e1f-c83a3f9b00d3
      admin_state:
      - set
      - []
      bfd:
      - map
      - []
      bfd_status:
      - map
      - []
      cfm_fault:
      - set
      - []
      cfm_fault_status:
      - set
      - []
      cfm_flap_count:
      - set
      - []
      cfm_health:
      - set
      - []
      cfm_mpid:
      - set
      - []
      cfm_remote_mpids:
      - set
      - []
      cfm_remote_opstate:
      - set
      - []
      duplex:
      - set
      - []
      external_ids:
      - map
      - []
      ifindex: 0
      ingress_policing_burst: 0
      ingress_policing_rate: 0
      lacp_current:
      - set
      - []
      link_resets:
      - set
      - []
      link_speed:
      - set
      - []
      link_state:
      - set
      - []
      mac:
      - set
      - []
      mac_in_use: 86:c4:d7:1c:05:a2
      mtu:
      - set
      - []
      name: patch-tun
      ofport: 1
      ofport_request:
      - set
      - []
      options:
      - map
      - - - peer
          - patch-int
      other_config:
      - map
      - []
      statistics:
      - map
      - - - collisions
          - 0
        - - rx_bytes
          - 0
        - - rx_crc_err
          - 0
        - - rx_dropped
          - 0
        - - rx_errors
          - 0
        - - rx_frame_err
          - 0
        - - rx_over_err
          - 0
        - - rx_packets
          - 0
        - - tx_bytes
          - 0
        - - tx_dropped
          - 0
        - - tx_errors
          - 0
        - - tx_packets
          - 0
      status:
      - map
      - []
      type: patch
[DEBUG] 2014-05-19 05:15:04,838 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=1,actions=resubmit(,1)
[DEBUG] 2014-05-19 05:15:04,855 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=0,priority=0,actions=drop
[DEBUG] 2014-05-19 05:15:04,871 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=01:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,19)
[DEBUG] 2014-05-19 05:15:04,900 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=00:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,20)
[DEBUG] 2014-05-19 05:15:04,914 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=2,priority=0,actions=drop
[DEBUG] 2014-05-19 05:15:04,923 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=3,priority=0,actions=drop
[DEBUG] 2014-05-19 05:15:04,943 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=10,priority=1,actions=learn(table=20,hard_timeout=300,priority=1,NXM_OF_VLAN_TCI[0..11],NXM_OF_ETH_DST[]=NXM_OF_ETH_SRC[],load:0->NXM_OF_VLAN_TCI[],load:NXM_NX_TUN_ID[]->NXM_NX_TUN_ID[],output:NXM_OF_IN_PORT[]),output:1
[DEBUG] 2014-05-19 05:15:04,956 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=19,priority=0,actions=resubmit(,21)
[DEBUG] 2014-05-19 05:15:04,967 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=20,priority=0,actions=resubmit(,21)
[DEBUG] 2014-05-19 05:15:04,976 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=21,priority=0,actions=drop
[DEBUG] 2014-05-19 05:15:04,986 module:ovsdb,function:crud,router:openwrt2
CRUD operation (add): {'ovs_bridges': 'enabled'}
[DEBUG] 2014-05-19 05:15:04,989 module:ovsdb,function:_send,router:openwrt2
request:
  id: 645962
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ovs_bridges: enabled
    table: NLAN_Bridges
    uuid-name: temp_551923
  - mutations:
    - - bridges
      - insert
      - - set
        - - - named-uuid
            - temp_551923
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 645962
  result:
  - uuid:
    - uuid
    - f4d4b13a-6128-491c-808f-f6f30c232209
  - count: 1
[DEBUG] 2014-05-19 05:15:04,993 module:ovsdb,function:_send,router:openwrt2
request:
  id: 223820
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Bridges
    where: []
response:
  error: null
  id: 223820
  result:
  - rows:
    - _uuid:
      - uuid
      - f4d4b13a-6128-491c-808f-f6f30c232209
      _version:
      - uuid
      - 24b8b36e-46e4-41ee-8ef9-b561510ed074
      controller:
      - set
      - []
      ovs_bridges: enabled
[INFO] 2014-05-19 05:15:05,001 module:nlan_agent,function:_route,router:openwrt2
function:vxlan.add, model:{'remote_ips': ['192.168.1.103', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.102'}
[DEBUG] 2014-05-19 05:15:05,002 module:ovsdb,function:_send,router:openwrt2
request:
  id: 554443
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 554443
  result:
  - rows:
    - _uuid:
      - uuid
      - 7acda763-620b-4421-83c6-c07597e92248
      _version:
      - uuid
      - 9b694d21-8adf-40ce-a0ac-53d95810a682
      bridges:
      - uuid
      - f4d4b13a-6128-491c-808f-f6f30c232209
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - set
      - []
      vxlan:
      - set
      - []
[DEBUG] 2014-05-19 05:15:05,008 module:ovsdb,function:_send,router:openwrt2
request:
  id: 22103
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_VXLAN
    where: []
response:
  error: null
  id: 22103
  result:
  - rows: []
[INFO] 2014-05-19 05:15:05,012 module:vxlan,function:add,router:openwrt2
Adding a VXLAN tunnel: vxlan_103
[DEBUG] 2014-05-19 05:15:05,013 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-tun vxlan_103 -- set interface vxlan_103 type=vxlan options:in_key=flow options:local_ip=192.168.1.102 options:out_key=flow options:remote_ip=192.168.1.103
[INFO] 2014-05-19 05:15:05,033 module:vxlan,function:add,router:openwrt2
Adding a VXLAN tunnel: vxlan_101
[DEBUG] 2014-05-19 05:15:05,034 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-tun vxlan_101 -- set interface vxlan_101 type=vxlan options:in_key=flow options:local_ip=192.168.1.102 options:out_key=flow options:remote_ip=192.168.1.101
[INFO] 2014-05-19 05:15:05,055 module:vxlan,function:add,router:openwrt2
Adding a VXLAN tunnel: vxlan_104
[DEBUG] 2014-05-19 05:15:05,055 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-tun vxlan_104 -- set interface vxlan_104 type=vxlan options:in_key=flow options:local_ip=192.168.1.102 options:out_key=flow options:remote_ip=192.168.1.104
[DEBUG] 2014-05-19 05:15:05,080 module:ovsdb,function:_send,router:openwrt2
request:
  id: 533914
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 533914
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-19 05:15:05,086 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=3,actions=resubmit(,2)
[DEBUG] 2014-05-19 05:15:05,096 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=2,actions=resubmit(,2)
[DEBUG] 2014-05-19 05:15:05,105 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=4,actions=resubmit(,2)
[DEBUG] 2014-05-19 05:15:05,114 module:ovsdb,function:crud,router:openwrt2
CRUD operation (add): {'remote_ips': ['192.168.1.103', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.102'}
[DEBUG] 2014-05-19 05:15:05,117 module:ovsdb,function:_send,router:openwrt2
request:
  id: 793911
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      local_ip: 192.168.1.102
      remote_ips:
      - set
      - - 192.168.1.103
        - 192.168.1.101
        - 192.168.1.104
    table: NLAN_VXLAN
    uuid-name: temp_306603
  - mutations:
    - - vxlan
      - insert
      - - set
        - - - named-uuid
            - temp_306603
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 793911
  result:
  - uuid:
    - uuid
    - 95116019-298e-458a-bc51-359458e88671
  - count: 1
[DEBUG] 2014-05-19 05:15:05,121 module:ovsdb,function:_send,router:openwrt2
request:
  id: 130248
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_VXLAN
    where: []
response:
  error: null
  id: 130248
  result:
  - rows:
    - _uuid:
      - uuid
      - 95116019-298e-458a-bc51-359458e88671
      _version:
      - uuid
      - 515adb8e-9721-4d7f-8e27-46a08679df79
      local_ip: 192.168.1.102
      remote_ips:
      - set
      - - 192.168.1.101
        - 192.168.1.103
        - 192.168.1.104
[INFO] 2014-05-19 05:15:05,138 module:nlan_agent,function:_route,router:openwrt2
function:subnets.add, index:['vni', 1], model:{'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 2, 'ip_vhost': '192.168.100.102/24', 'default_gw': '192.168.100.1', 'ip_dvr': OrderedDict([('addr', '192.168.100.2/24'), ('mode', 'dvr')]), 'vni': 1}
[DEBUG] 2014-05-19 05:15:05,140 module:ovsdb,function:_send,router:openwrt2
request:
  id: 35210
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 35210
  result:
  - rows:
    - _uuid:
      - uuid
      - 7acda763-620b-4421-83c6-c07597e92248
      _version:
      - uuid
      - 853291dc-d9cd-4270-b397-b7c500efc76d
      bridges:
      - uuid
      - f4d4b13a-6128-491c-808f-f6f30c232209
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - set
      - []
      vxlan:
      - uuid
      - 95116019-298e-458a-bc51-359458e88671
[DEBUG] 2014-05-19 05:15:05,146 module:ovsdb,function:_send,router:openwrt2
request:
  id: 674099
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1
response:
  error: null
  id: 674099
  result:
  - rows: []
[INFO] 2014-05-19 05:15:05,151 module:subnets,function:add,router:openwrt2
Adding a subnet(vlan): 2
[DEBUG] 2014-05-19 05:15:05,152 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addbr br1
[DEBUG] 2014-05-19 05:15:05,162 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int-br1 tag=2 -- set interface int-br1 type=internal
[DEBUG] 2014-05-19 05:15:05,202 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int-dvr1 tag=2 -- set interface int-dvr1 type=internal
[DEBUG] 2014-05-19 05:15:05,248 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br1 int-br1
[DEBUG] 2014-05-19 05:15:05,261 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-br1 promisc on
[DEBUG] 2014-05-19 05:15:05,266 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-br1 up
[DEBUG] 2014-05-19 05:15:05,277 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-dvr1 up
[DEBUG] 2014-05-19 05:15:05,281 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br1 up
[DEBUG] 2014-05-19 05:15:05,291 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns add ns1
[DEBUG] 2014-05-19 05:15:05,305 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link add veth-ns1 type veth peer name temp-ns1
[DEBUG] 2014-05-19 05:15:05,317 module:cmdutter:openwrt3
NLAN Agent execution completed
--- RESPONSE from router:openwrt3,platform:openwrt
message: Execution completed
exit: 0
il,function:_cmd2,router:openwrt2
cmd: ip link set dev temp-ns1 netns ns1
[DEBUG] 2014-05-19 05:15:05,324 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns1 ip link set dev temp-ns1 name eth0
[DEBUG] 2014-05-19 05:15:05,334 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br1 veth-ns1
[DEBUG] 2014-05-19 05:15:05,351 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns1 promisc on
[DEBUG] 2014-05-19 05:15:05,358 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns1 up
[DEBUG] 2014-05-19 05:15:05,374 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns1 ip link set dev eth0 up
[DEBUG] 2014-05-19 05:15:05,391 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns1 ip addr add dev eth0 192.168.100.102/24
[DEBUG] 2014-05-19 05:15:05,398 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns1 ip route add default via 192.168.100.2 dev eth0
[DEBUG] 2014-05-19 05:15:05,405 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip addr add dev int-dvr1 192.168.100.2/24
[DEBUG] 2014-05-19 05:15:05,411 module:cmdutil,function:_cmd2,router:openwrt2
cmd: route
[DEBUG] 2014-05-19 05:15:05,417 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip route add default via 192.168.100.1
[DEBUG] 2014-05-19 05:15:05,423 module:ovsdb,function:_send,router:openwrt2
request:
  id: 561222
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 561222
  result:
  - rows: []
[DEBUG] 2014-05-19 05:15:05,425 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=1,actions=mod_vlan_vid:2,resubmit(,10)
[DEBUG] 2014-05-19 05:15:05,435 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=2,nw_dst=192.168.100.2,actions=drop
[DEBUG] 2014-05-19 05:15:05,446 module:ovsdb,function:_send,router:openwrt2
request:
  id: 486401
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 486401
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-19 05:15:05,453 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=2,actions=strip_vlan,set_tunnel:1,output:3,output:2
[DEBUG] 2014-05-19 05:15:05,463 module:ovsdb,function:crud,router:openwrt2
CRUD operation (add): {'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 2, 'ip_vhost': '192.168.100.102/24', 'default_gw': '192.168.100.1', 'ip_dvr': OrderedDict([('addr', '192.168.100.2/24'), ('mode', 'dvr')]), 'vni': 1}
[DEBUG] 2014-05-19 05:15:05,468 module:ovsdb,function:_send,router:openwrt2
request:
  id: 132994
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      default_gw: 192.168.100.1
      ip_dvr:
      - map
      - - - addr
          - 192.168.100.2/24
        - - mode
          - dvr
      ip_vhost: 192.168.100.102/24
      peers:
      - set
      - - 192.168.1.101
        - 192.168.1.103
      vid: 2
      vni: 1
    table: NLAN_Subnet
    uuid-name: temp_891536
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_891536
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 132994
  result:
  - uuid:
    - uuid
    - 9e0e6b4e-7269-423f-98bd-4213cd3f3fec
  - count: 1
[DEBUG] 2014-05-19 05:15:05,473 module:ovsdb,function:_send,router:openwrt2
request:
  id: 655839
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1
response:
  error: null
  id: 655839
  result:
  - rows:
    - _uuid:
      - uuid
      - 9e0e6b4e-7269-423f-98bd-4213cd3f3fec
      _version:
      - uuid
      - bad4f352-419b-4347-95c8-ef55ec701523
      default_gw: 192.168.100.1
      ip_dvr:
      - map
      - - - addr
          - 192.168.100.2/24
        - - mode
          - dvr
      ip_vhost: 192.168.100.102/24
      peers:
      - set
      - - 192.168.1.101
        - 192.168.1.103
      ports:
      - set
      - []
      vid: 2
      vni: 1
[INFO] 2014-05-19 05:15:05,480 module:nlan_agent,function:_route,router:openwrt2
function:subnets.add, index:['vni', 103], model:{'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 3, 'ip_vhost': '10.0.3.102/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr')])}
[DEBUG] 2014-05-19 05:15:05,482 module:ovsdb,function:_send,router:openwrt2
request:
  id: 468654
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 468654
  result:
  - rows:
    - _uuid:
      - uuid
      - 7acda763-620b-4421-83c6-c07597e92248
      _version:
      - uuid
      - c8237877-bbe8-4a63-8476-7c277a804129
      bridges:
      - uuid
      - f4d4b13a-6128-491c-808f-f6f30c232209
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - uuid
      - 9e0e6b4e-7269-423f-98bd-4213cd3f3fec
      vxlan:
      - uuid
      - 95116019-298e-458a-bc51-359458e88671
[DEBUG] 2014-05-19 05:15:05,489 module:ovsdb,function:_send,router:openwrt2
request:
  id: 265196
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 103
response:
  error: null
  id: 265196
  result:
  - rows: []
[INFO] 2014-05-19 05:15:05,492 module:subnets,function:add,router:openwrt2
Adding a subnet(vlan): 3
[DEBUG] 2014-05-19 05:15:05,493 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addbr br103
[DEBUG] 2014-05-19 05:15:05,502 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int-br103 tag=3 -- set interface int-br103 type=internal
[DEBUG] 2014-05-19 05:15:05,540 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int-dvr103 tag=3 -- set interface int-dvr103 type=internal
[DEBUG] 2014-05-19 05:15:05,573 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br103 int-br103
[DEBUG] 2014-05-19 05:15:05,581 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-br103 promisc on
[DEBUG] 2014-05-19 05:15:05,588 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-br103 up
[DEBUG] 2014-05-19 05:15:05,594 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-dvr103 up
[DEBUG] 2014-05-19 05:15:05,600 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br103 up
[DEBUG] 2014-05-19 05:15:05,614 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns add ns103
[DEBUG] 2014-05-19 05:15:05,623 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link add veth-ns103 type veth peer name temp-ns103
[DEBUG] 2014-05-19 05:15:05,637 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev temp-ns103 netns ns103
[DEBUG] 2014-05-19 05:15:05,650 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns103 ip link set dev temp-ns103 name eth0
[DEBUG] 2014-05-19 05:15:05,659 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br103 veth-ns103
[DEBUG] 2014-05-19 05:15:05,669 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns103 promisc on
[DEBUG] 2014-05-19 05:15:05,680 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns103 up
[DEBUG] 2014-05-19 05:15:05,699 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns103 ip link set dev eth0 up
[DEBUG] 2014-05-19 05:15:05,710 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns103 ip addr add dev eth0 10.0.3.102/24
[DEBUG] 2014-05-19 05:15:05,719 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns103 ip route add default via 10.0.3.1 dev eth0
[DEBUG] 2014-05-19 05:15:05,727 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip addr add dev int-dvr103 10.0.3.1/24
[DEBUG] 2014-05-19 05:15:05,735 module:ovsdb,function:_send,router:openwrt2
request:
  id: 503559
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 503559
  result:
  - rows: []
[DEBUG] 2014-05-19 05:15:05,737 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=103,actions=mod_vlan_vid:3,resubmit(,10)
[DEBUG] 2014-05-19 05:15:05,746 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=3,nw_dst=10.0.3.1,actions=drop
[DEBUG] 2014-05-19 05:15:05,757 module:ovsdb,function:_send,router:openwrt2
request:
  id: 253344
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 253344
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-19 05:15:05,762 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=3,actions=strip_vlan,set_tunnel:103,output:3,output:2
[DEBUG] 2014-05-19 05:15:05,772 module:ovsdb,function:crud,router:openwrt2
CRUD operation (add): {'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 3, 'ip_vhost': '10.0.3.102/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr')])}
[DEBUG] 2014-05-19 05:15:05,776 module:ovsdb,function:_send,router:openwrt2
request:
  id: 797950
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ip_dvr:
      - map
      - - - addr
          - 10.0.3.1/24
        - - mode
          - dvr
      ip_vhost: 10.0.3.102/24
      peers:
      - set
      - - 192.168.1.101
        - 192.168.1.103
      vid: 3
      vni: 103
    table: NLAN_Subnet
    uuid-name: temp_408317
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_408317
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 797950
  result:
  - uuid:
    - uuid
    - a66ca0e2-af1e-4331-9b30-be754b616572
  - count: 1
[DEBUG] 2014-05-19 05:15:05,779 module:ovsdb,function:_send,router:openwrt2
request:
  id: 877411
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 103
response:
  error: null
  id: 877411
  result:
  - rows:
    - _uuid:
      - uuid
      - a66ca0e2-af1e-4331-9b30-be754b616572
      _version:
      - uuid
      - f33dada7-fd74-4891-9525-de2f50d4fec2
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - - - addr
          - 10.0.3.1/24
        - - mode
          - dvr
      ip_vhost: 10.0.3.102/24
      peers:
      - set
      - - 192.168.1.101
        - 192.168.1.103
      ports:
      - set
      - []
      vid: 3
      vni: 103
[INFO] 2014-05-19 05:15:05,786 module:nlan_agent,function:_route,router:openwrt2
function:subnets.add, index:['vni', 101], model:{'peers': ['192.168.1.103', '192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.102/24', 'vni': 101, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'spoke_dvr')])}
[DEBUG] 2014-05-19 05:15:05,787 module:ovsdb,function:_send,router:openwrt2
request:
  id: 951800
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 951800
  result:
  - rows:
    - _uuid:
      - uuid
      - 7acda763-620b-4421-83c6-c07597e92248
      _version:
      - uuid
      - 9fdeebd9-ef17-402f-967c-1aac009fc7f7
      bridges:
      - uuid
      - f4d4b13a-6128-491c-808f-f6f30c232209
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - set
      - - - uuid
          - 9e0e6b4e-7269-423f-98bd-4213cd3f3fec
        - - uuid
          - a66ca0e2-af1e-4331-9b30-be754b616572
      vxlan:
      - uuid
      - 95116019-298e-458a-bc51-359458e88671
[DEBUG] 2014-05-19 05:15:05,792 module:ovsdb,function:_send,router:openwrt2
request:
  id: 933766
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 101
response:
  error: null
  id: 933766
  result:
  - rows: []
[INFO] 2014-05-19 05:15:05,793 module:subnets,function:add,router:openwrt2
Adding a subnet(vlan): 1
[DEBUG] 2014-05-19 05:15:05,794 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addbr br101
[DEBUG] 2014-05-19 05:15:05,802 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int-br101 tag=1 -- set interface int-br101 type=internal
[DEBUG] 2014-05-19 05:15:05,830 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int-dvr101 tag=1 -- set interface int-dvr101 type=internal
[DEBUG] 2014-05-19 05:15:05,864 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br101 int-br101
[DEBUG] 2014-05-19 05:15:05,875 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-br101 promisc on
[DEBUG] 2014-05-19 05:15:05,879 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-br101 up
[DEBUG] 2014-05-19 05:15:05,885 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-dvr101 up
[DEBUG] 2014-05-19 05:15:05,888 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br101 up
[DEBUG] 2014-05-19 05:15:05,901 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns add ns101
[DEBUG] 2014-05-19 05:15:05,913 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link add veth-ns101 type veth peer name temp-ns101
[DEBUG] 2014-05-19 05:15:05,923 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev temp-ns101 netns ns101
[DEBUG] 2014-05-19 05:15:05,933 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns101 ip link set dev temp-ns101 name eth0
[DEBUG] 2014-05-19 05:15:05,940 module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br101 veth-ns101
[DEBUG] 2014-05-19 05:15:05,955 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns101 promisc on
[DEBUG] 2014-05-19 05:15:05,961 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns101 up
[DEBUG] 2014-05-19 05:15:05,977 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns101 ip link set dev eth0 up
[DEBUG] 2014-05-19 05:15:05,987 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns101 ip addr add dev eth0 10.0.1.102/24
[DEBUG] 2014-05-19 05:15:05,998 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns101 ip route add default via 10.0.1.1 dev eth0
[DEBUG] 2014-05-19 05:15:06,003 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip addr add dev int-dvr101 10.0.1.1/24
[DEBUG] 2014-05-19 05:15:06,011 module:ovsdb,function:_send,router:openwrt2
request:
  id: 551884
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 551884
  result:
  - rows: []
[DEBUG] 2014-05-19 05:15:06,014 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=101,actions=mod_vlan_vid:1,resubmit(,10)
[DEBUG] 2014-05-19 05:15:06,031 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link show dev int-dvr101
[DEBUG] 2014-05-19 05:15:06,038 module:ovsdb,function:_send,router:openwrt2
request:
  id: 395293
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: Interface
    where:
    - - name
      - ==
      - int-dvr101
response:
  error: null
  id: 395293
  result:
  - rows:
    - _uuid:
      - uuid
      - 91c95435-99b4-4b32-87e3-a96cdc18c546
      _version:
      - uuid
      - 1f3cdfa6-31fd-452c-b597-eba53ff1249b
      admin_state: up
      bfd:
      - map
      - []
      bfd_status:
      - map
      - []
      cfm_fault:
      - set
      - []
      cfm_fault_status:
      - set
      - []
      cfm_flap_count:
      - set
      - []
      cfm_health:
      - set
      - []
      cfm_mpid:
      - set
      - []
      cfm_remote_mpids:
      - set
      - []
      cfm_remote_opstate:
      - set
      - []
      duplex:
      - set
      - []
      external_ids:
      - map
      - []
      ifindex: 44
      ingress_policing_burst: 0
      ingress_policing_rate: 0
      lacp_current:
      - set
      - []
      link_resets: 2
      link_speed:
      - set
      - []
      link_state: up
      mac:
      - set
      - []
      mac_in_use: ba:85:15:a7:b1:4c
      mtu: 1500
      name: int-dvr101
      ofport: 7
      ofport_request:
      - set
      - []
      options:
      - map
      - []
      other_config:
      - map
      - []
      statistics:
      - map
      - - - collisions
          - 0
        - - rx_bytes
          - 0
        - - rx_crc_err
          - 0
        - - rx_dropped
          - 0
        - - rx_errors
          - 0
        - - rx_frame_err
          - 0
        - - rx_over_err
          - 0
        - - rx_packets
          - 0
        - - tx_bytes
          - 0
        - - tx_dropped
          - 0
        - - tx_errors
          - 0
        - - tx_packets
          - 0
      status:
      - map
      - - - driver_name
          - openvswitch
      type: internal
[DEBUG] 2014-05-19 05:15:06,053 module:ovsdb,function:_send,router:openwrt2
request:
  id: 568235
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: Interface
    where:
    - - name
      - ==
      - int-br101
response:
  error: null
  id: 568235
  result:
  - rows:
    - _uuid:
      - uuid
      - a4075998-5ea3-48f9-88e4-f47995f51456
      _version:
      - uuid
      - bc7281c6-2825-4dd3-a22e-4a69f1aea779
      admin_state: up
      bfd:
      - map
      - []
      bfd_status:
      - map
      - []
      cfm_fault:
      - set
      - []
      cfm_fault_status:
      - set
      - []
      cfm_flap_count:
      - set
      - []
      cfm_health:
      - set
      - []
      cfm_mpid:
      - set
      - []
      cfm_remote_mpids:
      - set
      - []
      cfm_remote_opstate:
      - set
      - []
      duplex:
      - set
      - []
      external_ids:
      - map
      - []
      ifindex: 43
      ingress_policing_burst: 0
      ingress_policing_rate: 0
      lacp_current:
      - set
      - []
      link_resets: 2
      link_speed:
      - set
      - []
      link_state: up
      mac:
      - set
      - []
      mac_in_use: f2:32:37:27:8c:3f
      mtu: 1500
      name: int-br101
      ofport: 6
      ofport_request:
      - set
      - []
      options:
      - map
      - []
      other_config:
      - map
      - []
      statistics:
      - map
      - - - collisions
          - 0
        - - rx_bytes
          - 0
        - - rx_crc_err
          - 0
        - - rx_dropped
          - 0
        - - rx_errors
          - 0
        - - rx_frame_err
          - 0
        - - rx_over_err
          - 0
        - - rx_packets
          - 0
        - - tx_bytes
          - 0
        - - tx_dropped
          - 0
        - - tx_errors
          - 0
        - - tx_packets
          - 0
      status:
      - map
      - - - driver_name
          - openvswitch
      type: internal
[DEBUG] 2014-05-19 05:15:06,065 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=0,priority=2,in_port=6,dl_type=0x0800,nw_dst=10.0.1.0/24,actions=normal
[DEBUG] 2014-05-19 05:15:06,073 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=10.0.0.0/8,actions=resubmit(,1)
[DEBUG] 2014-05-19 05:15:06,079 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=172.16.0.0/12,actions=resubmit(,1)
[DEBUG] 2014-05-19 05:15:06,089 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=192.168.0.0/16,actions=resubmit(,1)
[DEBUG] 2014-05-19 05:15:06,096 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=7,dl_type=0x0806,nw_src=10.0.1.1,nw_proto=2,actions=drop
[DEBUG] 2014-05-19 05:15:06,104 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=1,priority=0,in_port=6,actions=set_field:ba:85:15:a7:b1:4c->dl_dst,output:7
[DEBUG] 2014-05-19 05:15:06,113 module:ovsdb,function:_send,router:openwrt2
request:
  id: 299379
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 299379
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.101
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.102
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-19 05:15:06,118 module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=1,actions=strip_vlan,set_tunnel:101,output:2,output:4
[DEBUG] 2014-05-19 05:15:06,125 module:ovsdb,function:crud,router:openwrt2
CRUD operation (add): {'peers': ['192.168.1.103', '192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.102/24', 'vni': 101, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'spoke_dvr')])}
[DEBUG] 2014-05-19 05:15:06,127 module:ovsdb,function:_send,router:openwrt2
request:
  id: 169617
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ip_dvr:
      - map
      - - - addr
          - 10.0.1.1/24
        - - mode
          - spoke_dvr
      ip_vhost: 10.0.1.102/24
      peers:
      - set
      - - 192.168.1.103
        - 192.168.1.104
      vid: 1
      vni: 101
    table: NLAN_Subnet
    uuid-name: temp_584983
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_584983
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 169617
  result:
  - uuid:
    - uuid
    - 16266217-53a8-4f0e-ab12-4f4614c3e98f
  - count: 1
[DEBUG] 2014-05-19 05:15:06,130 module:ovsdb,function:_send,router:openwrt2
request:
  id: 481838
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 101
response:
  error: null
  id: 481838
  result:
  - rows:
    - _uuid:
      - uuid
      - 16266217-53a8-4f0e-ab12-4f4614c3e98f
      _version:
      - uuid
      - 3c6f38c1-4641-408f-85ea-4bce2da9bc19
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - - - addr
          - 10.0.1.1/24
        - - mode
          - spoke_dvr
      ip_vhost: 10.0.1.102/24
      peers:
      - set
      - - 192.168.1.103
        - 192.168.1.104
      ports:
      - set
      - []
      vid: 1
      vni: 101
[INFO] 2014-05-19 05:15:06,135 module:nlan_agent,function:<module>,router:openwrt2
NLAN Agent execution completed
--- RESPONSE from router:openwrt2,platform:openwrt
message: Execution completed
exit: 0
--- STDOUT from router:openwrt1,platform:openwrt
[INFO] 2014-05-19 05:15:04,721 module:nlan_agent,function:<module>,router:openwrt1
NLAN Agent initialization completed
[DEBUG] 2014-05-19 05:15:04,723 module:nlan_agent,function:<module>,router:openwrt1
__n__: {'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'platform': 'openwrt', 'share_dir': '/opt/nlan/share', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'logger': <logging.Logger object at 0xb760ba6c>, 'router': 'openwrt1', 'schema': 'ovsdb_nlan.schema', 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'enum': ['set', ['enabled']], 'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'ip_dvr': {'max': 2, 'value': {'type': 'string'}, 'key': {'enum': ['set', ['addr', 'mode']], 'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}}, 'indexes': {'services': 'name', 'subnets': 'vni'}}
[INFO] 2014-05-19 05:15:04,849 module:nlan_agent,function:_route,router:openwrt1
function:bridges.add, model:{'ovs_bridges': 'enabled'}
[DEBUG] 2014-05-19 05:15:04,859 module:ovsdb,function:_send,router:openwrt1
request:
  id: 541936
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 541936
  result:
  - rows: []
[DEBUG] 2014-05-19 05:15:04,862 module:ovsdb,function:_send,router:openwrt1
request:
  id: 760544
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row: {}
    table: NLAN
response:
  error: null
  id: 760544
  result:
  - uuid:
    - uuid
    - e90816b3-b14c-4ec9-97bf-ff9e8614fb48
[DEBUG] 2014-05-19 05:15:04,865 module:ovsdb,function:_send,router:openwrt1
request:
  id: 755782
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Bridges
    where: []
response:
  error: null
  id: 755782
  result:
  - rows: []
[INFO] 2014-05-19 05:15:04,868 module:bridges,function:add,router:openwrt1
Adding bridges: br-int and br-tun
[DEBUG] 2014-05-19 05:15:04,900 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-br br-int
[DEBUG] 2014-05-19 05:15:04,930 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-br br-tun
[DEBUG] 2014-05-19 05:15:04,978 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl del-flows br-tun
[DEBUG] 2014-05-19 05:15:04,992 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int patch-int -- set interface patch-int type=patch options:peer=patch-tun
[DEBUG] 2014-05-19 05:15:05,017 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-tun patch-tun -- set interface patch-tun type=patch options:peer=patch-int
[DEBUG] 2014-05-19 05:15:05,044 module:ovsdb,function:_send,router:openwrt1
request:
  id: 837979
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: Interface
    where:
    - - name
      - ==
      - patch-tun
response:
  error: null
  id: 837979
  result:
  - rows:
    - _uuid:
      - uuid
      - 780bf90a-2247-4947-90a1-d89991bdad38
      _version:
      - uuid
      - b6b5fd57-6a9e-4fcf-bebb-4788b3406cea
      admin_state:
      - set
      - []
      bfd:
      - map
      - []
      bfd_status:
      - map
      - []
      cfm_fault:
      - set
      - []
      cfm_fault_status:
      - set
      - []
      cfm_flap_count:
      - set
      - []
      cfm_health:
      - set
      - []
      cfm_mpid:
      - set
      - []
      cfm_remote_mpids:
      - set
      - []
      cfm_remote_opstate:
      - set
      - []
      duplex:
      - set
      - []
      external_ids:
      - map
      - []
      ifindex: 0
      ingress_policing_burst: 0
      ingress_policing_rate: 0
      lacp_current:
      - set
      - []
      link_resets:
      - set
      - []
      link_speed:
      - set
      - []
      link_state:
      - set
      - []
      mac:
      - set
      - []
      mac_in_use: 42:9d:7c:bc:a8:9f
      mtu:
      - set
      - []
      name: patch-tun
      ofport: 1
      ofport_request:
      - set
      - []
      options:
      - map
      - - - peer
          - patch-int
      other_config:
      - map
      - []
      statistics:
      - map
      - - - collisions
          - 0
        - - rx_bytes
          - 0
        - - rx_crc_err
          - 0
        - - rx_dropped
          - 0
        - - rx_errors
          - 0
        - - rx_frame_err
          - 0
        - - rx_over_err
          - 0
        - - rx_packets
          - 0
        - - tx_bytes
          - 0
        - - tx_dropped
          - 0
        - - tx_errors
          - 0
        - - tx_packets
          - 0
      status:
      - map
      - []
      type: patch
[DEBUG] 2014-05-19 05:15:05,066 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=1,actions=resubmit(,1)
[DEBUG] 2014-05-19 05:15:05,076 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=0,actions=drop
[DEBUG] 2014-05-19 05:15:05,085 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=01:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,19)
[DEBUG] 2014-05-19 05:15:05,097 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=00:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,20)
[DEBUG] 2014-05-19 05:15:05,107 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=2,priority=0,actions=drop
[DEBUG] 2014-05-19 05:15:05,123 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=3,priority=0,actions=drop
[DEBUG] 2014-05-19 05:15:05,148 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=10,priority=1,actions=learn(table=20,hard_timeout=300,priority=1,NXM_OF_VLAN_TCI[0..11],NXM_OF_ETH_DST[]=NXM_OF_ETH_SRC[],load:0->NXM_OF_VLAN_TCI[],load:NXM_NX_TUN_ID[]->NXM_NX_TUN_ID[],output:NXM_OF_IN_PORT[]),output:1
[DEBUG] 2014-05-19 05:15:05,172 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=19,priority=0,actions=resubmit(,21)
[DEBUG] 2014-05-19 05:15:05,182 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=20,priority=0,actions=resubmit(,21)
[DEBUG] 2014-05-19 05:15:05,191 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=21,priority=0,actions=drop
[DEBUG] 2014-05-19 05:15:05,202 module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'ovs_bridges': 'enabled'}
[DEBUG] 2014-05-19 05:15:05,205 module:ovsdb,function:_send,router:openwrt1
request:
  id: 48711
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ovs_bridges: enabled
    table: NLAN_Bridges
    uuid-name: temp_476984
  - mutations:
    - - bridges
      - insert
      - - set
        - - - named-uuid
            - temp_476984
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 48711
  result:
  - uuid:
    - uuid
    - 08de3b71-6efb-4161-87f5-85b292b533a6
  - count: 1
[DEBUG] 2014-05-19 05:15:05,209 module:ovsdb,function:_send,router:openwrt1
request:
  id: 476038
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Bridges
    where: []
response:
  error: null
  id: 476038
  result:
  - rows:
    - _uuid:
      - uuid
      - 08de3b71-6efb-4161-87f5-85b292b533a6
      _version:
      - uuid
      - c31da2ef-2825-4f8a-9fd6-45739b93308a
      controller:
      - set
      - []
      ovs_bridges: enabled
[INFO] 2014-05-19 05:15:05,216 module:nlan_agent,function:_route,router:openwrt1
function:gateway.add, model:{'network': 'eth2', 'rip': 'enabled'}
[DEBUG] 2014-05-19 05:15:05,218 module:ovsdb,function:_send,router:openwrt1
request:
  id: 427303
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 427303
  result:
  - rows:
    - _uuid:
      - uuid
      - e90816b3-b14c-4ec9-97bf-ff9e8614fb48
      _version:
      - uuid
      - 2f9b5586-00db-4cdc-8df1-e1c95f7c8177
      bridges:
      - uuid
      - 08de3b71-6efb-4161-87f5-85b292b533a6
      gateway:
      - set
      - []
      services:
      - set
      - []
      subnets:
      - set
      - []
      vxlan:
      - set
      - []
[DEBUG] 2014-05-19 05:15:05,224 module:ovsdb,function:_send,router:openwrt1
request:
  id: 961711
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Gateway
    where: []
response:
  error: null
  id: 961711
  result:
  - rows: []
[INFO] 2014-05-19 05:15:05,230 module:gateway,function:add,router:openwrt1
Adding a gateway router: rip
[DEBUG] 2014-05-19 05:15:05,231 module:cmdutil,function:_cmd2,router:openwrt1
cmd: vtysh -c configure terminal -c interface eth2 -c link-detect -c exit -c router rip -c version 2 -c redistribute connected -c network eth2 -c exit -c exit -c write -c exit
[DEBUG] 2014-05-19 05:15:05,315 module:cmdutil,function:_cmd2,router:openwrt1
cmd: /etc/init.d/quagga start
[DEBUG] 2014-05-19 05:15:05,432 module:cmdutil,function:_cmd2,router:openwrt1
cmd: vtysh -c configure terminal -c interface eth2 -c link-detect -c exit -c router rip -c version 2 -c redistribute connected -c network eth2 -c exit -c exit -c write -c exit
[DEBUG] 2014-05-19 05:15:05,588 module:cmdutil,function:_cmd2,router:openwrt1
cmd: /etc/init.d/quagga restart
[DEBUG] 2014-05-19 05:15:07,797 module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'network': 'eth2', 'rip': 'enabled'}
[DEBUG] 2014-05-19 05:15:07,801 module:ovsdb,function:_send,router:openwrt1
request:
  id: 775223
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      network: eth2
      rip: enabled
    table: NLAN_Gateway
    uuid-name: temp_345487
  - mutations:
    - - gateway
      - insert
      - - set
        - - - named-uuid
            - temp_345487
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 775223
  result:
  - uuid:
    - uuid
    - 801580ad-9484-404a-8a69-3dfab0ff4c42
  - count: 1
[DEBUG] 2014-05-19 05:15:07,810 module:ovsdb,function:_send,router:openwrt1
request:
  id: 72575
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Gateway
    where: []
response:
  error: null
  id: 72575
  result:
  - rows:
    - _uuid:
      - uuid
      - 801580ad-9484-404a-8a69-3dfab0ff4c42
      _version:
      - uuid
      - 4cd09f7a-7cfd-4c44-91e3-7d5defaf147b
      network: eth2
      rip: enabled
[INFO] 2014-05-19 05:15:07,816 module:nlan_agent,function:_route,router:openwrt1
function:vxlan.add, model:{'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.104'], 'local_ip': '192.168.1.101'}
[DEBUG] 2014-05-19 05:15:07,822 module:ovsdb,function:_send,router:openwrt1
request:
  id: 147010
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 147010
  result:
  - rows:
    - _uuid:
      - uuid
      - e90816b3-b14c-4ec9-97bf-ff9e8614fb48
      _version:
      - uuid
      - 51b3cda2-5418-490e-a3ab-2ce058458ca1
      bridges:
      - uuid
      - 08de3b71-6efb-4161-87f5-85b292b533a6
      gateway:
      - uuid
      - 801580ad-9484-404a-8a69-3dfab0ff4c42
      services:
      - set
      - []
      subnets:
      - set
      - []
      vxlan:
      - set
      - []
[DEBUG] 2014-05-19 05:15:07,828 module:ovsdb,function:_send,router:openwrt1
request:
  id: 8706
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_VXLAN
    where: []
response:
  error: null
  id: 8706
  result:
  - rows: []
[INFO] 2014-05-19 05:15:07,832 module:vxlan,function:add,router:openwrt1
Adding a VXLAN tunnel: vxlan_103
[DEBUG] 2014-05-19 05:15:07,833 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-tun vxlan_103 -- set interface vxlan_103 type=vxlan options:in_key=flow options:local_ip=192.168.1.101 options:out_key=flow options:remote_ip=192.168.1.103
[INFO] 2014-05-19 05:15:07,854 module:vxlan,function:add,router:openwrt1
Adding a VXLAN tunnel: vxlan_102
[DEBUG] 2014-05-19 05:15:07,854 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-tun vxlan_102 -- set interface vxlan_102 type=vxlan options:in_key=flow options:local_ip=192.168.1.101 options:out_key=flow options:remote_ip=192.168.1.102
[INFO] 2014-05-19 05:15:07,877 module:vxlan,function:add,router:openwrt1
Adding a VXLAN tunnel: vxlan_104
[DEBUG] 2014-05-19 05:15:07,878 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-tun vxlan_104 -- set interface vxlan_104 type=vxlan options:in_key=flow options:local_ip=192.168.1.101 options:out_key=flow options:remote_ip=192.168.1.104
[DEBUG] 2014-05-19 05:15:07,902 module:ovsdb,function:_send,router:openwrt1
request:
  id: 134371
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 134371
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-19 05:15:07,908 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=3,actions=resubmit(,2)
[DEBUG] 2014-05-19 05:15:07,918 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=2,actions=resubmit(,2)
[DEBUG] 2014-05-19 05:15:07,927 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=4,actions=resubmit(,2)
[DEBUG] 2014-05-19 05:15:07,938 module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.104'], 'local_ip': '192.168.1.101'}
[DEBUG] 2014-05-19 05:15:07,942 module:ovsdb,function:_send,router:openwrt1
request:
  id: 772373
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      local_ip: 192.168.1.101
      remote_ips:
      - set
      - - 192.168.1.103
        - 192.168.1.102
        - 192.168.1.104
    table: NLAN_VXLAN
    uuid-name: temp_194175
  - mutations:
    - - vxlan
      - insert
      - - set
        - - - named-uuid
            - temp_194175
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 772373
  result:
  - uuid:
    - uuid
    - 8e0b0ef1-7aff-429a-8e79-90833bd73c10
  - count: 1
[DEBUG] 2014-05-19 05:15:07,945 module:ovsdb,function:_send,router:openwrt1
request:
  id: 780204
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_VXLAN
    where: []
response:
  error: null
  id: 780204
  result:
  - rows:
    - _uuid:
      - uuid
      - 8e0b0ef1-7aff-429a-8e79-90833bd73c10
      _version:
      - uuid
      - 9fc09370-dfe2-43ee-b3c6-11f6f9df8d3d
      local_ip: 192.168.1.101
      remote_ips:
      - set
      - - 192.168.1.102
        - 192.168.1.103
        - 192.168.1.104
[INFO] 2014-05-19 05:15:07,963 module:nlan_agent,function:_route,router:openwrt1
function:subnets.add, index:['vni', 1], model:{'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 2, 'ip_vhost': '192.168.100.101/24', 'vni': 1, 'ip_dvr': OrderedDict([('addr', '192.168.100.1/24'), ('mode', 'dvr')])}
[DEBUG] 2014-05-19 05:15:07,966 module:ovsdb,function:_send,router:openwrt1
request:
  id: 771689
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 771689
  result:
  - rows:
    - _uuid:
      - uuid
      - e90816b3-b14c-4ec9-97bf-ff9e8614fb48
      _version:
      - uuid
      - fb72f3f6-758b-4c05-9467-91db25e54cf2
      bridges:
      - uuid
      - 08de3b71-6efb-4161-87f5-85b292b533a6
      gateway:
      - uuid
      - 801580ad-9484-404a-8a69-3dfab0ff4c42
      services:
      - set
      - []
      subnets:
      - set
      - []
      vxlan:
      - uuid
      - 8e0b0ef1-7aff-429a-8e79-90833bd73c10
[DEBUG] 2014-05-19 05:15:07,973 module:ovsdb,function:_send,router:openwrt1
request:
  id: 386508
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1
response:
  error: null
  id: 386508
  result:
  - rows: []
[INFO] 2014-05-19 05:15:07,977 module:subnets,function:add,router:openwrt1
Adding a subnet(vlan): 2
[DEBUG] 2014-05-19 05:15:07,978 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addbr br1
[DEBUG] 2014-05-19 05:15:07,990 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int-br1 tag=2 -- set interface int-br1 type=internal
[DEBUG] 2014-05-19 05:15:08,027 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int-dvr1 tag=2 -- set interface int-dvr1 type=internal
[DEBUG] 2014-05-19 05:15:08,077 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br1 int-br1
[DEBUG] 2014-05-19 05:15:08,091 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-br1 promisc on
[DEBUG] 2014-05-19 05:15:08,101 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-br1 up
[DEBUG] 2014-05-19 05:15:08,107 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-dvr1 up
[DEBUG] 2014-05-19 05:15:08,111 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br1 up
[DEBUG] 2014-05-19 05:15:08,126 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns add ns1
[DEBUG] 2014-05-19 05:15:08,135 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link add veth-ns1 type veth peer name temp-ns1
[DEBUG] 2014-05-19 05:15:08,151 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev temp-ns1 netns ns1
[DEBUG] 2014-05-19 05:15:08,160 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1 ip link set dev temp-ns1 name eth0
[DEBUG] 2014-05-19 05:15:08,171 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br1 veth-ns1
[DEBUG] 2014-05-19 05:15:08,185 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1 promisc on
[DEBUG] 2014-05-19 05:15:08,194 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1 up
[DEBUG] 2014-05-19 05:15:08,216 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1 ip link set dev eth0 up
[DEBUG] 2014-05-19 05:15:08,234 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1 ip addr add dev eth0 192.168.100.101/24
[DEBUG] 2014-05-19 05:15:08,246 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1 ip route add default via 192.168.100.1 dev eth0
[DEBUG] 2014-05-19 05:15:08,255 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip addr add dev int-dvr1 192.168.100.1/24
[DEBUG] 2014-05-19 05:15:08,264 module:ovsdb,function:_send,router:openwrt1
request:
  id: 759402
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 759402
  result:
  - rows: []
[DEBUG] 2014-05-19 05:15:08,267 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=1,actions=mod_vlan_vid:2,resubmit(,10)
[DEBUG] 2014-05-19 05:15:08,279 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=2,nw_dst=192.168.100.1,actions=drop
[DEBUG] 2014-05-19 05:15:08,290 module:ovsdb,function:_send,router:openwrt1
request:
  id: 616856
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 616856
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-19 05:15:08,298 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=2,actions=strip_vlan,set_tunnel:1,output:3,output:2
[DEBUG] 2014-05-19 05:15:08,308 module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 2, 'ip_vhost': '192.168.100.101/24', 'vni': 1, 'ip_dvr': OrderedDict([('addr', '192.168.100.1/24'), ('mode', 'dvr')])}
[DEBUG] 2014-05-19 05:15:08,312 module:ovsdb,function:_send,router:openwrt1
request:
  id: 927858
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ip_dvr:
      - map
      - - - addr
          - 192.168.100.1/24
        - - mode
          - dvr
      ip_vhost: 192.168.100.101/24
      peers:
      - set
      - - 192.168.1.102
        - 192.168.1.103
      vid: 2
      vni: 1
    table: NLAN_Subnet
    uuid-name: temp_360133
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_360133
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 927858
  result:
  - uuid:
    - uuid
    - 0e4f432a-4cf5-43fc-936d-3c6df98ee7ac
  - count: 1
[DEBUG] 2014-05-19 05:15:08,315 module:ovsdb,function:_send,router:openwrt1
request:
  id: 684180
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1
response:
  error: null
  id: 684180
  result:
  - rows:
    - _uuid:
      - uuid
      - 0e4f432a-4cf5-43fc-936d-3c6df98ee7ac
      _version:
      - uuid
      - 62ee5a8d-6cfa-4f58-965d-3b0504a5ba87
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - - - addr
          - 192.168.100.1/24
        - - mode
          - dvr
      ip_vhost: 192.168.100.101/24
      peers:
      - set
      - - 192.168.1.102
        - 192.168.1.103
      ports:
      - set
      - []
      vid: 2
      vni: 1
[INFO] 2014-05-19 05:15:08,321 module:nlan_agent,function:_route,router:openwrt1
function:subnets.add, index:['vni', 103], model:{'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 3, 'ip_vhost': '10.0.3.101/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr')])}
[DEBUG] 2014-05-19 05:15:08,323 module:ovsdb,function:_send,router:openwrt1
request:
  id: 986139
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 986139
  result:
  - rows:
    - _uuid:
      - uuid
      - e90816b3-b14c-4ec9-97bf-ff9e8614fb48
      _version:
      - uuid
      - 5d2eb018-472c-492e-b45b-3b770a238167
      bridges:
      - uuid
      - 08de3b71-6efb-4161-87f5-85b292b533a6
      gateway:
      - uuid
      - 801580ad-9484-404a-8a69-3dfab0ff4c42
      services:
      - set
      - []
      subnets:
      - uuid
      - 0e4f432a-4cf5-43fc-936d-3c6df98ee7ac
      vxlan:
      - uuid
      - 8e0b0ef1-7aff-429a-8e79-90833bd73c10
[DEBUG] 2014-05-19 05:15:08,329 module:ovsdb,function:_send,router:openwrt1
request:
  id: 135267
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 103
response:
  error: null
  id: 135267
  result:
  - rows: []
[INFO] 2014-05-19 05:15:08,332 module:subnets,function:add,router:openwrt1
Adding a subnet(vlan): 3
[DEBUG] 2014-05-19 05:15:08,333 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addbr br103
[DEBUG] 2014-05-19 05:15:08,343 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int-br103 tag=3 -- set interface int-br103 type=internal
[DEBUG] 2014-05-19 05:15:08,385 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int-dvr103 tag=3 -- set interface int-dvr103 type=internal
[DEBUG] 2014-05-19 05:15:08,441 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br103 int-br103
[DEBUG] 2014-05-19 05:15:08,450 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-br103 promisc on
[DEBUG] 2014-05-19 05:15:08,458 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-br103 up
[DEBUG] 2014-05-19 05:15:08,469 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-dvr103 up
[DEBUG] 2014-05-19 05:15:08,474 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br103 up
[DEBUG] 2014-05-19 05:15:08,486 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns add ns103
[DEBUG] 2014-05-19 05:15:08,496 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link add veth-ns103 type veth peer name temp-ns103
[DEBUG] 2014-05-19 05:15:08,512 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev temp-ns103 netns ns103
[DEBUG] 2014-05-19 05:15:08,525 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns103 ip link set dev temp-ns103 name eth0
[DEBUG] 2014-05-19 05:15:08,537 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br103 veth-ns103
[DEBUG] 2014-05-19 05:15:08,550 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns103 promisc on
[DEBUG] 2014-05-19 05:15:08,560 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns103 up
[DEBUG] 2014-05-19 05:15:08,586 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns103 ip link set dev eth0 up
[DEBUG] 2014-05-19 05:15:08,600 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns103 ip addr add dev eth0 10.0.3.101/24
[DEBUG] 2014-05-19 05:15:08,611 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns103 ip route add default via 10.0.3.1 dev eth0
[DEBUG] 2014-05-19 05:15:08,619 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip addr add dev int-dvr103 10.0.3.1/24
[DEBUG] 2014-05-19 05:15:08,627 module:ovsdb,function:_send,router:openwrt1
request:
  id: 209009
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 209009
  result:
  - rows: []
[DEBUG] 2014-05-19 05:15:08,629 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=103,actions=mod_vlan_vid:3,resubmit(,10)
[DEBUG] 2014-05-19 05:15:08,639 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=3,nw_dst=10.0.3.1,actions=drop
[DEBUG] 2014-05-19 05:15:08,655 module:ovsdb,function:_send,router:openwrt1
request:
  id: 365150
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 365150
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-19 05:15:08,666 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=3,actions=strip_vlan,set_tunnel:103,output:3,output:2
[DEBUG] 2014-05-19 05:15:08,679 module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 3, 'ip_vhost': '10.0.3.101/24', 'vni': 103, 'ip_dvr': OrderedDict([('addr', '10.0.3.1/24'), ('mode', 'dvr')])}
[DEBUG] 2014-05-19 05:15:08,685 module:ovsdb,function:_send,router:openwrt1
request:
  id: 152084
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ip_dvr:
      - map
      - - - addr
          - 10.0.3.1/24
        - - mode
          - dvr
      ip_vhost: 10.0.3.101/24
      peers:
      - set
      - - 192.168.1.102
        - 192.168.1.103
      vid: 3
      vni: 103
    table: NLAN_Subnet
    uuid-name: temp_581431
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_581431
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 152084
  result:
  - uuid:
    - uuid
    - b9d5e573-a687-499f-8710-e55a758858a6
  - count: 1
[DEBUG] 2014-05-19 05:15:08,691 module:ovsdb,function:_send,router:openwrt1
request:
  id: 13258
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 103
response:
  error: null
  id: 13258
  result:
  - rows:
    - _uuid:
      - uuid
      - b9d5e573-a687-499f-8710-e55a758858a6
      _version:
      - uuid
      - e7289247-8964-4e83-b284-7c87e5c9d17e
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - - - addr
          - 10.0.3.1/24
        - - mode
          - dvr
      ip_vhost: 10.0.3.101/24
      peers:
      - set
      - - 192.168.1.102
        - 192.168.1.103
      ports:
      - set
      - []
      vid: 3
      vni: 103
[INFO] 2014-05-19 05:15:08,697 module:nlan_agent,function:_route,router:openwrt1
function:subnets.add, index:['vni', 1001], model:{'peers': ['192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.101/24', 'vni': 1001, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'hub')])}
[DEBUG] 2014-05-19 05:15:08,699 module:ovsdb,function:_send,router:openwrt1
request:
  id: 379036
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN
    where: []
response:
  error: null
  id: 379036
  result:
  - rows:
    - _uuid:
      - uuid
      - e90816b3-b14c-4ec9-97bf-ff9e8614fb48
      _version:
      - uuid
      - 02da62d4-455d-4071-9f12-27efd0e2ecf3
      bridges:
      - uuid
      - 08de3b71-6efb-4161-87f5-85b292b533a6
      gateway:
      - uuid
      - 801580ad-9484-404a-8a69-3dfab0ff4c42
      services:
      - set
      - []
      subnets:
      - set
      - - - uuid
          - 0e4f432a-4cf5-43fc-936d-3c6df98ee7ac
        - - uuid
          - b9d5e573-a687-499f-8710-e55a758858a6
      vxlan:
      - uuid
      - 8e0b0ef1-7aff-429a-8e79-90833bd73c10
[DEBUG] 2014-05-19 05:15:08,706 module:ovsdb,function:_send,router:openwrt1
request:
  id: 720213
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1001
response:
  error: null
  id: 720213
  result:
  - rows: []
[INFO] 2014-05-19 05:15:08,711 module:subnets,function:add,router:openwrt1
Adding a subnet(vlan): 1
[DEBUG] 2014-05-19 05:15:08,714 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addbr br1001
[DEBUG] 2014-05-19 05:15:08,725 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int-br1001 tag=1 -- set interface int-br1001 type=internal
[DEBUG] 2014-05-19 05:15:08,779 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int-dvr1001 tag=1 -- set interface int-dvr1001 type=internal
[DEBUG] 2014-05-19 05:15:08,833 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br1001 int-br1001
[DEBUG] 2014-05-19 05:15:08,848 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-br1001 promisc on
[DEBUG] 2014-05-19 05:15:08,852 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-br1001 up
[DEBUG] 2014-05-19 05:15:08,861 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-dvr1001 up
[DEBUG] 2014-05-19 05:15:08,868 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br1001 up
[DEBUG] 2014-05-19 05:15:08,883 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns add ns1001
[DEBUG] 2014-05-19 05:15:08,891 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link add veth-ns1001 type veth peer name temp-ns1001
[DEBUG] 2014-05-19 05:15:08,910 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev temp-ns1001 netns ns1001
[DEBUG] 2014-05-19 05:15:08,919 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1001 ip link set dev temp-ns1001 name eth0
[DEBUG] 2014-05-19 05:15:08,931 module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br1001 veth-ns1001
[DEBUG] 2014-05-19 05:15:08,946 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1001 promisc on
[DEBUG] 2014-05-19 05:15:08,954 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1001 up
[DEBUG] 2014-05-19 05:15:08,982 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1001 ip link set dev eth0 up
[DEBUG] 2014-05-19 05:15:08,998 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1001 ip addr add dev eth0 10.0.1.101/24
[DEBUG] 2014-05-19 05:15:09,010 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1001 ip route add default via 10.0.1.1 dev eth0
[DEBUG] 2014-05-19 05:15:09,018 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip addr add dev int-dvr1001 10.0.1.1/24
[DEBUG] 2014-05-19 05:15:09,025 module:ovsdb,function:_send,router:openwrt1
request:
  id: 423294
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - target
    op: select
    table: Controller
    where: []
response:
  error: null
  id: 423294
  result:
  - rows: []
[DEBUG] 2014-05-19 05:15:09,028 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=1001,actions=mod_vlan_vid:1,resubmit(,10)
[DEBUG] 2014-05-19 05:15:09,041 module:ovsdb,function:_send,router:openwrt1
request:
  id: 660669
  method: transact
  params:
  - Open_vSwitch
  - columns:
    - ofport
    - options
    op: select
    table: Interface
    where:
    - - type
      - ==
      - vxlan
response:
  error: null
  id: 660669
  result:
  - rows:
    - ofport: 3
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.102
    - ofport: 2
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.103
    - ofport: 4
      options:
      - map
      - - - in_key
          - flow
        - - local_ip
          - 192.168.1.101
        - - out_key
          - flow
        - - remote_ip
          - 192.168.1.104
[DEBUG] 2014-05-19 05:15:09,048 module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=1,actions=strip_vlan,set_tunnel:1001,output:4
[DEBUG] 2014-05-19 05:15:09,058 module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'peers': ['192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.101/24', 'vni': 1001, 'ip_dvr': OrderedDict([('addr', '10.0.1.1/24'), ('mode', 'hub')])}
[DEBUG] 2014-05-19 05:15:09,062 module:ovsdb,function:_send,router:openwrt1
request:
  id: 990704
  method: transact
  params:
  - Open_vSwitch
  - op: insert
    row:
      ip_dvr:
      - map
      - - - addr
          - 10.0.1.1/24
        - - mode
          - hub
      ip_vhost: 10.0.1.101/24
      peers:
      - set
      - - 192.168.1.104
      vid: 1
      vni: 1001
    table: NLAN_Subnet
    uuid-name: temp_424391
  - mutations:
    - - subnets
      - insert
      - - set
        - - - named-uuid
            - temp_424391
    op: mutate
    table: NLAN
    where: []
response:
  error: null
  id: 990704
  result:
  - uuid:
    - uuid
    - ea2c6640-63fc-4ad6-8440-3b48e1f89576
  - count: 1
[DEBUG] 2014-05-19 05:15:09,065 module:ovsdb,function:_send,router:openwrt1
request:
  id: 594861
  method: transact
  params:
  - Open_vSwitch
  - op: select
    table: NLAN_Subnet
    where:
    - - vni
      - ==
      - 1001
response:
  error: null
  id: 594861
  result:
  - rows:
    - _uuid:
      - uuid
      - ea2c6640-63fc-4ad6-8440-3b48e1f89576
      _version:
      - uuid
      - f62ada2b-bebc-4fde-9d1f-48a7b7554af1
      default_gw:
      - set
      - []
      ip_dvr:
      - map
      - - - addr
          - 10.0.1.1/24
        - - mode
          - hub
      ip_vhost: 10.0.1.101/24
      peers: 192.168.1.104
      ports:
      - set
      - []
      vid: 1
      vni: 1001
[INFO] 2014-05-19 05:15:09,071 module:nlan_agent,function:<module>,router:openwrt1
NLAN Agent execution completed
--- RESPONSE from router:openwrt1,platform:openwrt
message: Execution completed
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-05-18 22:15:04.836416

Router           Result    Elapsed Time
---------------------------------------
rpi1              :-)         2.95(sec)
openwrt3          :-)         3.27(sec)
openwrt2          :-)         3.57(sec)
openwrt1          :-)         5.96(sec)
--- STDOUT from router:rpi1,platform:debian
Hello World!
--- STDOUT from router:openwrt1,platform:openwrt
Hello World!
--- STDOUT from router:openwrt2,platform:openwrt
Hello World!
--- STDOUT from router:openwrt3,platform:openwrt
Hello World!
--- STDOUT from router:openwrt1,platform:openwrt
PING 10.0.1.102 (10.0.1.102): 56 data bytes
64 bytes from 10.0.1.102: seq=0 ttl=64 time=12.069 ms

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 12.069/12.069/12.069 ms
--- STDOUT from router:openwrt1,platform:openwrt
PING 10.0.1.102 (10.0.1.102): 56 data bytes
64 bytes from 10.0.1.102: seq=0 ttl=64 time=1.866 ms

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 1.866/1.866/1.866 ms
--- STDOUT from router:openwrt1,platform:openwrt
PING 10.0.3.103 (10.0.3.103): 56 data bytes
64 bytes from 10.0.3.103: seq=0 ttl=64 time=7.333 ms

--- 10.0.3.103 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 7.333/7.333/7.333 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 10.0.1.101 (10.0.1.101): 56 data bytes
64 bytes from 10.0.1.101: seq=0 ttl=63 time=13.550 ms

--- 10.0.1.101 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 13.550/13.550/13.550 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=11.649 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 11.649/11.649/11.649 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=11.443 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 11.443/11.443/11.443 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=8.666 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 8.666/8.666/8.666 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=2.513 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 2.513/2.513/2.513 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 10.0.1.102 (10.0.1.102): 56 data bytes
64 bytes from 10.0.1.102: seq=0 ttl=63 time=8.354 ms

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 8.354/8.354/8.354 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 10.0.1.1 (10.0.1.1): 56 data bytes
64 bytes from 10.0.1.1: seq=0 ttl=64 time=6.375 ms

--- 10.0.1.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 6.375/6.375/6.375 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 10.0.1.1 (10.0.1.1): 56 data bytes
64 bytes from 10.0.1.1: seq=0 ttl=64 time=1.444 ms

--- 10.0.1.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 1.444/1.444/1.444 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=6.087 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 6.087/6.087/6.087 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=2.986 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 2.986/2.986/2.986 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=6.071 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 6.071/6.071/6.071 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=5.884 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 5.884/5.884/5.884 ms
--- STDOUT from router:openwrt3,platform:openwrt
Hello World!
--- STDOUT from router:openwrt2,platform:openwrt
Hello World!
--- STDOUT from router:openwrt1,platform:openwrt
Hello World!
--- STDOUT from router:rpi1,platform:debian
Hello World!
--- STDOUT from router:openwrt1,platform:openwrt
PING 10.0.1.102 (10.0.1.102): 56 data bytes
64 bytes from 10.0.1.102: seq=0 ttl=64 time=20.950 ms

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 20.950/20.950/20.950 ms
--- STDOUT from router:openwrt1,platform:openwrt
PING 10.0.1.102 (10.0.1.102): 56 data bytes
64 bytes from 10.0.1.102: seq=0 ttl=64 time=3.960 ms

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 3.960/3.960/3.960 ms
--- STDOUT from router:openwrt1,platform:openwrt
PING 10.0.3.103 (10.0.3.103): 56 data bytes
64 bytes from 10.0.3.103: seq=0 ttl=64 time=6.845 ms

--- 10.0.3.103 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 6.845/6.845/6.845 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 10.0.1.101 (10.0.1.101): 56 data bytes
64 bytes from 10.0.1.101: seq=0 ttl=63 time=12.496 ms

--- 10.0.1.101 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 12.496/12.496/12.496 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=13.901 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 13.901/13.901/13.901 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=12.429 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 12.429/12.429/12.429 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=7.272 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 7.272/7.272/7.272 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=2.245 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 2.245/2.245/2.245 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 10.0.1.102 (10.0.1.102): 56 data bytes
64 bytes from 10.0.1.102: seq=0 ttl=63 time=14.194 ms

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 14.194/14.194/14.194 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 10.0.1.1 (10.0.1.1): 56 data bytes
64 bytes from 10.0.1.1: seq=0 ttl=64 time=9.354 ms

--- 10.0.1.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 9.354/9.354/9.354 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 10.0.1.1 (10.0.1.1): 56 data bytes
64 bytes from 10.0.1.1: seq=0 ttl=64 time=1.195 ms

--- 10.0.1.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 1.195/1.195/1.195 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=5.353 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 5.353/5.353/5.353 ms
--- STDOUT from router:openwrt2,platform:openwrt
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=3.602 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 3.602/3.602/3.602 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=12.234 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 12.234/12.234/12.234 ms
--- STDOUT from router:openwrt3,platform:openwrt
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=6.392 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 6.392/6.392/6.392 ms
