#!template.dvsdvr
# The top line declares the corresponding template module.
#
# Ver 0.1: 2014/2/5
# Ver 0.2: 2014/2/27
# Ver 0.3: 2014/3/3
# Ver 0.4: 2014/3/28
# Ver 0.5: 2014/4/3, works with a template engine
# Ver 0.6: 2014/4/8, Service Function Chaining (NFV)
#
# OpenWRT DVS/DVR YAML config file
#
# A corresponding template module fills out all placeholders <...>
#
openwrt1:
   bridges: 
      ovs_bridges: enabled
#     controller: '192.168.1.1:6633'
   gateway:
      rip: enabled
      network: eth0.2
#     network: eth2 
   vxlan:
      local_ip: '192.168.1.101'
      remote_ips: <remote_ips>
   subnets:
      - vid: 1
        vni: 101
        ip_dvr: '10.0.1.1/24'
        ip_vhost: '10.0.1.101/24'
        ports:
           - eth0.1 
#          - veth0.1
        peers: <peers> 
      - vid: 3
        vni: 103
        ip_dvr: '10.0.3.1/24'
        ip_vhost: '10.0.3.101/24'
        ports:
           - eth0.3
#          - veth0.3
        peers: <peers>
      - vid: 2
        vni: 1
        ip_dvr: '192.168.100.1/24'
        ip_vhost: '192.168.100.101/24'
        peers: ['192.168.1.103', '192.168.1.104'] 

openwrt2:
   bridges: 
      ovs_bridges: enabled
#     controller: '192.168.1.1:6633'
   vxlan:
      local_ip: '192.168.1.102'
      remote_ips: <remote_ips>
   subnets:
      - vid: 1
        vni: 101
        ip_dvr: '10.0.1.1/24'
        ip_vhost: '10.0.1.102/24'
        ports:
           - eth0.1
#          - veth0.1
        peers: <peers>
      - vid: 3
        vni: 103
        ip_dvr: '10.0.3.1/24'
        ip_vhost: '10.0.3.102/24'
        ports:
           - eth0.3
#          - veth0.3
        peers: <peers>
      - vid: 2
        vni: 1001
        ip_dvr: '192.168.100.2/24'
        default_gw: '192.168.100.1'
        ip_vhost: '192.168.100.102/24'
        peers: ['192.168.1.104'] 


openwrt3:
   bridges:
     ovs_bridges: enabled
#    controller: '192.168.1.1:6633'
   vxlan:
     local_ip: '192.168.1.103'
     remote_ips: <remote_ips>
   subnets:
      - vid: 1
        vni: 101
        ip_dvr: '10.0.1.1/24'
        ip_vhost: '10.0.1.103/24'
        ports:
           - eth0.1
#          - veth0.1
        peers: <peers>
      - vid: 3
        vni: 103
        ip_dvr: '10.0.3.1/24'
        ip_vhost: '10.0.3.103/24'
        ports:
           - eth0.3
#          - veth0.3
        peers: <peers>
      - vid: 2
        vni: 1
        ip_dvr: '192.168.100.3/24'
        default_gw: '192.168.100.1'
        ip_vhost: '192.168.100.103/24'
        peers: ['192.168.1.101'] 

rpi1:
   # Service Function Chaining
   bridges:
      ovs_bridges: enabled
#     controller: '192.168.1.1:6633'
   services:
      - name: snort1
        function: snort 
        mode: bump-in-the-wire
        chain: [openwrt2.1001, openwrt1.1]
   vxlan:
      local_ip: '192.168.1.104'
      remote_ips: <remote_ips>
   subnets:
      - vid: 2
        vni: 1
        peers: ['192.168.1.101'] 
        ports: <sfports> 
      - vid: 1
        vni: 1001
        peers: ['192.168.1.102'] 
        ports: <sfports>

