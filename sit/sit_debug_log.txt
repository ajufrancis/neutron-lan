=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
openwrt2         192.168.1.102  OK
openwrt1         192.168.1.101  OK
rpi1             192.168.1.104  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --scpmod
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --scpmod
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --scpmod
=+=+= NLAN Request to router:rpi1,platform:debian =+=+=+=+=+=+=+=+=+=+=+=+=+=+
operation: --scpmod
=+=+= Files copied to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
target_dir: /opt/nlan
files: ['nlan.py', 'command.py', 'ovsdbrow.py', 'init.py', 'db.py', 'test.py', 'system.py', 'vxlan.py', 'subnets.py', 'gateway.py', 'bridges.py', 'services.py', 'ovsdb.py', 'oputil.py', 'nlan_agent.py', 'cmdutil.py', 'errors.py', 'nlan_debian', 'nlan.schema_0.0.1.yaml', 'nlan_openwrt', 'ovsdb_nlan.schema', 'vswitch.schema_2.0.0', 'nlan_env.conf']
exit: 0
=+=+= Files copied to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
target_dir: /opt/nlan
files: ['nlan.py', 'command.py', 'ovsdbrow.py', 'init.py', 'db.py', 'test.py', 'system.py', 'vxlan.py', 'subnets.py', 'gateway.py', 'bridges.py', 'services.py', 'ovsdb.py', 'oputil.py', 'nlan_agent.py', 'cmdutil.py', 'errors.py', 'nlan_debian', 'nlan.schema_0.0.1.yaml', 'nlan_openwrt', 'ovsdb_nlan.schema', 'vswitch.schema_2.0.0', 'nlan_env.conf']
exit: 0
=+=+= Files copied to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
target_dir: /opt/nlan
files: ['nlan.py', 'command.py', 'ovsdbrow.py', 'init.py', 'db.py', 'test.py', 'system.py', 'vxlan.py', 'subnets.py', 'gateway.py', 'bridges.py', 'services.py', 'ovsdb.py', 'oputil.py', 'nlan_agent.py', 'cmdutil.py', 'errors.py', 'nlan_debian', 'nlan.schema_0.0.1.yaml', 'nlan_openwrt', 'ovsdb_nlan.schema', 'vswitch.schema_2.0.0', 'nlan_env.conf']
exit: 0
=+=+= Files copied to router:rpi1,platform:debian =+=+=+=+=+=+=+=+=+=+=+=+=+=+
target_dir: /opt/nlan
files: ['nlan.py', 'command.py', 'ovsdbrow.py', 'init.py', 'db.py', 'test.py', 'system.py', 'vxlan.py', 'subnets.py', 'gateway.py', 'bridges.py', 'services.py', 'ovsdb.py', 'oputil.py', 'nlan_agent.py', 'cmdutil.py', 'errors.py', 'nlan_debian', 'nlan.schema_0.0.1.yaml', 'nlan_openwrt', 'ovsdb_nlan.schema', 'vswitch.schema_2.0.0', 'nlan_env.conf']
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:45:13.953154

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         3.22(sec)
openwrt3          :-)         3.26(sec)
openwrt2          :-)         3.33(sec)
rpi1              :-)         3.35(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
openwrt2         192.168.1.102  OK
openwrt1         192.168.1.101  OK
rpi1             192.168.1.104  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: rm -rf /opt/nlan
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: rm -rf /opt/nlan
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: rm -rf /opt/nlan
=+=+= NLAN Request to router:rpi1,platform:debian =+=+=+=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: rm -rf /opt/nlan
exit: 0
exit: 0
exit: 0
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:45:18.625697

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.90(sec)
openwrt2          :-)         0.92(sec)
openwrt3          :-)         0.97(sec)
rpi1              :-)         1.05(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
openwrt3         192.168.1.103  OK
openwrt2         192.168.1.102  OK
rpi1             192.168.1.104  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --scpmod
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --scpmod
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --scpmod
=+=+= NLAN Request to router:rpi1,platform:debian =+=+=+=+=+=+=+=+=+=+=+=+=+=+
operation: --scpmod
=+=+= Files copied to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
target_dir: /opt/nlan
files: ['nlan.py', 'command.py', 'ovsdbrow.py', 'init.py', 'db.py', 'test.py', 'system.py', 'vxlan.py', 'subnets.py', 'gateway.py', 'bridges.py', 'services.py', 'ovsdb.py', 'oputil.py', 'nlan_agent.py', 'cmdutil.py', 'errors.py', 'nlan_debian', 'nlan.schema_0.0.1.yaml', 'nlan_openwrt', 'ovsdb_nlan.schema', 'vswitch.schema_2.0.0', 'nlan_env.conf']
exit: 0
=+=+= Files copied to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
target_dir: /opt/nlan
files: ['nlan.py', 'command.py', 'ovsdbrow.py', 'init.py', 'db.py', 'test.py', 'system.py', 'vxlan.py', 'subnets.py', 'gateway.py', 'bridges.py', 'services.py', 'ovsdb.py', 'oputil.py', 'nlan_agent.py', 'cmdutil.py', 'errors.py', 'nlan_debian', 'nlan.schema_0.0.1.yaml', 'nlan_openwrt', 'ovsdb_nlan.schema', 'vswitch.schema_2.0.0', 'nlan_env.conf']
exit: 0
=+=+= Files copied to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
target_dir: /opt/nlan
files: ['nlan.py', 'command.py', 'ovsdbrow.py', 'init.py', 'db.py', 'test.py', 'system.py', 'vxlan.py', 'subnets.py', 'gateway.py', 'bridges.py', 'services.py', 'ovsdb.py', 'oputil.py', 'nlan_agent.py', 'cmdutil.py', 'errors.py', 'nlan_debian', 'nlan.schema_0.0.1.yaml', 'nlan_openwrt', 'ovsdb_nlan.schema', 'vswitch.schema_2.0.0', 'nlan_env.conf']
exit: 0
=+=+= Files copied to router:rpi1,platform:debian =+=+=+=+=+=+=+=+=+=+=+=+=+=+
target_dir: /opt/nlan
files: ['nlan.py', 'command.py', 'ovsdbrow.py', 'init.py', 'db.py', 'test.py', 'system.py', 'vxlan.py', 'subnets.py', 'gateway.py', 'bridges.py', 'services.py', 'ovsdb.py', 'oputil.py', 'nlan_agent.py', 'cmdutil.py', 'errors.py', 'nlan_debian', 'nlan.schema_0.0.1.yaml', 'nlan_openwrt', 'ovsdb_nlan.schema', 'vswitch.schema_2.0.0', 'nlan_env.conf']
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:45:21.311296

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         3.30(sec)
openwrt2          :-)         3.40(sec)
openwrt3          :-)         3.43(sec)
rpi1              :-)         3.75(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
openwrt1         192.168.1.101  OK
rpi1             192.168.1.104  OK
openwrt2         192.168.1.102  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: init.run
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: init.run
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: init.run
=+=+= NLAN Request to router:rpi1,platform:debian =+=+=+=+=+=+=+=+=+=+=+=+=+=+
command: init.run
=+=+= NLAN Response from router:openwrt1,platform:openwrt =+=+=+=+=+=+=+=+=+=+
[INFO] module:nlan_agent,function:<module>,router:openwrt1
NLAN Agent initialization completed
{'mod_dir': ['command', 'config'], 'etc_dir': '/opt/nlan/etc', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'ip_dvr': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'mode': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}}, 'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'indexes': {'services': 'name', 'subnets': 'vni'}, 'platform': 'openwrt', 'init': False, 'router': 'openwrt1', 'logger': <logging.Logger object at 0xb766f30c>, 'schema': 'ovsdb_nlan.schema'}
[INFO] module:nlan_agent,function:_route,router:openwrt1
function:init.run, args:()
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: lxc-ls
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl --if-exists del-br br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl --if-exists del-br br-int
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl show
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns3 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delif br3 veth-ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br3 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delbr br3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns2 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delif br2 veth-ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br2 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delbr br2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delif br1 veth-ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br1 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl delbr br1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns list
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns del ns-global
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns del ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns del ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns del ns1
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","where":[],"op":"delete"}],"method":"transact","id":648345}
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
[INFO] module:nlan_agent,function:<module>,router:openwrt3
NLAN Agent initialization completed
{'mod_dir': ['command', 'config'], 'etc_dir': '/opt/nlan/etc', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'ip_dvr': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'mode': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}}, 'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'indexes': {'services': 'name', 'subnets': 'vni'}, 'platform': 'openwrt', 'init': False, 'router': 'openwrt3', 'logger': <logging.Logger object at 0xb75aa7ac>, 'schema': 'ovsdb_nlan.schema'}
[INFO] module:nlan_agent,function:_route,router:openwrt3
function:init.run, args:()
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: lxc-ls
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl --if-exists del-br br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl --if-exists del-br br-int
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl show
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns3 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delif br3 veth-ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br3 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delbr br3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns2 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delif br2 veth-ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br2 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delbr br2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns1 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delif br1 veth-ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br1 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl delbr br1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns list
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns del ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns del ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns del ns2
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","where":[],"op":"delete"}],"method":"transact","id":154665}
... JSON-RPC response ...
{"id":154665,"result":[{"count":1}],"error":null}
__ NLA... JSON-RPC response ...
{"id":648345,"result":[{"count":1}],"error":null}
__ NLAN response __
message: Execution completed
exit: 0
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
[INFO] module:nlan_agent,function:<module>,router:openwrt2
NLAN Agent initialization completed
{'mod_dir': ['command', 'config'], 'etc_dir': '/opt/nlan/etc', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'ip_dvr': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'mode': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}}, 'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'indexes': {'services': 'name', 'subnets': 'vni'}, 'platform': 'openwrt', 'init': False, 'router': 'openwrt2', 'logger': <logging.Logger object at 0xb761e36c>, 'schema': 'ovsdb_nlan.schema'}
[INFO] module:nlan_agent,function:_route,router:openwrt2
function:init.run, args:()
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: lxc-ls
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl --if-exists del-br br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl --if-exists del-br br-int
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl show
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns3 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delif br3 veth-ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br3 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delbr br3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns2 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delif br2 veth-ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br2 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delbr br2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns1 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delif br1 veth-ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br1 down
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl delbr br1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns list
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns del ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns del ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns del ns2
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","where":[],"op":"delete"}],"method":"transact","id":867365}
... JSON-RPC response ...
{"id":867365,"result":[{"count":1}],"error":null}
__ NLAN response __
message: Execution completed
exit: 0
N response __
message: Execution completed
exit: 0
=+=+= NLAN Response from router:rpi1,platform:debian +=+=+=+=+=+=+=+=+=+=+=+=+
[INFO] module:nlan_agent,function:<module>,router:rpi1
NLAN Agent initialization completed
{'mod_dir': ['command', 'config'], 'etc_dir': '/opt/nlan/etc', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'ip_dvr': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'mode': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}}, 'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'indexes': {'services': 'name', 'subnets': 'vni'}, 'platform': 'debian', 'init': False, 'router': 'rpi1', 'logger': <logging.Logger object at 0xb72ad3ec>, 'schema': 'ovsdb_nlan.schema'}
[INFO] module:nlan_agent,function:_route,router:rpi1
function:init.run, args:()
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: lxc-ls
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: lxc-stop -n snort1
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: lxc-stop -n snort2
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl --if-exists del-br br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl --if-exists del-br br-int
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl show
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev veth-ns111 down
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl delif br111 veth-ns111
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev br111 down
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl delbr br111
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev mz.101 down
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl delif br1 mz.101
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev veth-ns1 down
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl delif br1 veth-ns1
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev br1 down
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl delbr br1
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip netns list
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip netns del ns1
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip netns del ns111
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN", "where": [], "op": "delete"}], "method": "transact", "id": 968109}
... JSON-RPC response ...
{"id":968109,"result":[{"count":1}],"error":null}
... stderr ...
Cannot find device "mz.101"
interface mz.101 does not exist!
__ NLAN response __
message: Execution completed
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:45:26.483416

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         1.49(sec)
openwrt3          :-)         1.59(sec)
openwrt2          :-)         1.67(sec)
rpi1              :-)         1.83(sec)
cmd: git show HEAD:~~~
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
rpi1             192.168.1.104  OK
openwrt2         192.168.1.102  OK
openwrt3         192.168.1.103  OK
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:rpi1,platform:debian =+=+=+=+=+=+=+=+=+=+=+=+=+=+
operation: --add
dict_args: "OrderedDict([('bridges', {'ovs_bridges': 'enabled'}), ('services', {('name', 'snort1'): {'name': 'snort1', 'chain': ['mz.101', 'dmz.1001']}}), ('vxlan', {'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.101'], 'local_ip': '192.168.1.104'}), ('subnets', {('vni', 1001): {'peers': ['192.168.1.101'], 'vid': 111, 'vni': 1001, 'ports': ['dmz.1001']}, ('vni', 101): {'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 1, 'vni': 101, 'ports': ['mz.101']}})])"
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --add
dict_args: "OrderedDict([('bridges', {'ovs_bridges': 'enabled'}), ('vxlan', {'remote_ips': ['192.168.1.102', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.103'}), ('subnets', {('vni', 1): {'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 2, 'ip_vhost': '192.168.100.103/24', 'default_gw': '192.168.100.1', 'ip_dvr': '192.168.100.3/24', 'vni': 1}, ('vni', 103): {'ip_vhost': '10.0.3.103/24', 'ip_dvr': '10.0.3.1/24', 'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 3, 'vni': 103}, ('vni', 101): {'peers': ['192.168.1.102', '192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.103/24', 'vni': 101, 'ip_dvr': '10.0.1.1/24', 'mode': 'spoke_dvr'}})])"
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --add
dict_args: "OrderedDict([('bridges', {'ovs_bridges': 'enabled'}), ('vxlan', {'remote_ips': ['192.168.1.103', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.102'}), ('subnets', {('vni', 1): {'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 2, 'ip_vhost': '192.168.100.102/24', 'default_gw': '192.168.100.1', 'ip_dvr': '192.168.100.2/24', 'vni': 1}, ('vni', 103): {'ip_vhost': '10.0.3.102/24', 'ip_dvr': '10.0.3.1/24', 'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 3, 'vni': 103}, ('vni', 101): {'peers': ['192.168.1.103', '192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.102/24', 'vni': 101, 'ip_dvr': '10.0.1.1/24', 'mode': 'spoke_dvr'}})])"
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --add
dict_args: "OrderedDict([('bridges', {'ovs_bridges': 'enabled'}), ('gateway', {'network': 'eth2', 'rip': 'enabled'}), ('vxlan', {'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.104'], 'local_ip': '192.168.1.101'}), ('subnets', {('vni', 1): {'ip_vhost': '192.168.100.101/24', 'ip_dvr': '192.168.100.1/24', 'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 2, 'vni': 1}, ('vni', 103): {'ip_vhost': '10.0.3.101/24', 'ip_dvr': '10.0.3.1/24', 'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 3, 'vni': 103}, ('vni', 1001): {'peers': ['192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.101/24', 'vni': 1001, 'ip_dvr': '10.0.1.1/24', 'mode': 'hub'}})])"
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
[INFO] module:nlan_agent,function:<module>,router:openwrt3
NLAN Agent initialization completed
{'mod_dir': ['command', 'config'], 'etc_dir': '/opt/nlan/etc', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'ip_dvr': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'mode': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}}, 'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'indexes': {'services': 'name', 'subnets': 'vni'}, 'platform': 'openwrt', 'init': False, 'router': 'openwrt3', 'logger': <logging.Logger object at 0xb74faf0c>, 'schema': 'ovsdb_nlan.schema'}
[INFO] module:nlan_agent,function:_route,router:openwrt3
function:bridges.add, model:{'ovs_bridges': 'enabled'}
[INFO] module:bridges,function:add,router:openwrt3
Adding bridges: br-int and br-tun
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":410855}
... JSON-RPC response ...
{"id":410855,"result":[{"uuid":["uuid","ad987f0c-3a04-4718-be46-9ea8574a7c9c"]}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Bridges","where":[],"op":"select"}],"method":"transact","id":148074}
... JSON-RPC response ...
{"id":148074,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-br br-int
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-br br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl del-flows br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int patch-int -- set interface patch-int type=patch options:peer=patch-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-tun patch-tun -- set interface patch-tun type=patch options:peer=patch-int
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["name","==","patch-tun"]],"op":"select"}],"method":"transact","id":246825}
... JSON-RPC response ...
{"id":246825,"result":[{"rows":[{"options":["map",[["peer","patch-int"]]],"mtu":["set",[]],"link_speed":["set",[]],"statistics":["map",[["collisions",0],["rx_bytes",0],["rx_crc_err",0],["rx_dropped",0],["rx_errors",0],["rx_frame_err",0],["rx_over_err",0],["rx_packets",0],["tx_bytes",0],["tx_dropped",0],["tx_errors",0],["tx_packets",0]]],"mac_in_use":"ce:b9:7f:86:ae:0c","ingress_policing_rate":0,"ofport":1,"mac":["set",[]],"cfm_fault_status":["set",[]],"duplex":["set",[]],"lacp_current":["set",[]],"cfm_fault":["set",[]],"link_state":["set",[]],"external_ids":["map",[]],"bfd_status":["map",[]],"link_resets":["set",[]],"name":"patch-tun","type":"patch","cfm_remote_opstate":["set",[]],"_uuid":["uuid","cdfa2844-eb35-4eb1-a052-9f2767b2269e"],"status":["map",[]],"ifindex":0,"_version":["uuid","413e7b4f-28ef-43d8-a043-d66a468fd940"],"other_config":["map",[]],"admin_state":["set",[]],"cfm_remote_mpids":["set",[]],"cfm_mpid":["set",[]],"bfd":["map",[]],"ofport_request":["set",[]],"ingress_policing_burst":0,"cfm_flap_count":["set",[]],"cfm_health":["set",[]]}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl del-flows br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=1,actions=resubmit(,1)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=0,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=01:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,19)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=00:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,20)
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["name","==","patch-tun"]],"op":"select"}],"method":"transact","id":418531}
... JSON-RPC response ...
{"id":418531,"result":[{"rows":[{"options":["map",[["peer","patch-int"]]],"mtu":["set",[]],"link_speed":["set",[]],"statistics":["map",[["collisions",0],["rx_bytes",0],["rx_crc_err",0],["rx_dropped",0],["rx_errors",0],["rx_frame_err",0],["rx_over_err",0],["rx_packets",0],["tx_bytes",0],["tx_dropped",0],["tx_errors",0],["tx_packets",0]]],"mac_in_use":"ce:b9:7f:86:ae:0c","ingress_policing_rate":0,"ofport":1,"mac":["set",[]],"cfm_fault_status":["set",[]],"duplex":["set",[]],"lacp_current":["set",[]],"cfm_fault":["set",[]],"link_state":"up","external_ids":["map",[]],"bfd_status":["map",[]],"link_resets":0,"name":"patch-tun","type":"patch","cfm_remote_opstate":["set",[]],"_uuid":["uuid","cdfa2844-eb35-4eb1-a052-9f2767b2269e"],"status":["map",[]],"ifindex":0,"_version":["uuid","c09d61f5-e736-4909-93cc-2342a66ee374"],"other_config":["map",[]],"admin_state":"up","cfm_remote_mpids":["set",[]],"cfm_mpid":["set",[]],"bfd":["map",[]],"ofport_request":["set",[]],"ingress_policing_burst":0,"cfm_flap_count":["set",[]],"cfm_health":["set",[]]}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=2,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=3,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=10,priority=1,actions=learn(table=20,hard_timeout=300,priority=1,NXM_OF_VLAN_TCI[0..11],NXM_OF_ETH_DST[]=NXM_OF_ETH_SRC[],load:0->NXM_OF_VLAN_TCI[],load:NXM_NX_TUN_ID[]->NXM_NX_TUN_ID[],output:NXM_OF_IN_PORT[]),output:1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=19,priority=0,actions=resubmit(,21)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=20,priority=0,actions=resubmit(,21)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=21,priority=0,actions=drop
[DEBUG] module:ovsdb,function:crud,router:openwrt3
CRUD operation (add): {'ovs_bridges': 'enabled'}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Bridges","uuid-name":"temp_448471","row":{"ovs_bridges":"enabled"},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["bridges","insert",["set",[["named-uuid","temp_448471"]]]]],"op":"mutate"}],"method":"transact","id":10185}
... JSON-RPC response ...
{"id":10185,"result":[{"uuid":["uuid","91deca47-c329-45da-8504-4af753fe3a91"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Bridges","where":[],"op":"select"}],"method":"transact","id":436342}
... JSON-RPC response ...
{"id":436342,"result":[{"rows":[{"_uuid":["uuid","91deca47-c329-45da-8504-4af753fe3a91"],"_version":["uuid","7d402422-cbda-4abd-956b-cf28803a58c1"],"ovs_bridges":"enabled","controller":["set",[]]}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:openwrt3
function:vxlan.add, model:{'remote_ips': ['192.168.1.102', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.103'}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":549672}
... JSON-RPC response ...
{"id":549672,"result":[{"uuid":["uuid","e8308041-c68f-4fab-adf7-a8550db690ed"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_VXLAN","where":[],"op":"select"}],"method":"transact","id":808374}
... JSON-RPC response ...
{"id":808374,"result":[{"rows":[]}],"error":null}
[INFO] module:vxlan,function:add,router:openwrt3
Adding a VXLAN tunnel: vxlan_102
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-tun vxlan_102 -- set interface vxlan_102 type=vxlan options:in_key=flow options:local_ip=192.168.1.103 options:out_key=flow options:remote_ip=192.168.1.102
[INFO] module:vxlan,function:add,router:openwrt3
Adding a VXLAN tunnel: vxlan_101
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-tun vxlan_101 -- set interface vxlan_101 type=vxlan options:in_key=flow options:local_ip=192.168.1.103 options:out_key=flow options:remote_ip=192.168.1.101
[INFO] module:vxlan,function:add,router:openwrt3
Adding a VXLAN tunnel: vxlan_104
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-tun vxlan_104 -- set interface vxlan_104 type=vxlan options:in_key=flow options:local_ip=192.168.1.103 options:out_key=flow options:remote_ip=192.168.1.104
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["type","==","vxlan"]],"columns":["ofport","options"],"op":"select"}],"method":"transact","id":593354}
... JSON-RPC response ...
{"id":593354,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.103"],["out_key","flow"],["remote_ip","192.168.1.101"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.103"],["out_key","flow"],["remote_ip","192.168.1.102"]]],"ofport":2},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.103"],["out_key","flow"],["remote_ip","192.168.1.104"]]],"ofport":4}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=3,actions=resubmit(,2)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=2,actions=resubmit(,2)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=4,actions=resubmit(,2)
[DEBUG] module:ovsdb,function:crud,router:openwrt3
CRUD operation (add): {'remote_ips': ['192.168.1.102', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.103'}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_VXLAN","uuid-name":"temp_580490","row":{"remote_ips":["set",["192.168.1.102","192.168.1.101","192.168.1.104"]],"local_ip":"192.168.1.103"},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["vxlan","insert",["set",[["named-uuid","temp_580490"]]]]],"op":"mutate"}],"method":"transact","id":86208}
... JSON-RPC response ...
{"id":86208,"result":[{"uuid":["uuid","cdc4164d-5011-4422-ad89-f6c2950d0d9f"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_VXLAN","where":[],"op":"select"}],"method":"transact","id":244154}
... JSON-RPC response ...
{"id":244154,"result":[{"rows":[{"_version":["uuid","2d6b370a-7257-446d-b8f1-2721cf352942"],"_uuid":["uuid","cdc4164d-5011-4422-ad89-f6c2950d0d9f"],"local_ip":"192.168.1.103","remote_ips":["set",["192.168.1.101","192.168.1.102","192.168.1.104"]]}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:openwrt3
function:subnets.add, index:('vni', 1), model:{'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 2, 'ip_vhost': '192.168.100.103/24', 'default_gw': '192.168.100.1', 'ip_dvr': '192.168.100.3/24', 'vni': 1}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":457743}
... JSON-RPC response ...
{"id":457743,"result":[{"uuid":["uuid","351154c7-9f3e-4798-82c4-9ff9d66e8e57"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",1]],"op":"select"}],"method":"transact","id":490895}
... JSON-RPC response ...
{"id":490895,"result":[{"rows":[]}],"error":null}
[INFO] module:subnets,function:_crud,router:openwrt3
Adding a subnet(vlan): 2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns add ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addbr br2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link add veth-ns2 type veth peer name temp-ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev temp-ns2 netns ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns2 ip link set dev temp-ns2 name eth0
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int-br2 tag=2 -- set interface int-br2 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int-dvr2 tag=2 -- set interface int-dvr2 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br2 veth-ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br2 int-br2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns2 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns2 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns2 ip link set dev eth0 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-br2 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-br2 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-dvr2 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br2 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns2 ip addr add dev eth0 192.168.100.103/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip addr add dev int-dvr2 192.168.100.3/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns2 ip route add default via 192.168.100.3 dev eth0
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: route
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip route add default via 192.168.100.1
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Controller","where":[],"columns":["target"],"op":"select"}],"method":"transact","id":899532}
... JSON-RPC response ...
{"id":899532,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=1,actions=mod_vlan_vid:2,resubmit(,10)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=2,nw_dst=192.168.100.3,actions=drop
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["type","==","vxlan"]],"columns":["ofport","options"],"op":"select"}],"method":"transact","id":63326}
... JSON-RPC response ...
{"id":63326,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.103"],["out_key","flow"],["remote_ip","192.168.1.101"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.103"],["out_key","flow"],["remote_ip","192.168.1.102"]]],"ofport":2},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.103"],["out_key","flow"],["remote_ip","192.168.1.104"]]],"ofport":4}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=2,actions=strip_vlan,set_tunnel:1,output:3,output:2
[DEBUG] module:ovsdb,function:crud,router:openwrt3
CRUD operation (add): {'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 2, 'ip_vhost': '192.168.100.103/24', 'default_gw': '192.168.100.1', 'ip_dvr': '192.168.100.3/24', 'vni': 1}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","uuid-name":"temp_683807","row":{"peers":["set",["192.168.1.101","192.168.1.102"]],"vid":2,"ip_vhost":"192.168.100.103/24","default_gw":"192.168.100.1","ip_dvr":"192.168.100.3/24","vni":1},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["subnets","insert",["set",[["named-uuid","temp_683807"]]]]],"op":"mutate"}],"method":"transact","id":236553}
... JSON-RPC response ...
{"id":236553,"result":[{"uuid":["uuid","c21e848f-781c-4d74-94b9-1ef5fd367940"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",1]],"op":"select"}],"method":"transact","id":582698}
... JSON-RPC response ...
{"id":582698,"result":[{"rows":[{"peers":["set",["192.168.1.101","192.168.1.102"]],"_version":["uuid","d53139f9-01c4-4577-99b2-3fb64b5bf28b"],"vni":1,"ports":["set",[]],"mode":["set",[]],"vid":2,"_uuid":["uuid","c21e848f-781c-4d74-94b9-1ef5fd367940"],"default_gw":"192.168.100.1","ip_vhost":"192.168.100.103/24","ip_dvr":"192.168.100.3/24"}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:openwrt3
function:subnets.add, index:('vni', 103), model:{'ip_dvr': '10.0.3.1/24', 'ip_vhost': '10.0.3.103/24', 'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 3, 'vni': 103}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":306444}
... JSON-RPC response ...
{"id":306444,"result":[{"uuid":["uuid","8069499a-fb6e-462b-9cdd-da9691072dcf"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",103]],"op":"select"}],"method":"transact","id":974598}
... JSON-RPC response ...
{"id":974598,"result":[{"rows":[]}],"error":null}
[INFO] module:subnets,function:_crud,router:openwrt3
Adding a subnet(vlan): 3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns add ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addbr br3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link add veth-ns3 type veth peer name temp-ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev temp-ns3 netns ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns3 ip link set dev temp-ns3 name eth0
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int-br3 tag=3 -- set interface int-br3 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int-dvr3 tag=3 -- set interface int-dvr3 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br3 veth-ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br3 int-br3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns3 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns3 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns3 ip link set dev eth0 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-br3 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-br3 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-dvr3 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br3 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns3 ip addr add dev eth0 10.0.3.103/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip addr add dev int-dvr3 10.0.3.1/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns3 ip route add default via 10.0.3.1 dev eth0
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Controller","where":[],"columns":["target"],"op":"select"}],"method":"transact","id":54011}
... JSON-RPC response ...
{"id":54011,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=103,actions=mod_vlan_vid:3,resubmit(,10)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=3,nw_dst=10.0.3.1,actions=drop
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["type","==","vxlan"]],"columns":["ofport","options"],"op":"select"}],"method":"transact","id":938314}
... JSON-RPC response ...
{"id":938314,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.103"],["out_key","flow"],["remote_ip","192.168.1.101"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.103"],["out_key","flow"],["remote_ip","192.168.1.102"]]],"ofport":2},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.103"],["out_key","flow"],["remote_ip","192.168.1.104"]]],"ofport":4}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=3,actions=strip_vlan,set_tunnel:103,output:3,output:2
[DEBUG] module:ovsdb,function:crud,router:openwrt3
CRUD operation (add): {'ip_dvr': '10.0.3.1/24', 'ip_vhost': '10.0.3.103/24', 'peers': ['192.168.1.101', '192.168.1.102'], 'vid': 3, 'vni': 103}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","uuid-name":"temp_754170","row":{"ip_dvr":"10.0.3.1/24","ip_vhost":"10.0.3.103/24","peers":["set",["192.168.1.101","192.168.1.102"]],"vid":3,"vni":103},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["subnets","insert",["set",[["named-uuid","temp_754170"]]]]],"op":"mutate"}],"method":"transact","id":791606}
... JSON-RPC response ...
{"id":791606,"result":[{"uuid":["uuid","e13f0eab-f093-4192-a61c-331754f6e2d4"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",103]],"op":"select"}],"method":"transact","id":822934}
... JSON-RPC response ...
{"id":822934,"result":[{"rows":[{"peers":["set",["192.168.1.101","192.168.1.102"]],"_version":["uuid","6e3e2493-4885-4a5b-aa31-49e5a48fae25"],"vni":103,"ports":["set",[]],"mode":["set",[]],"vid":3,"_uuid":["uuid","e13f0eab-f093-4192-a61c-331754f6e2d4"],"default_gw":["set",[]],"ip_vhost":"10.0.3.103/24","ip_dvr":"10.0.3.1/24"}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:openwrt3
function:subnets.add, index:('vni', 101), model:{'peers': ['192.168.1.102', '192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.103/24', 'vni': 101, 'ip_dvr': '10.0.1.1/24', 'mode': 'spoke_dvr'}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":332431}
... JSON-RPC response ...
{"id":332431,"result":[{"uuid":["uuid","359df492-2328-408b-8dd3-762cf53f2146"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",101]],"op":"select"}],"method":"transact","id":419085}
... JSON-RPC response ...
{"id":419085,"result":[{"rows":[]}],"error":null}
[INFO] module:subnets,function:_crud,router:openwrt3
Adding a subnet(vlan): 1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns add ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addbr br1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link add veth-ns1 type veth peer name temp-ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev temp-ns1 netns ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns1 ip link set dev temp-ns1 name eth0
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int-br1 tag=1 -- set interface int-br1 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-vsctl add-port br-int int-dvr1 tag=1 -- set interface int-dvr1 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br1 veth-ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: brctl addif br1 int-br1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns1 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev veth-ns1 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns1 ip link set dev eth0 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-br1 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-br1 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev int-dvr1 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link set dev br1 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns1 ip addr add dev eth0 10.0.1.103/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip addr add dev int-dvr1 10.0.1.1/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip netns exec ns1 ip route add default via 10.0.1.1 dev eth0
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Controller","where":[],"columns":["target"],"op":"select"}],"method":"transact","id":44246}
... JSON-RPC response ...
{"id":44246,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=101,actions=mod_vlan_vid:1,resubmit(,10)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ip link show dev int-dvr1
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["name","==","int-dvr1"]],"op":"select"}],"method":"transact","id":333110}
... JSON-RPC response ...
{"id":333110,"result":[{"rows":[{"options":["map",[]],"mtu":1500,"link_speed":["set",[]],"statistics":["map",[["collisions",0],["rx_bytes",0],["rx_crc_err",0],["rx_dropped",0],["rx_errors",0],["rx_frame_err",0],["rx_over_err",0],["rx_packets",0],["tx_bytes",0],["tx_dropped",0],["tx_errors",0],["tx_packets",0]]],"mac_in_use":"5a:7c:e5:50:15:db","ingress_policing_rate":0,"ofport":7,"mac":["set",[]],"cfm_fault_status":["set",[]],"duplex":["set",[]],"lacp_current":["set",[]],"cfm_fault":["set",[]],"link_state":"up","external_ids":["map",[]],"bfd_status":["map",[]],"link_resets":2,"name":"int-dvr1","type":"internal","cfm_remote_opstate":["set",[]],"_uuid":["uuid","7bda8f0f-62b2-47f3-93b0-c20b6d80eaed"],"status":["map",[["driver_name","openvswitch"]]],"ifindex":46,"_version":["uuid","5273da83-d513-4e66-aad3-2ee394c38d24"],"other_config":["map",[]],"admin_state":"up","cfm_remote_mpids":["set",[]],"cfm_mpid":["set",[]],"bfd":["map",[]],"ofport_request":["set",[]],"ingress_policing_burst":0,"cfm_flap_count":["set",[]],"cfm_health":["set",[]]}]}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["name","==","int-br1"]],"op":"select"}],"method":"transact","id":256586}
... JSON-RPC response ...
{"id":256586,"result":[{"rows":[{"options":["map",[]],"mtu":1500,"link_speed":["set",[]],"statistics":["map",[["collisions",0],["rx_bytes",0],["rx_crc_err",0],["rx_dropped",0],["rx_errors",0],["rx_frame_err",0],["rx_over_err",0],["rx_packets",0],["tx_bytes",0],["tx_dropped",0],["tx_errors",0],["tx_packets",0]]],"mac_in_use":"8a:d4:f5:17:e8:73","ingress_policing_rate":0,"ofport":6,"mac":["set",[]],"cfm_fault_status":["set",[]],"duplex":["set",[]],"lacp_current":["set",[]],"cfm_fault":["set",[]],"link_state":"up","external_ids":["map",[]],"bfd_status":["map",[]],"link_resets":2,"name":"int-br1","type":"internal","cfm_remote_opstate":["set",[]],"_uuid":["uuid","4c427522-ef88-4b5a-ad62-b8c4710e0198"],"status":["map",[["driver_name","openvswitch"]]],"ifindex":45,"_version":["uuid","a8f540b2-79b5-496f-8e05-8f22f3d961df"],"other_config":["map",[]],"admin_state":"up","cfm_remote_mpids":["set",[]],"cfm_mpid":["set",[]],"bfd":["map",[]],"ofport_request":["set",[]],"ingress_policing_burst":0,"cfm_flap_count":["set",[]],"cfm_health":["set",[]]}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=0,priority=2,in_port=6,dl_type=0x0800,nw_dst=10.0.1.0/24,actions=normal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=10.0.0.0/8,actions=resubmit(,1)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=172.16.0.0/12,actions=resubmit(,1)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=192.168.0.0/16,actions=resubmit(,1)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=7,dl_type=0x0806,nw_src=10.0.1.1,nw_proto=2,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-int table=1,priority=0,actions=set_field:5a:7c:e5:50:15:db->dl_dst,output:7
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["type","==","vxlan"]],"columns":["ofport","options"],"op":"select"}],"method":"transact","id":151323}
... JSON-RPC response ...
{"id":151323,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.103"],["out_key","flow"],["remote_ip","192.168.1.101"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.103"],["out_key","flow"],["remote_ip","192.168.1.102"]]],"ofport":2},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.103"],["out_key","flow"],["remote_ip","192.168.1.104"]]],"ofport":4}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt3
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=1,actions=strip_vlan,set_tunnel:101,output:2,output:4
[DEBUG] module:ovsdb,function:crud,router:openwrt3
CRUD operation (add): {'peers': ['192.168.1.102', '192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.103/24', 'vni': 101, 'ip_dvr': '10.0.1.1/24', 'mode': 'spoke_dvr'}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","uuid-name":"te=+=+= NLAN Response from router:rpi1,platform:debian +=+=+=+=+=+=+=+=+=+=+=+=+
[INFO] module:nlan_agent,function:<module>,router:rpi1
NLAN Agent initialization completed
{'mod_dir': ['command', 'config'], 'etc_dir': '/opt/nlan/etc', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'ip_dvr': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'mode': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}}, 'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'indexes': {'services': 'name', 'subnets': 'vni'}, 'platform': 'debian', 'init': False, 'router': 'rpi1', 'logger': <logging.Logger object at 0xb72c4b6c>, 'schema': 'ovsdb_nlan.schema'}
[INFO] module:nlan_agent,function:_route,router:rpi1
function:bridges.add, model:{'ovs_bridges': 'enabled'}
[INFO] module:bridges,function:add,router:rpi1
Adding bridges: br-int and br-tun
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN", "row": {}, "op": "insert"}], "method": "transact", "id": 105638}
... JSON-RPC response ...
{"id":105638,"result":[{"uuid":["uuid","281d6b3a-f262-4e6d-aad1-4458f40f0a41"]}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_Bridges", "where": [], "op": "select"}], "method": "transact", "id": 340430}
... JSON-RPC response ...
{"id":340430,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-br br-int
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-br br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl del-flows br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-int patch-int -- set interface patch-int type=patch options:peer=patch-tun
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-tun patch-tun -- set interface patch-tun type=patch options:peer=patch-int
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "Interface", "where": [["name", "==", "patch-tun"]], "op": "select"}], "method": "transact", "id": 240364}
... JSON-RPC response ...
{"id":240364,"result":[{"rows":[{"options":["map",[["peer","patch-int"]]],"mtu":["set",[]],"link_speed":["set",[]],"statistics":["map",[["collisions",0],["rx_bytes",0],["rx_crc_err",0],["rx_dropped",0],["rx_errors",0],["rx_frame_err",0],["rx_over_err",0],["rx_packets",0],["tx_bytes",0],["tx_dropped",0],["tx_errors",0],["tx_packets",0]]],"mac_in_use":"c2:af:e7:b2:8e:25","ingress_policing_rate":0,"mac":["set",[]],"ofport":1,"cfm_fault_status":["set",[]],"duplex":["set",[]],"cfm_fault":["set",[]],"lacp_current":["set",[]],"external_ids":["map",[]],"link_state":["set",[]],"bfd_status":["map",[]],"link_resets":["set",[]],"name":"patch-tun","type":"patch","cfm_remote_opstate":["set",[]],"_uuid":["uuid","6c0bdcd1-d225-48ec-9d7b-71688f749946"],"status":["map",[]],"ifindex":0,"_version":["uuid","3b8fe700-e045-4851-b8c7-120c7d6142bf"],"other_config":["map",[]],"admin_state":["set",[]],"cfm_remote_mpids":["set",[]],"cfm_mpid":["set",[]],"bfd":["map",[]],"ofport_request":["set",[]],"ingress_policing_burst":0,"cfm_flap_count":["set",[]],"cfm_health":["set",[]]}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl del-flows br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=1,actions=resubmit(,1)
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=0,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=01:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,19)
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=00:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,20)
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "Interface", "where": [["name", "==", "patch-tun"]], "op": "select"}], "method": "transact", "id": 342571}
... JSON-RPC response ...
{"id":342571,"result":[{"rows":[{"options":["map",[["peer","patch-int"]]],"mtu":["set",[]],"link_speed":["set",[]],"statistics":["map",[["collisions",0],["rx_bytes",0],["rx_crc_err",0],["rx_dropped",0],["rx_errors",0],["rx_frame_err",0],["rx_over_err",0],["rx_packets",0],["tx_bytes",0],["tx_dropped",0],["tx_errors",0],["tx_packets",0]]],"mac_in_use":"c2:af:e7:b2:8e:25","ingress_policing_rate":0,"mac":["set",[]],"ofport":1,"cfm_fault_status":["set",[]],"duplex":["set",[]],"cfm_fault":["set",[]],"lacp_current":["set",[]],"external_ids":["map",[]],"link_state":"up","bfd_status":["map",[]],"link_resets":0,"name":"patch-tun","type":"patch","cfm_remote_opstate":["set",[]],"_uuid":["uuid","6c0bdcd1-d225-48ec-9d7b-71688f749946"],"status":["map",[]],"ifindex":0,"_version":["uuid","ebfd26d5-8c75-45ea-a14e-3c3704c3139a"],"other_config":["map",[]],"admin_state":"up","cfm_remote_mpids":["set",[]],"cfm_mpid":["set",[]],"bfd":["map",[]],"ofport_request":["set",[]],"ingress_policing_burst":0,"cfm_flap_count":["set",[]],"cfm_health":["set",[]]}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=2,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=3,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=10,priority=1,actions=learn(table=20,hard_timeout=300,priority=1,NXM_OF_VLAN_TCI[0..11],NXM_OF_ETH_DST[]=NXM_OF_ETH_SRC[],load:0->NXM_OF_VLAN_TCI[],load:NXM_NX_TUN_ID[]->NXM_NX_TUN_ID[],output:NXM_OF_IN_PORT[]),output:1
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=19,priority=0,actions=resubmit(,21)
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=20,priority=0,actions=resubmit(,21)
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=21,priority=0,actions=drop
[DEBUG] module:ovsdb,function:crud,router:rpi1
CRUD operation (add): {'ovs_bridges': 'enabled'}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_Bridges", "uuid-name": "temp_31122", "row": {"ovs_bridges": "enabled"}, "op": "insert"}, {"table": "NLAN", "where": [], "mutations": [["bridges", "insert", ["set", [["named-uuid", "temp_31122"]]]]], "op": "mutate"}], "method": "transact", "id": 752486}
... JSON-RPC response ...
{"id":752486,"result":[{"uuid":["uuid","76a38e22-b690-4c4a-8e3f-e4d57a150fc7"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_Bridges", "where": [], "op": "select"}], "method": "transact", "id": 776122}
... JSON-RPC response ...
{"id":776122,"result":[{"rows":[{"_uuid":["uuid","76a38e22-b690-4c4a-8e3f-e4d57a150fc7"],"_version":["uuid","33e88553-4d5c-4710-aaba-560c60422ad8"],"ovs_bridges":"enabled","controller":["set",[]]}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:rpi1
function:services.add, index:('name', 'snort1'), model:{'name': 'snort1', 'chain': ['mz.101', 'dmz.1001']}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN", "row": {}, "op": "insert"}], "method": "transact", "id": 932084}
... JSON-RPC response ...
{"id":932084,"result":[{"uuid":["uuid","d4760200-5adf-445b-bfb0-0632d310f374"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_Service", "where": [["name", "==", "snort1"]], "op": "select"}], "method": "transact", "id": 124857}
... JSON-RPC response ...
{"id":124857,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: lxc-start -d -f /var/lib/lxc/snort1/config_nlan -n snort1
[DEBUG] module:ovsdb,function:crud,router:rpi1
CRUD operation (add): {'name': 'snort1', 'chain': ['mz.101', 'dmz.1001']}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_Service", "uuid-name": "temp_795805", "row": {"name": "snort1", "chain": ["set", ["mz.101", "dmz.1001"]]}, "op": "insert"}, {"table": "NLAN", "where": [], "mutations": [["services", "insert", ["set", [["named-uuid", "temp_795805"]]]]], "op": "mutate"}], "method": "transact", "id": 75959}
... JSON-RPC response ...
{"id":75959,"result":[{"uuid":["uuid","2c223df1-d965-4b07-a9e2-8b37f06ae2ae"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_Service", "where": [["name", "==", "snort1"]], "op": "select"}], "method": "transact", "id": 590020}
... JSON-RPC response ...
{"id":590020,"result":[{"rows":[{"_version":["uuid","c446c390-404a-4241-9576-ffe9291d1519"],"_uuid":["uuid","2c223df1-d965-4b07-a9e2-8b37f06ae2ae"],"name":"snort1","chain":["set",["dmz.1001","mz.101"]]}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:rpi1
function:vxlan.add, model:{'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.101'], 'local_ip': '192.168.1.104'}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN", "row": {}, "op": "insert"}], "method": "transact", "id": 719543}
... JSON-RPC response ...
{"id":719543,"result":[{"uuid":["uuid","5bda99e0-5f20-48a0-9465-9939351fd483"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_VXLAN", "where": [], "op": "select"}], "method": "transact", "id": 983641}
... JSON-RPC response ...
{"id":983641,"result":[{"rows":[]}],"error":null}
[INFO] module:vxlan,function:add,router:rpi1
Adding a VXLAN tunnel: vxlan_103
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-tun vxlan_103 -- set interface vxlan_103 type=vxlan options:in_key=flow options:local_ip=192.168.1.104 options:out_key=flow options:remote_ip=192.168.1.103
[INFO] module:vxlan,function:add,router:rpi1
Adding a VXLAN tunnel: vxlan_102
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-tun vxlan_102 -- set interface vxlan_102 type=vxlan options:in_key=flow options:local_ip=192.168.1.104 options:out_key=flow options:remote_ip=192.168.1.102
[INFO] module:vxlan,function:add,router:rpi1
Adding a VXLAN tunnel: vxlan_101
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-tun vxlan_101 -- set interface vxlan_101 type=vxlan options:in_key=flow options:local_ip=192.168.1.104 options:out_key=flow options:remote_ip=192.168.1.101
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "Interface", "where": [["type", "==", "vxlan"]], "columns": ["ofport", "options"], "op": "select"}], "method": "transact", "id": 299975}
... JSON-RPC response ...
{"id":299975,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.104"],["out_key","flow"],["remote_ip","192.168.1.101"]]],"ofport":4},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.104"],["out_key","flow"],["remote_ip","192.168.1.102"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.104"],["out_key","flow"],["remote_ip","192.168.1.103"]]],"ofport":2}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=4,actions=resubmit(,2)
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=3,actions=resubmit(,2)
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=2,actions=resubmit(,2)
[DEBUG] module:ovsdb,function:crud,router:rpi1
CRUD operation (add): {'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.101'], 'local_ip': '192.168.1.104'}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_VXLAN", "uuid-name": "temp_20675", "row": {"remote_ips": ["set", ["192.168.1.103", "192.168.1.102", "192.168.1.101"]], "local_ip": "192.168.1.104"}, "op": "insert"}, {"table": "NLAN", "where": [], "mutations": [["vxlan", "insert", ["set", [["named-uuid", "temp_20675"]]]]], "op": "mutate"}], "method": "transact", "id": 287990}
... JSON-RPC response ...
{"id":287990,"result":[{"uuid":["uuid","41f8b370-cb12-4a35-b65f-bac8d797ec5b"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_VXLAN", "where": [], "op": "select"}], "method": "transact", "id": 229411}
... JSON-RPC response ...
{"id":229411,"result":[{"rows":[{"_version":["uuid","f5992f47-a78b-44db-aa82-cb87c2278cb4"],"_uuid":["uuid","41f8b370-cb12-4a35-b65f-bac8d797ec5b"],"remote_ips":["set",["192.168.1.101","192.168.1.102","192.168.1.103"]],"local_ip":"192.168.1.104"}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:rpi1
function:subnets.add, index:('vni', 1001), model:{'peers': ['192.168.1.101'], 'vni': 1001, 'vid': 111, 'ports': ['dmz.1001']}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN", "row": {}, "op": "insert"}], "method": "transact", "id": 390167}
... JSON-RPC response ...
{"id":390167,"result":[{"uuid":["uuid","ee184ef2-4df4-4c25-9711-781a641f3659"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_Subnet", "where": [["vni", "==", 1001]], "op": "select"}], "method": "transact", "id": 773253}
... JSON-RPC response ...
{"id":773253,"result":[{"rows":[]}],"error":null}
[INFO] module:subnets,function:_crud,router:rpi1
Adding a subnet(vlan): 111
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip netns add ns111
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addbr br111
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link add veth-ns111 type veth peer name temp-ns111
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev temp-ns111 netns ns111
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip netns exec ns111 ip link set dev temp-ns111 name eth0
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-int int-br111 tag=111 -- set interface int-br111 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-int int-dvr111 tag=111 -- set interface int-dvr111 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addif br111 veth-ns111
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addif br111 int-br111
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev veth-ns111 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev veth-ns111 up
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip netns exec ns111 ip link set dev eth0 up
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int-br111 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int-br111 up
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int-dvr111 up
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev br111 up
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addif br111 dmz.1001
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "Controller", "where": [], "columns": ["target"], "op": "select"}], "method": "transact", "id": 693245}
... JSON-RPC response ...
{"id":693245,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=1001,actions=mod_vlan_vid:111,resubmit(,10)
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "Interface", "where": [["type", "==", "vxlan"]], "columns": ["ofport", "options"], "op": "select"}], "method": "transact", "id": 987440}
... JSON-RPC response ...
{"id":987440,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.104"],["out_key","flow"],["remote_ip","192.168.1.101"]]],"ofport":4},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.104"],["out_key","flow"],["remote_ip","192.168.1.102"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.104"],["out_key","flow"],["remote_ip","192.168.1.103"]]],"ofport":2}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=111,actions=strip_vlan,set_tunnel:1001,output:4
[DEBUG] module:ovsdb,function:crud,router:rpi1
CRUD operation (add): {'peers': ['192.168.1.101'], 'vni': 1001, 'vid': 111, 'ports': ['dmz.1001']}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_Subnet", "uuid-name": "temp_178082", "row": {"peers": ["set", ["192.168.1.101"]], "vid": 111, "vni": 1001, "ports": ["set", ["dmz.1001"]]}, "op": "insert"}, {"table": "NLAN", "where": [], "mutations": [["subnets", "insert", ["set", [["named-uuid", "temp_178082"]]]]], "op": "mutate"}], "method": "transact", "id": 264775}
... JSON-RPC response ...
{"id":264775,"result":[{"uuid":["uuid","e715df29-5865-46f7-a826-1f4ca5adb5a7"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_Subnet", "where": [["vni", "==", 1001]], "op": "select"}], "method": "transact", "id": 53326}
... JSON-RPC response ...
{"id":53326,"result":[{"rows":[{"peers":"192.168.1.101","_version":["uuid","e592817f-29ba-4fe0-a5b2-c81188c26cc2"],"vni":1001,"ports":"dmz.1001","mode":["set",[]],"vid":111,"_uuid":["uuid","e715df29-5865-46f7-a826-1f4ca5adb5a7"],"default_gw":["set",[]],"ip_vhost":["set",[]],"ip_dvr":["set",[]]}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:rpi1
function:subnets.add, index:('vni', 101), model:{'peers': ['192.168.1.102', '192.168.1.103'], 'vni': 101, 'vid': 1, 'ports': ['mz.101']}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN", "row": {}, "op": "insert"}], "method": "transact", "id": 520200}
... JSON-RPC response ...
{"id":520200,"result":[{"uuid":["uuid","d241a3a0-6880-48df-be13-ec2a4271e2c4"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_Subnet", "where": [["vni", "==", 101]], "op": "select"}], "method": "transact", "id": 399967}
... JSON-RPC response ...
{"id":399967,"result":[{"rows":[]}],"error":null}
[INFO] module:subnets,function:_crud,router:rpi1
Adding a subnet(vlan): 1
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip netns add ns1
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addbr br1
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link add veth-ns1 type veth peer name temp-ns1
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev temp-ns1 netns ns1
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip netns exec ns1 ip link set dev temp-ns1 name eth0
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-int int-br1 tag=1 -- set interface int-br1 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-vsctl add-port br-int int-dvr1 tag=1 -- set interface int-dvr1 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addif br1 veth-ns1
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addif br1 int-br1
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev veth-ns1 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev veth-ns1 up
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip netns exec ns1 ip link set dev eth0 up
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int-br1 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int-br1 up
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev int-dvr1 up
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ip link set dev br1 up
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: brctl addif br1 mz.101
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "Controller", "where": [], "columns": ["target"], "op": "select"}], "method": "transact", "id": 590990}
... JSON-RPC response ...
{"id":590990,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=101,actions=mod_vlan_vid:1,resubmit(,10)
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "Interface", "where": [["type", "==", "vxlan"]], "columns": ["ofport", "options"], "op": "select"}], "method": "transact", "id": 730556}
... JSON-RPC response ...
{"id":730556,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.104"],["out_key","flow"],["remote_ip","192.168.1.101"]]],"ofport":4},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.104"],["out_key","flow"],["remote_ip","192.168.1.102"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.104"],["out_key","flow"],["remote_ip","192.168.1.103"]]],"ofport":2}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:rpi1
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=1,actions=strip_vlan,set_tunnel:101,output:3,output:2
[DEBUG] module:ovsdb,function:crud,router:rpi1
CRUD operation (add): {'peers': ['192.168.1.102', '192.168.1.103'], 'vni': 101, 'vid': 1, 'ports': ['mz.101']}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_Subnet", "uuid-name": "temp_530242", "row": {"peers": ["set", ["192.168.1.102", "192.168.1.103"]], "vid": 1, "vni": 101, "ports": ["set", ["mz.101"]]}, "op": "insert"}, {"table": "NLAN", "where": [], "mutations": [["subnets", "insert", ["set", [["named-uuid", "temp_530242"]]]]], "op": "mutate"}], "metmp_125634","row":{"peers":["set",["192.168.1.102","192.168.1.104"]],"vid":1,"ip_vhost":"10.0.1.103/24","vni":101,"ip_dvr":"10.0.1.1/24","mode":"spoke_dvr"},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["subnets","insert",["set",[["named-uuid","temp_125634"]]]]],"op":"mutate"}],"method":"transact","id":577047}
... JSON-RPC response ...
{"id":577047,"result":[{"uuid":["uuid","1c063adf-a46d-492f-bee4-4683e8f14ef9"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt3
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",101]],"op":"select"}],"method":"transact","id":598010}
... JSON-RPC response ...
{"id":598010,"result":[{"rows":[{"peers":["set",["192.168.1.102","192.168.1.104"]],"_version":["uuid","718a4d5a-32aa-4922-bef0-49714741839e"],"vni":101,"ports":["set",[]],"mode":"spoke_dvr","vid":1,"_uuid":["uuid","1c063adf-a46d-492f-bee4-4683e8f14ef9"],"default_gw":["set",[]],"ip_vhost":"10.0.1.103/24","ip_dvr":"10.0.1.1/24"}]}],"error":null}
__ NLAN response __
message: Execution completed
exit: 0
hod": "transact", "id": 30111}
... JSON-RPC response ...
{"id":30111,"result":[{"uuid":["uuid","e41a4d36-68bd-4366-83d2-df7f17099a8b"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:rpi1
... JSON-RPC request ...
{"params": ["Open_vSwitch", {"table": "NLAN_Subnet", "where": [["vni", "==", 101]], "op": "select"}], "method": "transact", "id": 651180}
... JSON-RPC response ...
{"id":651180,"result":[{"rows":[{"peers":["set",["192.168.1.102","192.168.1.103"]],"_version":["uuid","449ee809-e241-42bf-b095-982c98d2acb5"],"vni":101,"ports":"mz.101","mode":["set",[]],"vid":1,"_uuid":["uuid","e41a4d36-68bd-4366-83d2-df7f17099a8b"],"default_gw":["set",[]],"ip_vhost":["set",[]],"ip_dvr":["set",[]]}]}],"error":null}
__ NLAN response __
message: Execution completed
exit: 0
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
[INFO] module:nlan_agent,function:<module>,router:openwrt2
NLAN Agent initialization completed
{'mod_dir': ['command', 'config'], 'etc_dir': '/opt/nlan/etc', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'ip_dvr': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'mode': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}}, 'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'indexes': {'services': 'name', 'subnets': 'vni'}, 'platform': 'openwrt', 'init': False, 'router': 'openwrt2', 'logger': <logging.Logger object at 0xb75a2f0c>, 'schema': 'ovsdb_nlan.schema'}
[INFO] module:nlan_agent,function:_route,router:openwrt2
function:bridges.add, model:{'ovs_bridges': 'enabled'}
[INFO] module:bridges,function:add,router:openwrt2
Adding bridges: br-int and br-tun
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":299750}
... JSON-RPC response ...
{"id":299750,"result":[{"uuid":["uuid","fb43688a-f76d-480b-9762-b61751423837"]}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Bridges","where":[],"op":"select"}],"method":"transact","id":334421}
... JSON-RPC response ...
{"id":334421,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-br br-int
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-br br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl del-flows br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int patch-int -- set interface patch-int type=patch options:peer=patch-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-tun patch-tun -- set interface patch-tun type=patch options:peer=patch-int
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["name","==","patch-tun"]],"op":"select"}],"method":"transact","id":179717}
... JSON-RPC response ...
{"id":179717,"result":[{"rows":[{"options":["map",[["peer","patch-int"]]],"mtu":["set",[]],"link_speed":["set",[]],"statistics":["map",[["collisions",0],["rx_bytes",0],["rx_crc_err",0],["rx_dropped",0],["rx_errors",0],["rx_frame_err",0],["rx_over_err",0],["rx_packets",0],["tx_bytes",0],["tx_dropped",0],["tx_errors",0],["tx_packets",0]]],"mac_in_use":"ce:b1:27:54:82:58","ingress_policing_rate":0,"ofport":1,"mac":["set",[]],"cfm_fault_status":["set",[]],"duplex":["set",[]],"lacp_current":["set",[]],"cfm_fault":["set",[]],"link_state":["set",[]],"external_ids":["map",[]],"bfd_status":["map",[]],"link_resets":["set",[]],"name":"patch-tun","type":"patch","cfm_remote_opstate":["set",[]],"_uuid":["uuid","dd66a799-d544-4d03-b6bd-52309573e230"],"status":["map",[]],"ifindex":0,"_version":["uuid","e4ab7030-10a6-4927-bd1f-36ba94b32517"],"other_config":["map",[]],"admin_state":["set",[]],"cfm_remote_mpids":["set",[]],"cfm_mpid":["set",[]],"bfd":["map",[]],"ofport_request":["set",[]],"ingress_policing_burst":0,"cfm_flap_count":["set",[]],"cfm_health":["set",[]]}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl del-flows br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=1,actions=resubmit(,1)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=0,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=01:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,19)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=00:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,20)
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["name","==","patch-tun"]],"op":"select"}],"method":"transact","id":165179}
... JSON-RPC response ...
{"id":165179,"result":[{"rows":[{"options":["map",[["peer","patch-int"]]],"mtu":["set",[]],"link_speed":["set",[]],"statistics":["map",[["collisions",0],["rx_bytes",0],["rx_crc_err",0],["rx_dropped",0],["rx_errors",0],["rx_frame_err",0],["rx_over_err",0],["rx_packets",0],["tx_bytes",0],["tx_dropped",0],["tx_errors",0],["tx_packets",0]]],"mac_in_use":"ce:b1:27:54:82:58","ingress_policing_rate":0,"ofport":1,"mac":["set",[]],"cfm_fault_status":["set",[]],"duplex":["set",[]],"lacp_current":["set",[]],"cfm_fault":["set",[]],"link_state":"up","external_ids":["map",[]],"bfd_status":["map",[]],"link_resets":0,"name":"patch-tun","type":"patch","cfm_remote_opstate":["set",[]],"_uuid":["uuid","dd66a799-d544-4d03-b6bd-52309573e230"],"status":["map",[]],"ifindex":0,"_version":["uuid","6dcb7e19-26c7-4227-8fd0-404492b28fe2"],"other_config":["map",[]],"admin_state":"up","cfm_remote_mpids":["set",[]],"cfm_mpid":["set",[]],"bfd":["map",[]],"ofport_request":["set",[]],"ingress_policing_burst":0,"cfm_flap_count":["set",[]],"cfm_health":["set",[]]}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=2,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=3,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=10,priority=1,actions=learn(table=20,hard_timeout=300,priority=1,NXM_OF_VLAN_TCI[0..11],NXM_OF_ETH_DST[]=NXM_OF_ETH_SRC[],load:0->NXM_OF_VLAN_TCI[],load:NXM_NX_TUN_ID[]->NXM_NX_TUN_ID[],output:NXM_OF_IN_PORT[]),output:1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=19,priority=0,actions=resubmit(,21)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=20,priority=0,actions=resubmit(,21)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=21,priority=0,actions=drop
[DEBUG] module:ovsdb,function:crud,router:openwrt2
CRUD operation (add): {'ovs_bridges': 'enabled'}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Bridges","uuid-name":"temp_833991","row":{"ovs_bridges":"enabled"},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["bridges","insert",["set",[["named-uuid","temp_833991"]]]]],"op":"mutate"}],"method":"transact","id":492328}
... JSON-RPC response ...
{"id":492328,"result":[{"uuid":["uuid","2c756031-3f0a-40a9-8dee-399a33ae0319"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Bridges","where":[],"op":"select"}],"method":"transact","id":642332}
... JSON-RPC response ...
{"id":642332,"result":[{"rows":[{"_uuid":["uuid","2c756031-3f0a-40a9-8dee-399a33ae0319"],"_version":["uuid","00244ef1-0c58-4cc5-98d9-56afb3c79113"],"ovs_bridges":"enabled","controller":["set",[]]}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:openwrt2
function:vxlan.add, model:{'remote_ips': ['192.168.1.103', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.102'}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":317463}
... JSON-RPC response ...
{"id":317463,"result":[{"uuid":["uuid","d4c08c15-ec9d-498c-93e7-fab7f600086c"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_VXLAN","where":[],"op":"select"}],"method":"transact","id":652588}
... JSON-RPC response ...
{"id":652588,"result":[{"rows":[]}],"error":null}
[INFO] module:vxlan,function:add,router:openwrt2
Adding a VXLAN tunnel: vxlan_103
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-tun vxlan_103 -- set interface vxlan_103 type=vxlan options:in_key=flow options:local_ip=192.168.1.102 options:out_key=flow options:remote_ip=192.168.1.103
[INFO] module:vxlan,function:add,router:openwrt2
Adding a VXLAN tunnel: vxlan_101
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-tun vxlan_101 -- set interface vxlan_101 type=vxlan options:in_key=flow options:local_ip=192.168.1.102 options:out_key=flow options:remote_ip=192.168.1.101
[INFO] module:vxlan,function:add,router:openwrt2
Adding a VXLAN tunnel: vxlan_104
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-tun vxlan_104 -- set interface vxlan_104 type=vxlan options:in_key=flow options:local_ip=192.168.1.102 options:out_key=flow options:remote_ip=192.168.1.104
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["type","==","vxlan"]],"columns":["ofport","options"],"op":"select"}],"method":"transact","id":54145}
... JSON-RPC response ...
{"id":54145,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.102"],["out_key","flow"],["remote_ip","192.168.1.101"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.102"],["out_key","flow"],["remote_ip","192.168.1.103"]]],"ofport":2},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.102"],["out_key","flow"],["remote_ip","192.168.1.104"]]],"ofport":4}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=3,actions=resubmit(,2)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=2,actions=resubmit(,2)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=4,actions=resubmit(,2)
[DEBUG] module:ovsdb,function:crud,router:openwrt2
CRUD operation (add): {'remote_ips': ['192.168.1.103', '192.168.1.101', '192.168.1.104'], 'local_ip': '192.168.1.102'}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_VXLAN","uuid-name":"temp_36658","row":{"remote_ips":["set",["192.168.1.103","192.168.1.101","192.168.1.104"]],"local_ip":"192.168.1.102"},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["vxlan","insert",["set",[["named-uuid","temp_36658"]]]]],"op":"mutate"}],"method":"transact","id":125880}
... JSON-RPC response ...
{"id":125880,"result":[{"uuid":["uuid","7286ff4d-a8d4-4843-b206-e29999e51cae"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_VXLAN","where":[],"op":"select"}],"method":"transact","id":965902}
... JSON-RPC response ...
{"id":965902,"result":[{"rows":[{"_version":["uuid","b479b32c-a52d-447c-bc41-59c79dcfe0c9"],"_uuid":["uuid","7286ff4d-a8d4-4843-b206-e29999e51cae"],"local_ip":"192.168.1.102","remote_ips":["set",["192.168.1.101","192.168.1.103","192.168.1.104"]]}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:openwrt2
function:subnets.add, index:('vni', 1), model:{'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 2, 'ip_vhost': '192.168.100.102/24', 'default_gw': '192.168.100.1', 'ip_dvr': '192.168.100.2/24', 'vni': 1}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":36672}
... JSON-RPC response ...
{"id":36672,"result":[{"uuid":["uuid","12ef7fd1-9515-4dbf-b38b-0738a4246d34"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",1]],"op":"select"}],"method":"transact","id":158106}
... JSON-RPC response ...
{"id":158106,"result":[{"rows":[]}],"error":null}
[INFO] module:subnets,function:_crud,router:openwrt2
Adding a subnet(vlan): 2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns add ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addbr br2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link add veth-ns2 type veth peer name temp-ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev temp-ns2 netns ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns2 ip link set dev temp-ns2 name eth0
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int-br2 tag=2 -- set interface int-br2 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int-dvr2 tag=2 -- set interface int-dvr2 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br2 veth-ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br2 int-br2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns2 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns2 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns2 ip link set dev eth0 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-br2 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-br2 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-dvr2 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br2 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns2 ip addr add dev eth0 192.168.100.102/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip addr add dev int-dvr2 192.168.100.2/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns2 ip route add default via 192.168.100.2 dev eth0
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: route
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip route add default via 192.168.100.1
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Controller","where":[],"columns":["target"],"op":"select"}],"method":"transact","id":447990}
... JSON-RPC response ...
{"id":447990,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=1,actions=mod_vlan_vid:2,resubmit(,10)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=2,nw_dst=192.168.100.2,actions=drop
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["type","==","vxlan"]],"columns":["ofport","options"],"op":"select"}],"method":"transact","id":22657}
... JSON-RPC response ...
{"id":22657,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.102"],["out_key","flow"],["remote_ip","192.168.1.101"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.102"],["out_key","flow"],["remote_ip","192.168.1.103"]]],"ofport":2},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.102"],["out_key","flow"],["remote_ip","192.168.1.104"]]],"ofport":4}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=2,actions=strip_vlan,set_tunnel:1,output:3,output:2
[DEBUG] module:ovsdb,function:crud,router:openwrt2
CRUD operation (add): {'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 2, 'ip_vhost': '192.168.100.102/24', 'default_gw': '192.168.100.1', 'ip_dvr': '192.168.100.2/24', 'vni': 1}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","uuid-name":"temp_681887","row":{"peers":["set",["192.168.1.101","192.168.1.103"]],"vid":2,"ip_vhost":"192.168.100.102/24","default_gw":"192.168.100.1","ip_dvr":"192.168.100.2/24","vni":1},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["subnets","insert",["set",[["named-uuid","temp_681887"]]]]],"op":"mutate"}],"method":"transact","id":596219}
... JSON-RPC response ...
{"id":596219,"result":[{"uuid":["uuid","8359fe8d-e7b9-4508-9b2c-6d8a7cde0beb"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",1]],"op":"select"}],"method":"transact","id":150404}
... JSON-RPC response ...
{"id":150404,"result":[{"rows":[{"peers":["set",["192.168.1.101","192.168.1.103"]],"_version":["uuid","dff720bd-dac1-4155-bc50-31b289edffcc"],"vni":1,"ports":["set",[]],"mode":["set",[]],"vid":2,"_uuid":["uuid","8359fe8d-e7b9-4508-9b2c-6d8a7cde0beb"],"default_gw":"192.168.100.1","ip_vhost":"192.168.100.102/24","ip_dvr":"192.168.100.2/24"}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:openwrt2
function:subnets.add, index:('vni', 103), model:{'ip_dvr': '10.0.3.1/24', 'ip_vhost': '10.0.3.102/24', 'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 3, 'vni': 103}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":220012}
... JSON-RPC response ...
{"id":220012,"result":[{"uuid":["uuid","226aed01-5807-40c3-aea2-2d6382a1d471"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",103]],"op":"select"}],"method":"transact","id":790214}
... JSON-RPC response ...
{"id":790214,"result":[{"rows":[]}],"error":null}
[INFO] module:subnets,function:_crud,router:openwrt2
Adding a subnet(vlan): 3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns add ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addbr br3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link add veth-ns3 type veth peer name temp-ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev temp-ns3 netns ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns3 ip link set dev temp-ns3 name eth0
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int-br3 tag=3 -- set interface int-br3 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int-dvr3 tag=3 -- set interface int-dvr3 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br3 veth-ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br3 int-br3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns3 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns3 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns3 ip link set dev eth0 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-br3 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-br3 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-dvr3 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br3 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns3 ip addr add dev eth0 10.0.3.102/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip addr add dev int-dvr3 10.0.3.1/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns3 ip route add default via 10.0.3.1 dev eth0
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Controller","where":[],"columns":["target"],"op":"select"}],"method":"transact","id":205331}
... JSON-RPC response ...
{"id":205331,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=103,actions=mod_vlan_vid:3,resubmit(,10)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=3,nw_dst=10.0.3.1,actions=drop
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["type","==","vxlan"]],"columns":["ofport","options"],"op":"select"}],"method":"transact","id":184501}
... JSON-RPC response ...
{"id":184501,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.102"],["out_key","flow"],["remote_ip","192.168.1.101"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.102"],["out_key","flow"],["remote_ip","192.168.1.103"]]],"ofport":2},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.102"],["out_key","flow"],["remote_ip","192.168.1.104"]]],"ofport":4}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=3,actions=strip_vlan,set_tunnel:103,output:3,output:2
[DEBUG] module:ovsdb,function:crud,router:openwrt2
CRUD operation (add): {'ip_dvr': '10.0.3.1/24', 'ip_vhost': '10.0.3.102/24', 'peers': ['192.168.1.101', '192.168.1.103'], 'vid': 3, 'vni': 103}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","uuid-name":"temp_831133","row":{"ip_dvr":"10.0.3.1/24","ip_vhost":"10.0.3.102/24","peers":["set",["192.168.1.101","192.168.1.103"]],"vid":3,"vni":103},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["subnets","insert",["set",[["named-uuid","temp_831133"]]]]],"op":"mutate"}],"method":"transact","id":170718}
... JSON-RPC response ...
{"id":170718,"result":[{"uuid":["uuid","adf4715f-3b21-4ebb-9566-db32a183d8be"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",103]],"op":"select"}],"method":"transact","id":217580}
... JSON-RPC response ...
{"id":217580,"result":[{"rows":[{"peers":["set",["192.168.1.101","192.168.1.103"]],"_version":["uuid","00a135b0-1718-4d5f-b955-7bdbc2f109aa"],"vni":103,"ports":["set",[]],"mode":["set",[]],"vid":3,"_uuid":["uuid","adf4715f-3b21-4ebb-9566-db32a183d8be"],"default_gw":["set",[]],"ip_vhost":"10.0.3.102/24","ip_dvr":"10.0.3.1/24"}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:openwrt2
function:subnets.add, index:('vni', 101), model:{'peers': ['192.168.1.103', '192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.102/24', 'vni': 101, 'ip_dvr': '10.0.1.1/24', 'mode': 'spoke_dvr'}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":134299}
... JSON-RPC response ...
{"id":134299,"result":[{"uuid":["uuid","abf936da-6253-42c6-a8b6-93166b5bf87d"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",101]],"op":"select"}],"method":"transact","id":273760}
... JSON-RPC response ...
{"id":273760,"result":[{"rows":[]}],"error":null}
[INFO] module:subnets,function:_crud,router:openwrt2
Adding a subnet(vlan): 1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns add ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addbr br1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link add veth-ns1 type veth peer name temp-ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev temp-ns1 netns ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns1 ip link set dev temp-ns1 name eth0
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int-br1 tag=1 -- set interface int-br1 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-vsctl add-port br-int int-dvr1 tag=1 -- set interface int-dvr1 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br1 veth-ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: brctl addif br1 int-br1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns1 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev veth-ns1 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns1 ip link set dev eth0 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-br1 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-br1 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev int-dvr1 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link set dev br1 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns1 ip addr add dev eth0 10.0.1.102/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip addr add dev int-dvr1 10.0.1.1/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip netns exec ns1 ip route add default via 10.0.1.1 dev eth0
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Controller","where":[],"columns":["target"],"op":"select"}],"method":"transact","id":701171}
... JSON-RPC response ...
{"id":701171,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=101,actions=mod_vlan_vid:1,resubmit(,10)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ip link show dev int-dvr1
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["name","==","int-dvr1"]],"op":"select"}],"method":"transact","id":915900}
... JSON-RPC response ...
{"id":915900,"result":[{"rows":[{"options":["map",[]],"mtu":1500,"link_speed":["set",[]],"statistics":["map",[["collisions",0],["rx_bytes",0],["rx_crc_err",0],["rx_dropped",0],["rx_errors",0],["rx_frame_err",0],["rx_over_err",0],["rx_packets",0],["tx_bytes",0],["tx_dropped",0],["tx_errors",0],["tx_packets",0]]],"mac_in_use":"da:e5:1d:34:72:7a","ingress_policing_rate":0,"ofport":7,"mac":["set",[]],"cfm_fault_status":["set",[]],"duplex":["set",[]],"lacp_current":["set",[]],"cfm_fault":["set",[]],"link_state":"up","external_ids":["map",[]],"bfd_status":["map",[]],"link_resets":2,"name":"int-dvr1","type":"internal","cfm_remote_opstate":["set",[]],"_uuid":["uuid","7bdf5ad7-e968-44e7-8820-9af108ab4617"],"status":["map",[["driver_name","openvswitch"]]],"ifindex":46,"_version":["uuid","1f9ee6c3-f25b-4ce6-a6fe-6100e481452b"],"other_config":["map",[]],"admin_state":"up","cfm_remote_mpids":["set",[]],"cfm_mpid":["set",[]],"bfd":["map",[]],"ofport_request":["set",[]],"ingress_policing_burst":0,"cfm_flap_count":["set",[]],"cfm_health":["set",[]]}]}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["name","==","int-br1"]],"op":"select"}],"method":"transact","id":184983}
... JSON-RPC response ...
{"id":184983,"result":[{"rows":[{"options":["map",[]],"mtu":1500,"link_speed":["set",[]],"statistics":["map",[["collisions",0],["rx_bytes",0],["rx_crc_err",0],["rx_dropped",0],["rx_errors",0],["rx_frame_err",0],["rx_over_err",0],["rx_packets",0],["tx_bytes",0],["tx_dropped",0],["tx_errors",0],["tx_packets",0]]],"mac_in_use":"ce:97:7a:5d:39:27","ingress_policing_rate":0,"ofport":6,"mac":["set",[]],"cfm_fault_status":["set",[]],"duplex":["set",[]],"lacp_current":["set",[]],"cfm_fault":["set",[]],"link_state":"up","external_ids":["map",[]],"bfd_status":["map",[]],"link_resets":2,"name":"int-br1","type":"internal","cfm_remote_opstate":["set",[]],"_uuid":["uuid","5af4ef77-7d86-4a12-b787-2d01872cbb24"],"status":["map",[["driver_name","openvswitch"]]],"ifindex":45,"_version":["uuid","e2d952ce-93d6-4901-ba41-5c0bd9dfdd01"],"other_config":["map",[]],"admin_state":"up","cfm_remote_mpids":["set",[]],"cfm_mpid":["set",[]],"bfd":["map",[]],"ofport_request":["set",[]],"ingress_policing_burst":0,"cfm_flap_count":["set",[]],"cfm_health":["set",[]]}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=0,priority=2,in_port=6,dl_type=0x0800,nw_dst=10.0.1.0/24,actions=normal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=10.0.0.0/8,actions=resubmit(,1)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=172.16.0.0/12,actions=resubmit(,1)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=6,dl_type=0x0800,nw_dst=192.168.0.0/16,actions=resubmit(,1)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=0,priority=1,in_port=7,dl_type=0x0806,nw_src=10.0.1.1,nw_proto=2,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-int table=1,priority=0,actions=set_field:da:e5:1d:34:72:7a->dl_dst,output:7
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["type","==","vxlan"]],"columns":["ofport","options"],"op":"select"}],"method":"transact","id":832964}
... JSON-RPC response ...
{"id":832964,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.102"],["out_key","flow"],["remote_ip","192.168.1.101"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.102"],["out_key","flow"],["remote_ip","192.168.1.103"]]],"ofport":2},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.102"],["out_key","flow"],["remote_ip","192.168.1.104"]]],"ofport":4}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt2
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=1,actions=strip_vlan,set_tunnel:101,output:2,output:4
[DEBUG] module:ovsdb,function:crud,router:openwrt2
CRUD operation (add): {'peers': ['192.168.1.103', '192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.102/24', 'vni': 101, 'ip_dvr': '10.0.1.1/24', 'mode': 'spoke_dvr'}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","uuid-name":"temp_659041","row":{"peers":["set",["192.168.1.103","192.168.1.104"]],"vid":1,"ip_vhost":"10.0.1.102/24","vni":101,"ip_dvr":"10.0.1.1/24","mode":"spoke_dvr"},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["subnets","insert",["set",[["named-uuid","temp_659041"]]]]],"op":"mutate"}],"method":"transact","id":240879}
... JSON-RPC response ...
{"id":240879,"result":[{"uuid":["uuid","a598d17c-3872-4998-be76-0d6056b01863"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt2
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",101]],"op":"select"}],"method":"transact","id":534444}
... JSON-RPC response ...
{"id":534444,"result":[{"rows":[{"peers":["set",["192.168.1.103","192.168.1.104"]],"_version":["uuid","8e1ade42-14f2-407a-83c3-96af0218219e"],"vni":101,"ports":["set",[]],"mode":"spoke_dvr","vid":1,"_uuid":["uuid","a598d17c-3872-4998-be76-0d6056b01863"],"default_gw":["set",[]],"ip_vhost":"10.0.1.102/24","ip_dvr":"10.0.1.1/24"}]}],"error":null}
__ NLAN response __
message: Execution completed
exit: 0
=+=+= NLAN Response from router:openwrt1,platform:openwrt =+=+=+=+=+=+=+=+=+=+
[INFO] module:nlan_agent,function:<module>,router:openwrt1
NLAN Agent initialization completed
{'mod_dir': ['command', 'config'], 'etc_dir': '/opt/nlan/etc', 'state_order': ['bridges', 'services', 'gateway', 'vxlan', 'subnets'], 'types': {'services': {'name': {'max': 1, 'key': {'type': 'string'}, 'min': 1}, 'chain': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}}, 'bridges': {'controller': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ovs_bridges': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'gateway': {'network': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'rip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'vxlan': {'remote_ips': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'local_ip': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}, 'subnets': {'ip_dvr': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'peers': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'vni': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 16777215, 'type': 'integer'}, 'min': 1}, 'vid': {'max': 1, 'key': {'minInteger': 0, 'maxInteger': 4095, 'type': 'integer'}, 'min': 0}, 'ip_vhost': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'ports': {'max': 'unlimited', 'key': {'type': 'string'}, 'min': 0}, 'default_gw': {'max': 1, 'key': {'type': 'string'}, 'min': 0}, 'mode': {'max': 1, 'key': {'type': 'string'}, 'min': 0}}}, 'tables': {'services': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Service'}, 'min': 0}, 'bridges': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Bridges'}, 'min': 0}, 'gateway': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_Gateway'}, 'min': 0}, 'vxlan': {'max': 1, 'key': {'type': 'uuid', 'refTable': 'NLAN_VXLAN'}, 'min': 0}, 'subnets': {'max': 'unlimited', 'key': {'type': 'uuid', 'refTable': 'NLAN_Subnet'}, 'min': 0}}, 'agent_dir': '/opt/nlan', 'indexes': {'services': 'name', 'subnets': 'vni'}, 'platform': 'openwrt', 'init': False, 'router': 'openwrt1', 'logger': <logging.Logger object at 0xb757beac>, 'schema': 'ovsdb_nlan.schema'}
[INFO] module:nlan_agent,function:_route,router:openwrt1
function:bridges.add, model:{'ovs_bridges': 'enabled'}
[INFO] module:bridges,function:add,router:openwrt1
Adding bridges: br-int and br-tun
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":905878}
... JSON-RPC response ...
{"id":905878,"result":[{"uuid":["uuid","70feab6c-a1bf-4089-b084-c91a3b918a97"]}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Bridges","where":[],"op":"select"}],"method":"transact","id":439361}
... JSON-RPC response ...
{"id":439361,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-br br-int
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-br br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl del-flows br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int patch-int -- set interface patch-int type=patch options:peer=patch-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-tun patch-tun -- set interface patch-tun type=patch options:peer=patch-int
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["name","==","patch-tun"]],"op":"select"}],"method":"transact","id":304103}
... JSON-RPC response ...
{"id":304103,"result":[{"rows":[{"options":["map",[["peer","patch-int"]]],"mtu":["set",[]],"link_speed":["set",[]],"statistics":["map",[["collisions",0],["rx_bytes",0],["rx_crc_err",0],["rx_dropped",0],["rx_errors",0],["rx_frame_err",0],["rx_over_err",0],["rx_packets",0],["tx_bytes",0],["tx_dropped",0],["tx_errors",0],["tx_packets",0]]],"mac_in_use":"a2:90:66:78:b9:76","ingress_policing_rate":0,"ofport":1,"mac":["set",[]],"cfm_fault_status":["set",[]],"duplex":["set",[]],"lacp_current":["set",[]],"cfm_fault":["set",[]],"link_state":["set",[]],"external_ids":["map",[]],"bfd_status":["map",[]],"link_resets":["set",[]],"name":"patch-tun","type":"patch","cfm_remote_opstate":["set",[]],"_uuid":["uuid","2c97e1ee-e3d4-4b54-b147-0d35c8cf2686"],"status":["map",[]],"ifindex":0,"_version":["uuid","74e70458-7946-4eaf-9939-d3413313ce29"],"other_config":["map",[]],"admin_state":["set",[]],"cfm_remote_mpids":["set",[]],"cfm_mpid":["set",[]],"bfd":["map",[]],"ofport_request":["set",[]],"ingress_policing_burst":0,"cfm_flap_count":["set",[]],"cfm_health":["set",[]]}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl del-flows br-tun
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=1,actions=resubmit(,1)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=01:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,19)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=1,priority=0,dl_dst=00:00:00:00:00:00/01:00:00:00:00:00,actions=resubmit(,20)
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["name","==","patch-tun"]],"op":"select"}],"method":"transact","id":684574}
... JSON-RPC response ...
{"id":684574,"result":[{"rows":[{"options":["map",[["peer","patch-int"]]],"mtu":["set",[]],"link_speed":["set",[]],"statistics":["map",[["collisions",0],["rx_bytes",0],["rx_crc_err",0],["rx_dropped",0],["rx_errors",0],["rx_frame_err",0],["rx_over_err",0],["rx_packets",0],["tx_bytes",0],["tx_dropped",0],["tx_errors",0],["tx_packets",0]]],"mac_in_use":"a2:90:66:78:b9:76","ingress_policing_rate":0,"ofport":1,"mac":["set",[]],"cfm_fault_status":["set",[]],"duplex":["set",[]],"lacp_current":["set",[]],"cfm_fault":["set",[]],"link_state":"up","external_ids":["map",[]],"bfd_status":["map",[]],"link_resets":0,"name":"patch-tun","type":"patch","cfm_remote_opstate":["set",[]],"_uuid":["uuid","2c97e1ee-e3d4-4b54-b147-0d35c8cf2686"],"status":["map",[]],"ifindex":0,"_version":["uuid","fce00a82-5048-420e-b3e6-8f1ab41c7d60"],"other_config":["map",[]],"admin_state":"up","cfm_remote_mpids":["set",[]],"cfm_mpid":["set",[]],"bfd":["map",[]],"ofport_request":["set",[]],"ingress_policing_burst":0,"cfm_flap_count":["set",[]],"cfm_health":["set",[]]}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=2,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=3,priority=0,actions=drop
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=10,priority=1,actions=learn(table=20,hard_timeout=300,priority=1,NXM_OF_VLAN_TCI[0..11],NXM_OF_ETH_DST[]=NXM_OF_ETH_SRC[],load:0->NXM_OF_VLAN_TCI[],load:NXM_NX_TUN_ID[]->NXM_NX_TUN_ID[],output:NXM_OF_IN_PORT[]),output:1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=19,priority=0,actions=resubmit(,21)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=20,priority=0,actions=resubmit(,21)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=21,priority=0,actions=drop
[DEBUG] module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'ovs_bridges': 'enabled'}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Bridges","uuid-name":"temp_520123","row":{"ovs_bridges":"enabled"},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["bridges","insert",["set",[["named-uuid","temp_520123"]]]]],"op":"mutate"}],"method":"transact","id":779480}
... JSON-RPC response ...
{"id":779480,"result":[{"uuid":["uuid","689b7e7b-50bc-438d-87a7-83e48875f727"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Bridges","where":[],"op":"select"}],"method":"transact","id":839631}
... JSON-RPC response ...
{"id":839631,"result":[{"rows":[{"_uuid":["uuid","689b7e7b-50bc-438d-87a7-83e48875f727"],"_version":["uuid","f2685ef2-ae1a-4de5-93b4-394680030c29"],"ovs_bridges":"enabled","controller":["set",[]]}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:openwrt1
function:gateway.add, model:{'network': 'eth2', 'rip': 'enabled'}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":74140}
... JSON-RPC response ...
{"id":74140,"result":[{"uuid":["uuid","d6faeab6-a41f-4e8a-a0c7-503cfb663ae2"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Gateway","where":[],"op":"select"}],"method":"transact","id":814512}
... JSON-RPC response ...
{"id":814512,"result":[{"rows":[]}],"error":null}
[INFO] module:gateway,function:add,router:openwrt1
Adding a gateway router: rip
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: vtysh -c configure terminal -c interface eth2 -c link-detect -c exit -c router rip -c version 2 -c redistribute connected -c network eth2 -c exit -c exit -c write -c exit
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: /etc/init.d/quagga start
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: vtysh -c configure terminal -c interface eth2 -c link-detect -c exit -c router rip -c version 2 -c redistribute connected -c network eth2 -c exit -c exit -c write -c exit
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: /etc/init.d/quagga restart
[DEBUG] module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'network': 'eth2', 'rip': 'enabled'}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Gateway","uuid-name":"temp_880613","row":{"network":"eth2","rip":"enabled"},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["gateway","insert",["set",[["named-uuid","temp_880613"]]]]],"op":"mutate"}],"method":"transact","id":7585}
... JSON-RPC response ...
{"id":7585,"result":[{"uuid":["uuid","0618b712-9e8f-4aab-a518-63dd240e99bc"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Gateway","where":[],"op":"select"}],"method":"transact","id":874666}
... JSON-RPC response ...
{"id":874666,"result":[{"rows":[{"_version":["uuid","ecaecffa-4157-4663-9045-4e8d909b1be3"],"network":"eth2","_uuid":["uuid","0618b712-9e8f-4aab-a518-63dd240e99bc"],"rip":"enabled"}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:openwrt1
function:vxlan.add, model:{'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.104'], 'local_ip': '192.168.1.101'}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":208500}
... JSON-RPC response ...
{"id":208500,"result":[{"uuid":["uuid","15f7634b-3d89-4ac2-9d63-076626f7f428"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_VXLAN","where":[],"op":"select"}],"method":"transact","id":795915}
... JSON-RPC response ...
{"id":795915,"result":[{"rows":[]}],"error":null}
[INFO] module:vxlan,function:add,router:openwrt1
Adding a VXLAN tunnel: vxlan_103
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-tun vxlan_103 -- set interface vxlan_103 type=vxlan options:in_key=flow options:local_ip=192.168.1.101 options:out_key=flow options:remote_ip=192.168.1.103
[INFO] module:vxlan,function:add,router:openwrt1
Adding a VXLAN tunnel: vxlan_102
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-tun vxlan_102 -- set interface vxlan_102 type=vxlan options:in_key=flow options:local_ip=192.168.1.101 options:out_key=flow options:remote_ip=192.168.1.102
[INFO] module:vxlan,function:add,router:openwrt1
Adding a VXLAN tunnel: vxlan_104
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-tun vxlan_104 -- set interface vxlan_104 type=vxlan options:in_key=flow options:local_ip=192.168.1.101 options:out_key=flow options:remote_ip=192.168.1.104
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["type","==","vxlan"]],"columns":["ofport","options"],"op":"select"}],"method":"transact","id":13173}
... JSON-RPC response ...
{"id":13173,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.101"],["out_key","flow"],["remote_ip","192.168.1.102"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.101"],["out_key","flow"],["remote_ip","192.168.1.103"]]],"ofport":2},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.101"],["out_key","flow"],["remote_ip","192.168.1.104"]]],"ofport":4}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=3,actions=resubmit(,2)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=2,actions=resubmit(,2)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=0,priority=1,in_port=4,actions=resubmit(,2)
[DEBUG] module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'remote_ips': ['192.168.1.103', '192.168.1.102', '192.168.1.104'], 'local_ip': '192.168.1.101'}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_VXLAN","uuid-name":"temp_135233","row":{"remote_ips":["set",["192.168.1.103","192.168.1.102","192.168.1.104"]],"local_ip":"192.168.1.101"},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["vxlan","insert",["set",[["named-uuid","temp_135233"]]]]],"op":"mutate"}],"method":"transact","id":750634}
... JSON-RPC response ...
{"id":750634,"result":[{"uuid":["uuid","23702bec-8ed0-4d96-916f-9b3fa74272d9"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_VXLAN","where":[],"op":"select"}],"method":"transact","id":795050}
... JSON-RPC response ...
{"id":795050,"result":[{"rows":[{"_version":["uuid","62841051-c8d5-4df7-97b7-bb1acd7b7ade"],"_uuid":["uuid","23702bec-8ed0-4d96-916f-9b3fa74272d9"],"local_ip":"192.168.1.101","remote_ips":["set",["192.168.1.102","192.168.1.103","192.168.1.104"]]}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:openwrt1
function:subnets.add, index:('vni', 1), model:{'ip_dvr': '192.168.100.1/24', 'ip_vhost': '192.168.100.101/24', 'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 2, 'vni': 1}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":235304}
... JSON-RPC response ...
{"id":235304,"result":[{"uuid":["uuid","3587078d-1545-40b8-9157-0ff0ac4aec66"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",1]],"op":"select"}],"method":"transact","id":748439}
... JSON-RPC response ...
{"id":748439,"result":[{"rows":[]}],"error":null}
[INFO] module:subnets,function:_crud,router:openwrt1
Adding a subnet(vlan): 2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns add ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addbr br2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link add veth-ns2 type veth peer name temp-ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev temp-ns2 netns ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns2 ip link set dev temp-ns2 name eth0
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int-br2 tag=2 -- set interface int-br2 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int-dvr2 tag=2 -- set interface int-dvr2 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br2 veth-ns2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br2 int-br2
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns2 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns2 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns2 ip link set dev eth0 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-br2 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-br2 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-dvr2 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br2 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns2 ip addr add dev eth0 192.168.100.101/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip addr add dev int-dvr2 192.168.100.1/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns2 ip route add default via 192.168.100.1 dev eth0
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Controller","where":[],"columns":["target"],"op":"select"}],"method":"transact","id":679448}
... JSON-RPC response ...
{"id":679448,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=1,actions=mod_vlan_vid:2,resubmit(,10)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=2,nw_dst=192.168.100.1,actions=drop
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["type","==","vxlan"]],"columns":["ofport","options"],"op":"select"}],"method":"transact","id":584528}
... JSON-RPC response ...
{"id":584528,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.101"],["out_key","flow"],["remote_ip","192.168.1.102"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.101"],["out_key","flow"],["remote_ip","192.168.1.103"]]],"ofport":2},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.101"],["out_key","flow"],["remote_ip","192.168.1.104"]]],"ofport":4}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=2,actions=strip_vlan,set_tunnel:1,output:3,output:2
[DEBUG] module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'ip_dvr': '192.168.100.1/24', 'ip_vhost': '192.168.100.101/24', 'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 2, 'vni': 1}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","uuid-name":"temp_781555","row":{"ip_dvr":"192.168.100.1/24","ip_vhost":"192.168.100.101/24","peers":["set",["192.168.1.102","192.168.1.103"]],"vid":2,"vni":1},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["subnets","insert",["set",[["named-uuid","temp_781555"]]]]],"op":"mutate"}],"method":"transact","id":443853}
... JSON-RPC response ...
{"id":443853,"result":[{"uuid":["uuid","cadf9147-9921-422a-86c2-38cb9e85063a"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",1]],"op":"select"}],"method":"transact","id":281566}
... JSON-RPC response ...
{"id":281566,"result":[{"rows":[{"peers":["set",["192.168.1.102","192.168.1.103"]],"_version":["uuid","f39022ee-5dab-4364-9d45-54c1a4fda301"],"vni":1,"ports":["set",[]],"mode":["set",[]],"vid":2,"_uuid":["uuid","cadf9147-9921-422a-86c2-38cb9e85063a"],"default_gw":["set",[]],"ip_vhost":"192.168.100.101/24","ip_dvr":"192.168.100.1/24"}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:openwrt1
function:subnets.add, index:('vni', 103), model:{'ip_dvr': '10.0.3.1/24', 'ip_vhost': '10.0.3.101/24', 'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 3, 'vni': 103}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":790857}
... JSON-RPC response ...
{"id":790857,"result":[{"uuid":["uuid","e38a49f5-f7f7-49ce-af56-83655836bdec"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",103]],"op":"select"}],"method":"transact","id":890960}
... JSON-RPC response ...
{"id":890960,"result":[{"rows":[]}],"error":null}
[INFO] module:subnets,function:_crud,router:openwrt1
Adding a subnet(vlan): 3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns add ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addbr br3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link add veth-ns3 type veth peer name temp-ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev temp-ns3 netns ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns3 ip link set dev temp-ns3 name eth0
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int-br3 tag=3 -- set interface int-br3 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int-dvr3 tag=3 -- set interface int-dvr3 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br3 veth-ns3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br3 int-br3
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns3 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns3 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns3 ip link set dev eth0 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-br3 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-br3 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-dvr3 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br3 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns3 ip addr add dev eth0 10.0.3.101/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip addr add dev int-dvr3 10.0.3.1/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns3 ip route add default via 10.0.3.1 dev eth0
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Controller","where":[],"columns":["target"],"op":"select"}],"method":"transact","id":569364}
... JSON-RPC response ...
{"id":569364,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=103,actions=mod_vlan_vid:3,resubmit(,10)
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=19,priority=1,dl_type=0x0806,dl_vlan=3,nw_dst=10.0.3.1,actions=drop
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["type","==","vxlan"]],"columns":["ofport","options"],"op":"select"}],"method":"transact","id":799548}
... JSON-RPC response ...
{"id":799548,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.101"],["out_key","flow"],["remote_ip","192.168.1.102"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.101"],["out_key","flow"],["remote_ip","192.168.1.103"]]],"ofport":2},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.101"],["out_key","flow"],["remote_ip","192.168.1.104"]]],"ofport":4}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=3,actions=strip_vlan,set_tunnel:103,output:3,output:2
[DEBUG] module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'ip_dvr': '10.0.3.1/24', 'ip_vhost': '10.0.3.101/24', 'peers': ['192.168.1.102', '192.168.1.103'], 'vid': 3, 'vni': 103}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","uuid-name":"temp_456965","row":{"ip_dvr":"10.0.3.1/24","ip_vhost":"10.0.3.101/24","peers":["set",["192.168.1.102","192.168.1.103"]],"vid":3,"vni":103},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["subnets","insert",["set",[["named-uuid","temp_456965"]]]]],"op":"mutate"}],"method":"transact","id":189905}
... JSON-RPC response ...
{"id":189905,"result":[{"uuid":["uuid","ac114169-6bf0-4cbd-b687-24bde60b2b64"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",103]],"op":"select"}],"method":"transact","id":193584}
... JSON-RPC response ...
{"id":193584,"result":[{"rows":[{"peers":["set",["192.168.1.102","192.168.1.103"]],"_version":["uuid","0036b95a-842c-47b3-a0b7-ff93d7a03c8a"],"vni":103,"ports":["set",[]],"mode":["set",[]],"vid":3,"_uuid":["uuid","ac114169-6bf0-4cbd-b687-24bde60b2b64"],"default_gw":["set",[]],"ip_vhost":"10.0.3.101/24","ip_dvr":"10.0.3.1/24"}]}],"error":null}
[INFO] module:nlan_agent,function:_route,router:openwrt1
function:subnets.add, index:('vni', 1001), model:{'peers': ['192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.101/24', 'vni': 1001, 'ip_dvr': '10.0.1.1/24', 'mode': 'hub'}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN","row":{},"op":"insert"}],"method":"transact","id":995409}
... JSON-RPC response ...
{"id":995409,"result":[{"uuid":["uuid","77f4b285-e607-43cf-8133-b3f5650733a1"]},{"error":"constraint violation","details":"transaction causes \"NLAN\" table to contain 2 rows, greater than the schema-defined limit of 1 row(s)"}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",1001]],"op":"select"}],"method":"transact","id":832265}
... JSON-RPC response ...
{"id":832265,"result":[{"rows":[]}],"error":null}
[INFO] module:subnets,function:_crud,router:openwrt1
Adding a subnet(vlan): 1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns add ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addbr br1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link add veth-ns1 type veth peer name temp-ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev temp-ns1 netns ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1 ip link set dev temp-ns1 name eth0
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int-br1 tag=1 -- set interface int-br1 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-vsctl add-port br-int int-dvr1 tag=1 -- set interface int-dvr1 type=internal
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br1 veth-ns1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: brctl addif br1 int-br1
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev veth-ns1 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1 ip link set dev eth0 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-br1 promisc on
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-br1 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev int-dvr1 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip link set dev br1 up
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1 ip addr add dev eth0 10.0.1.101/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip addr add dev int-dvr1 10.0.1.1/24
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ip netns exec ns1 ip route add default via 10.0.1.1 dev eth0
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Controller","where":[],"columns":["target"],"op":"select"}],"method":"transact","id":426273}
... JSON-RPC response ...
{"id":426273,"result":[{"rows":[]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=2,priority=1,tun_id=1001,actions=mod_vlan_vid:1,resubmit(,10)
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"Interface","where":[["type","==","vxlan"]],"columns":["ofport","options"],"op":"select"}],"method":"transact","id":173065}
... JSON-RPC response ...
{"id":173065,"result":[{"rows":[{"options":["map",[["in_key","flow"],["local_ip","192.168.1.101"],["out_key","flow"],["remote_ip","192.168.1.102"]]],"ofport":3},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.101"],["out_key","flow"],["remote_ip","192.168.1.103"]]],"ofport":2},{"options":["map",[["in_key","flow"],["local_ip","192.168.1.101"],["out_key","flow"],["remote_ip","192.168.1.104"]]],"ofport":4}]}],"error":null}
[DEBUG] module:cmdutil,function:_cmd2,router:openwrt1
cmd: ovs-ofctl add-flow br-tun table=21,priority=1,dl_vlan=1,actions=strip_vlan,set_tunnel:1001,output:4
[DEBUG] module:ovsdb,function:crud,router:openwrt1
CRUD operation (add): {'peers': ['192.168.1.104'], 'vid': 1, 'ip_vhost': '10.0.1.101/24', 'vni': 1001, 'ip_dvr': '10.0.1.1/24', 'mode': 'hub'}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","uuid-name":"temp_244223","row":{"peers":["set",["192.168.1.104"]],"vid":1,"ip_vhost":"10.0.1.101/24","vni":1001,"ip_dvr":"10.0.1.1/24","mode":"hub"},"op":"insert"},{"table":"NLAN","where":[],"mutations":[["subnets","insert",["set",[["named-uuid","temp_244223"]]]]],"op":"mutate"}],"method":"transact","id":44986}
... JSON-RPC response ...
{"id":44986,"result":[{"uuid":["uuid","fa5ad692-34c7-427d-bb07-679112071bed"]},{"count":1}],"error":null}
[DEBUG] module:ovsdb,function:_send,router:openwrt1
... JSON-RPC request ...
{"params":["Open_vSwitch",{"table":"NLAN_Subnet","where":[["vni","==",1001]],"op":"select"}],"method":"transact","id":266983}
... JSON-RPC response ...
{"id":266983,"result":[{"rows":[{"peers":"192.168.1.104","_version":["uuid","93dcd796-1e04-45c3-bcf2-6e1100f2b607"],"vni":1001,"ports":["set",[]],"mode":"hub","vid":1,"_uuid":["uuid","fa5ad692-34c7-427d-bb07-679112071bed"],"default_gw":["set",[]],"ip_vhost":"10.0.1.101/24","ip_dvr":"10.0.1.1/24"}]}],"error":null}
__ NLAN response __
message: Execution completed
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:45:29.839567

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         2.93(sec)
rpi1              :-)         2.99(sec)
openwrt2          :-)         3.13(sec)
openwrt1          :-)         5.44(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns add ns-global
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:45:37.015389

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.32(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip link add veth-global type veth peer name temp
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:45:38.712944

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.34(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip link set dev temp netns ns-global
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:45:40.363576

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.33(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns-global ip link set dev temp name eth0
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:45:42.033968

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.33(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns-global ip addr add dev eth0 8.8.8.8/24
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:45:43.720179

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.33(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip link set dev veth-global up
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:45:45.384474

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.32(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip addr add dev veth-global 8.8.8.1/24
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:45:47.030628

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.32(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns-global ip link set dev eth0 up
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:45:48.700661

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.33(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns-global ip route add default via  8.8.8.1
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:45:50.353393

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.32(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
rpi1             192.168.1.104  OK
openwrt1         192.168.1.101  OK
openwrt2         192.168.1.102  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: test.echo Hello World!
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: test.echo Hello World!
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: test.echo Hello World!
=+=+= NLAN Request to router:rpi1,platform:debian =+=+=+=+=+=+=+=+=+=+=+=+=+=+
command: test.echo Hello World!
=+=+= NLAN Response from router:rpi1,platform:debian +=+=+=+=+=+=+=+=+=+=+=+=+
Hello World!
__ NLAN response __
message: Execution completed
exit: 0
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
Hello World!
__ NLAN response __
message: Execution completed
exit: 0
=+=+= NLAN Response from router:openwrt1,platform:openwrt =+=+=+=+=+=+=+=+=+=+
Hello World!
__ NLAN response __
message: Execution completed
exit: 0
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
Hello World!
__ NLAN response __
message: Execution completed
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:45:52.011388

Router           Result    Elapsed Time
---------------------------------------
rpi1              :-)         1.07(sec)
openwrt3          :-)         1.12(sec)
openwrt1          :-)         1.14(sec)
openwrt2          :-)         1.18(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns1 ping -c 1 10.0.1.102
=+=+= NLAN Response from router:openwrt1,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.1.102 (10.0.1.102): 56 data bytes
64 bytes from 10.0.1.102: seq=0 ttl=64 time=10.141 ms

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 10.141/10.141/10.141 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:45:54.696784

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.34(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns1 ping -c 1 10.0.1.102
=+=+= NLAN Response from router:openwrt1,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.1.102 (10.0.1.102): 56 data bytes
64 bytes from 10.0.1.102: seq=0 ttl=64 time=2.320 ms

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 2.320/2.320/2.320 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:45:56.338292

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.32(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 10.0.3.103
=+=+= NLAN Response from router:openwrt1,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.3.103 (10.0.3.103): 56 data bytes
64 bytes from 10.0.3.103: seq=0 ttl=64 time=6.727 ms

--- 10.0.3.103 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 6.727/6.727/6.727 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:45:57.982920

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.33(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 10.0.1.101
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.1.101 (10.0.1.101): 56 data bytes
64 bytes from 10.0.1.101: seq=0 ttl=63 time=15.270 ms

--- 10.0.1.101 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 15.270/15.270/15.270 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:45:59.643472

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.34(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns1 ping -c 1 192.168.100.1
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=16.826 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 16.826/16.826/16.826 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:46:01.301379

Router           Result    Elapsed Time
---------------------------------------
openwrt2          :-)         0.36(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns1 ping -c 1 192.168.100.1
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=13.310 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 13.310/13.310/13.310 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:46:02.971629

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.35(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 192.168.100.1
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=10.021 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 10.021/10.021/10.021 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:46:04.650920

Router           Result    Elapsed Time
---------------------------------------
openwrt2          :-)         0.34(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ping -c 1 192.168.100.1
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=3.862 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 3.862/3.862/3.862 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:46:06.291904

Router           Result    Elapsed Time
---------------------------------------
openwrt2          :-)         0.34(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 10.0.1.102
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.1.102 (10.0.1.102): 56 data bytes
64 bytes from 10.0.1.102: seq=0 ttl=63 time=8.720 ms

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 8.720/8.720/8.720 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:46:07.936089

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.34(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 10.0.1.1
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.1.1 (10.0.1.1): 56 data bytes
64 bytes from 10.0.1.1: seq=0 ttl=64 time=3.941 ms

--- 10.0.1.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 3.941/3.941/3.941 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:46:09.593675

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.33(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 10.0.1.1
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.1.1 (10.0.1.1): 56 data bytes
64 bytes from 10.0.1.1: seq=0 ttl=64 time=1.300 ms

--- 10.0.1.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 1.300/1.300/1.300 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:46:11.239726

Router           Result    Elapsed Time
---------------------------------------
openwrt2          :-)         0.33(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns1 ping -c 1 8.8.8.8
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=6.308 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 6.308/6.308/6.308 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:46:12.907231

Router           Result    Elapsed Time
---------------------------------------
openwrt2          :-)         0.34(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 8.8.8.8
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=4.103 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 4.103/4.103/4.103 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:46:14.582706

Router           Result    Elapsed Time
---------------------------------------
openwrt2          :-)         0.33(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns1 ping -c 1 8.8.8.8
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=5.062 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 5.062/5.062/5.062 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:46:16.195258

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.32(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 8.8.8.8
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=6.875 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 6.875/6.875/6.875 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:46:17.848546

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.33(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
openwrt2         192.168.1.102  OK
rpi1             192.168.1.104  OK
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: system.reboot
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: system.reboot
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: system.reboot
=+=+= NLAN Request to router:rpi1,platform:debian =+=+=+=+=+=+=+=+=+=+=+=+=+=+
command: system.reboot
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
__ NLAN response __
message: Execution completed
exit: 0
=+=+= NLAN Response from router:openwrt1,platform:openwrt =+=+=+=+=+=+=+=+=+=+
__ NLAN response __
message: Execution completed
exit: 0
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
__ NLAN response __
message: Execution completed
exit: 0
=+=+= NLAN Response from router:rpi1,platform:debian +=+=+=+=+=+=+=+=+=+=+=+=+
__ NLAN response __
message: Execution completed
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:46:19.521261

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.89(sec)
openwrt1          :-)         1.17(sec)
openwrt2          :-)         1.17(sec)
rpi1              :-)         1.33(sec)

Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  NG
openwrt1         192.168.1.101  NG
openwrt3         192.168.1.103  NG
rpi1             192.168.1.104  NG

Router           Host           Ping
------------------------------------
rpi1             192.168.1.104  OK
openwrt1         192.168.1.101  OK
openwrt3         192.168.1.103  OK
openwrt2         192.168.1.102  OK
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns add ns-global
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:46:43.748054

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.17(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip link add veth-global type veth peer name temp
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:46:45.089299

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.18(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip link set dev temp netns ns-global
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:46:46.473612

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.22(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns-global ip link set dev temp name eth0
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:46:48.204822

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.29(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns-global ip addr add dev eth0 8.8.8.8/24
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:46:49.801682

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.37(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip link set dev veth-global up
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:46:51.508691

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.36(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip addr add dev veth-global 8.8.8.1/24
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:46:53.206939

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.38(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns-global ip link set dev eth0 up
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:46:54.976101

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.35(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns-global ip route add default via  8.8.8.1
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:46:56.727787

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.33(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
openwrt1         192.168.1.101  OK
openwrt3         192.168.1.103  OK
rpi1             192.168.1.104  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: test.echo Hello World!
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: test.echo Hello World!
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
command: test.echo Hello World!
=+=+= NLAN Request to router:rpi1,platform:debian =+=+=+=+=+=+=+=+=+=+=+=+=+=+
command: test.echo Hello World!
=+=+= NLAN Request Failure router:rpi1,platform:debian +=+=+=+=+=+=+=+=+=+=+=+
__ Exception __
exit: 1
exception: error
message: See the traceback message
traceeback: Traceback (most recent call last):
  File "/root/neutron-lan/nlan/nlan.py", line 88, in _ssh_session
    ssh.connect(host,username=user,password=passwd,timeout=SSH_TIMEOUT)
  File "/usr/local/lib/python2.7/dist-packages/paramiko/client.py", line 305, in connect
    retry_on_signal(lambda: sock.connect(addr))
  File "/usr/local/lib/python2.7/dist-packages/paramiko/util.py", line 278, in retry_on_signal
    return function()
  File "/usr/local/lib/python2.7/dist-packages/paramiko/client.py", line 305, in <lambda>
    retry_on_signal(lambda: sock.connect(addr))
  File "/usr/lib/python2.7/socket.py", line 224, in meth
    return getattr(self._sock,name)(*args)
error: [Errno 111] Connection refused

=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
Hello World!
__ NLAN response __
message: Execution completed
exit: 0
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
Hello World!
__ NLAN response __
message: Execution completed
exit: 0
=+=+= NLAN Response from router:openwrt1,platform:openwrt =+=+=+=+=+=+=+=+=+=+
Hello World!
__ NLAN response __
message: Execution completed
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:47:03.400487

Router           Result    Elapsed Time
---------------------------------------
rpi1              XXX         0.11(sec)
openwrt3          :-)         0.99(sec)
openwrt2          :-)         1.01(sec)
openwrt1          :-)         1.02(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns1 ping -c 1 10.0.1.102
=+=+= NLAN Response from router:openwrt1,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.1.102 (10.0.1.102): 56 data bytes

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 0 packets received, 100% packet loss
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:47:06.106461

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)        10.36(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns1 ping -c 1 10.0.1.102
=+=+= NLAN Response from router:openwrt1,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.1.102 (10.0.1.102): 56 data bytes
64 bytes from 10.0.1.102: seq=0 ttl=64 time=13.704 ms

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 13.704/13.704/13.704 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:47:17.817868

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.37(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt1         192.168.1.101  OK
=+=+= NLAN Request to router:openwrt1,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 10.0.3.103
=+=+= NLAN Response from router:openwrt1,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.3.103 (10.0.3.103): 56 data bytes
64 bytes from 10.0.3.103: seq=0 ttl=64 time=7.273 ms

--- 10.0.3.103 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 7.273/7.273/7.273 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:47:19.476007

Router           Result    Elapsed Time
---------------------------------------
openwrt1          :-)         0.33(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 10.0.1.101
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.1.101 (10.0.1.101): 56 data bytes
64 bytes from 10.0.1.101: seq=0 ttl=63 time=15.867 ms

--- 10.0.1.101 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 15.867/15.867/15.867 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:47:21.119028

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.34(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns1 ping -c 1 192.168.100.1
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=12.038 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 12.038/12.038/12.038 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:47:22.774332

Router           Result    Elapsed Time
---------------------------------------
openwrt2          :-)         0.34(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns1 ping -c 1 192.168.100.1
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=13.173 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 13.173/13.173/13.173 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:47:24.414673

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.34(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 192.168.100.1
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=5.419 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 5.419/5.419/5.419 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:47:26.060839

Router           Result    Elapsed Time
---------------------------------------
openwrt2          :-)         0.33(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ping -c 1 192.168.100.1
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 192.168.100.1 (192.168.100.1): 56 data bytes
64 bytes from 192.168.100.1: seq=0 ttl=64 time=3.473 ms

--- 192.168.100.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 3.473/3.473/3.473 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:47:27.707100

Router           Result    Elapsed Time
---------------------------------------
openwrt2          :-)         0.33(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 10.0.1.102
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.1.102 (10.0.1.102): 56 data bytes
64 bytes from 10.0.1.102: seq=0 ttl=63 time=8.128 ms

--- 10.0.1.102 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 8.128/8.128/8.128 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:47:29.367335

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.35(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 10.0.1.1
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.1.1 (10.0.1.1): 56 data bytes
64 bytes from 10.0.1.1: seq=0 ttl=64 time=3.096 ms

--- 10.0.1.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 3.096/3.096/3.096 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:47:31.034695

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.32(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 10.0.1.1
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 10.0.1.1 (10.0.1.1): 56 data bytes
64 bytes from 10.0.1.1: seq=0 ttl=64 time=1.365 ms

--- 10.0.1.1 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 1.365/1.365/1.365 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:47:32.678306

Router           Result    Elapsed Time
---------------------------------------
openwrt2          :-)         0.33(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns1 ping -c 1 8.8.8.8
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=7.224 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 7.224/7.224/7.224 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:47:34.322692

Router           Result    Elapsed Time
---------------------------------------
openwrt2          :-)         0.33(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt2         192.168.1.102  OK
=+=+= NLAN Request to router:openwrt2,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 8.8.8.8
=+=+= NLAN Response from router:openwrt2,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=4.023 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 4.023/4.023/4.023 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:47:36.011770

Router           Result    Elapsed Time
---------------------------------------
openwrt2          :-)         0.32(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns1 ping -c 1 8.8.8.8
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=7.348 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 7.348/7.348/7.348 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:47:37.676525

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.36(sec)
=+=+= Ping test to all the target routers =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
Router           Host           Ping
------------------------------------
openwrt3         192.168.1.103  OK
=+=+= NLAN Request to router:openwrt3,platform:openwrt +=+=+=+=+=+=+=+=+=+=+=+
operation: --raw
command: ip netns exec ns3 ping -c 1 8.8.8.8
=+=+= NLAN Response from router:openwrt3,platform:openwrt =+=+=+=+=+=+=+=+=+=+
PING 8.8.8.8 (8.8.8.8): 56 data bytes
64 bytes from 8.8.8.8: seq=0 ttl=63 time=7.204 ms

--- 8.8.8.8 ping statistics ---
1 packets transmitted, 1 packets received, 0% packet loss
round-trip min/avg/max = 7.204/7.204/7.204 ms
exit: 0
=+=+= Transaction Summary =+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

Start Time: 2014-04-25 01:47:39.345899

Router           Result    Elapsed Time
---------------------------------------
openwrt3          :-)         0.35(sec)
